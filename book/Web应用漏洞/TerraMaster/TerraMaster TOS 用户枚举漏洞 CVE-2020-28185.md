# TerraMaster TOS 用户枚举漏洞 CVE-2020-28185

## 漏洞描述

TerraMaster TOS 存在用户枚举漏洞，通过wizard/initialise.php页面的username参数即可枚举系统中的用户，以及泄露邮箱信息

## 漏洞影响

> [!NOTE]
>
> TerraMaster TOS < 4.2.06

## FOFA

> [!NOTE]
>
> "TerraMaster" && header="TOS"

## 漏洞复现

漏洞点来源于找回密码的用户存在校验

![](http://wikioss.peiqi.tech/vuln/tm-3.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10)

输入用户名 admin 点击确定，查看Burp捕获的包

其中有一个请求包用于确认用户admin是否存在

![](http://wikioss.peiqi.tech/vuln/tm-4.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10)

存在则返回用户的邮箱信息

